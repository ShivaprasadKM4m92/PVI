<?xml version="1.0" encoding="utf-8"?>
<HTTPSnapshot xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" id="59">
  <HTTPTask id="590" hostname="10.100.22.228:8081" path="/assets/app/dashboard/dashboard-manifest-341004fa249db2aaf456b8b3f9116380.js" url="http://10.100.22.228:8081/assets/app/dashboard/dashboard-manifest-341004fa249db2aaf456b8b3f9116380.js" ip="10.100.22.228" port="8081" connectionId="41" origin="Primary" frame="1" startDateTime="2020-07-13T17:29:18.060+05:30" startTime="620990781" endTime="620993484">
    <HTTPRequest method="GET">
      <HTTPHeaders>
        <HTTPHeaderEntity name="Host" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MTAuMTAwLjIyLjIyODo4MDgx</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Connection" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>a2VlcC1hbGl2ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="User-Agent" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzgzLjAuNDEwMy4xMTYgU2FmYXJpLzUzNy4zNg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Ki8q</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Referer" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aHR0cDovLzEwLjEwMC4yMi4yMjg6ODA4MS8=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Encoding" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcCwgZGVmbGF0ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Language" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>ZW4tVVMsZW47cT0wLjk=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cookie" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>U0VTU0lPTj0xZmVlMTIwMC05NDQxLTQyYzUtYTUxYS1iMjhhZmU4OGVjYjQ7IEF1dGhUeXBlPURhdGFiYXNl</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>R0VUIC9hc3NldHMvYXBwL2Rhc2hib2FyZC9kYXNoYm9hcmQtbWFuaWZlc3QtMzQxMDA0ZmEyNDlkYjJhYWY0NTZiOGIzZjkxMTYzODAuanMgSFRUUC8xLjENCkhvc3Q6IDEwLjEwMC4yMi4yMjg6ODA4MQ0KQ29ubmVjdGlvbjoga2VlcC1hbGl2ZQ0KVXNlci1BZ2VudDogTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzgzLjAuNDEwMy4xMTYgU2FmYXJpLzUzNy4zNg0KQWNjZXB0OiAqLyoNClJlZmVyZXI6IGh0dHA6Ly8xMC4xMDAuMjIuMjI4OjgwODEvDQpBY2NlcHQtRW5jb2Rpbmc6IGd6aXAsIGRlZmxhdGUNCkFjY2VwdC1MYW5ndWFnZTogZW4tVVMsZW47cT0wLjkNCkNvb2tpZTogU0VTU0lPTj0xZmVlMTIwMC05NDQxLTQyYzUtYTUxYS1iMjhhZmU4OGVjYjQ7IEF1dGhUeXBlPURhdGFiYXNlDQoNCg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
        <HTTPCookies>
          <HTTPHeaderEntity name="SESSION" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MWZlZTEyMDAtOTQ0MS00MmM1LWE1MWEtYjI4YWZlODhlY2I0</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="AuthType" index="1">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>RGF0YWJhc2U=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
        </HTTPCookies>
      </HTTPHeaders>
    </HTTPRequest>
    <HTTPResponse>
      <contentLenght>99424</contentLenght>
      <HTTPHeaders>
        <HTTPHeaderEntity name="X-Frame-Options" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>REVOWQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Last-Modified" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>RnJpLCAxMCBKdWwgMjAyMCAxMTo1NzozNCBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="ETag" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>ImFwcC9kYXNoYm9hcmQvZGFzaGJvYXJkLW1hbmlmZXN0LTM0MTAwNGZhMjQ5ZGIyYWFmNDU2YjhiM2Y5MTE2MzgwLmpzIg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Vary" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>QWNjZXB0LUVuY29kaW5n</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cache-Control" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>cHVibGljLCBtYXgtYWdlPTMxNTM2MDAw</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Encoding" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Type" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>YXBwbGljYXRpb24vamF2YXNjcmlwdDtjaGFyc2V0PVVURi04</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Length" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>OTk0MjQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Date" index="8">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TW9uLCAxMyBKdWwgMjAyMCAxMToyNTo1MSBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>SFRUUC8xLjEgMjAwIA0KWC1GcmFtZS1PcHRpb25zOiBERU5ZDQpMYXN0LU1vZGlmaWVkOiBGcmksIDEwIEp1bCAyMDIwIDExOjU3OjM0IEdNVA0KRVRhZzogImFwcC9kYXNoYm9hcmQvZGFzaGJvYXJkLW1hbmlmZXN0LTM0MTAwNGZhMjQ5ZGIyYWFmNDU2YjhiM2Y5MTE2MzgwLmpzIg0KVmFyeTogQWNjZXB0LUVuY29kaW5nDQpDYWNoZS1Db250cm9sOiBwdWJsaWMsIG1heC1hZ2U9MzE1MzYwMDANCkNvbnRlbnQtRW5jb2Rpbmc6IGd6aXANCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdDtjaGFyc2V0PVVURi04DQpDb250ZW50LUxlbmd0aDogOTk0MjQNCkRhdGU6IE1vbiwgMTMgSnVsIDIwMjAgMTE6MjU6NTEgR01UDQoNCg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
      </HTTPHeaders>
      <HTTPBody>
        <HTTPDataSet>
          <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
            <ActualData>LyoqDQogKiBncmlkc3RhY2suanMgMC4zLjAtZGV2DQogKiBodHRwOi8vdHJvb2xlZS5naXRodWIuaW8vZ3JpZHN0YWNrLmpzLw0KICogKGMpIDIwMTQtMjAxNiBQYXZlbCBSZXpuaWtvdiwgRHlsYW4gV2Vpc3MNCiAqIGdyaWRzdGFjay5qcyBtYXkgYmUgZnJlZWx5IGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4NCiAqIEBwcmVzZXJ2ZQ0KKi8NCiFmdW5jdGlvbihhKXtpZigiZnVuY3Rpb24iPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kKWRlZmluZShbImpxdWVyeSIsImxvZGFzaCJdLGEpO2Vsc2UgaWYoInVuZGVmaW5lZCIhPXR5cGVvZiBleHBvcnRzKXt0cnl7alF1ZXJ5PXJlcXVpcmUoImpxdWVyeSIpfWNhdGNoKGEpe310cnl7Xz1yZXF1aXJlKCJsb2Rhc2giKX1jYXRjaChhKXt9YShqUXVlcnksXyl9ZWxzZSBhKGpRdWVyeSxfKX0oZnVuY3Rpb24oYSxiKXsNCi8vIGpzY3M6ZW5hYmxlIHJlcXVpcmVDYW1lbENhc2VPclVwcGVyQ2FzZUlkZW50aWZpZXJzDQovKioNCiAgICAqIEBjbGFzcyBHcmlkU3RhY2tEcmFnRHJvcFBsdWdpbg0KICAgICogQmFzZSBjbGFzcyBmb3IgZHJhZyduJ2Ryb3AgcGx1Z2luLg0KICAgICovDQpmdW5jdGlvbiBjKGEpe3RoaXMuZ3JpZD1hfXZhciBkPXdpbmRvdyxlPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD1mdW5jdGlvbigpe3JldHVybiBjb25zb2xlLndhcm4oImdyaWRzdGFjay5qczogRnVuY3Rpb24gYCIrYisiYCBpcyBkZXByZWNhdGVkIGFzIG9mIHYwLjIuNSBhbmQgaGFzIGJlZW4gcmVwbGFjZWQgd2l0aCBgIitjKyJgLiBJdCB3aWxsIGJlICoqY29tcGxldGVseSoqIHJlbW92ZWQgaW4gdjEuMC4iKSxhLmFwcGx5KHRoaXMsYXJndW1lbnRzKX07cmV0dXJuIGQucHJvdG90eXBlPWEucHJvdG90eXBlLGR9LGY9ZnVuY3Rpb24oYSxiKXtjb25zb2xlLndhcm4oImdyaWRzdGFjay5qczogT3B0aW9uIGAiK2ErImAgaXMgZGVwcmVjYXRlZCBhcyBvZiB2MC4yLjUgYW5kIGhhcyBiZWVuIHJlcGxhY2VkIHdpdGggYCIrYisiYC4gSXQgd2lsbCBiZSAqKmNvbXBsZXRlbHkqKiByZW1vdmVkIGluIHYxLjAuIil9LGc9e2lzSW50ZXJjZXB0ZWQ6ZnVuY3Rpb24oYSxiKXtyZXR1cm4hKGEueCthLndpZHRoPD1iLnh8fGIueCtiLndpZHRoPD1hLnh8fGEueSthLmhlaWdodDw9Yi55fHxiLnkrYi5oZWlnaHQ8PWEueSl9LHNvcnQ6ZnVuY3Rpb24oYSxjLGQpe3JldHVybiBkPWR8fGIuY2hhaW4oYSkubWFwKGZ1bmN0aW9uKGEpe3JldHVybiBhLngrYS53aWR0aH0pLm1heCgpLnZhbHVlKCksYz1jIT0tMT8xOi0xLGIuc29ydEJ5KGEsZnVuY3Rpb24oYSl7cmV0dXJuIGMqKGEueCthLnkqZCl9KX0sY3JlYXRlU3R5bGVzaGVldDpmdW5jdGlvbihhKXt2YXIgYj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzdHlsZSIpO3JldHVybiBiLnNldEF0dHJpYnV0ZSgidHlwZSIsInRleHQvY3NzIiksYi5zZXRBdHRyaWJ1dGUoImRhdGEtZ3Mtc3R5bGUtaWQiLGEpLGIuc3R5bGVTaGVldD9iLnN0eWxlU2hlZXQuY3NzVGV4dD0iIjpiLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCIiKSksZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImhlYWQiKVswXS5hcHBlbmRDaGlsZChiKSxiLnNoZWV0fSxyZW1vdmVTdHlsZXNoZWV0OmZ1bmN0aW9uKGIpe2EoIlNUWUxFW2RhdGEtZ3Mtc3R5bGUtaWQ9IitiKyJdIikucmVtb3ZlKCl9LGluc2VydENTU1J1bGU6ZnVuY3Rpb24oYSxiLGMsZCl7ImZ1bmN0aW9uIj09dHlwZW9mIGEuaW5zZXJ0UnVsZT9hLmluc2VydFJ1bGUoYisieyIrYysifSIsZCk6ImZ1bmN0aW9uIj09dHlwZW9mIGEuYWRkUnVsZSYmYS5hZGRSdWxlKGIsYyxkKX0sdG9Cb29sOmZ1bmN0aW9uKGEpe3JldHVybiJib29sZWFuIj09dHlwZW9mIGE/YToic3RyaW5nIj09dHlwZW9mIGE/KGE9YS50b0xvd2VyQ2FzZSgpLCEoIiI9PT1hfHwibm8iPT1hfHwiZmFsc2UiPT1hfHwiMCI9PWEpKTpCb29sZWFuKGEpfSxfY29sbGlzaW9uTm9kZUNoZWNrOmZ1bmN0aW9uKGEpe3JldHVybiBhIT10aGlzLm5vZGUmJmcuaXNJbnRlcmNlcHRlZChhLHRoaXMubm4pfSxfZGlkQ29sbGlkZTpmdW5jdGlvbihhKXtyZXR1cm4gZy5pc0ludGVyY2VwdGVkKHt4OnRoaXMubi54LHk6dGhpcy5uZXdZLHdpZHRoOnRoaXMubi53aWR0aCxoZWlnaHQ6dGhpcy5uLmhlaWdodH0sYSl9LF9pc0FkZE5vZGVJbnRlcmNlcHRlZDpmdW5jdGlvbihhKXtyZXR1cm4gZy5pc0ludGVyY2VwdGVkKHt4OnRoaXMueCx5OnRoaXMueSx3aWR0aDp0aGlzLm5vZGUud2lkdGgsaGVpZ2h0OnRoaXMubm9kZS5oZWlnaHR9LGEpfSxwYXJzZUhlaWdodDpmdW5jdGlvbihhKXt2YXIgYz1hLGQ9InB4IjtpZihjJiZiLmlzU3RyaW5nKGMpKXt2YXIgZT1jLm1hdGNoKC9eKC1bMC05XStcLlswLTldK3xbMC05XSpcLlswLTldK3wtWzAtOV0rfFswLTldKykocHh8ZW18cmVtfHZofHZ3KT8kLyk7aWYoIWUpdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIGhlaWdodCIpO2Q9ZVsyXXx8InB4IixjPXBhcnNlRmxvYXQoZVsxXSl9cmV0dXJue2hlaWdodDpjLHVuaXQ6ZH19fTsNCi8vIGpzY3M6ZGlzYWJsZSByZXF1aXJlQ2FtZWxDYXNlT3JVcHBlckNhc2VJZGVudGlmaWVycw0KZy5pc19pbnRlcmNlcHRlZD1lKGcuaXNJbnRlcmNlcHRlZCwiaXNfaW50ZXJjZXB0ZWQiLCJpc0ludGVyY2VwdGVkIiksZy5jcmVhdGVfc3R5bGVzaGVldD1lKGcuY3JlYXRlU3R5bGVzaGVldCwiY3JlYXRlX3N0eWxlc2hlZXQiLCJjcmVhdGVTdHlsZXNoZWV0IiksZy5yZW1vdmVfc3R5bGVzaGVldD1lKGcucmVtb3ZlU3R5bGVzaGVldCwicmVtb3ZlX3N0eWxlc2hlZXQiLCJyZW1vdmVTdHlsZXNoZWV0IiksZy5pbnNlcnRfY3NzX3J1bGU9ZShnLmluc2VydENTU1J1bGUsImluc2VydF9jc3NfcnVsZSIsImluc2VydENTU1J1bGUiKSxjLnJlZ2lzdGVyZWRQbHVnaW5zPVtdLGMucmVnaXN0ZXJQbHVnaW49ZnVuY3Rpb24oYSl7Yy5yZWdpc3RlcmVkUGx1Z2lucy5wdXNoKGEpfSxjLnByb3RvdHlwZS5yZXNpemFibGU9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpc30sYy5wcm90b3R5cGUuZHJhZ2dhYmxlPWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXN9LGMucHJvdG90eXBlLmRyb3BwYWJsZT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzfSxjLnByb3RvdHlwZS5pc0Ryb3BwYWJsZT1mdW5jdGlvbihhKXtyZXR1cm4hMX0sYy5wcm90b3R5cGUub249ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB0aGlzfTt2YXIgaD0wLGk9ZnVuY3Rpb24oYSxiLGMsZCxlKXt0aGlzLndpZHRoPWEsdGhpcy5mbG9hdD1jfHwhMSx0aGlzLmhlaWdodD1kfHwwLHRoaXMubm9kZXM9ZXx8W10sdGhpcy5vbmNoYW5nZT1ifHxmdW5jdGlvbigpe30sdGhpcy5fdXBkYXRlQ291bnRlcj0wLHRoaXMuX2Zsb2F0PXRoaXMuZmxvYXQsdGhpcy5fYWRkZWROb2Rlcz1bXSx0aGlzLl9yZW1vdmVkTm9kZXM9W119O2kucHJvdG90eXBlLmJhdGNoVXBkYXRlPWZ1bmN0aW9uKCl7dGhpcy5fdXBkYXRlQ291bnRlcj0xLHRoaXMuZmxvYXQ9ITB9LGkucHJvdG90eXBlLmNvbW1pdD1mdW5jdGlvbigpezAhPT10aGlzLl91cGRhdGVDb3VudGVyJiYodGhpcy5fdXBkYXRlQ291bnRlcj0wLHRoaXMuZmxvYXQ9dGhpcy5fZmxvYXQsdGhpcy5fcGFja05vZGVzKCksdGhpcy5fbm90aWZ5KCkpfSwNCi8vIEZvciBNZXRlb3Igc3VwcG9ydDogaHR0cHM6Ly9naXRodWIuY29tL3Ryb29sZWUvZ3JpZHN0YWNrLmpzL3B1bGwvMjcyDQppLnByb3RvdHlwZS5nZXROb2RlRGF0YUJ5RE9NRWw9ZnVuY3Rpb24oYSl7cmV0dXJuIGIuZmluZCh0aGlzLm5vZGVzLGZ1bmN0aW9uKGIpe3JldHVybiBhLmdldCgwKT09PWIuZWwuZ2V0KDApfSl9LGkucHJvdG90eXBlLl9maXhDb2xsaXNpb25zPWZ1bmN0aW9uKGEpe3RoaXMuX3NvcnROb2RlcygtMSk7dmFyIGM9YSxkPUJvb2xlYW4oYi5maW5kKHRoaXMubm9kZXMsZnVuY3Rpb24oYSl7cmV0dXJuIGEubG9ja2VkfSkpO2Zvcih0aGlzLmZsb2F0fHxkfHwoYz17eDowLHk6YS55LHdpZHRoOnRoaXMud2lkdGgsaGVpZ2h0OmEuaGVpZ2h0fSk7Oyl7dmFyIGU9Yi5maW5kKHRoaXMubm9kZXMsYi5iaW5kKGcuX2NvbGxpc2lvbk5vZGVDaGVjayx7bm9kZTphLG5uOmN9KSk7aWYoInVuZGVmaW5lZCI9PXR5cGVvZiBlKXJldHVybjt0aGlzLm1vdmVOb2RlKGUsZS54LGEueSthLmhlaWdodCxlLndpZHRoLGUuaGVpZ2h0LCEwKX19LGkucHJvdG90eXBlLmlzQXJlYUVtcHR5PWZ1bmN0aW9uKGEsYyxkLGUpe3ZhciBmPXt4OmF8fDAseTpjfHwwLHdpZHRoOmR8fDEsaGVpZ2h0OmV8fDF9LGg9Yi5maW5kKHRoaXMubm9kZXMsYi5iaW5kKGZ1bmN0aW9uKGEpe3JldHVybiBnLmlzSW50ZXJjZXB0ZWQoYSxmKX0sdGhpcykpO3JldHVybiBudWxsPT09aHx8InVuZGVmaW5lZCI9PXR5cGVvZiBofSxpLnByb3RvdHlwZS5fc29ydE5vZGVzPWZ1bmN0aW9uKGEpe3RoaXMubm9kZXM9Zy5zb3J0KHRoaXMubm9kZXMsYSx0aGlzLndpZHRoKX0saS5wcm90b3R5cGUuX3BhY2tOb2Rlcz1mdW5jdGlvbigpe3RoaXMuX3NvcnROb2RlcygpLHRoaXMuZmxvYXQ/Yi5lYWNoKHRoaXMubm9kZXMsYi5iaW5kKGZ1bmN0aW9uKGEsYyl7aWYoIWEuX3VwZGF0aW5nJiYidW5kZWZpbmVkIiE9dHlwZW9mIGEuX29yaWdZJiZhLnkhPWEuX29yaWdZKWZvcih2YXIgZD1hLnk7ZD49YS5fb3JpZ1k7KXt2YXIgZT1iLmNoYWluKHRoaXMubm9kZXMpLmZpbmQoYi5iaW5kKGcuX2RpZENvbGxpZGUse246YSxuZXdZOmR9KSkudmFsdWUoKTtlfHwoYS5fZGlydHk9ITAsYS55PWQpLC0tZH19LHRoaXMpKTpiLmVhY2godGhpcy5ub2RlcyxiLmJpbmQoZnVuY3Rpb24oYSxjKXtpZighYS5sb2NrZWQpZm9yKDthLnk+MDspe3ZhciBkPWEueS0xLGU9MD09PWM7aWYoYz4wKXt2YXIgZj1iLmNoYWluKHRoaXMubm9kZXMpLnRha2UoYykuZmluZChiLmJpbmQoZy5fZGlkQ29sbGlkZSx7bjphLG5ld1k6ZH0pKS52YWx1ZSgpO2U9InVuZGVmaW5lZCI9PXR5cGVvZiBmfWlmKCFlKWJyZWFrO2EuX2RpcnR5PWEueSE9ZCxhLnk9ZH19LHRoaXMpKX0saS5wcm90b3R5cGUuX3ByZXBhcmVOb2RlPWZ1bmN0aW9uKGEsYyl7cmV0dXJuIGE9Yi5kZWZhdWx0cyhhfHx7fSx7d2lkdGg6MSxoZWlnaHQ6MSx4OjAseTowfSksYS54PXBhcnNlSW50KCIiK2EueCksYS55PXBhcnNlSW50KCIiK2EueSksYS53aWR0aD1wYXJzZUludCgiIithLndpZHRoKSxhLmhlaWdodD1wYXJzZUludCgiIithLmhlaWdodCksYS5hdXRvUG9zaXRpb249YS5hdXRvUG9zaXRpb258fCExLGEubm9SZXNpemU9YS5ub1Jlc2l6ZXx8ITEsYS5ub01vdmU9YS5ub01vdmV8fCExLGEud2lkdGg+dGhpcy53aWR0aD9hLndpZHRoPXRoaXMud2lkdGg6YS53aWR0aDwxJiYoYS53aWR0aD0xKSxhLmhlaWdodDwxJiYoYS5oZWlnaHQ9MSksYS54PDAmJihhLng9MCksYS54K2Eud2lkdGg+dGhpcy53aWR0aCYmKGM/YS53aWR0aD10aGlzLndpZHRoLWEueDphLng9dGhpcy53aWR0aC1hLndpZHRoKSxhLnk8MCYmKGEueT0wKSxhfSxpLnByb3RvdHlwZS5fbm90aWZ5PWZ1bmN0aW9uKCl7dmFyIGE9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApO2lmKGFbMF09InVuZGVmaW5lZCI9PXR5cGVvZiBhWzBdP1tdOlthWzBdXSxhWzFdPSJ1bmRlZmluZWQiPT10eXBlb2YgYVsxXXx8YVsxXSwhdGhpcy5fdXBkYXRlQ291bnRlcil7dmFyIGI9YVswXS5jb25jYXQodGhpcy5nZXREaXJ0eU5vZGVzKCkpO3RoaXMub25jaGFuZ2UoYixhWzFdKX19LGkucHJvdG90eXBlLmNsZWFuTm9kZXM9ZnVuY3Rpb24oKXt0aGlzLl91cGRhdGVDb3VudGVyfHxiLmVhY2godGhpcy5ub2RlcyxmdW5jdGlvbihhKXthLl9kaXJ0eT0hMX0pfSxpLnByb3RvdHlwZS5nZXREaXJ0eU5vZGVzPWZ1bmN0aW9uKCl7cmV0dXJuIGIuZmlsdGVyKHRoaXMubm9kZXMsZnVuY3Rpb24oYSl7cmV0dXJuIGEuX2RpcnR5fSl9LGkucHJvdG90eXBlLmFkZE5vZGU9ZnVuY3Rpb24oYSxjKXtpZihhPXRoaXMuX3ByZXBhcmVOb2RlKGEpLCJ1bmRlZmluZWQiIT10eXBlb2YgYS5tYXhXaWR0aCYmKGEud2lkdGg9TWF0aC5taW4oYS53aWR0aCxhLm1heFdpZHRoKSksInVuZGVmaW5lZCIhPXR5cGVvZiBhLm1heEhlaWdodCYmKGEuaGVpZ2h0PU1hdGgubWluKGEuaGVpZ2h0LGEubWF4SGVpZ2h0KSksInVuZGVmaW5lZCIhPXR5cGVvZiBhLm1pbldpZHRoJiYoYS53aWR0aD1NYXRoLm1heChhLndpZHRoLGEubWluV2lkdGgpKSwidW5kZWZpbmVkIiE9dHlwZW9mIGEubWluSGVpZ2h0JiYoYS5oZWlnaHQ9TWF0aC5tYXgoYS5oZWlnaHQsYS5taW5IZWlnaHQpKSxhLl9pZD0rK2gsYS5fZGlydHk9ITAsYS5hdXRvUG9zaXRpb24pe3RoaXMuX3NvcnROb2RlcygpO2Zvcih2YXIgZD0wOzsrK2Qpe3ZhciBlPWQldGhpcy53aWR0aCxmPU1hdGguZmxvb3IoZC90aGlzLndpZHRoKTtpZighKGUrYS53aWR0aD50aGlzLndpZHRofHxiLmZpbmQodGhpcy5ub2RlcyxiLmJpbmQoZy5faXNBZGROb2RlSW50ZXJjZXB0ZWQse3g6ZSx5OmYsbm9kZTphfSkpKSl7YS54PWUsYS55PWY7YnJlYWt9fX1yZXR1cm4gdGhpcy5ub2Rlcy5wdXNoKGEpLCJ1bmRlZmluZWQiIT10eXBlb2YgYyYmYyYmdGhpcy5fYWRkZWROb2Rlcy5wdXNoKGIuY2xvbmUoYSkpLHRoaXMuX2ZpeENvbGxpc2lvbnMoYSksdGhpcy5fcGFja05vZGVzKCksdGhpcy5fbm90aWZ5KCksYX0saS5wcm90b3R5cGUucmVtb3ZlTm9kZT1mdW5jdGlvbihhLGMpe2M9InVuZGVmaW5lZCI9PXR5cGVvZiBjfHxjLHRoaXMuX3JlbW92ZWROb2Rlcy5wdXNoKGIuY2xvbmUoYSkpLGEuX2lkPW51bGwsdGhpcy5ub2Rlcz1iLndpdGhvdXQodGhpcy5ub2RlcyxhKSx0aGlzLl9wYWNrTm9kZXMoKSx0aGlzLl9ub3RpZnkoYSxjKX0saS5wcm90b3R5cGUuY2FuTW92ZU5vZGU9ZnVuY3Rpb24oYyxkLGUsZixnKXtpZighdGhpcy5pc05vZGVDaGFuZ2VkUG9zaXRpb24oYyxkLGUsZixnKSlyZXR1cm4hMTt2YXIgaD1Cb29sZWFuKGIuZmluZCh0aGlzLm5vZGVzLGZ1bmN0aW9uKGEpe3JldHVybiBhLmxvY2tlZH0pKTtpZighdGhpcy5oZWlnaHQmJiFoKXJldHVybiEwO3ZhciBqLGs9bmV3IGkodGhpcy53aWR0aCxudWxsLHRoaXMuZmxvYXQsMCxiLm1hcCh0aGlzLm5vZGVzLGZ1bmN0aW9uKGIpe3JldHVybiBiPT1jP2o9YS5leHRlbmQoe30sYik6YS5leHRlbmQoe30sYil9KSk7aWYoInVuZGVmaW5lZCI9PXR5cGVvZiBqKXJldHVybiEwO2subW92ZU5vZGUoaixkLGUsZixnKTt2YXIgbD0hMDtyZXR1cm4gaCYmKGwmPSFCb29sZWFuKGIuZmluZChrLm5vZGVzLGZ1bmN0aW9uKGEpe3JldHVybiBhIT1qJiZCb29sZWFuKGEubG9ja2VkKSYmQm9vbGVhbihhLl9kaXJ0eSl9KSkpLHRoaXMuaGVpZ2h0JiYobCY9ay5nZXRHcmlkSGVpZ2h0KCk8PXRoaXMuaGVpZ2h0KSxsfSxpLnByb3RvdHlwZS5jYW5CZVBsYWNlZFdpdGhSZXNwZWN0VG9IZWlnaHQ9ZnVuY3Rpb24oYyl7aWYoIXRoaXMuaGVpZ2h0KXJldHVybiEwO3ZhciBkPW5ldyBpKHRoaXMud2lkdGgsbnVsbCx0aGlzLmZsb2F0LDAsYi5tYXAodGhpcy5ub2RlcyxmdW5jdGlvbihiKXtyZXR1cm4gYS5leHRlbmQoe30sYil9KSk7cmV0dXJuIGQuYWRkTm9kZShjKSxkLmdldEdyaWRIZWlnaHQoKTw9dGhpcy5oZWlnaHR9LGkucHJvdG90eXBlLmlzTm9kZUNoYW5nZWRQb3NpdGlvbj1mdW5jdGlvbihhLGIsYyxkLGUpe3JldHVybiJudW1iZXIiIT10eXBlb2YgYiYmKGI9YS54KSwibnVtYmVyIiE9dHlwZW9mIGMmJihjPWEueSksIm51bWJlciIhPXR5cGVvZiBkJiYoZD1hLndpZHRoKSwibnVtYmVyIiE9dHlwZW9mIGUmJihlPWEuaGVpZ2h0KSwidW5kZWZpbmVkIiE9dHlwZW9mIGEubWF4V2lkdGgmJihkPU1hdGgubWluKGQsYS5tYXhXaWR0aCkpLCJ1bmRlZmluZWQiIT10eXBlb2YgYS5tYXhIZWlnaHQmJihlPU1hdGgubWluKGUsYS5tYXhIZWlnaHQpKSwidW5kZWZpbmVkIiE9dHlwZW9mIGEubWluV2lkdGgmJihkPU1hdGgubWF4KGQsYS5taW5XaWR0aCkpLCJ1bmRlZmluZWQiIT10eXBlb2YgYS5taW5IZWlnaHQmJihlPU1hdGgubWF4KGUsYS5taW5IZWlnaHQpKSxhLnghPWJ8fGEueSE9Y3x8YS53aWR0aCE9ZHx8YS5oZWlnaHQhPWV9LGkucHJvdG90eXBlLm1vdmVOb2RlPWZ1bmN0aW9uKGEsYixjLGQsZSxmKXtpZighdGhpcy5pc05vZGVDaGFuZ2VkUG9zaXRpb24oYSxiLGMsZCxlKSlyZXR1cm4gYTtpZigibnVtYmVyIiE9dHlwZW9mIGImJihiPWEueCksIm51bWJlciIhPXR5cGVvZiBjJiYoYz1hLnkpLCJudW1iZXIiIT10eXBlb2YgZCYmKGQ9YS53aWR0aCksIm51bWJlciIhPXR5cGVvZiBlJiYoZT1hLmhlaWdodCksInVuZGVmaW5lZCIhPXR5cGVvZiBhLm1heFdpZHRoJiYoZD1NYXRoLm1pbihkLGEubWF4V2lkdGgpKSwidW5kZWZpbmVkIiE9dHlwZW9mIGEubWF4SGVpZ2h0JiYoZT1NYXRoLm1pbihlLGEubWF4SGVpZ2h0KSksInVuZGVmaW5lZCIhPXR5cGVvZiBhLm1pbldpZHRoJiYoZD1NYXRoLm1heChkLGEubWluV2lkdGgpKSwidW5kZWZpbmVkIiE9dHlwZW9mIGEubWluSGVpZ2h0JiYoZT1NYXRoLm1heChlLGEubWluSGVpZ2h0KSksYS54PT1iJiZhLnk9PWMmJmEud2lkdGg9PWQmJmEuaGVpZ2h0PT1lKXJldHVybiBhO3ZhciBnPWEud2lkdGghPWQ7cmV0dXJuIGEuX2RpcnR5PSEwLGEueD1iLGEueT1jLGEud2lkdGg9ZCxhLmhlaWdodD1lLGEubGFzdFRyaWVkWD1iLGEubGFzdFRyaWVkWT1jLGEubGFzdFRyaWVkV2lkdGg9ZCxhLmxhc3RUcmllZEhlaWdodD1lLGE9dGhpcy5fcHJlcGFyZU5vZGUoYSxnKSx0aGlzLl9maXhDb2xsaXNpb25zKGEpLGZ8fCh0aGlzLl9wYWNrTm9kZXMoKSx0aGlzLl9ub3RpZnkoKSksYX0saS5wcm90b3R5cGUuZ2V0R3JpZEhlaWdodD1mdW5jdGlvbigpe3JldHVybiBiLnJlZHVjZSh0aGlzLm5vZGVzLGZ1bmN0aW9uKGEsYil7cmV0dXJuIE1hdGgubWF4KGEsYi55K2IuaGVpZ2h0KX0sMCl9LGkucHJvdG90eXBlLmJlZ2luVXBkYXRlPWZ1bmN0aW9uKGEpe2IuZWFjaCh0aGlzLm5vZGVzLGZ1bmN0aW9uKGEpe2EuX29yaWdZPWEueX0pLGEuX3VwZGF0aW5nPSEwfSxpLnByb3RvdHlwZS5lbmRVcGRhdGU9ZnVuY3Rpb24oKXtiLmVhY2godGhpcy5ub2RlcyxmdW5jdGlvbihhKXthLl9vcmlnWT1hLnl9KTt2YXIgYT1iLmZpbmQodGhpcy5ub2RlcyxmdW5jdGlvbihhKXtyZXR1cm4gYS5fdXBkYXRpbmd9KTthJiYoYS5fdXBkYXRpbmc9ITEpfTt2YXIgaj1mdW5jdGlvbihkLGUpe3ZhciBnLGgsaj10aGlzO2U9ZXx8e30sdGhpcy5jb250YWluZXI9YShkKSwNCi8vIGpzY3M6ZGlzYWJsZSByZXF1aXJlQ2FtZWxDYXNlT3JVcHBlckNhc2VJZGVudGlmaWVycw0KInVuZGVmaW5lZCIhPXR5cGVvZiBlLmhhbmRsZV9jbGFzcyYmKGUuaGFuZGxlQ2xhc3M9ZS5oYW5kbGVfY2xhc3MsZigiaGFuZGxlX2NsYXNzIiwiaGFuZGxlQ2xhc3MiKSksInVuZGVmaW5lZCIhPXR5cGVvZiBlLml0ZW1fY2xhc3MmJihlLml0ZW1DbGFzcz1lLml0ZW1fY2xhc3MsZigiaXRlbV9jbGFzcyIsIml0ZW1DbGFzcyIpKSwidW5kZWZpbmVkIiE9dHlwZW9mIGUucGxhY2Vob2xkZXJfY2xhc3MmJihlLnBsYWNlaG9sZGVyQ2xhc3M9ZS5wbGFjZWhvbGRlcl9jbGFzcyxmKCJwbGFjZWhvbGRlcl9jbGFzcyIsInBsYWNlaG9sZGVyQ2xhc3MiKSksInVuZGVmaW5lZCIhPXR5cGVvZiBlLnBsYWNlaG9sZGVyX3RleHQmJihlLnBsYWNlaG9sZGVyVGV4dD1lLnBsYWNlaG9sZGVyX3RleHQsZigicGxhY2Vob2xkZXJfdGV4dCIsInBsYWNlaG9sZGVyVGV4dCIpKSwidW5kZWZpbmVkIiE9dHlwZW9mIGUuY2VsbF9oZWlnaHQmJihlLmNlbGxIZWlnaHQ9ZS5jZWxsX2hlaWdodCxmKCJjZWxsX2hlaWdodCIsImNlbGxIZWlnaHQiKSksInVuZGVmaW5lZCIhPXR5cGVvZiBlLnZlcnRpY2FsX21hcmdpbiYmKGUudmVydGljYWxNYXJnaW49ZS52ZXJ0aWNhbF9tYXJnaW4sZigidmVydGljYWxfbWFyZ2luIiwidmVydGljYWxNYXJnaW4iKSksInVuZGVmaW5lZCIhPXR5cGVvZiBlLm1pbl93aWR0aCYmKGUubWluV2lkdGg9ZS5taW5fd2lkdGgsZigibWluX3dpZHRoIiwibWluV2lkdGgiKSksInVuZGVmaW5lZCIhPXR5cGVvZiBlLnN0YXRpY19ncmlkJiYoZS5zdGF0aWNHcmlkPWUuc3RhdGljX2dyaWQsZigic3RhdGljX2dyaWQiLCJzdGF0aWNHcmlkIikpLCJ1bmRlZmluZWQiIT10eXBlb2YgZS5pc19uZXN0ZWQmJihlLmlzTmVzdGVkPWUuaXNfbmVzdGVkLGYoImlzX25lc3RlZCIsImlzTmVzdGVkIikpLCJ1bmRlZmluZWQiIT10eXBlb2YgZS5hbHdheXNfc2hvd19yZXNpemVfaGFuZGxlJiYoZS5hbHdheXNTaG93UmVzaXplSGFuZGxlPWUuYWx3YXlzX3Nob3dfcmVzaXplX2hhbmRsZSxmKCJhbHdheXNfc2hvd19yZXNpemVfaGFuZGxlIiwiYWx3YXlzU2hvd1Jlc2l6ZUhhbmRsZSIpKSwNCi8vIGpzY3M6ZW5hYmxlIHJlcXVpcmVDYW1lbENhc2VPclVwcGVyQ2FzZUlkZW50aWZpZXJzDQplLml0ZW1DbGFzcz1lLml0ZW1DbGFzc3x8ImdyaWQtc3RhY2staXRlbSI7dmFyIGs9dGhpcy5jb250YWluZXIuY2xvc2VzdCgiLiIrZS5pdGVtQ2xhc3MpLmxlbmd0aD4wO2lmKHRoaXMub3B0cz1iLmRlZmF1bHRzKGV8fHt9LHt3aWR0aDpwYXJzZUludCh0aGlzLmNvbnRhaW5lci5hdHRyKCJkYXRhLWdzLXdpZHRoIikpfHwxMixoZWlnaHQ6cGFyc2VJbnQodGhpcy5jb250YWluZXIuYXR0cigiZGF0YS1ncy1oZWlnaHQiKSl8fDAsaXRlbUNsYXNzOiJncmlkLXN0YWNrLWl0ZW0iLHBsYWNlaG9sZGVyQ2xhc3M6ImdyaWQtc3RhY2stcGxhY2Vob2xkZXIiLHBsYWNlaG9sZGVyVGV4dDoiIixoYW5kbGU6Ii5ncmlkLXN0YWNrLWl0ZW0tY29udGVudCIsaGFuZGxlQ2xhc3M6bnVsbCxjZWxsSGVpZ2h0OjYwLHZlcnRpY2FsTWFyZ2luOjIwLGF1dG86ITAsbWluV2lkdGg6NzY4LGZsb2F0OiExLHN0YXRpY0dyaWQ6ITEsX2NsYXNzOiJncmlkLXN0YWNrLWluc3RhbmNlLSIrKDFlNCpNYXRoLnJhbmRvbSgpKS50b0ZpeGVkKDApLGFuaW1hdGU6Qm9vbGVhbih0aGlzLmNvbnRhaW5lci5hdHRyKCJkYXRhLWdzLWFuaW1hdGUiKSl8fCExLGFsd2F5c1Nob3dSZXNpemVIYW5kbGU6ZS5hbHdheXNTaG93UmVzaXplSGFuZGxlfHwhMSxyZXNpemFibGU6Yi5kZWZhdWx0cyhlLnJlc2l6YWJsZXx8e30se2F1dG9IaWRlOiFlLmFsd2F5c1Nob3dSZXNpemVIYW5kbGUsaGFuZGxlczoic2UifSksZHJhZ2dhYmxlOmIuZGVmYXVsdHMoZS5kcmFnZ2FibGV8fHt9LHtoYW5kbGU6KGUuaGFuZGxlQ2xhc3M/Ii4iK2UuaGFuZGxlQ2xhc3M6ZS5oYW5kbGU/ZS5oYW5kbGU6IiIpfHwiLmdyaWQtc3RhY2staXRlbS1jb250ZW50IixzY3JvbGw6ITEsYXBwZW5kVG86ImJvZHkifSksZGlzYWJsZURyYWc6ZS5kaXNhYmxlRHJhZ3x8ITEsZGlzYWJsZVJlc2l6ZTplLmRpc2FibGVSZXNpemV8fCExLHJ0bDoiYXV0byIscmVtb3ZhYmxlOiExLHJlbW92ZVRpbWVvdXQ6MmUzLHZlcnRpY2FsTWFyZ2luVW5pdDoicHgiLGNlbGxIZWlnaHRVbml0OiJweCIsb25lQ29sdW1uTW9kZUNsYXNzOmUub25lQ29sdW1uTW9kZUNsYXNzfHwiZ3JpZC1zdGFjay1vbmUtY29sdW1uLW1vZGUiLGRkUGx1Z2luOm51bGx9KSx0aGlzLm9wdHMuZGRQbHVnaW49PT0hMT90aGlzLm9wdHMuZGRQbHVnaW49YzpudWxsPT09dGhpcy5vcHRzLmRkUGx1Z2luJiYodGhpcy5vcHRzLmRkUGx1Z2luPWIuZmlyc3QoYy5yZWdpc3RlcmVkUGx1Z2lucyl8fGMpLHRoaXMuZGQ9bmV3IHRoaXMub3B0cy5kZFBsdWdpbih0aGlzKSwiYXV0byI9PT10aGlzLm9wdHMucnRsJiYodGhpcy5vcHRzLnJ0bD0icnRsIj09PXRoaXMuY29udGFpbmVyLmNzcygiZGlyZWN0aW9uIikpLHRoaXMub3B0cy5ydGwmJnRoaXMuY29udGFpbmVyLmFkZENsYXNzKCJncmlkLXN0YWNrLXJ0bCIpLHRoaXMub3B0cy5pc05lc3RlZD1rLGg9ImF1dG8iPT09dGhpcy5vcHRzLmNlbGxIZWlnaHQsaD9qLmNlbGxIZWlnaHQoai5jZWxsV2lkdGgoKSwhMCk6dGhpcy5jZWxsSGVpZ2h0KHRoaXMub3B0cy5jZWxsSGVpZ2h0LCEwKSx0aGlzLnZlcnRpY2FsTWFyZ2luKHRoaXMub3B0cy52ZXJ0aWNhbE1hcmdpbiwhMCksdGhpcy5jb250YWluZXIuYWRkQ2xhc3ModGhpcy5vcHRzLl9jbGFzcyksdGhpcy5fc2V0U3RhdGljQ2xhc3MoKSxrJiZ0aGlzLmNvbnRhaW5lci5hZGRDbGFzcygiZ3JpZC1zdGFjay1uZXN0ZWQiKSx0aGlzLl9pbml0U3R5bGVzKCksdGhpcy5ncmlkPW5ldyBpKHRoaXMub3B0cy53aWR0aCxmdW5jdGlvbihhLGMpe2M9InVuZGVmaW5lZCI9PXR5cGVvZiBjfHxjO3ZhciBkPTA7Yi5lYWNoKGEsZnVuY3Rpb24oYSl7YyYmbnVsbD09PWEuX2lkP2EuZWwmJmEuZWwucmVtb3ZlKCk6KGEuZWwuYXR0cigiZGF0YS1ncy14IixhLngpLmF0dHIoImRhdGEtZ3MteSIsYS55KS5hdHRyKCJkYXRhLWdzLXdpZHRoIixhLndpZHRoKS5hdHRyKCJkYXRhLWdzLWhlaWdodCIsYS5oZWlnaHQpLGQ9TWF0aC5tYXgoZCxhLnkrYS5oZWlnaHQpKX0pLGouX3VwZGF0ZVN0eWxlcyhkKzEwKX0sdGhpcy5vcHRzLmZsb2F0LHRoaXMub3B0cy5oZWlnaHQpLHRoaXMub3B0cy5hdXRvKXt2YXIgbD1bXSxtPXRoaXM7dGhpcy5jb250YWluZXIuY2hpbGRyZW4oIi4iK3RoaXMub3B0cy5pdGVtQ2xhc3MrIjpub3QoLiIrdGhpcy5vcHRzLnBsYWNlaG9sZGVyQ2xhc3MrIikiKS5lYWNoKGZ1bmN0aW9uKGIsYyl7Yz1hKGMpLGwucHVzaCh7ZWw6YyxpOnBhcnNlSW50KGMuYXR0cigiZGF0YS1ncy14IikpK3BhcnNlSW50KGMuYXR0cigiZGF0YS1ncy15IikpKm0ub3B0cy53aWR0aH0pfSksYi5jaGFpbihsKS5zb3J0QnkoZnVuY3Rpb24oYSl7cmV0dXJuIGEuaX0pLmVhY2goZnVuY3Rpb24oYSl7ai5fcHJlcGFyZUVsZW1lbnQoYS5lbCl9KS52YWx1ZSgpfWlmKHRoaXMuc2V0QW5pbWF0aW9uKHRoaXMub3B0cy5hbmltYXRlKSx0aGlzLnBsYWNlaG9sZGVyPWEoJzxkaXYgY2xhc3M9IicrdGhpcy5vcHRzLnBsYWNlaG9sZGVyQ2xhc3MrIiAiK3RoaXMub3B0cy5pdGVtQ2xhc3MrJyI+PGRpdiBjbGFzcz0icGxhY2Vob2xkZXItY29udGVudCI+Jyt0aGlzLm9wdHMucGxhY2Vob2xkZXJUZXh0KyI8L2Rpdj48L2Rpdj4iKS5oaWRlKCksdGhpcy5fdXBkYXRlQ29udGFpbmVySGVpZ2h0KCksdGhpcy5fdXBkYXRlSGVpZ2h0c09uUmVzaXplPWIudGhyb3R0bGUoZnVuY3Rpb24oKXtqLmNlbGxIZWlnaHQoai5jZWxsV2lkdGgoKSwhMSl9LDEwMCksdGhpcy5vblJlc2l6ZUhhbmRsZXI9ZnVuY3Rpb24oKXtpZihoJiZqLl91cGRhdGVIZWlnaHRzT25SZXNpemUoKSxqLl9pc09uZUNvbHVtbk1vZGUoKSl7aWYoZylyZXR1cm47ai5jb250YWluZXIuYWRkQ2xhc3Moai5vcHRzLm9uZUNvbHVtbk1vZGVDbGFzcyksZz0hMCxqLmdyaWQuX3NvcnROb2RlcygpLGIuZWFjaChqLmdyaWQubm9kZXMsZnVuY3Rpb24oYSl7ai5jb250YWluZXIuYXBwZW5kKGEuZWwpLGoub3B0cy5zdGF0aWNHcmlkfHwoKGEubm9Nb3ZlfHxqLm9wdHMuZGlzYWJsZURyYWcpJiZqLmRkLmRyYWdnYWJsZShhLmVsLCJkaXNhYmxlIiksKGEubm9SZXNpemV8fGoub3B0cy5kaXNhYmxlUmVzaXplKSYmai5kZC5yZXNpemFibGUoYS5lbCwiZGlzYWJsZSIpLGEuZWwudHJpZ2dlcigicmVzaXplIikpfSl9ZWxzZXtpZighZylyZXR1cm47aWYoai5jb250YWluZXIucmVtb3ZlQ2xhc3Moai5vcHRzLm9uZUNvbHVtbk1vZGVDbGFzcyksZz0hMSxqLm9wdHMuc3RhdGljR3JpZClyZXR1cm47Yi5lYWNoKGouZ3JpZC5ub2RlcyxmdW5jdGlvbihhKXthLm5vTW92ZXx8ai5vcHRzLmRpc2FibGVEcmFnfHxqLmRkLmRyYWdnYWJsZShhLmVsLCJlbmFibGUiKSxhLm5vUmVzaXplfHxqLm9wdHMuZGlzYWJsZVJlc2l6ZXx8ai5kZC5yZXNpemFibGUoYS5lbCwiZW5hYmxlIiksYS5lbC50cmlnZ2VyKCJyZXNpemUiKX0pfX0sYSh3aW5kb3cpLnJlc2l6ZSh0aGlzLm9uUmVzaXplSGFuZGxlciksdGhpcy5vblJlc2l6ZUhhbmRsZXIoKSwhai5vcHRzLnN0YXRpY0dyaWQmJiJzdHJpbmciPT10eXBlb2Ygai5vcHRzLnJlbW92YWJsZSl7dmFyIG49YShqLm9wdHMucmVtb3ZhYmxlKTt0aGlzLmRkLmlzRHJvcHBhYmxlKG4pfHx0aGlzLmRkLmRyb3BwYWJsZShuLHthY2NlcHQ6Ii4iK2oub3B0cy5pdGVtQ2xhc3N9KSx0aGlzLmRkLm9uKG4sImRyb3BvdmVyIixmdW5jdGlvbihiLGMpe3ZhciBkPWEoYy5kcmFnZ2FibGUpLGU9ZC5kYXRhKCJfZ3JpZHN0YWNrX25vZGUiKTtlLl9ncmlkPT09aiYmai5fc2V0dXBSZW1vdmluZ1RpbWVvdXQoZCl9KS5vbihuLCJkcm9wb3V0IixmdW5jdGlvbihiLGMpe3ZhciBkPWEoYy5kcmFnZ2FibGUpLGU9ZC5kYXRhKCJfZ3JpZHN0YWNrX25vZGUiKTtlLl9ncmlkPT09aiYmai5fY2xlYXJSZW1vdmluZ1RpbWVvdXQoZCl9KX1pZighai5vcHRzLnN0YXRpY0dyaWQmJmoub3B0cy5hY2NlcHRXaWRnZXRzKXt2YXIgbz1udWxsLHA9ZnVuY3Rpb24oYSxiKXt2YXIgYz1vLGQ9Yy5kYXRhKCJfZ3JpZHN0YWNrX25vZGUiKSxlPWouZ2V0Q2VsbEZyb21QaXhlbChiLm9mZnNldCwhMCksZj1NYXRoLm1heCgwLGUueCksZz1NYXRoLm1heCgwLGUueSk7aWYoZC5fYWRkZWQpe2lmKCFqLmdyaWQuY2FuTW92ZU5vZGUoZCxmLGcpKXJldHVybjtqLmdyaWQubW92ZU5vZGUoZCxmLGcpLGouX3VwZGF0ZUNvbnRhaW5lckhlaWdodCgpfWVsc2UgZC5fYWRkZWQ9ITAsZC5lbD1jLGQueD1mLGQueT1nLGouZ3JpZC5jbGVhbk5vZGVzKCksai5ncmlkLmJlZ2luVXBkYXRlKGQpLGouZ3JpZC5hZGROb2RlKGQpLGouY29udGFpbmVyLmFwcGVuZChqLnBsYWNlaG9sZGVyKSxqLnBsYWNlaG9sZGVyLmF0dHIoImRhdGEtZ3MteCIsZC54KS5hdHRyKCJkYXRhLWdzLXkiLGQueSkuYXR0cigiZGF0YS1ncy13aWR0aCIsZC53aWR0aCkuYXR0cigiZGF0YS1ncy1oZWlnaHQiLGQuaGVpZ2h0KS5zaG93KCksZC5lbD1qLnBsYWNlaG9sZGVyLGQuX2JlZm9yZURyYWdYPWQueCxkLl9iZWZvcmVEcmFnWT1kLnksai5fdXBkYXRlQ29udGFpbmVySGVpZ2h0KCl9O3RoaXMuZGQuZHJvcHBhYmxlKGouY29udGFpbmVyLHthY2NlcHQ6ZnVuY3Rpb24oYil7Yj1hKGIpO3ZhciBjPWIuZGF0YSgiX2dyaWRzdGFja19ub2RlIik7cmV0dXJuKCFjfHxjLl9ncmlkIT09aikmJmIuaXMoai5vcHRzLmFjY2VwdFdpZGdldHM9PT0hMD8iLmdyaWQtc3RhY2staXRlbSI6ai5vcHRzLmFjY2VwdFdpZGdldHMpfX0pLm9uKGouY29udGFpbmVyLCJkcm9wb3ZlciIsZnVuY3Rpb24oYixjKXt2YXIgZD0oai5jb250YWluZXIub2Zmc2V0KCksYShjLmRyYWdnYWJsZSkpLGU9ai5jZWxsV2lkdGgoKSxmPWouY2VsbEhlaWdodCgpLGc9ZC5kYXRhKCJfZ3JpZHN0YWNrX25vZGUiKSxoPWc/Zy53aWR0aDpNYXRoLmNlaWwoZC5vdXRlcldpZHRoKCkvZSksaT1nP2cuaGVpZ2h0Ok1hdGguY2VpbChkLm91dGVySGVpZ2h0KCkvZik7bz1kO3ZhciBrPWouZ3JpZC5fcHJlcGFyZU5vZGUoe3dpZHRoOmgsaGVpZ2h0OmksX2FkZGVkOiExLF90ZW1wb3Jhcnk6ITB9KTtkLmRhdGEoIl9ncmlkc3RhY2tfbm9kZSIsayksZC5kYXRhKCJfZ3JpZHN0YWNrX25vZGVfb3JpZyIsZyksZC5vbigiZHJhZyIscCl9KS5vbihqLmNvbnRhaW5lciwiZHJvcG91dCIsZnVuY3Rpb24oYixjKXt2YXIgZD1hKGMuZHJhZ2dhYmxlKTtkLnVuYmluZCgiZHJhZyIscCk7dmFyIGU9ZC5kYXRhKCJfZ3JpZHN0YWNrX25vZGUiKTtlLmVsPW51bGwsai5ncmlkLnJlbW92ZU5vZGUoZSksai5wbGFjZWhvbGRlci5kZXRhY2goKSxqLl91cGRhdGVDb250YWluZXJIZWlnaHQoKSxkLmRhdGEoIl9ncmlkc3RhY2tfbm9kZSIsZC5kYXRhKCJfZ3JpZHN0YWNrX25vZGVfb3JpZyIpKX0pLm9uKGouY29udGFpbmVyLCJkcm9wIixmdW5jdGlvbihiLGMpe2oucGxhY2Vob2xkZXIuZGV0YWNoKCk7dmFyIGQ9YShjLmRyYWdnYWJsZSkuZGF0YSgiX2dyaWRzdGFja19ub2RlIik7ZC5fZ3JpZD1qO3ZhciBlPWEoYy5kcmFnZ2FibGUpLmNsb25lKCExKTtlLmRhdGEoIl9ncmlkc3RhY2tfbm9kZSIsZCksYShjLmRyYWdnYWJsZSkucmVtb3ZlKCksZC5lbD1lLGoucGxhY2Vob2xkZXIuaGlkZSgpLGUuYXR0cigiZGF0YS1ncy14IixkLngpLmF0dHIoImRhdGEtZ3MteSIsZC55KS5hdHRyKCJkYXRhLWdzLXdpZHRoIixkLndpZHRoKS5hdHRyKCJkYXRhLWdzLWhlaWdodCIsZC5oZWlnaHQpLmFkZENsYXNzKGoub3B0cy5pdGVtQ2xhc3MpLnJlbW92ZUF0dHIoInN0eWxlIikuZW5hYmxlU2VsZWN0aW9uKCkucmVtb3ZlRGF0YSgiZHJhZ2dhYmxlIikucmVtb3ZlQ2xhc3MoInVpLWRyYWdnYWJsZSB1aS1kcmFnZ2FibGUtZHJhZ2dpbmcgdWktZHJhZ2dhYmxlLWRpc2FibGVkIikudW5iaW5kKCJkcmFnIixwKSxqLmNvbnRhaW5lci5hcHBlbmQoZSksai5fcHJlcGFyZUVsZW1lbnRzQnlOb2RlKGUsZCksai5fdXBkYXRlQ29udGFpbmVySGVpZ2h0KCksai5fdHJpZ2dlckNoYW5nZUV2ZW50KCksai5ncmlkLmVuZFVwZGF0ZSgpfSl9fTsNCi8vIGpzY3M6ZGlzYWJsZSByZXF1aXJlQ2FtZWxDYXNlT3JVcHBlckNhc2VJZGVudGlmaWVycw0KLy8ganNjczplbmFibGUgcmVxdWlyZUNhbWVsQ2FzZU9yVXBwZXJDYXNlSWRlbnRpZmllcnMNCnJldHVybiBqLnByb3RvdHlwZS5fdHJpZ2dlckNoYW5nZUV2ZW50PWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuZ3JpZC5nZXREaXJ0eU5vZGVzKCksYz0hMSxkPVtdO2ImJmIubGVuZ3RoJiYoZC5wdXNoKGIpLGM9ITApLChjfHxhPT09ITApJiZ0aGlzLmNvbnRhaW5lci50cmlnZ2VyKCJjaGFuZ2UiLGQpfSxqLnByb3RvdHlwZS5fdHJpZ2dlckFkZEV2ZW50PWZ1bmN0aW9uKCl7dGhpcy5ncmlkLl9hZGRlZE5vZGVzJiZ0aGlzLmdyaWQuX2FkZGVkTm9kZXMubGVuZ3RoPjAmJih0aGlzLmNvbnRhaW5lci50cmlnZ2VyKCJhZGRlZCIsW2IubWFwKHRoaXMuZ3JpZC5fYWRkZWROb2RlcyxiLmNsb25lKV0pLHRoaXMuZ3JpZC5fYWRkZWROb2Rlcz1bXSl9LGoucHJvdG90eXBlLl90cmlnZ2VyUmVtb3ZlRXZlbnQ9ZnVuY3Rpb24oKXt0aGlzLmdyaWQuX3JlbW92ZWROb2RlcyYmdGhpcy5ncmlkLl9yZW1vdmVkTm9kZXMubGVuZ3RoPjAmJih0aGlzLmNvbnRhaW5lci50cmlnZ2VyKCJyZW1vdmVkIixbYi5tYXAodGhpcy5ncmlkLl9yZW1vdmVkTm9kZXMsYi5jbG9uZSldKSx0aGlzLmdyaWQuX3JlbW92ZWROb2Rlcz1bXSl9LGoucHJvdG90eXBlLl9pbml0U3R5bGVzPWZ1bmN0aW9uKCl7dGhpcy5fc3R5bGVzSWQmJmcucmVtb3ZlU3R5bGVzaGVldCh0aGlzLl9zdHlsZXNJZCksdGhpcy5fc3R5bGVzSWQ9ImdyaWRzdGFjay1zdHlsZS0iKygxZTUqTWF0aC5yYW5kb20oKSkudG9GaXhlZCgpLHRoaXMuX3N0eWxlcz1nLmNyZWF0ZVN0eWxlc2hlZXQodGhpcy5fc3R5bGVzSWQpLG51bGwhPT10aGlzLl9zdHlsZXMmJih0aGlzLl9zdHlsZXMuX21heD0wKX0sai5wcm90b3R5cGUuX3VwZGF0ZVN0eWxlcz1mdW5jdGlvbihhKXtpZihudWxsIT09dGhpcy5fc3R5bGVzJiYidW5kZWZpbmVkIiE9dHlwZW9mIHRoaXMuX3N0eWxlcyl7dmFyIGIsYz0iLiIrdGhpcy5vcHRzLl9jbGFzcysiIC4iK3RoaXMub3B0cy5pdGVtQ2xhc3MsZD10aGlzO2lmKCJ1bmRlZmluZWQiPT10eXBlb2YgYSYmKGE9dGhpcy5fc3R5bGVzLl9tYXgsdGhpcy5faW5pdFN0eWxlcygpLHRoaXMuX3VwZGF0ZUNvbnRhaW5lckhlaWdodCgpKSx0aGlzLm9wdHMuY2VsbEhlaWdodCYmISgwIT09dGhpcy5fc3R5bGVzLl9tYXgmJmE8PXRoaXMuX3N0eWxlcy5fbWF4KSYmKGI9dGhpcy5vcHRzLnZlcnRpY2FsTWFyZ2luJiZ0aGlzLm9wdHMuY2VsbEhlaWdodFVuaXQhPT10aGlzLm9wdHMudmVydGljYWxNYXJnaW5Vbml0P2Z1bmN0aW9uKGEsYil7cmV0dXJuIGEmJmI/ImNhbGMoIisoZC5vcHRzLmNlbGxIZWlnaHQqYStkLm9wdHMuY2VsbEhlaWdodFVuaXQpKyIgKyAiKyhkLm9wdHMudmVydGljYWxNYXJnaW4qYitkLm9wdHMudmVydGljYWxNYXJnaW5Vbml0KSsiKSI6ZC5vcHRzLmNlbGxIZWlnaHQqYStkLm9wdHMudmVydGljYWxNYXJnaW4qYitkLm9wdHMuY2VsbEhlaWdodFVuaXR9OmZ1bmN0aW9uKGEsYil7cmV0dXJuIGQub3B0cy5jZWxsSGVpZ2h0KmErZC5vcHRzLnZlcnRpY2FsTWFyZ2luKmIrZC5vcHRzLmNlbGxIZWlnaHRVbml0fSwwPT09dGhpcy5fc3R5bGVzLl9tYXgmJmcuaW5zZXJ0Q1NTUnVsZSh0aGlzLl9zdHlsZXMsYywibWluLWhlaWdodDogIitiKDEsMCkrIjsiLDApLGE+dGhpcy5fc3R5bGVzLl9tYXgpKXtmb3IodmFyIGU9dGhpcy5fc3R5bGVzLl9tYXg7ZTxhOysrZSlnLmluc2VydENTU1J1bGUodGhpcy5fc3R5bGVzLGMrJ1tkYXRhLWdzLWhlaWdodD0iJysoZSsxKSsnIl0nLCJoZWlnaHQ6ICIrYihlKzEsZSkrIjsiLGUpLGcuaW5zZXJ0Q1NTUnVsZSh0aGlzLl9zdHlsZXMsYysnW2RhdGEtZ3MtbWluLWhlaWdodD0iJysoZSsxKSsnIl0nLCJtaW4taGVpZ2h0OiAiK2IoZSsxLGUpKyI7IixlKSxnLmluc2VydENTU1J1bGUodGhpcy5fc3R5bGVzLGMrJ1tkYXRhLWdzLW1heC1oZWlnaHQ9IicrKGUrMSkrJyJdJywibWF4LWhlaWdodDogIitiKGUrMSxlKSsiOyIsZSksZy5pbnNlcnRDU1NSdWxlKHRoaXMuX3N0eWxlcyxjKydbZGF0YS1ncy15PSInK2UrJyJdJywidG9wOiAiK2IoZSxlKSsiOyIsZSk7dGhpcy5fc3R5bGVzLl9tYXg9YX19fSxqLnByb3RvdHlwZS5fdXBkYXRlQ29udGFpbmVySGVpZ2h0PWZ1bmN0aW9uKCl7aWYoIXRoaXMuZ3JpZC5fdXBkYXRlQ291bnRlcil7dmFyIGE9dGhpcy5ncmlkLmdldEdyaWRIZWlnaHQoKTt0aGlzLmNvbnRhaW5lci5hdHRyKCJkYXRhLWdzLWN1cnJlbnQtaGVpZ2h0IixhKSx0aGlzLm9wdHMuY2VsbEhlaWdodCYmKHRoaXMub3B0cy52ZXJ0aWNhbE1hcmdpbj90aGlzLm9wdHMuY2VsbEhlaWdodFVuaXQ9PT10aGlzLm9wdHMudmVydGljYWxNYXJnaW5Vbml0P3RoaXMuY29udGFpbmVyLmNzcygiaGVpZ2h0IixhKih0aGlzLm9wdHMuY2VsbEhlaWdodCt0aGlzLm9wdHMudmVydGljYWxNYXJnaW4pLXRoaXMub3B0cy52ZXJ0aWNhbE1hcmdpbit0aGlzLm9wdHMuY2VsbEhlaWdodFVuaXQpOnRoaXMuY29udGFpbmVyLmNzcygiaGVpZ2h0IiwiY2FsYygiKyhhKnRoaXMub3B0cy5jZWxsSGVpZ2h0K3RoaXMub3B0cy5jZWxsSGVpZ2h0VW5pdCkrIiArICIrKGEqKHRoaXMub3B0cy52ZXJ0aWNhbE1hcmdpbi0xKSt0aGlzLm9wdHMudmVydGljYWxNYXJnaW5Vbml0KSsiKSIpOnRoaXMuY29udGFpbmVyLmNzcygiaGVpZ2h0IixhKnRoaXMub3B0cy5jZWxsSGVpZ2h0K3RoaXMub3B0cy5jZWxsSGVpZ2h0VW5pdCkpfX0sai5wcm90b3R5cGUuX2lzT25lQ29sdW1uTW9kZT1mdW5jdGlvbigpe3JldHVybih3aW5kb3cuaW5uZXJXaWR0aHx8ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRofHxkb2N1bWVudC5ib2R5LmNsaWVudFdpZHRoKTw9dGhpcy5vcHRzLm1pbldpZHRofSxqLnByb3RvdHlwZS5fc2V0dXBSZW1vdmluZ1RpbWVvdXQ9ZnVuY3Rpb24oYil7dmFyIGM9dGhpcyxkPWEoYikuZGF0YSgiX2dyaWRzdGFja19ub2RlIik7IWQuX3JlbW92ZVRpbWVvdXQmJmMub3B0cy5yZW1vdmFibGUmJihkLl9yZW1vdmVUaW1lb3V0PXNldFRpbWVvdXQoZnVuY3Rpb24oKXtiLmFkZENsYXNzKCJncmlkLXN0YWNrLWl0ZW0tcmVtb3ZpbmciKSxkLl9pc0Fib3V0VG9SZW1vdmU9ITB9LGMub3B0cy5yZW1vdmVUaW1lb3V0KSl9LGoucHJvdG90eXBlLl9jbGVhclJlbW92aW5nVGltZW91dD1mdW5jdGlvbihiKXt2YXIgYz1hKGIpLmRhdGEoIl9ncmlkc3RhY2tfbm9kZSIpO2MuX3JlbW92ZVRpbWVvdXQmJihjbGVhclRpbWVvdXQoYy5fcmVtb3ZlVGltZW91dCksYy5fcmVtb3ZlVGltZW91dD1udWxsLGIucmVtb3ZlQ2xhc3MoImdyaWQtc3RhY2staXRlbS1yZW1vdmluZyIpLGMuX2lzQWJvdXRUb1JlbW92ZT0hMSl9LGoucHJvdG90eXBlLl9wcmVwYXJlRWxlbWVudHNCeU5vZGU9ZnVuY3Rpb24oYixjKXtpZigidW5kZWZpbmVkIiE9dHlwZW9mIGEudWkpe3ZhciBkLGUsZj10aGlzLGc9ZnVuY3Rpb24oYSxnKXt2YXIgaCxpLGo9TWF0aC5yb3VuZChnLnBvc2l0aW9uLmxlZnQvZCksaz1NYXRoLmZsb29yKChnLnBvc2l0aW9uLnRvcCtlLzIpL2UpO2lmKCJkcmFnIiE9YS50eXBlJiYoaD1NYXRoLnJvdW5kKGcuc2l6ZS53aWR0aC9kKSxpPU1hdGgucm91bmQoZy5zaXplLmhlaWdodC9lKSksImRyYWciPT1hLnR5cGUpajwwfHxqPj1mLmdyaWQud2lkdGh8fGs8MD8oZi5vcHRzLnJlbW92YWJsZT09PSEwJiZmLl9zZXR1cFJlbW92aW5nVGltZW91dChiKSxqPWMuX2JlZm9yZURyYWdYLGs9Yy5fYmVmb3JlRHJhZ1ksZi5wbGFjZWhvbGRlci5kZXRhY2goKSxmLnBsYWNlaG9sZGVyLmhpZGUoKSxmLmdyaWQucmVtb3ZlTm9kZShjKSxmLl91cGRhdGVDb250YWluZXJIZWlnaHQoKSxjLl90ZW1wb3JhcnlSZW1vdmVkPSEwKTooZi5fY2xlYXJSZW1vdmluZ1RpbWVvdXQoYiksYy5fdGVtcG9yYXJ5UmVtb3ZlZCYmKGYuZ3JpZC5hZGROb2RlKGMpLGYucGxhY2Vob2xkZXIuYXR0cigiZGF0YS1ncy14IixqKS5hdHRyKCJkYXRhLWdzLXkiLGspLmF0dHIoImRhdGEtZ3Mtd2lkdGgiLGgpLmF0dHIoImRhdGEtZ3MtaGVpZ2h0IixpKS5zaG93KCksZi5jb250YWluZXIuYXBwZW5kKGYucGxhY2Vob2xkZXIpLGMuZWw9Zi5wbGFjZWhvbGRlcixjLl90ZW1wb3JhcnlSZW1vdmVkPSExKSk7ZWxzZSBpZigicmVzaXplIj09YS50eXBlJiZqPDApcmV0dXJuOw0KLy8gd2lkdGggYW5kIGhlaWdodCBhcmUgdW5kZWZpbmVkIGlmIG5vdCByZXNpemluZw0KdmFyIGw9InVuZGVmaW5lZCIhPXR5cGVvZiBoP2g6Yy5sYXN0VHJpZWRXaWR0aCxtPSJ1bmRlZmluZWQiIT10eXBlb2YgaT9pOmMubGFzdFRyaWVkSGVpZ2h0OyFmLmdyaWQuY2FuTW92ZU5vZGUoYyxqLGssaCxpKXx8Yy5sYXN0VHJpZWRYPT09aiYmYy5sYXN0VHJpZWRZPT09ayYmYy5sYXN0VHJpZWRXaWR0aD09PWwmJmMubGFzdFRyaWVkSGVpZ2h0PT09bXx8KGMubGFzdFRyaWVkWD1qLGMubGFzdFRyaWVkWT1rLGMubGFzdFRyaWVkV2lkdGg9aCxjLmxhc3RUcmllZEhlaWdodD1pLGYuZ3JpZC5tb3ZlTm9kZShjLGosayxoLGkpLGYuX3VwZGF0ZUNvbnRhaW5lckhlaWdodCgpKX0saD1mdW5jdGlvbihnLGgpe2YuY29udGFpbmVyLmFwcGVuZChmLnBsYWNlaG9sZGVyKTt2YXIgaT1hKHRoaXMpO2YuZ3JpZC5jbGVhbk5vZGVzKCksZi5ncmlkLmJlZ2luVXBkYXRlKGMpLGQ9Zi5jZWxsV2lkdGgoKTt2YXIgaj1NYXRoLmNlaWwoaS5vdXRlckhlaWdodCgpL2kuYXR0cigiZGF0YS1ncy1oZWlnaHQiKSk7ZT1mLmNvbnRhaW5lci5oZWlnaHQoKS9wYXJzZUludChmLmNvbnRhaW5lci5hdHRyKCJkYXRhLWdzLWN1cnJlbnQtaGVpZ2h0IikpLGYucGxhY2Vob2xkZXIuYXR0cigiZGF0YS1ncy14IixpLmF0dHIoImRhdGEtZ3MteCIpKS5hdHRyKCJkYXRhLWdzLXkiLGkuYXR0cigiZGF0YS1ncy15IikpLmF0dHIoImRhdGEtZ3Mtd2lkdGgiLGkuYXR0cigiZGF0YS1ncy13aWR0aCIpKS5hdHRyKCJkYXRhLWdzLWhlaWdodCIsaS5hdHRyKCJkYXRhLWdzLWhlaWdodCIpKS5zaG93KCksYy5lbD1mLnBsYWNlaG9sZGVyLGMuX2JlZm9yZURyYWdYPWMueCxjLl9iZWZvcmVEcmFnWT1jLnksZi5kZC5yZXNpemFibGUoYiwib3B0aW9uIiwibWluV2lkdGgiLGQqKGMubWluV2lkdGh8fDEpKSxmLmRkLnJlc2l6YWJsZShiLCJvcHRpb24iLCJtaW5IZWlnaHQiLGoqKGMubWluSGVpZ2h0fHwxKSksInJlc2l6ZXN0YXJ0Ij09Zy50eXBlJiZpLmZpbmQoIi5ncmlkLXN0YWNrLWl0ZW0iKS50cmlnZ2VyKCJyZXNpemVzdGFydCIpfSxpPWZ1bmN0aW9uKGQsZSl7dmFyIGc9YSh0aGlzKTtpZihnLmRhdGEoIl9ncmlkc3RhY2tfbm9kZSIpKXt2YXIgaD0hMTtmLnBsYWNlaG9sZGVyLmRldGFjaCgpLGMuZWw9ZyxmLnBsYWNlaG9sZGVyLmhpZGUoKSxjLl9pc0Fib3V0VG9SZW1vdmU/KGg9ITAsYi5yZW1vdmVEYXRhKCJfZ3JpZHN0YWNrX25vZGUiKSxiLnJlbW92ZSgpKTooZi5fY2xlYXJSZW1vdmluZ1RpbWVvdXQoYiksYy5fdGVtcG9yYXJ5UmVtb3ZlZD8oZy5hdHRyKCJkYXRhLWdzLXgiLGMuX2JlZm9yZURyYWdYKS5hdHRyKCJkYXRhLWdzLXkiLGMuX2JlZm9yZURyYWdZKS5hdHRyKCJkYXRhLWdzLXdpZHRoIixjLndpZHRoKS5hdHRyKCJkYXRhLWdzLWhlaWdodCIsYy5oZWlnaHQpLnJlbW92ZUF0dHIoInN0eWxlIiksYy54PWMuX2JlZm9yZURyYWdYLGMueT1jLl9iZWZvcmVEcmFnWSxmLmdyaWQuYWRkTm9kZShjKSk6Zy5hdHRyKCJkYXRhLWdzLXgiLGMueCkuYXR0cigiZGF0YS1ncy15IixjLnkpLmF0dHIoImRhdGEtZ3Mtd2lkdGgiLGMud2lkdGgpLmF0dHIoImRhdGEtZ3MtaGVpZ2h0IixjLmhlaWdodCkucmVtb3ZlQXR0cigic3R5bGUiKSksZi5fdXBkYXRlQ29udGFpbmVySGVpZ2h0KCksZi5fdHJpZ2dlckNoYW5nZUV2ZW50KGgpLGYuZ3JpZC5lbmRVcGRhdGUoKTt2YXIgaT1nLmZpbmQoIi5ncmlkLXN0YWNrIik7aS5sZW5ndGgmJiJyZXNpemVzdG9wIj09ZC50eXBlJiYoaS5lYWNoKGZ1bmN0aW9uKGIsYyl7YShjKS5kYXRhKCJncmlkc3RhY2siKS5vblJlc2l6ZUhhbmRsZXIoKX0pLGcuZmluZCgiLmdyaWQtc3RhY2staXRlbSIpLnRyaWdnZXIoInJlc2l6ZXN0b3AiKSl9fTt0aGlzLmRkLmRyYWdnYWJsZShiLHtzdGFydDpoLHN0b3A6aSxkcmFnOmd9KS5yZXNpemFibGUoYix7c3RhcnQ6aCxzdG9wOmkscmVzaXplOmd9KSwoYy5ub01vdmV8fHRoaXMuX2lzT25lQ29sdW1uTW9kZSgpfHx0aGlzLm9wdHMuZGlzYWJsZURyYWcpJiZ0aGlzLmRkLmRyYWdnYWJsZShiLCJkaXNhYmxlIiksKGMubm9SZXNpemV8fHRoaXMuX2lzT25lQ29sdW1uTW9kZSgpfHx0aGlzLm9wdHMuZGlzYWJsZVJlc2l6ZSkmJnRoaXMuZGQucmVzaXphYmxlKGIsImRpc2FibGUiKSxiLmF0dHIoImRhdGEtZ3MtbG9ja2VkIixjLmxvY2tlZD8ieWVzIjpudWxsKX19LGoucHJvdG90eXBlLl9wcmVwYXJlRWxlbWVudD1mdW5jdGlvbihiLGMpe2M9InVuZGVmaW5lZCIhPXR5cGVvZiBjJiZjO3ZhciBkPXRoaXM7Yj1hKGIpLGIuYWRkQ2xhc3ModGhpcy5vcHRzLml0ZW1DbGFzcyk7dmFyIGU9ZC5ncmlkLmFkZE5vZGUoe3g6Yi5hdHRyKCJkYXRhLWdzLXgiKSx5OmIuYXR0cigiZGF0YS1ncy15Iiksd2lkdGg6Yi5hdHRyKCJkYXRhLWdzLXdpZHRoIiksaGVpZ2h0OmIuYXR0cigiZGF0YS1ncy1oZWlnaHQiKSxtYXhXaWR0aDpiLmF0dHIoImRhdGEtZ3MtbWF4LXdpZHRoIiksbWluV2lkdGg6Yi5hdHRyKCJkYXRhLWdzLW1pbi13aWR0aCIpLG1heEhlaWdodDpiLmF0dHIoImRhdGEtZ3MtbWF4LWhlaWdodCIpLG1pbkhlaWdodDpiLmF0dHIoImRhdGEtZ3MtbWluLWhlaWdodCIpLGF1dG9Qb3NpdGlvbjpnLnRvQm9vbChiLmF0dHIoImRhdGEtZ3MtYXV0by1wb3NpdGlvbiIpKSxub1Jlc2l6ZTpnLnRvQm9vbChiLmF0dHIoImRhdGEtZ3Mtbm8tcmVzaXplIikpLG5vTW92ZTpnLnRvQm9vbChiLmF0dHIoImRhdGEtZ3Mtbm8tbW92ZSIpKSxsb2NrZWQ6Zy50b0Jvb2woYi5hdHRyKCJkYXRhLWdzLWxvY2tlZCIpKSxlbDpiLGlkOmIuYXR0cigiZGF0YS1ncy1pZCIpLF9ncmlkOmR9LGMpO2IuZGF0YSgiX2dyaWRzdGFja19ub2RlIixlKSx0aGlzLl9wcmVwYXJlRWxlbWVudHNCeU5vZGUoYixlKX0sai5wcm90b3R5cGUuc2V0QW5pbWF0aW9uPWZ1bmN0aW9uKGEpe2E/dGhpcy5jb250YWluZXIuYWRkQ2xhc3MoImdyaWQtc3RhY2stYW5pbWF0ZSIpOnRoaXMuY29udGFpbmVyLnJlbW92ZUNsYXNzKCJncmlkLXN0YWNrLWFuaW1hdGUiKX0sai5wcm90b3R5cGUuYWRkV2lkZ2V0PWZ1bmN0aW9uKGIsYyxkLGUsZixnLGgsaSxqLGssbCl7cmV0dXJuIGI9YShiKSwidW5kZWZpbmVkIiE9dHlwZW9mIGMmJmIuYXR0cigiZGF0YS1ncy14IixjKSwidW5kZWZpbmVkIiE9dHlwZW9mIGQmJmIuYXR0cigiZGF0YS1ncy15IixkKSwidW5kZWZpbmVkIiE9dHlwZW9mIGUmJmIuYXR0cigiZGF0YS1ncy13aWR0aCIsZSksInVuZGVmaW5lZCIhPXR5cGVvZiBmJiZiLmF0dHIoImRhdGEtZ3MtaGVpZ2h0IixmKSwidW5kZWZpbmVkIiE9dHlwZW9mIGcmJmIuYXR0cigiZGF0YS1ncy1hdXRvLXBvc2l0aW9uIixnPyJ5ZXMiOm51bGwpLCJ1bmRlZmluZWQiIT10eXBlb2YgaCYmYi5hdHRyKCJkYXRhLWdzLW1pbi13aWR0aCIsaCksInVuZGVmaW5lZCIhPXR5cGVvZiBpJiZiLmF0dHIoImRhdGEtZ3MtbWF4LXdpZHRoIixpKSwidW5kZWZpbmVkIiE9dHlwZW9mIGomJmIuYXR0cigiZGF0YS1ncy1taW4taGVpZ2h0IixqKSwidW5kZWZpbmVkIiE9dHlwZW9mIGsmJmIuYXR0cigiZGF0YS1ncy1tYXgtaGVpZ2h0IixrKSwidW5kZWZpbmVkIiE9dHlwZW9mIGwmJmIuYXR0cigiZGF0YS1ncy1pZCIsbCksdGhpcy5jb250YWluZXIuYXBwZW5kKGIpLHRoaXMuX3ByZXBhcmVFbGVtZW50KGIsITApLHRoaXMuX3RyaWdnZXJBZGRFdmVudCgpLHRoaXMuX3VwZGF0ZUNvbnRhaW5lckhlaWdodCgpLHRoaXMuX3RyaWdnZXJDaGFuZ2VFdmVudCghMCksYn0sai5wcm90b3R5cGUubWFrZVdpZGdldD1mdW5jdGlvbihiKXtyZXR1cm4gYj1hKGIpLHRoaXMuX3ByZXBhcmVFbGVtZW50KGIsITApLHRoaXMuX3RyaWdnZXJBZGRFdmVudCgpLHRoaXMuX3VwZGF0ZUNvbnRhaW5lckhlaWdodCgpLHRoaXMuX3RyaWdnZXJDaGFuZ2VFdmVudCghMCksYn0sai5wcm90b3R5cGUud2lsbEl0Rml0PWZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9e3g6YSx5OmIsd2lkdGg6YyxoZWlnaHQ6ZCxhdXRvUG9zaXRpb246ZX07cmV0dXJuIHRoaXMuZ3JpZC5jYW5CZVBsYWNlZFdpdGhSZXNwZWN0VG9IZWlnaHQoZil9LGoucHJvdG90eXBlLnJlbW92ZVdpZGdldD1mdW5jdGlvbihiLGMpe2M9InVuZGVmaW5lZCI9PXR5cGVvZiBjfHxjLGI9YShiKTt2YXIgZD1iLmRhdGEoIl9ncmlkc3RhY2tfbm9kZSIpOw0KLy8gRm9yIE1ldGVvciBzdXBwb3J0OiBodHRwczovL2dpdGh1Yi5jb20vdHJvb2xlZS9ncmlkc3RhY2suanMvcHVsbC8yNzINCmR8fChkPXRoaXMuZ3JpZC5nZXROb2RlRGF0YUJ5RE9NRWwoYikpLHRoaXMuZ3JpZC5yZW1vdmVOb2RlKGQsYyksYi5yZW1vdmVEYXRhKCJfZ3JpZHN0YWNrX25vZGUiKSx0aGlzLl91cGRhdGVDb250YWluZXJIZWlnaHQoKSxjJiZiLnJlbW92ZSgpLHRoaXMuX3RyaWdnZXJDaGFuZ2VFdmVudCghMCksdGhpcy5fdHJpZ2dlclJlbW92ZUV2ZW50KCl9LGoucHJvdG90eXBlLnJlbW92ZUFsbD1mdW5jdGlvbihhKXtiLmVhY2godGhpcy5ncmlkLm5vZGVzLGIuYmluZChmdW5jdGlvbihiKXt0aGlzLnJlbW92ZVdpZGdldChiLmVsLGEpfSx0aGlzKSksdGhpcy5ncmlkLm5vZGVzPVtdLHRoaXMuX3VwZGF0ZUNvbnRhaW5lckhlaWdodCgpfSxqLnByb3RvdHlwZS5kZXN0cm95PWZ1bmN0aW9uKGIpe2Eod2luZG93KS5vZmYoInJlc2l6ZSIsdGhpcy5vblJlc2l6ZUhhbmRsZXIpLHRoaXMuZGlzYWJsZSgpLCJ1bmRlZmluZWQiPT10eXBlb2YgYnx8Yj90aGlzLmNvbnRhaW5lci5yZW1vdmUoKToodGhpcy5yZW1vdmVBbGwoITEpLHRoaXMuY29udGFpbmVyLnJlbW92ZURhdGEoImdyaWRzdGFjayIpKSxnLnJlbW92ZVN0eWxlc2hlZXQodGhpcy5fc3R5bGVzSWQpLHRoaXMuZ3JpZCYmKHRoaXMuZ3JpZD1udWxsKX0sai5wcm90b3R5cGUucmVzaXphYmxlPWZ1bmN0aW9uKGIsYyl7dmFyIGQ9dGhpcztyZXR1cm4gYj1hKGIpLGIuZWFjaChmdW5jdGlvbihiLGUpe2U9YShlKTt2YXIgZj1lLmRhdGEoIl9ncmlkc3RhY2tfbm9kZSIpOyJ1bmRlZmluZWQiIT10eXBlb2YgZiYmbnVsbCE9PWYmJiJ1bmRlZmluZWQiIT10eXBlb2YgYS51aSYmKGYubm9SZXNpemU9IWMsZi5ub1Jlc2l6ZXx8ZC5faXNPbmVDb2x1bW5Nb2RlKCk/ZC5kZC5yZXNpemFibGUoZSwiZGlzYWJsZSIpOmQuZGQucmVzaXphYmxlKGUsImVuYWJsZSIpKX0pLHRoaXN9LGoucHJvdG90eXBlLm1vdmFibGU9ZnVuY3Rpb24oYixjKXt2YXIgZD10aGlzO3JldHVybiBiPWEoYiksYi5lYWNoKGZ1bmN0aW9uKGIsZSl7ZT1hKGUpO3ZhciBmPWUuZGF0YSgiX2dyaWRzdGFja19ub2RlIik7InVuZGVmaW5lZCIhPXR5cGVvZiBmJiZudWxsIT09ZiYmInVuZGVmaW5lZCIhPXR5cGVvZiBhLnVpJiYoZi5ub01vdmU9IWMsZi5ub01vdmV8fGQuX2lzT25lQ29sdW1uTW9kZSgpPyhkLmRkLmRyYWdnYWJsZShlLCJkaXNhYmxlIiksZS5yZW1vdmVDbGFzcygidWktZHJhZ2dhYmxlLWhhbmRsZSIpKTooZC5kZC5kcmFnZ2FibGUoZSwiZW5hYmxlIiksZS5hZGRDbGFzcygidWktZHJhZ2dhYmxlLWhhbmRsZSIpKSl9KSx0aGlzfSxqLnByb3RvdHlwZS5lbmFibGVNb3ZlPWZ1bmN0aW9uKGEsYil7dGhpcy5tb3ZhYmxlKHRoaXMuY29udGFpbmVyLmNoaWxkcmVuKCIuIit0aGlzLm9wdHMuaXRlbUNsYXNzKSxhKSxiJiYodGhpcy5vcHRzLmRpc2FibGVEcmFnPSFhKX0sai5wcm90b3R5cGUuZW5hYmxlUmVzaXplPWZ1bmN0aW9uKGEsYil7dGhpcy5yZXNpemFibGUodGhpcy5jb250YWluZXIuY2hpbGRyZW4oIi4iK3RoaXMub3B0cy5pdGVtQ2xhc3MpLGEpLGImJih0aGlzLm9wdHMuZGlzYWJsZVJlc2l6ZT0hYSl9LGoucHJvdG90eXBlLmRpc2FibGU9ZnVuY3Rpb24oKXt0aGlzLm1vdmFibGUodGhpcy5jb250YWluZXIuY2hpbGRyZW4oIi4iK3RoaXMub3B0cy5pdGVtQ2xhc3MpLCExKSx0aGlzLnJlc2l6YWJsZSh0aGlzLmNvbnRhaW5lci5jaGlsZHJlbigiLiIrdGhpcy5vcHRzLml0ZW1DbGFzcyksITEpLHRoaXMuY29udGFpbmVyLnRyaWdnZXIoImRpc2FibGUiKX0sai5wcm90b3R5cGUuZW5hYmxlPWZ1bmN0aW9uKCl7dGhpcy5tb3ZhYmxlKHRoaXMuY29udGFpbmVyLmNoaWxkcmVuKCIuIit0aGlzLm9wdHMuaXRlbUNsYXNzKSwhMCksdGhpcy5yZXNpemFibGUodGhpcy5jb250YWluZXIuY2hpbGRyZW4oIi4iK3RoaXMub3B0cy5pdGVtQ2xhc3MpLCEwKSx0aGlzLmNvbnRhaW5lci50cmlnZ2VyKCJlbmFibGUiKX0sai5wcm90b3R5cGUubG9ja2VkPWZ1bmN0aW9uKGIsYyl7cmV0dXJuIGI9YShiKSxiLmVhY2goZnVuY3Rpb24oYixkKXtkPWEoZCk7dmFyIGU9ZC5kYXRhKCJfZ3JpZHN0YWNrX25vZGUiKTsidW5kZWZpbmVkIiE9dHlwZW9mIGUmJm51bGwhPT1lJiYoZS5sb2NrZWQ9Y3x8ITEsZC5hdHRyKCJkYXRhLWdzLWxvY2tlZCIsZS5sb2NrZWQ/InllcyI6bnVsbCkpfSksdGhpc30sai5wcm90b3R5cGUubWF4SGVpZ2h0PWZ1bmN0aW9uKGIsYyl7cmV0dXJuIGI9YShiKSxiLmVhY2goZnVuY3Rpb24oYixkKXtkPWEoZCk7dmFyIGU9ZC5kYXRhKCJfZ3JpZHN0YWNrX25vZGUiKTsidW5kZWZpbmVkIiE9dHlwZW9mIGUmJm51bGwhPT1lJiYoaXNOYU4oYyl8fChlLm1heEhlaWdodD1jfHwhMSxkLmF0dHIoImRhdGEtZ3MtbWF4LWhlaWdodCIsYykpKX0pLHRoaXN9LGoucHJvdG90eXBlLm1pbkhlaWdodD1mdW5jdGlvbihiLGMpe3JldHVybiBiPWEoYiksYi5lYWNoKGZ1bmN0aW9uKGIsZCl7ZD1hKGQpO3ZhciBlPWQuZGF0YSgiX2dyaWRzdGFja19ub2RlIik7InVuZGVmaW5lZCIhPXR5cGVvZiBlJiZudWxsIT09ZSYmKGlzTmFOKGMpfHwoZS5taW5IZWlnaHQ9Y3x8ITEsZC5hdHRyKCJkYXRhLWdzLW1pbi1oZWlnaHQiLGMpKSl9KSx0aGlzfSxqLnByb3RvdHlwZS5tYXhXaWR0aD1mdW5jdGlvbihiLGMpe3JldHVybiBiPWEoYiksYi5lYWNoKGZ1bmN0aW9uKGIsZCl7ZD1hKGQpO3ZhciBlPWQuZGF0YSgiX2dyaWRzdGFja19ub2RlIik7InVuZGVmaW5lZCIhPXR5cGVvZiBlJiZudWxsIT09ZSYmKGlzTmFOKGMpfHwoZS5tYXhXaWR0aD1jfHwhMSxkLmF0dHIoImRhdGEtZ3MtbWF4LXdpZHRoIixjKSkpfSksdGhpc30sai5wcm90b3R5cGUubWluV2lkdGg9ZnVuY3Rpb24oYixjKXtyZXR1cm4gYj1hKGIpLGIuZWFjaChmdW5jdGlvbihiLGQpe2Q9YShkKTt2YXIgZT1kLmRhdGEoIl9ncmlkc3RhY2tfbm9kZSIpOyJ1bmRlZmluZWQiIT10eXBlb2YgZSYmbnVsbCE9PWUmJihpc05hTihjKXx8KGUubWluV2lkdGg9Y3x8ITEsZC5hdHRyKCJkYXRhLWdzLW1pbi13aWR0aCIsYykpKX0pLHRoaXN9LGoucHJvdG90eXBlLl91cGRhdGVFbGVtZW50PWZ1bmN0aW9uKGIsYyl7Yj1hKGIpLmZpcnN0KCk7dmFyIGQ9Yi5kYXRhKCJfZ3JpZHN0YWNrX25vZGUiKTtpZigidW5kZWZpbmVkIiE9dHlwZW9mIGQmJm51bGwhPT1kKXt2YXIgZT10aGlzO2UuZ3JpZC5jbGVhbk5vZGVzKCksZS5ncmlkLmJlZ2luVXBkYXRlKGQpLGMuY2FsbCh0aGlzLGIsZCksZS5fdXBkYXRlQ29udGFpbmVySGVpZ2h0KCksZS5fdHJpZ2dlckNoYW5nZUV2ZW50KCksZS5ncmlkLmVuZFVwZGF0ZSgpfX0sai5wcm90b3R5cGUucmVzaXplPWZ1bmN0aW9uKGEsYixjKXt0aGlzLl91cGRhdGVFbGVtZW50KGEsZnVuY3Rpb24oYSxkKXtiPW51bGwhPT1iJiYidW5kZWZpbmVkIiE9dHlwZW9mIGI/YjpkLndpZHRoLGM9bnVsbCE9PWMmJiJ1bmRlZmluZWQiIT10eXBlb2YgYz9jOmQuaGVpZ2h0LHRoaXMuZ3JpZC5tb3ZlTm9kZShkLGQueCxkLnksYixjKX0pfSxqLnByb3RvdHlwZS5tb3ZlPWZ1bmN0aW9uKGEsYixjKXt0aGlzLl91cGRhdGVFbGVtZW50KGEsZnVuY3Rpb24oYSxkKXtiPW51bGwhPT1iJiYidW5kZWZpbmVkIiE9dHlwZW9mIGI/YjpkLngsYz1udWxsIT09YyYmInVuZGVmaW5lZCIhPXR5cGVvZiBjP2M6ZC55LHRoaXMuZ3JpZC5tb3ZlTm9kZShkLGIsYyxkLndpZHRoLGQuaGVpZ2h0KX0pfSxqLnByb3RvdHlwZS51cGRhdGU9ZnVuY3Rpb24oYSxiLGMsZCxlKXt0aGlzLl91cGRhdGVFbGVtZW50KGEsZnVuY3Rpb24oYSxmKXtiPW51bGwhPT1iJiYidW5kZWZpbmVkIiE9dHlwZW9mIGI/YjpmLngsYz1udWxsIT09YyYmInVuZGVmaW5lZCIhPXR5cGVvZiBjP2M6Zi55LGQ9bnVsbCE9PWQmJiJ1bmRlZmluZWQiIT10eXBlb2YgZD9kOmYud2lkdGgsZT1udWxsIT09ZSYmInVuZGVmaW5lZCIhPXR5cGVvZiBlP2U6Zi5oZWlnaHQsdGhpcy5ncmlkLm1vdmVOb2RlKGYsYixjLGQsZSl9KX0sai5wcm90b3R5cGUudmVydGljYWxNYXJnaW49ZnVuY3Rpb24oYSxiKXtpZigidW5kZWZpbmVkIj09dHlwZW9mIGEpcmV0dXJuIHRoaXMub3B0cy52ZXJ0aWNhbE1hcmdpbjt2YXIgYz1nLnBhcnNlSGVpZ2h0KGEpO3RoaXMub3B0cy52ZXJ0aWNhbE1hcmdpblVuaXQ9PT1jLnVuaXQmJnRoaXMub3B0cy5oZWlnaHQ9PT1jLmhlaWdodHx8KHRoaXMub3B0cy52ZXJ0aWNhbE1hcmdpblVuaXQ9Yy51bml0LHRoaXMub3B0cy52ZXJ0aWNhbE1hcmdpbj1jLmhlaWdodCxifHx0aGlzLl91cGRhdGVTdHlsZXMoKSl9LGoucHJvdG90eXBlLmNlbGxIZWlnaHQ9ZnVuY3Rpb24oYSxiKXtpZigidW5kZWZpbmVkIj09dHlwZW9mIGEpe2lmKHRoaXMub3B0cy5jZWxsSGVpZ2h0KXJldHVybiB0aGlzLm9wdHMuY2VsbEhlaWdodDt2YXIgYz10aGlzLmNvbnRhaW5lci5jaGlsZHJlbigiLiIrdGhpcy5vcHRzLml0ZW1DbGFzcykuZmlyc3QoKTtyZXR1cm4gTWF0aC5jZWlsKGMub3V0ZXJIZWlnaHQoKS9jLmF0dHIoImRhdGEtZ3MtaGVpZ2h0IikpfXZhciBkPWcucGFyc2VIZWlnaHQoYSk7dGhpcy5vcHRzLmNlbGxIZWlnaHRVbml0PT09ZC5oZWlnaHRVbml0JiZ0aGlzLm9wdHMuaGVpZ2h0PT09ZC5oZWlnaHR8fCh0aGlzLm9wdHMuY2VsbEhlaWdodFVuaXQ9ZC51bml0LHRoaXMub3B0cy5jZWxsSGVpZ2h0PWQuaGVpZ2h0LGJ8fHRoaXMuX3VwZGF0ZVN0eWxlcygpKX0sai5wcm90b3R5cGUuY2VsbFdpZHRoPWZ1bmN0aW9uKCl7cmV0dXJuIE1hdGgucm91bmQodGhpcy5jb250YWluZXIub3V0ZXJXaWR0aCgpL3RoaXMub3B0cy53aWR0aCl9LGoucHJvdG90eXBlLmdldENlbGxGcm9tUGl4ZWw9ZnVuY3Rpb24oYSxiKXt2YXIgYz0idW5kZWZpbmVkIiE9dHlwZW9mIGImJmI/dGhpcy5jb250YWluZXIub2Zmc2V0KCk6dGhpcy5jb250YWluZXIucG9zaXRpb24oKSxkPWEubGVmdC1jLmxlZnQsZT1hLnRvcC1jLnRvcCxmPU1hdGguZmxvb3IodGhpcy5jb250YWluZXIud2lkdGgoKS90aGlzLm9wdHMud2lkdGgpLGc9TWF0aC5mbG9vcih0aGlzLmNvbnRhaW5lci5oZWlnaHQoKS9wYXJzZUludCh0aGlzLmNvbnRhaW5lci5hdHRyKCJkYXRhLWdzLWN1cnJlbnQtaGVpZ2h0IikpKTtyZXR1cm57eDpNYXRoLmZsb29yKGQvZikseTpNYXRoLmZsb29yKGUvZyl9fSxqLnByb3RvdHlwZS5iYXRjaFVwZGF0ZT1mdW5jdGlvbigpe3RoaXMuZ3JpZC5iYXRjaFVwZGF0ZSgpfSxqLnByb3RvdHlwZS5jb21taXQ9ZnVuY3Rpb24oKXt0aGlzLmdyaWQuY29tbWl0KCksdGhpcy5fdXBkYXRlQ29udGFpbmVySGVpZ2h0KCl9LGoucHJvdG90eXBlLmlzQXJlYUVtcHR5PWZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiB0aGlzLmdyaWQuaXNBcmVhRW1wdHkoYSxiLGMsZCl9LGoucHJvdG90eXBlLnNldFN0YXRpYz1mdW5jdGlvbihhKXt0aGlzLm9wdHMuc3RhdGljR3JpZD1hPT09ITAsdGhpcy5lbmFibGVNb3ZlKCFhKSx0aGlzLmVuYWJsZVJlc2l6ZSghYSksdGhpcy5fc2V0U3RhdGljQ2xhc3MoKX0sai5wcm90b3R5cGUuX3NldFN0YXRpY0NsYXNzPWZ1bmN0aW9uKCl7dmFyIGE9ImdyaWQtc3RhY2stc3RhdGljIjt0aGlzLm9wdHMuc3RhdGljR3JpZD09PSEwP3RoaXMuY29udGFpbmVyLmFkZENsYXNzKGEpOnRoaXMuY29udGFpbmVyLnJlbW92ZUNsYXNzKGEpfSxqLnByb3RvdHlwZS5fdXBkYXRlTm9kZVdpZHRocz1mdW5jdGlvbihhLGIpe3RoaXMuZ3JpZC5fc29ydE5vZGVzKCksdGhpcy5ncmlkLmJhdGNoVXBkYXRlKCk7Zm9yKHZhciBjPXt9LGQ9MDtkPHRoaXMuZ3JpZC5ub2Rlcy5sZW5ndGg7ZCsrKWM9dGhpcy5ncmlkLm5vZGVzW2RdLHRoaXMudXBkYXRlKGMuZWwsTWF0aC5yb3VuZChjLngqYi9hKSx2b2lkIDAsTWF0aC5yb3VuZChjLndpZHRoKmIvYSksdm9pZCAwKTt0aGlzLmdyaWQuY29tbWl0KCl9LGoucHJvdG90eXBlLnNldEdyaWRXaWR0aD1mdW5jdGlvbihhLGIpe3RoaXMuY29udGFpbmVyLnJlbW92ZUNsYXNzKCJncmlkLXN0YWNrLSIrdGhpcy5vcHRzLndpZHRoKSxiIT09ITAmJnRoaXMuX3VwZGF0ZU5vZGVXaWR0aHModGhpcy5vcHRzLndpZHRoLGEpLHRoaXMub3B0cy53aWR0aD1hLHRoaXMuZ3JpZC53aWR0aD1hLHRoaXMuY29udGFpbmVyLmFkZENsYXNzKCJncmlkLXN0YWNrLSIrYSl9LGkucHJvdG90eXBlLmJhdGNoX3VwZGF0ZT1lKGkucHJvdG90eXBlLmJhdGNoVXBkYXRlKSxpLnByb3RvdHlwZS5fZml4X2NvbGxpc2lvbnM9ZShpLnByb3RvdHlwZS5fZml4Q29sbGlzaW9ucywiX2ZpeF9jb2xsaXNpb25zIiwiX2ZpeENvbGxpc2lvbnMiKSxpLnByb3RvdHlwZS5pc19hcmVhX2VtcHR5PWUoaS5wcm90b3R5cGUuaXNBcmVhRW1wdHksImlzX2FyZWFfZW1wdHkiLCJpc0FyZWFFbXB0eSIpLGkucHJvdG90eXBlLl9zb3J0X25vZGVzPWUoaS5wcm90b3R5cGUuX3NvcnROb2RlcywiX3NvcnRfbm9kZXMiLCJfc29ydE5vZGVzIiksaS5wcm90b3R5cGUuX3BhY2tfbm9kZXM9ZShpLnByb3RvdHlwZS5fcGFja05vZGVzLCJfcGFja19ub2RlcyIsIl9wYWNrTm9kZXMiKSxpLnByb3RvdHlwZS5fcHJlcGFyZV9ub2RlPWUoaS5wcm90b3R5cGUuX3ByZXBhcmVOb2RlLCJfcHJlcGFyZV9ub2RlIiwiX3ByZXBhcmVOb2RlIiksaS5wcm90b3R5cGUuY2xlYW5fbm9kZXM9ZShpLnByb3RvdHlwZS5jbGVhbk5vZGVzLCJjbGVhbl9ub2RlcyIsImNsZWFuTm9kZXMiKSxpLnByb3RvdHlwZS5nZXRfZGlydHlfbm9kZXM9ZShpLnByb3RvdHlwZS5nZXREaXJ0eU5vZGVzLCJnZXRfZGlydHlfbm9kZXMiLCJnZXREaXJ0eU5vZGVzIiksaS5wcm90b3R5cGUuYWRkX25vZGU9ZShpLnByb3RvdHlwZS5hZGROb2RlLCJhZGRfbm9kZSIsImFkZE5vZGUsICIpLGkucHJvdG90eXBlLnJlbW92ZV9ub2RlPWUoaS5wcm90b3R5cGUucmVtb3ZlTm9kZSwicmVtb3ZlX25vZGUiLCJyZW1vdmVOb2RlIiksaS5wcm90b3R5cGUuY2FuX21vdmVfbm9kZT1lKGkucHJvdG90eXBlLmNhbk1vdmVOb2RlLCJjYW5fbW92ZV9ub2RlIiwiY2FuTW92ZU5vZGUiKSxpLnByb3RvdHlwZS5tb3ZlX25vZGU9ZShpLnByb3RvdHlwZS5tb3ZlTm9kZSwibW92ZV9ub2RlIiwibW92ZU5vZGUiKSxpLnByb3RvdHlwZS5nZXRfZ3JpZF9oZWlnaHQ9ZShpLnByb3RvdHlwZS5nZXRHcmlkSGVpZ2h0LCJnZXRfZ3JpZF9oZWlnaHQiLCJnZXRHcmlkSGVpZ2h0IiksaS5wcm90b3R5cGUuYmVnaW5fdXBkYXRlPWUoaS5wcm90b3R5cGUuYmVnaW5VcGRhdGUsImJlZ2luX3VwZGF0ZSIsImJlZ2luVXBkYXRlIiksaS5wcm90b3R5cGUuZW5kX3VwZGF0ZT1lKGkucHJvdG90eXBlLmVuZFVwZGF0ZSwiZW5kX3VwZGF0ZSIsImVuZFVwZGF0ZSIpLGkucHJvdG90eXBlLmNhbl9iZV9wbGFjZWRfd2l0aF9yZXNwZWN0X3RvX2hlaWdodD1lKGkucHJvdG90eXBlLmNhbkJlUGxhY2VkV2l0aFJlc3BlY3RUb0hlaWdodCwiY2FuX2JlX3BsYWNlZF93aXRoX3Jlc3BlY3RfdG9faGVpZ2h0IiwiY2FuQmVQbGFjZWRXaXRoUmVzcGVjdFRvSGVpZ2h0Iiksai5wcm90b3R5cGUuX3RyaWdnZXJfY2hhbmdlX2V2ZW50PWUoai5wcm90b3R5cGUuX3RyaWdnZXJDaGFuZ2VFdmVudCwiX3RyaWdnZXJfY2hhbmdlX2V2ZW50IiwiX3RyaWdnZXJDaGFuZ2VFdmVudCIpLGoucHJvdG90eXBlLl9pbml0X3N0eWxlcz1lKGoucHJvdG90eXBlLl9pbml0U3R5bGVzLCJfaW5pdF9zdHlsZXMiLCJfaW5pdFN0eWxlcyIpLGoucHJvdG90eXBlLl91cGRhdGVfc3R5bGVzPWUoai5wcm90b3R5cGUuX3VwZGF0ZVN0eWxlcywiX3VwZGF0ZV9zdHlsZXMiLCJfdXBkYXRlU3R5bGVzIiksai5wcm90b3R5cGUuX3VwZGF0ZV9jb250YWluZXJfaGVpZ2h0PWUoai5wcm90b3R5cGUuX3VwZGF0ZUNvbnRhaW5lckhlaWdodCwiX3VwZGF0ZV9jb250YWluZXJfaGVpZ2h0IiwiX3VwZGF0ZUNvbnRhaW5lckhlaWdodCIpLGoucHJvdG90eXBlLl9pc19vbmVfY29sdW1uX21vZGU9ZShqLnByb3RvdHlwZS5faXNPbmVDb2x1bW5Nb2RlLCJfaXNfb25lX2NvbHVtbl9tb2RlIiwiX2lzT25lQ29sdW1uTW9kZSIpLGoucHJvdG90eXBlLl9wcmVwYXJlX2VsZW1lbnQ9ZShqLnByb3RvdHlwZS5fcHJlcGFyZUVsZW1lbnQsIl9wcmVwYXJlX2VsZW1lbnQiLCJfcHJlcGFyZUVsZW1lbnQiKSxqLnByb3RvdHlwZS5zZXRfYW5pbWF0aW9uPWUoai5wcm90b3R5cGUuc2V0QW5pbWF0aW9uLCJzZXRfYW5pbWF0aW9uIiwic2V0QW5pbWF0aW9uIiksai5wcm90b3R5cGUuYWRkX3dpZGdldD1lKGoucHJvdG90eXBlLmFkZFdpZGdldCwiYWRkX3dpZGdldCIsImFkZFdpZGdldCIpLGoucHJvdG90eXBlLm1ha2Vfd2lkZ2V0PWUoai5wcm90b3R5cGUubWFrZVdpZGdldCwibWFrZV93aWRnZXQiLCJtYWtlV2lkZ2V0Iiksai5wcm90b3R5cGUud2lsbF9pdF9maXQ9ZShqLnByb3RvdHlwZS53aWxsSXRGaXQsIndpbGxfaXRfZml0Iiwid2lsbEl0Rml0Iiksai5wcm90b3R5cGUucmVtb3ZlX3dpZGdldD1lKGoucHJvdG90eXBlLnJlbW92ZVdpZGdldCwicmVtb3ZlX3dpZGdldCIsInJlbW92ZVdpZGdldCIpLGoucHJvdG90eXBlLnJlbW92ZV9hbGw9ZShqLnByb3RvdHlwZS5yZW1vdmVBbGwsInJlbW92ZV9hbGwiLCJyZW1vdmVBbGwiKSxqLnByb3RvdHlwZS5taW5faGVpZ2h0PWUoai5wcm90b3R5cGUubWluSGVpZ2h0LCJtaW5faGVpZ2h0IiwibWluSGVpZ2h0Iiksai5wcm90b3R5cGUubWluX3dpZHRoPWUoai5wcm90b3R5cGUubWluV2lkdGgsIm1pbl93aWR0aCIsIm1pbldpZHRoIiksai5wcm90b3R5cGUuX3VwZGF0ZV9lbGVtZW50PWUoai5wcm90b3R5cGUuX3VwZGF0ZUVsZW1lbnQsIl91cGRhdGVfZWxlbWVudCIsIl91cGRhdGVFbGVtZW50Iiksai5wcm90b3R5cGUuY2VsbF9oZWlnaHQ9ZShqLnByb3RvdHlwZS5jZWxsSGVpZ2h0LCJjZWxsX2hlaWdodCIsImNlbGxIZWlnaHQiKSxqLnByb3RvdHlwZS5jZWxsX3dpZHRoPWUoai5wcm90b3R5cGUuY2VsbFdpZHRoLCJjZWxsX3dpZHRoIiwiY2VsbFdpZHRoIiksai5wcm90b3R5cGUuZ2V0X2NlbGxfZnJvbV9waXhlbD1lKGoucHJvdG90eXBlLmdldENlbGxGcm9tUGl4ZWwsImdldF9jZWxsX2Zyb21fcGl4ZWwiLCJnZXRDZWxsRnJvbVBpeGVsIiksai5wcm90b3R5cGUuYmF0Y2hfdXBkYXRlPWUoai5wcm90b3R5cGUuYmF0Y2hVcGRhdGUsImJhdGNoX3VwZGF0ZSIsImJhdGNoVXBkYXRlIiksai5wcm90b3R5cGUuaXNfYXJlYV9lbXB0eT1lKGoucHJvdG90eXBlLmlzQXJlYUVtcHR5LCJpc19hcmVhX2VtcHR5IiwiaXNBcmVhRW1wdHkiKSxqLnByb3RvdHlwZS5zZXRfc3RhdGljPWUoai5wcm90b3R5cGUuc2V0U3RhdGljLCJzZXRfc3RhdGljIiwic2V0U3RhdGljIiksai5wcm90b3R5cGUuX3NldF9zdGF0aWNfY2xhc3M9ZShqLnByb3RvdHlwZS5fc2V0U3RhdGljQ2xhc3MsIl9zZXRfc3RhdGljX2NsYXNzIiwiX3NldFN0YXRpY0NsYXNzIiksZC5HcmlkU3RhY2tVST1qLGQuR3JpZFN0YWNrVUkuVXRpbHM9ZyxkLkdyaWRTdGFja1VJLkVuZ2luZT1pLGQuR3JpZFN0YWNrVUkuR3JpZFN0YWNrRHJhZ0Ryb3BQbHVnaW49YyxhLmZuLmdyaWRzdGFjaz1mdW5jdGlvbihiKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGM9YSh0aGlzKTtjLmRhdGEoImdyaWRzdGFjayIpfHxjLmRhdGEoImdyaWRzdGFjayIsbmV3IGoodGhpcyxiKSl9KX0sZC5HcmlkU3RhY2tVSX0pOw0KLy8jIHNvdXJjZU1hcHBpbmdVUkw9Z3JpZHN0YWNrLm1pbi5tYXAKLyoqDQogKiBncmlkc3RhY2suanMgMC4zLjAtZGV2DQogKiBodHRwOi8vdHJvb2xlZS5naXRodWIuaW8vZ3JpZHN0YWNrLmpzLw0KICogKGMpIDIwMTQtMjAxNiBQYXZlbCBSZXpuaWtvdiwgRHlsYW4gV2Vpc3MNCiAqIGdyaWRzdGFjay5qcyBtYXkgYmUgZnJlZWx5IGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4NCiAqIEBwcmVzZXJ2ZQ0KKi8NCiFmdW5jdGlvbihhKXtpZigiZnVuY3Rpb24iPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kKWRlZmluZShbImpxdWVyeSIsImxvZGFzaCIsImdyaWRzdGFjayIsImpxdWVyeS11aS9kYXRhIiwianF1ZXJ5LXVpL2Rpc2FibGUtc2VsZWN0aW9uIiwianF1ZXJ5LXVpL2ZvY3VzYWJsZSIsImpxdWVyeS11aS9mb3JtIiwianF1ZXJ5LXVpL2llIiwianF1ZXJ5LXVpL2tleWNvZGUiLCJqcXVlcnktdWkvbGFiZWxzIiwianF1ZXJ5LXVpL2pxdWVyeS0xLTciLCJqcXVlcnktdWkvcGx1Z2luIiwianF1ZXJ5LXVpL3NhZmUtYWN0aXZlLWVsZW1lbnQiLCJqcXVlcnktdWkvc2FmZS1ibHVyIiwianF1ZXJ5LXVpL3Njcm9sbC1wYXJlbnQiLCJqcXVlcnktdWkvdGFiYmFibGUiLCJqcXVlcnktdWkvdW5pcXVlLWlkIiwianF1ZXJ5LXVpL3ZlcnNpb24iLCJqcXVlcnktdWkvd2lkZ2V0IiwianF1ZXJ5LXVpL3dpZGdldHMvbW91c2UiLCJqcXVlcnktdWkvd2lkZ2V0cy9kcmFnZ2FibGUiLCJqcXVlcnktdWkvd2lkZ2V0cy9kcm9wcGFibGUiLCJqcXVlcnktdWkvd2lkZ2V0cy9yZXNpemFibGUiXSxhKTtlbHNlIGlmKCJ1bmRlZmluZWQiIT10eXBlb2YgZXhwb3J0cyl7dHJ5e2pRdWVyeT1yZXF1aXJlKCJqcXVlcnkiKX1jYXRjaChhKXt9dHJ5e189cmVxdWlyZSgibG9kYXNoIil9Y2F0Y2goYSl7fXRyeXtHcmlkU3RhY2tVST1yZXF1aXJlKCJncmlkc3RhY2siKX1jYXRjaChhKXt9YShqUXVlcnksXyxHcmlkU3RhY2tVSSl9ZWxzZSBhKGpRdWVyeSxfLEdyaWRTdGFja1VJKX0oZnVuY3Rpb24oYSxiLGMpey8qKg0KICAgICogQGNsYXNzIEpRdWVyeVVJR3JpZFN0YWNrRHJhZ0Ryb3BQbHVnaW4NCiAgICAqIGpRdWVyeSBVSSBpbXBsZW1lbnRhdGlvbiBvZiBkcmFnJ24nZHJvcCBncmlkc3RhY2sgcGx1Z2luLg0KICAgICovDQpmdW5jdGlvbiBkKGEpe2MuR3JpZFN0YWNrRHJhZ0Ryb3BQbHVnaW4uY2FsbCh0aGlzLGEpfXdpbmRvdztyZXR1cm4gYy5HcmlkU3RhY2tEcmFnRHJvcFBsdWdpbi5yZWdpc3RlclBsdWdpbihkKSxkLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGMuR3JpZFN0YWNrRHJhZ0Ryb3BQbHVnaW4ucHJvdG90eXBlKSxkLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1kLGQucHJvdG90eXBlLnJlc2l6YWJsZT1mdW5jdGlvbihjLGQpe2lmKGM9YShjKSwiZGlzYWJsZSI9PT1kfHwiZW5hYmxlIj09PWQpYy5yZXNpemFibGUoZCk7ZWxzZSBpZigib3B0aW9uIj09PWQpe3ZhciBlPWFyZ3VtZW50c1syXSxmPWFyZ3VtZW50c1szXTtjLnJlc2l6YWJsZShkLGUsZil9ZWxzZSBjLnJlc2l6YWJsZShiLmV4dGVuZCh7fSx0aGlzLmdyaWQub3B0cy5yZXNpemFibGUse3N0YXJ0OmQuc3RhcnR8fGZ1bmN0aW9uKCl7fSxzdG9wOmQuc3RvcHx8ZnVuY3Rpb24oKXt9LHJlc2l6ZTpkLnJlc2l6ZXx8ZnVuY3Rpb24oKXt9fSkpO3JldHVybiB0aGlzfSxkLnByb3RvdHlwZS5kcmFnZ2FibGU9ZnVuY3Rpb24oYyxkKXtyZXR1cm4gYz1hKGMpLCJkaXNhYmxlIj09PWR8fCJlbmFibGUiPT09ZD9jLmRyYWdnYWJsZShkKTpjLmRyYWdnYWJsZShiLmV4dGVuZCh7fSx0aGlzLmdyaWQub3B0cy5kcmFnZ2FibGUse2NvbnRhaW5tZW50OnRoaXMuZ3JpZC5vcHRzLmlzTmVzdGVkP3RoaXMuZ3JpZC5jb250YWluZXIucGFyZW50KCk6bnVsbCxzdGFydDpkLnN0YXJ0fHxmdW5jdGlvbigpe30sc3RvcDpkLnN0b3B8fGZ1bmN0aW9uKCl7fSxkcmFnOmQuZHJhZ3x8ZnVuY3Rpb24oKXt9fSkpLHRoaXN9LGQucHJvdG90eXBlLmRyb3BwYWJsZT1mdW5jdGlvbihiLGMpe3JldHVybiBiPWEoYiksImRpc2FibGUiPT09Y3x8ImVuYWJsZSI9PT1jP2IuZHJvcHBhYmxlKGMpOmIuZHJvcHBhYmxlKHthY2NlcHQ6Yy5hY2NlcHR9KSx0aGlzfSxkLnByb3RvdHlwZS5pc0Ryb3BwYWJsZT1mdW5jdGlvbihiLGMpe3JldHVybiBiPWEoYiksQm9vbGVhbihiLmRhdGEoImRyb3BwYWJsZSIpKX0sZC5wcm90b3R5cGUub249ZnVuY3Rpb24oYixjLGQpe3JldHVybiBhKGIpLm9uKGMsZCksdGhpc30sZH0pOw0KLy8jIHNvdXJjZU1hcHBpbmdVUkw9Z3JpZHN0YWNrLm1pbi5tYXAKLyohDQoqIGpxdWVyeS5jb3VudGVydXAuanMgMS4wDQoqDQoqIENvcHlyaWdodCAyMDEzLCBCZW5qYW1pbiBJbnRhbCBodHRwOi8vZ2FtYml0LnBoIEBiZmludGFsDQoqIFJlbGVhc2VkIHVuZGVyIHRoZSBHUEwgdjIgTGljZW5zZQ0KKg0KKiBEYXRlOiBOb3YgMjYsIDIwMTMNCiovKGZ1bmN0aW9uKGUpeyJ1c2Ugc3RyaWN0IjtlLmZuLmNvdW50ZXJVcD1mdW5jdGlvbih0KXt2YXIgbj1lLmV4dGVuZCh7dGltZTo0MDAsZGVsYXk6MTB9LHQpO3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgdD1lKHRoaXMpLHI9bixpPWZ1bmN0aW9uKCl7dmFyIGU9W10sbj1yLnRpbWUvci5kZWxheSxpPXQudGV4dCgpLHM9L1swLTldKyxbMC05XSsvLnRlc3QoaSk7aT1pLnJlcGxhY2UoLywvZywiIik7dmFyIG89L15bMC05XSskLy50ZXN0KGkpLHU9L15bMC05XStcLlswLTldKyQvLnRlc3QoaSksYT11PyhpLnNwbGl0KCIuIilbMV18fFtdKS5sZW5ndGg6MDtmb3IodmFyIGY9bjtmPj0xO2YtLSl7dmFyIGw9cGFyc2VJbnQoaS9uKmYpO3UmJihsPXBhcnNlRmxvYXQoaS9uKmYpLnRvRml4ZWQoYSkpO2lmKHMpd2hpbGUoLyhcZCspKFxkezN9KS8udGVzdChsLnRvU3RyaW5nKCkpKWw9bC50b1N0cmluZygpLnJlcGxhY2UoLyhcZCspKFxkezN9KS8sIiQxLCQyIik7ZS51bnNoaWZ0KGwpfXQuZGF0YSgiY291bnRlcnVwLW51bXMiLGUpO3QudGV4dCgiMCIpO3ZhciBjPWZ1bmN0aW9uKCl7dC50ZXh0KHQuZGF0YSgiY291bnRlcnVwLW51bXMiKS5zaGlmdCgpKTtpZih0LmRhdGEoImNvdW50ZXJ1cC1udW1zIikubGVuZ3RoKXNldFRpbWVvdXQodC5kYXRhKCJjb3VudGVydXAtZnVuYyIpLHIuZGVsYXkpO2Vsc2V7ZGVsZXRlIHQuZGF0YSgiY291bnRlcnVwLW51bXMiKTt0LmRhdGEoImNvdW50ZXJ1cC1udW1zIixudWxsKTt0LmRhdGEoImNvdW50ZXJ1cC1mdW5jIixudWxsKX19O3QuZGF0YSgiY291bnRlcnVwLWZ1bmMiLGMpO3NldFRpbWVvdXQodC5kYXRhKCJjb3VudGVydXAtZnVuYyIpLHIuZGVsYXkpfTt0LndheXBvaW50KGkse29mZnNldDoiMTAwJSIsdHJpZ2dlck9uY2U6ITB9KX0pfX0pKGpRdWVyeSk7CnZhciBwdmkgID0gcHZpIHx8IHt9OwoKcHZpLmRhc2hib2FyZCA9IChmdW5jdGlvbiAoKSB7CgogICAgdmFyIGdyaWRzdGFja09wdGlvbnMgPSB7CiAgICAgICAgd2lkdGg6IDEyLAogICAgICAgIHJlc2l6YWJsZToge2F1dG9IaWRlOiB0cnVlLCBoYW5kbGVzOiAnYWxsJ30sCiAgICAgICAgdmVydGljYWxNYXJnaW46IDEwLAogICAgICAgIGFuaW1hdGU6IHRydWUsCiAgICAgICAgZHJhZ2dhYmxlOiB7CiAgICAgICAgICAgIGhhbmRsZTogJy5wdi1zZWMtaGVhZGluZycsCiAgICAgICAgICAgIHNjcm9sbDogdHJ1ZQogICAgICAgIH0KICAgIH07CgogICAgdmFyIHNhdmVXaWRnZXRzID0gZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIHNlcmlhbGl6ZWREYXRhID0gXy5tYXAoJCgnLmdyaWQtc3RhY2sgPiAuZ3JpZC1zdGFjay1pdGVtOnZpc2libGUnKSwgZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICAgIHZhciBub2RlID0gJChlbCkuZGF0YSgnX2dyaWRzdGFja19ub2RlJyk7CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICBpZDogbm9kZS5pZCwKICAgICAgICAgICAgICAgIHg6IG5vZGUueCwKICAgICAgICAgICAgICAgIHk6IG5vZGUueSwKICAgICAgICAgICAgICAgIHdpZHRoOiBub2RlLndpZHRoLAogICAgICAgICAgICAgICAgaGVpZ2h0OiBub2RlLmhlaWdodAogICAgICAgICAgICB9OwogICAgICAgIH0sIHRoaXMpOwoKICAgICAgICAkLmFqYXgoewogICAgICAgICAgICB0eXBlOiAiUE9TVCIsCiAgICAgICAgICAgIHVybDogQ09ORklHVVJBVElPTi51cGRhdGVXaWRnZXRzVXJsLAogICAgICAgICAgICBkYXRhVHlwZTogImpzb24iLAogICAgICAgICAgICBkYXRhOiB7CiAgICAgICAgICAgICAgICBpdGVtczogSlNPTi5zdHJpbmdpZnkoc2VyaWFsaXplZERhdGEsIG51bGwsICcgICAgJykKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uIChlcnIpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH07CgogICAgdmFyIGRhc2hib2FyZEV2ZW50QmluZGluZyA9IGZ1bmN0aW9uICgpIHsKCiAgICAgICAgLy9yZW1vdmUgd2lkZ2V0IGV2ZW50IGJpbmRpbmcKICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCcucmVtb3ZlLXdpZGdldCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIGVsZW1lbnRTZWxlY3RvciA9ICQodGhpcyk7CiAgICAgICAgICAgIHZhciB3aWRnZXQgPSBlbGVtZW50U2VsZWN0b3IuY2xvc2VzdCgiLmdyaWQtc3RhY2staXRlbSIpOwogICAgICAgICAgICB2YXIgdXJsID0gZWxlbWVudFNlbGVjdG9yLmRhdGEoInVybCIpOwogICAgICAgICAgICB2YXIgcGFyYW1zID0gZWxlbWVudFNlbGVjdG9yLmRhdGEoInBhcmFtcyIpOwogICAgICAgICAgICB2YXIgd2lkZ2V0SWQgPSBlbGVtZW50U2VsZWN0b3IuZGF0YSgid2lkZ2V0aWQiKTsKICAgICAgICAgICAgaWYgKENPTkZJR1VSQVRJT05bdXJsXSkgewogICAgICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiUE9TVCIsCiAgICAgICAgICAgICAgICAgICAgdXJsOiBDT05GSUdVUkFUSU9OW3VybF0sCiAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGU6ICJqc29uIiwKICAgICAgICAgICAgICAgICAgICBkYXRhOiBwYXJhbXMsCiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uIChlcnIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBncmlkID0gJCgnLmdyaWQtc3RhY2snKS5kYXRhKCdncmlkc3RhY2snKTsKICAgICAgICAgICAgICAgICAgICAgICAgZ3JpZC5yZW1vdmVXaWRnZXQod2lkZ2V0KTsKICAgICAgICAgICAgICAgICAgICAgICAgJCgiLnJ4LXdpZGdldC1tZW51LWNvbnRlbnQgbGlbZGF0YS13aWRnZXRpZD0iICsgd2lkZ2V0SWQgKyAiXSIpLmZpbmQoImlucHV0W3R5cGU9J2NoZWNrYm94J10iKS5yZW1vdmVBdHRyKCdjaGVja2VkJyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgLy9ldmVudCBiaW5kaW5nIGZvciB3aWRnZXQgbGlzdCBkcm9wZG93bgogICAgICAgICQoZG9jdW1lbnQpLm9uKCJjbGljayIsICIucngtd2lkZ2V0LW1lbnUtY29udGVudCBsaSIsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIGVsZW1lbnRTZWxlY3RvciA9ICQodGhpcyk7CiAgICAgICAgICAgIHZhciB1cmwgPSBlbGVtZW50U2VsZWN0b3IuZGF0YSgidXJsIik7CiAgICAgICAgICAgIHZhciBwYXJhbXMgPSBlbGVtZW50U2VsZWN0b3IuZGF0YSgicGFyYW1zIik7CiAgICAgICAgICAgIGlmIChDT05GSUdVUkFUSU9OW3VybF0pIHsKICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gQ09ORklHVVJBVElPTlt1cmxdICsgIj8iICsgJC5wYXJhbShwYXJhbXMpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIC8vZXZlbnQgYmluZGluZyBmb3IgZGFzaGJvYXJkIHJlc2V0IGJ1dHRvbgogICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICIjcmVzZXRCdXR0b24iLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciB1cmwgPSAkKHRoaXMpLmRhdGEoInVybCIpOwogICAgICAgICAgICBwdmkudXRpbC5zaG93V2FybmluZyhnZXRNZXNzYWdlKCJ3aWRnZXRfcmVmcmVzaF9tZXNzYWdlIiksICJDYW5jZWwiLCAiT2siLCBmdW5jdGlvbiB5ZXMoKSB7CiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IENPTkZJR1VSQVRJT05bdXJsXTsKICAgICAgICAgICAgfSkKICAgICAgICB9KTsKCiAgICAgICAgJCgnLmdyaWQtc3RhY2snKS5ncmlkc3RhY2soZ3JpZHN0YWNrT3B0aW9ucyk7CgogICAgICAgICQoZG9jdW1lbnQpLm9uKCdjaGFuZ2UnLCcuZ3JpZC1zdGFjaycsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgc2F2ZVdpZGdldHMoKTsKICAgICAgICB9KTsKCiAgICAgICAgJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAkKCcuY291bnRlcicpLmNvdW50ZXJVcCh7CiAgICAgICAgICAgICAgICBkZWxheTogMTAwLAogICAgICAgICAgICAgICAgdGltZTogMTIwMAogICAgICAgICAgICB9KTsKICAgICAgICB9KTsKCiAgICB9OwoKICAgIHZhciBsb2FkRGF0YSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAkLmFqYXgoewogICAgICAgICAgICB1cmw6IHB2aV91cmxzLnBlcnNvbmFsX3N0YXRzX3VybCwKICAgICAgICAgICAgYXN5bmM6IGZhbHNlLAogICAgICAgICAgICB0eXBlOiAnR0VUJywKICAgICAgICAgICAgYmVmb3JlU2VuZDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgcHZ1aS5jb21tb24uc2hvd1BWTG9hZGVyKCk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICB2YXIgcGVyc29uYWxTdGF0cyA9IGRhdGEucmVzdWx0LnBlcnNvbmFsU3RhdHM7CiAgICAgICAgICAgICAgICB2YXIgZGF0YUxlbmd0aCA9IHBlcnNvbmFsU3RhdHMubGVuZ3RoOwogICAgICAgICAgICAgICAgdmFyIHBlcnNvbmFsU3RhdGVDb3VudGFpbmVyID0gJCgiLnB2LXdpZGdldC1wZXJzb25hbC1zdGF0cyIpOwogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhTGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICB2YXIgcGVyc29uYWxTdGF0ID0gcGVyc29uYWxTdGF0c1tpXTsKICAgICAgICAgICAgICAgICAgICBwZXJzb25hbFN0YXRlQ291bnRhaW5lci5maW5kKCIuIiArIHBlcnNvbmFsU3RhdC5lbGVtZW50TmFtZSkudGV4dChwZXJzb25hbFN0YXQuY291bnQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcHZ1aS5jb21tb24uaGlkZVBWTG9hZGVyKCk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgcHZ1aS5jb21tb24uaGlkZVBWTG9hZGVyKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH07CgogICAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgZGFzaGJvYXJkRXZlbnRCaW5kaW5nKCk7CiAgICAgICAgcHZpLnV0aWwuYmluZERhdGVQaWNrZXJzKCk7CiAgICAgICAgcHZpLnV0aWwuYmluZEZpbGVVcGxvYWRlckV2ZW50KCk7CiAgICB9OwoKICAgIHJldHVybiB7CiAgICAgICAgaW5pdDogaW5pdCwKICAgICAgICBsb2FkRGF0YTogbG9hZERhdGEKICAgIH0KCn0pKCk7CgpwdmkuZGFzaGJvYXJkLmluaXQoKTsKLy8gVGhpcyBpcyBhIG1hbmlmZXN0IGZpbGUgdGhhdCdsbCBiZSBjb21waWxlZCBpbnRvIGxpc3QtbWFuaWZlc3QuanMuCi8vCi8vIEFueSBKYXZhU2NyaXB0IGZpbGUgd2l0aGluIHRoaXMgZGlyZWN0b3J5IGNhbiBiZSByZWZlcmVuY2VkIGhlcmUgdXNpbmcgYSByZWxhdGl2ZSBwYXRoLgovLwovLyBZb3UncmUgZnJlZSB0byBhZGQgYXBwbGljYXRpb24td2lkZSBKYXZhU2NyaXB0IHRvIHRoaXMgZmlsZSwgYnV0IGl0J3MgZ2VuZXJhbGx5IGJldHRlcgovLyB0byBjcmVhdGUgc2VwYXJhdGUgSmF2YVNjcmlwdCBmaWxlcyBhcyBuZWVkZWQuCi8vCi8vPSByZXF1aXJlX3NlbGYKLy89IHJlcXVpcmUgZ3JpZAovLz0gcmVxdWlyZSB2ZW5kb3JVaS9kYXRhdGFibGVzL2RhdGF0YWJsZS5jb2xzUmVvcmRlci5taW4KLy89IHJlcXVpcmUgdmVuZG9yVWkvZGF0YXRhYmxlcy9kYXRhVGFibGVzLnJvd0dyb3VwLm1pbgovLz0gcmVxdWlyZSBhcHAvbGlzdC9saXN0LWZvcm0tc3RhdGUtc2F2ZQovLz0gcmVxdWlyZSBhcHAvbGlzdC9yZXBvcnQtZGlzdHJpYnV0aW9uLWxvZwovLz0gcmVxdWlyZSBhcHAvbGlzdC9saXN0Ci8vPSByZXF1aXJlIGFwcC9saXN0L3NwZWVjaC1yZWNvZy1zZWFyY2gKCi8qdG9kbyByZWZhY3RvciBiZWxvdyBjb2RlKi8KdGFza0FjdGlvbi5jb21tb25NZXRob2QuaW5pdChmdW5jdGlvbigpe30scHZ1aS5jb21tb24uc2hvd1BWTG9hZGVyLHB2dWkuY29tbW9uLmhpZGVQVkxvYWRlcixwdmkudXRpbC5zaG93RmxvYXRpbmdOb3RpZmljYXRpb24uc3VjY2Vzc01lc3NhZ2UscHZpLnV0aWwuc2hvd0Zsb2F0aW5nTm90aWZpY2F0aW9uLmVycm9yTWVzc2FnZSxwdmkudXRpbC5zaG93V2FybmluZyk7Cgpmb2xsb3dVcFF1ZXJ5LmNvbW1vbk1ldGhvZC5pbml0KGZ1bmN0aW9uKCl7fSxwdnVpLmNvbW1vbi5zaG93UFZMb2FkZXIscHZ1aS5jb21tb24uaGlkZVBWTG9hZGVyLHB2aS51dGlsLnNob3dGbG9hdGluZ05vdGlmaWNhdGlvbi5zdWNjZXNzTWVzc2FnZSxwdmkudXRpbC5zaG93RmxvYXRpbmdOb3RpZmljYXRpb24uZXJyb3JNZXNzYWdlLHB2aS51dGlsLnNob3dXYXJuaW5nKTsKLyohDQogRGF0YVRhYmxlcyAxLjEwLjE2DQogwqkyMDA4LTIwMTcgU3ByeU1lZGlhIEx0ZCAtIGRhdGF0YWJsZXMubmV0L2xpY2Vuc2UNCiovDQooZnVuY3Rpb24oaCl7ImZ1bmN0aW9uIj09PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFsianF1ZXJ5Il0sZnVuY3Rpb24oRSl7cmV0dXJuIGgoRSx3aW5kb3csZG9jdW1lbnQpfSk6Im9iamVjdCI9PT10eXBlb2YgZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1mdW5jdGlvbihFLEcpe0V8fChFPXdpbmRvdyk7R3x8KEc9InVuZGVmaW5lZCIhPT10eXBlb2Ygd2luZG93P3JlcXVpcmUoImpxdWVyeSIpOnJlcXVpcmUoImpxdWVyeSIpKEUpKTtyZXR1cm4gaChHLEUsRS5kb2N1bWVudCl9OmgoalF1ZXJ5LHdpbmRvdyxkb2N1bWVudCl9KShmdW5jdGlvbihoLEUsRyxrKXtmdW5jdGlvbiBYKGEpe3ZhciBiLGMsZD17fTtoLmVhY2goYSxmdW5jdGlvbihlKXtpZigoYj1lLm1hdGNoKC9eKFteQS1aXSs/KShbQS1aXSkvKSkmJi0xIT09ImEgYWEgYWkgYW8gYXMgYiBmbiBpIG0gbyBzICIuaW5kZXhPZihiWzFdKyIgIikpYz1lLnJlcGxhY2UoYlswXSxiWzJdLnRvTG93ZXJDYXNlKCkpLA0KICAgIGRbY109ZSwibyI9PT1iWzFdJiZYKGFbZV0pfSk7YS5faHVuZ2FyaWFuTWFwPWR9ZnVuY3Rpb24gSShhLGIsYyl7YS5faHVuZ2FyaWFuTWFwfHxYKGEpO3ZhciBkO2guZWFjaChiLGZ1bmN0aW9uKGUpe2Q9YS5faHVuZ2FyaWFuTWFwW2VdO2lmKGQhPT1rJiYoY3x8YltkXT09PWspKSJvIj09PWQuY2hhckF0KDApPyhiW2RdfHwoYltkXT17fSksaC5leHRlbmQoITAsYltkXSxiW2VdKSxJKGFbZF0sYltkXSxjKSk6YltkXT1iW2VdfSl9ZnVuY3Rpb24gQ2EoYSl7dmFyIGI9bS5kZWZhdWx0cy5vTGFuZ3VhZ2UsYz1hLnNaZXJvUmVjb3JkczshYS5zRW1wdHlUYWJsZSYmKGMmJiJObyBkYXRhIGF2YWlsYWJsZSBpbiB0YWJsZSI9PT1iLnNFbXB0eVRhYmxlKSYmRihhLGEsInNaZXJvUmVjb3JkcyIsInNFbXB0eVRhYmxlIik7IWEuc0xvYWRpbmdSZWNvcmRzJiYoYyYmIkxvYWRpbmcuLi4iPT09Yi5zTG9hZGluZ1JlY29yZHMpJiZGKGEsYSwic1plcm9SZWNvcmRzIiwic0xvYWRpbmdSZWNvcmRzIik7DQogICAgYS5zSW5mb1Rob3VzYW5kcyYmKGEuc1Rob3VzYW5kcz1hLnNJbmZvVGhvdXNhbmRzKTsoYT1hLnNEZWNpbWFsKSYmY2IoYSl9ZnVuY3Rpb24gZGIoYSl7QShhLCJvcmRlcmluZyIsImJTb3J0Iik7QShhLCJvcmRlck11bHRpIiwiYlNvcnRNdWx0aSIpO0EoYSwib3JkZXJDbGFzc2VzIiwiYlNvcnRDbGFzc2VzIik7QShhLCJvcmRlckNlbGxzVG9wIiwiYlNvcnRDZWxsc1RvcCIpO0EoYSwib3JkZXIiLCJhYVNvcnRpbmciKTtBKGEsIm9yZGVyRml4ZWQiLCJhYVNvcnRpbmdGaXhlZCIpO0EoYSwicGFnaW5nIiwiYlBhZ2luYXRlIik7QShhLCJwYWdpbmdUeXBlIiwic1BhZ2luYXRpb25UeXBlIik7QShhLCJwYWdlTGVuZ3RoIiwiaURpc3BsYXlMZW5ndGgiKTtBKGEsInNlYXJjaGluZyIsImJGaWx0ZXIiKTsiYm9vbGVhbiI9PT10eXBlb2YgYS5zU2Nyb2xsWCYmKGEuc1Njcm9sbFg9YS5zU2Nyb2xsWD8iMTAwJSI6IiIpOyJib29sZWFuIj09PXR5cGVvZiBhLnNjcm9sbFgmJihhLnNjcm9sbFg9DQogICAgYS5zY3JvbGxYPyIxMDAlIjoiIik7aWYoYT1hLmFvU2VhcmNoQ29scylmb3IodmFyIGI9MCxjPWEubGVuZ3RoO2I8YztiKyspYVtiXSYmSShtLm1vZGVscy5vU2VhcmNoLGFbYl0pfWZ1bmN0aW9uIGViKGEpe0EoYSwib3JkZXJhYmxlIiwiYlNvcnRhYmxlIik7QShhLCJvcmRlckRhdGEiLCJhRGF0YVNvcnQiKTtBKGEsIm9yZGVyU2VxdWVuY2UiLCJhc1NvcnRpbmciKTtBKGEsIm9yZGVyRGF0YVR5cGUiLCJzb3J0RGF0YVR5cGUiKTt2YXIgYj1hLmFEYXRhU29ydDsibnVtYmVyIj09PXR5cGVvZiBiJiYhaC5pc0FycmF5KGIpJiYoYS5hRGF0YVNvcnQ9W2JdKX1mdW5jdGlvbiBmYihhKXtpZighbS5fX2Jyb3dzZXIpe3ZhciBiPXt9O20uX19icm93c2VyPWI7dmFyIGM9aCgiPGRpdi8+IikuY3NzKHtwb3NpdGlvbjoiZml4ZWQiLHRvcDowLGxlZnQ6LTEqaChFKS5zY3JvbGxMZWZ0KCksaGVpZ2h0OjEsd2lkdGg6MSxvdmVyZmxvdzoiaGlkZGVuIn0pLmFwcGVuZChoKCI8ZGl2Lz4iKS5jc3Moe3Bvc2l0aW9uOiJhYnNvbHV0ZSIsDQogICAgdG9wOjEsbGVmdDoxLHdpZHRoOjEwMCxvdmVyZmxvdzoic2Nyb2xsIn0pLmFwcGVuZChoKCI8ZGl2Lz4iKS5jc3Moe3dpZHRoOiIxMDAlIixoZWlnaHQ6MTB9KSkpLmFwcGVuZFRvKCJib2R5IiksZD1jLmNoaWxkcmVuKCksZT1kLmNoaWxkcmVuKCk7Yi5iYXJXaWR0aD1kWzBdLm9mZnNldFdpZHRoLWRbMF0uY2xpZW50V2lkdGg7Yi5iU2Nyb2xsT3ZlcnNpemU9MTAwPT09ZVswXS5vZmZzZXRXaWR0aCYmMTAwIT09ZFswXS5jbGllbnRXaWR0aDtiLmJTY3JvbGxiYXJMZWZ0PTEhPT1NYXRoLnJvdW5kKGUub2Zmc2V0KCkubGVmdCk7Yi5iQm91bmRpbmc9Y1swXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aD8hMDohMTtjLnJlbW92ZSgpfWguZXh0ZW5kKGEub0Jyb3dzZXIsbS5fX2Jyb3dzZXIpO2Eub1Njcm9sbC5pQmFyV2lkdGg9bS5fX2Jyb3dzZXIuYmFyV2lkdGh9ZnVuY3Rpb24gZ2IoYSxiLGMsZCxlLGYpe3ZhciBnLGo9ITE7YyE9PWsmJihnPWMsaj0hMCk7Zm9yKDtkIT09DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlOylhLmhhc093blByb3BlcnR5KGQpJiYoZz1qP2IoZyxhW2RdLGQsYSk6YVtkXSxqPSEwLGQrPWYpO3JldHVybiBnfWZ1bmN0aW9uIERhKGEsYil7dmFyIGM9bS5kZWZhdWx0cy5jb2x1bW4sZD1hLmFvQ29sdW1ucy5sZW5ndGgsYz1oLmV4dGVuZCh7fSxtLm1vZGVscy5vQ29sdW1uLGMse25UaDpiP2I6Ry5jcmVhdGVFbGVtZW50KCJ0aCIpLHNUaXRsZTpjLnNUaXRsZT9jLnNUaXRsZTpiP2IuaW5uZXJIVE1MOiIiLGFEYXRhU29ydDpjLmFEYXRhU29ydD9jLmFEYXRhU29ydDpbZF0sbURhdGE6Yy5tRGF0YT9jLm1EYXRhOmQsaWR4OmR9KTthLmFvQ29sdW1ucy5wdXNoKGMpO2M9YS5hb1ByZVNlYXJjaENvbHM7Y1tkXT1oLmV4dGVuZCh7fSxtLm1vZGVscy5vU2VhcmNoLGNbZF0pO2phKGEsZCxoKGIpLmRhdGEoKSl9ZnVuY3Rpb24gamEoYSxiLGMpe3ZhciBiPWEuYW9Db2x1bW5zW2JdLGQ9YS5vQ2xhc3NlcyxlPWgoYi5uVGgpO2lmKCFiLnNXaWR0aE9yaWcpe2Iuc1dpZHRoT3JpZz0NCiAgICBlLmF0dHIoIndpZHRoIil8fG51bGw7dmFyIGY9KGUuYXR0cigic3R5bGUiKXx8IiIpLm1hdGNoKC93aWR0aDpccyooXGQrW3B4ZW0lXSspLyk7ZiYmKGIuc1dpZHRoT3JpZz1mWzFdKX1jIT09ayYmbnVsbCE9PWMmJihlYihjKSxJKG0uZGVmYXVsdHMuY29sdW1uLGMpLGMubURhdGFQcm9wIT09ayYmIWMubURhdGEmJihjLm1EYXRhPWMubURhdGFQcm9wKSxjLnNUeXBlJiYoYi5fc01hbnVhbFR5cGU9Yy5zVHlwZSksYy5jbGFzc05hbWUmJiFjLnNDbGFzcyYmKGMuc0NsYXNzPWMuY2xhc3NOYW1lKSxjLnNDbGFzcyYmZS5hZGRDbGFzcyhjLnNDbGFzcyksaC5leHRlbmQoYixjKSxGKGIsYywic1dpZHRoIiwic1dpZHRoT3JpZyIpLGMuaURhdGFTb3J0IT09ayYmKGIuYURhdGFTb3J0PVtjLmlEYXRhU29ydF0pLEYoYixjLCJhRGF0YVNvcnQiKSk7dmFyIGc9Yi5tRGF0YSxqPVEoZyksaT1iLm1SZW5kZXI/UShiLm1SZW5kZXIpOm51bGwsYz1mdW5jdGlvbihhKXtyZXR1cm4ic3RyaW5nIj09PQ0KICAgIHR5cGVvZiBhJiYtMSE9PWEuaW5kZXhPZigiQCIpfTtiLl9iQXR0clNyYz1oLmlzUGxhaW5PYmplY3QoZykmJihjKGcuc29ydCl8fGMoZy50eXBlKXx8YyhnLmZpbHRlcikpO2IuX3NldHRlcj1udWxsO2IuZm5HZXREYXRhPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD1qKGEsYixrLGMpO3JldHVybiBpJiZiP2koZCxiLGEsYyk6ZH07Yi5mblNldERhdGE9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBSKGcpKGEsYixjKX07Im51bWJlciIhPT10eXBlb2YgZyYmKGEuX3Jvd1JlYWRPYmplY3Q9ITApO2Eub0ZlYXR1cmVzLmJTb3J0fHwoYi5iU29ydGFibGU9ITEsZS5hZGRDbGFzcyhkLnNTb3J0YWJsZU5vbmUpKTthPS0xIT09aC5pbkFycmF5KCJhc2MiLGIuYXNTb3J0aW5nKTtjPS0xIT09aC5pbkFycmF5KCJkZXNjIixiLmFzU29ydGluZyk7IWIuYlNvcnRhYmxlfHwhYSYmIWM/KGIuc1NvcnRpbmdDbGFzcz1kLnNTb3J0YWJsZU5vbmUsYi5zU29ydGluZ0NsYXNzSlVJPSIiKTphJiYhYz8oYi5zU29ydGluZ0NsYXNzPQ0KICAgIGQuc1NvcnRhYmxlQXNjLGIuc1NvcnRpbmdDbGFzc0pVST1kLnNTb3J0SlVJQXNjQWxsb3dlZCk6IWEmJmM/KGIuc1NvcnRpbmdDbGFzcz1kLnNTb3J0YWJsZURlc2MsYi5zU29ydGluZ0NsYXNzSlVJPWQuc1NvcnRKVUlEZXNjQWxsb3dlZCk6KGIuc1NvcnRpbmdDbGFzcz1kLnNTb3J0YWJsZSxiLnNTb3J0aW5nQ2xhc3NKVUk9ZC5zU29ydEpVSSl9ZnVuY3Rpb24gWShhKXtpZighMSE9PWEub0ZlYXR1cmVzLmJBdXRvV2lkdGgpe3ZhciBiPWEuYW9Db2x1bW5zO0VhKGEpO2Zvcih2YXIgYz0wLGQ9Yi5sZW5ndGg7YzxkO2MrKyliW2NdLm5UaC5zdHlsZS53aWR0aD1iW2NdLnNXaWR0aH1iPWEub1Njcm9sbDsoIiIhPT1iLnNZfHwiIiE9PWIuc1gpJiZrYShhKTtyKGEsbnVsbCwiY29sdW1uLXNpemluZyIsW2FdKX1mdW5jdGlvbiBaKGEsYil7dmFyIGM9bGEoYSwiYlZpc2libGUiKTtyZXR1cm4ibnVtYmVyIj09PXR5cGVvZiBjW2JdP2NbYl06bnVsbH1mdW5jdGlvbiAkKGEsYil7dmFyIGM9DQogICAgbGEoYSwiYlZpc2libGUiKSxjPWguaW5BcnJheShiLGMpO3JldHVybi0xIT09Yz9jOm51bGx9ZnVuY3Rpb24gYWEoYSl7dmFyIGI9MDtoLmVhY2goYS5hb0NvbHVtbnMsZnVuY3Rpb24oYSxkKXtkLmJWaXNpYmxlJiYibm9uZSIhPT1oKGQublRoKS5jc3MoImRpc3BsYXkiKSYmYisrfSk7cmV0dXJuIGJ9ZnVuY3Rpb24gbGEoYSxiKXt2YXIgYz1bXTtoLm1hcChhLmFvQ29sdW1ucyxmdW5jdGlvbihhLGUpe2FbYl0mJmMucHVzaChlKX0pO3JldHVybiBjfWZ1bmN0aW9uIEZhKGEpe3ZhciBiPWEuYW9Db2x1bW5zLGM9YS5hb0RhdGEsZD1tLmV4dC50eXBlLmRldGVjdCxlLGYsZyxqLGksaCxsLHEsdDtlPTA7Zm9yKGY9Yi5sZW5ndGg7ZTxmO2UrKylpZihsPWJbZV0sdD1bXSwhbC5zVHlwZSYmbC5fc01hbnVhbFR5cGUpbC5zVHlwZT1sLl9zTWFudWFsVHlwZTtlbHNlIGlmKCFsLnNUeXBlKXtnPTA7Zm9yKGo9ZC5sZW5ndGg7ZzxqO2crKyl7aT0wO2ZvcihoPWMubGVuZ3RoO2k8aDtpKyspe3RbaV09PT0NCmsmJih0W2ldPUIoYSxpLGUsInR5cGUiKSk7cT1kW2ddKHRbaV0sYSk7aWYoIXEmJmchPT1kLmxlbmd0aC0xKWJyZWFrO2lmKCJodG1sIj09PXEpYnJlYWt9aWYocSl7bC5zVHlwZT1xO2JyZWFrfX1sLnNUeXBlfHwobC5zVHlwZT0ic3RyaW5nIil9fWZ1bmN0aW9uIGhiKGEsYixjLGQpe3ZhciBlLGYsZyxqLGksbixsPWEuYW9Db2x1bW5zO2lmKGIpZm9yKGU9Yi5sZW5ndGgtMTswPD1lO2UtLSl7bj1iW2VdO3ZhciBxPW4udGFyZ2V0cyE9PWs/bi50YXJnZXRzOm4uYVRhcmdldHM7aC5pc0FycmF5KHEpfHwocT1bcV0pO2Y9MDtmb3IoZz1xLmxlbmd0aDtmPGc7ZisrKWlmKCJudW1iZXIiPT09dHlwZW9mIHFbZl0mJjA8PXFbZl0pe2Zvcig7bC5sZW5ndGg8PXFbZl07KURhKGEpO2QocVtmXSxuKX1lbHNlIGlmKCJudW1iZXIiPT09dHlwZW9mIHFbZl0mJjA+cVtmXSlkKGwubGVuZ3RoK3FbZl0sbik7ZWxzZSBpZigic3RyaW5nIj09PXR5cGVvZiBxW2ZdKXtqPTA7Zm9yKGk9bC5sZW5ndGg7ajwNCmk7aisrKSgiX2FsbCI9PXFbZl18fGgobFtqXS5uVGgpLmhhc0NsYXNzKHFbZl0pKSYmZChqLG4pfX1pZihjKXtlPTA7Zm9yKGE9Yy5sZW5ndGg7ZTxhO2UrKylkKGUsY1tlXSl9fWZ1bmN0aW9uIE0oYSxiLGMsZCl7dmFyIGU9YS5hb0RhdGEubGVuZ3RoLGY9aC5leHRlbmQoITAse30sbS5tb2RlbHMub1Jvdyx7c3JjOmM/ImRvbSI6ImRhdGEiLGlkeDplfSk7Zi5fYURhdGE9YjthLmFvRGF0YS5wdXNoKGYpO2Zvcih2YXIgZz1hLmFvQ29sdW1ucyxqPTAsaT1nLmxlbmd0aDtqPGk7aisrKWdbal0uc1R5cGU9bnVsbDthLmFpRGlzcGxheU1hc3Rlci5wdXNoKGUpO2I9YS5yb3dJZEZuKGIpO2IhPT1rJiYoYS5hSWRzW2JdPWYpOyhjfHwhYS5vRmVhdHVyZXMuYkRlZmVyUmVuZGVyKSYmR2EoYSxlLGMsZCk7cmV0dXJuIGV9ZnVuY3Rpb24gbWEoYSxiKXt2YXIgYztiIGluc3RhbmNlb2YgaHx8KGI9aChiKSk7cmV0dXJuIGIubWFwKGZ1bmN0aW9uKGIsZSl7Yz1IYShhLGUpO3JldHVybiBNKGEsDQogICAgYy5kYXRhLGUsYy5jZWxscyl9KX1mdW5jdGlvbiBCKGEsYixjLGQpe3ZhciBlPWEuaURyYXcsZj1hLmFvQ29sdW1uc1tjXSxnPWEuYW9EYXRhW2JdLl9hRGF0YSxqPWYuc0RlZmF1bHRDb250ZW50LGk9Zi5mbkdldERhdGEoZyxkLHtzZXR0aW5nczphLHJvdzpiLGNvbDpjfSk7aWYoaT09PWspcmV0dXJuIGEuaURyYXdFcnJvciE9ZSYmbnVsbD09PWomJihKKGEsMCwiUmVxdWVzdGVkIHVua25vd24gcGFyYW1ldGVyICIrKCJmdW5jdGlvbiI9PXR5cGVvZiBmLm1EYXRhPyJ7ZnVuY3Rpb259IjoiJyIrZi5tRGF0YSsiJyIpKyIgZm9yIHJvdyAiK2IrIiwgY29sdW1uICIrYyw0KSxhLmlEcmF3RXJyb3I9ZSksajtpZigoaT09PWd8fG51bGw9PT1pKSYmbnVsbCE9PWomJmQhPT1rKWk9ajtlbHNlIGlmKCJmdW5jdGlvbiI9PT10eXBlb2YgaSlyZXR1cm4gaS5jYWxsKGcpO3JldHVybiBudWxsPT09aSYmImRpc3BsYXkiPT1kPyIiOml9ZnVuY3Rpb24gaWIoYSxiLGMsZCl7YS5hb0NvbHVtbnNbY10uZm5TZXREYXRhKGEuYW9EYXRhW2JdLl9hRGF0YSwNCiAgICBkLHtzZXR0aW5nczphLHJvdzpiLGNvbDpjfSl9ZnVuY3Rpb24gSWEoYSl7cmV0dXJuIGgubWFwKGEubWF0Y2goLyhcXC58W15cLl0pKy9nKXx8WyIiXSxmdW5jdGlvbihhKXtyZXR1cm4gYS5yZXBsYWNlKC9cXFwuL2csIi4iKX0pfWZ1bmN0aW9uIFEoYSl7aWYoaC5pc1BsYWluT2JqZWN0KGEpKXt2YXIgYj17fTtoLmVhY2goYSxmdW5jdGlvbihhLGMpe2MmJihiW2FdPVEoYykpfSk7cmV0dXJuIGZ1bmN0aW9uKGEsYyxmLGcpe3ZhciBqPWJbY118fGIuXztyZXR1cm4gaiE9PWs/aihhLGMsZixnKTphfX1pZihudWxsPT09YSlyZXR1cm4gZnVuY3Rpb24oYSl7cmV0dXJuIGF9O2lmKCJmdW5jdGlvbiI9PT10eXBlb2YgYSlyZXR1cm4gZnVuY3Rpb24oYixjLGYsZyl7cmV0dXJuIGEoYixjLGYsZyl9O2lmKCJzdHJpbmciPT09dHlwZW9mIGEmJigtMSE9PWEuaW5kZXhPZigiLiIpfHwtMSE9PWEuaW5kZXhPZigiWyIpfHwtMSE9PWEuaW5kZXhPZigiKCIpKSl7dmFyIGM9ZnVuY3Rpb24oYSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYixmKXt2YXIgZyxqO2lmKCIiIT09Zil7aj1JYShmKTtmb3IodmFyIGk9MCxuPWoubGVuZ3RoO2k8bjtpKyspe2Y9altpXS5tYXRjaChiYSk7Zz1qW2ldLm1hdGNoKFUpO2lmKGYpe2pbaV09altpXS5yZXBsYWNlKGJhLCIiKTsiIiE9PWpbaV0mJihhPWFbaltpXV0pO2c9W107ai5zcGxpY2UoMCxpKzEpO2o9ai5qb2luKCIuIik7aWYoaC5pc0FycmF5KGEpKXtpPTA7Zm9yKG49YS5sZW5ndGg7aTxuO2krKylnLnB1c2goYyhhW2ldLGIsaikpfWE9ZlswXS5zdWJzdHJpbmcoMSxmWzBdLmxlbmd0aC0xKTthPSIiPT09YT9nOmcuam9pbihhKTticmVha31lbHNlIGlmKGcpe2pbaV09altpXS5yZXBsYWNlKFUsIiIpO2E9YVtqW2ldXSgpO2NvbnRpbnVlfWlmKG51bGw9PT1hfHxhW2pbaV1dPT09aylyZXR1cm4gazthPWFbaltpXV19fXJldHVybiBhfTtyZXR1cm4gZnVuY3Rpb24oYixlKXtyZXR1cm4gYyhiLGUsYSl9fXJldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gYlthXX19ZnVuY3Rpb24gUihhKXtpZihoLmlzUGxhaW5PYmplY3QoYSkpcmV0dXJuIFIoYS5fKTsNCiAgICBpZihudWxsPT09YSlyZXR1cm4gZnVuY3Rpb24oKXt9O2lmKCJmdW5jdGlvbiI9PT10eXBlb2YgYSlyZXR1cm4gZnVuY3Rpb24oYixkLGUpe2EoYiwic2V0IixkLGUpfTtpZigic3RyaW5nIj09PXR5cGVvZiBhJiYoLTEhPT1hLmluZGV4T2YoIi4iKXx8LTEhPT1hLmluZGV4T2YoIlsiKXx8LTEhPT1hLmluZGV4T2YoIigiKSkpe3ZhciBiPWZ1bmN0aW9uKGEsZCxlKXt2YXIgZT1JYShlKSxmO2Y9ZVtlLmxlbmd0aC0xXTtmb3IodmFyIGcsaixpPTAsbj1lLmxlbmd0aC0xO2k8bjtpKyspe2c9ZVtpXS5tYXRjaChiYSk7aj1lW2ldLm1hdGNoKFUpO2lmKGcpe2VbaV09ZVtpXS5yZXBsYWNlKGJhLCIiKTthW2VbaV1dPVtdO2Y9ZS5zbGljZSgpO2Yuc3BsaWNlKDAsaSsxKTtnPWYuam9pbigiLiIpO2lmKGguaXNBcnJheShkKSl7aj0wO2ZvcihuPWQubGVuZ3RoO2o8bjtqKyspZj17fSxiKGYsZFtqXSxnKSxhW2VbaV1dLnB1c2goZil9ZWxzZSBhW2VbaV1dPWQ7cmV0dXJufWomJihlW2ldPWVbaV0ucmVwbGFjZShVLA0KICAgICAgICAiIiksYT1hW2VbaV1dKGQpKTtpZihudWxsPT09YVtlW2ldXXx8YVtlW2ldXT09PWspYVtlW2ldXT17fTthPWFbZVtpXV19aWYoZi5tYXRjaChVKSlhW2YucmVwbGFjZShVLCIiKV0oZCk7ZWxzZSBhW2YucmVwbGFjZShiYSwiIildPWR9O3JldHVybiBmdW5jdGlvbihjLGQpe3JldHVybiBiKGMsZCxhKX19cmV0dXJuIGZ1bmN0aW9uKGIsZCl7YlthXT1kfX1mdW5jdGlvbiBKYShhKXtyZXR1cm4gRChhLmFvRGF0YSwiX2FEYXRhIil9ZnVuY3Rpb24gbmEoYSl7YS5hb0RhdGEubGVuZ3RoPTA7YS5haURpc3BsYXlNYXN0ZXIubGVuZ3RoPTA7YS5haURpc3BsYXkubGVuZ3RoPTA7YS5hSWRzPXt9fWZ1bmN0aW9uIG9hKGEsYixjKXtmb3IodmFyIGQ9LTEsZT0wLGY9YS5sZW5ndGg7ZTxmO2UrKylhW2VdPT1iP2Q9ZTphW2VdPmImJmFbZV0tLTsgLTEhPWQmJmM9PT1rJiZhLnNwbGljZShkLDEpfWZ1bmN0aW9uIGNhKGEsYixjLGQpe3ZhciBlPWEuYW9EYXRhW2JdLGYsZz1mdW5jdGlvbihjLGQpe2Zvcig7Yy5jaGlsZE5vZGVzLmxlbmd0aDspYy5yZW1vdmVDaGlsZChjLmZpcnN0Q2hpbGQpOw0KICAgIGMuaW5uZXJIVE1MPUIoYSxiLGQsImRpc3BsYXkiKX07aWYoImRvbSI9PT1jfHwoIWN8fCJhdXRvIj09PWMpJiYiZG9tIj09PWUuc3JjKWUuX2FEYXRhPUhhKGEsZSxkLGQ9PT1rP2s6ZS5fYURhdGEpLmRhdGE7ZWxzZXt2YXIgaj1lLmFuQ2VsbHM7aWYoailpZihkIT09aylnKGpbZF0sZCk7ZWxzZXtjPTA7Zm9yKGY9ai5sZW5ndGg7YzxmO2MrKylnKGpbY10sYyl9fWUuX2FTb3J0RGF0YT1udWxsO2UuX2FGaWx0ZXJEYXRhPW51bGw7Zz1hLmFvQ29sdW1ucztpZihkIT09aylnW2RdLnNUeXBlPW51bGw7ZWxzZXtjPTA7Zm9yKGY9Zy5sZW5ndGg7YzxmO2MrKylnW2NdLnNUeXBlPW51bGw7S2EoYSxlKX19ZnVuY3Rpb24gSGEoYSxiLGMsZCl7dmFyIGU9W10sZj1iLmZpcnN0Q2hpbGQsZyxqLGk9MCxuLGw9YS5hb0NvbHVtbnMscT1hLl9yb3dSZWFkT2JqZWN0LGQ9ZCE9PWs/ZDpxP3t9OltdLHQ9ZnVuY3Rpb24oYSxiKXtpZigic3RyaW5nIj09PXR5cGVvZiBhKXt2YXIgYz1hLmluZGV4T2YoIkAiKTsNCiAgICAtMSE9PWMmJihjPWEuc3Vic3RyaW5nKGMrMSksUihhKShkLGIuZ2V0QXR0cmlidXRlKGMpKSl9fSxtPWZ1bmN0aW9uKGEpe2lmKGM9PT1rfHxjPT09aSlqPWxbaV0sbj1oLnRyaW0oYS5pbm5lckhUTUwpLGomJmouX2JBdHRyU3JjPyhSKGoubURhdGEuXykoZCxuKSx0KGoubURhdGEuc29ydCxhKSx0KGoubURhdGEudHlwZSxhKSx0KGoubURhdGEuZmlsdGVyLGEpKTpxPyhqLl9zZXR0ZXJ8fChqLl9zZXR0ZXI9UihqLm1EYXRhKSksai5fc2V0dGVyKGQsbikpOmRbaV09bjtpKyt9O2lmKGYpZm9yKDtmOyl7Zz1mLm5vZGVOYW1lLnRvVXBwZXJDYXNlKCk7aWYoIlREIj09Z3x8IlRIIj09ZyltKGYpLGUucHVzaChmKTtmPWYubmV4dFNpYmxpbmd9ZWxzZXtlPWIuYW5DZWxscztmPTA7Zm9yKGc9ZS5sZW5ndGg7ZjxnO2YrKyltKGVbZl0pfWlmKGI9Yi5maXJzdENoaWxkP2I6Yi5uVHIpKGI9Yi5nZXRBdHRyaWJ1dGUoImlkIikpJiZSKGEucm93SWQpKGQsYik7cmV0dXJue2RhdGE6ZCxjZWxsczplfX0NCiAgICBmdW5jdGlvbiBHYShhLGIsYyxkKXt2YXIgZT1hLmFvRGF0YVtiXSxmPWUuX2FEYXRhLGc9W10saixpLG4sbCxxO2lmKG51bGw9PT1lLm5Ucil7aj1jfHxHLmNyZWF0ZUVsZW1lbnQoInRyIik7ZS5uVHI9ajtlLmFuQ2VsbHM9ZztqLl9EVF9Sb3dJbmRleD1iO0thKGEsZSk7bD0wO2ZvcihxPWEuYW9Db2x1bW5zLmxlbmd0aDtsPHE7bCsrKXtuPWEuYW9Db2x1bW5zW2xdO2k9Yz9kW2xdOkcuY3JlYXRlRWxlbWVudChuLnNDZWxsVHlwZSk7aS5fRFRfQ2VsbEluZGV4PXtyb3c6Yixjb2x1bW46bH07Zy5wdXNoKGkpO2lmKCghY3x8bi5tUmVuZGVyfHxuLm1EYXRhIT09bCkmJighaC5pc1BsYWluT2JqZWN0KG4ubURhdGEpfHxuLm1EYXRhLl8hPT1sKyIuZGlzcGxheSIpKWkuaW5uZXJIVE1MPUIoYSxiLGwsImRpc3BsYXkiKTtuLnNDbGFzcyYmKGkuY2xhc3NOYW1lKz0iICIrbi5zQ2xhc3MpO24uYlZpc2libGUmJiFjP2ouYXBwZW5kQ2hpbGQoaSk6IW4uYlZpc2libGUmJmMmJmkucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChpKTsNCiAgICAgICAgbi5mbkNyZWF0ZWRDZWxsJiZuLmZuQ3JlYXRlZENlbGwuY2FsbChhLm9JbnN0YW5jZSxpLEIoYSxiLGwpLGYsYixsKX1yKGEsImFvUm93Q3JlYXRlZENhbGxiYWNrIixudWxsLFtqLGYsYl0pfWUublRyLnNldEF0dHJpYnV0ZSgicm9sZSIsInJvdyIpfWZ1bmN0aW9uIEthKGEsYil7dmFyIGM9Yi5uVHIsZD1iLl9hRGF0YTtpZihjKXt2YXIgZT1hLnJvd0lkRm4oZCk7ZSYmKGMuaWQ9ZSk7ZC5EVF9Sb3dDbGFzcyYmKGU9ZC5EVF9Sb3dDbGFzcy5zcGxpdCgiICIpLGIuX19yb3djPWIuX19yb3djP3FhKGIuX19yb3djLmNvbmNhdChlKSk6ZSxoKGMpLnJlbW92ZUNsYXNzKGIuX19yb3djLmpvaW4oIiAiKSkuYWRkQ2xhc3MoZC5EVF9Sb3dDbGFzcykpO2QuRFRfUm93QXR0ciYmaChjKS5hdHRyKGQuRFRfUm93QXR0cik7ZC5EVF9Sb3dEYXRhJiZoKGMpLmRhdGEoZC5EVF9Sb3dEYXRhKX19ZnVuY3Rpb24gamIoYSl7dmFyIGIsYyxkLGUsZixnPWEublRIZWFkLGo9YS5uVEZvb3QsaT0wPT09DQogICAgICAgIGgoInRoLCB0ZCIsZykubGVuZ3RoLG49YS5vQ2xhc3NlcyxsPWEuYW9Db2x1bW5zO2kmJihlPWgoIjx0ci8+IikuYXBwZW5kVG8oZykpO2I9MDtmb3IoYz1sLmxlbmd0aDtiPGM7YisrKWY9bFtiXSxkPWgoZi5uVGgpLmFkZENsYXNzKGYuc0NsYXNzKSxpJiZkLmFwcGVuZFRvKGUpLGEub0ZlYXR1cmVzLmJTb3J0JiYoZC5hZGRDbGFzcyhmLnNTb3J0aW5nQ2xhc3MpLCExIT09Zi5iU29ydGFibGUmJihkLmF0dHIoInRhYmluZGV4IixhLmlUYWJJbmRleCkuYXR0cigiYXJpYS1jb250cm9scyIsYS5zVGFibGVJZCksTGEoYSxmLm5UaCxiKSkpLGYuc1RpdGxlIT1kWzBdLmlubmVySFRNTCYmZC5odG1sKGYuc1RpdGxlKSxNYShhLCJoZWFkZXIiKShhLGQsZixuKTtpJiZkYShhLmFvSGVhZGVyLGcpO2goZykuZmluZCgiPnRyIikuYXR0cigicm9sZSIsInJvdyIpO2goZykuZmluZCgiPnRyPnRoLCA+dHI+dGQiKS5hZGRDbGFzcyhuLnNIZWFkZXJUSCk7aChqKS5maW5kKCI+dHI+dGgsID50cj50ZCIpLmFkZENsYXNzKG4uc0Zvb3RlclRIKTsNCiAgICAgICAgaWYobnVsbCE9PWope2E9YS5hb0Zvb3RlclswXTtiPTA7Zm9yKGM9YS5sZW5ndGg7YjxjO2IrKylmPWxbYl0sZi5uVGY9YVtiXS5jZWxsLGYuc0NsYXNzJiZoKGYublRmKS5hZGRDbGFzcyhmLnNDbGFzcyl9fWZ1bmN0aW9uIGVhKGEsYixjKXt2YXIgZCxlLGYsZz1bXSxqPVtdLGk9YS5hb0NvbHVtbnMubGVuZ3RoLG47aWYoYil7Yz09PWsmJihjPSExKTtkPTA7Zm9yKGU9Yi5sZW5ndGg7ZDxlO2QrKyl7Z1tkXT1iW2RdLnNsaWNlKCk7Z1tkXS5uVHI9YltkXS5uVHI7Zm9yKGY9aS0xOzA8PWY7Zi0tKSFhLmFvQ29sdW1uc1tmXS5iVmlzaWJsZSYmIWMmJmdbZF0uc3BsaWNlKGYsMSk7ai5wdXNoKFtdKX1kPTA7Zm9yKGU9Zy5sZW5ndGg7ZDxlO2QrKyl7aWYoYT1nW2RdLm5Ucilmb3IoO2Y9YS5maXJzdENoaWxkOylhLnJlbW92ZUNoaWxkKGYpO2Y9MDtmb3IoYj1nW2RdLmxlbmd0aDtmPGI7ZisrKWlmKG49aT0xLGpbZF1bZl09PT1rKXthLmFwcGVuZENoaWxkKGdbZF1bZl0uY2VsbCk7DQogICAgICAgIGZvcihqW2RdW2ZdPTE7Z1tkK2ldIT09ayYmZ1tkXVtmXS5jZWxsPT1nW2QraV1bZl0uY2VsbDspaltkK2ldW2ZdPTEsaSsrO2Zvcig7Z1tkXVtmK25dIT09ayYmZ1tkXVtmXS5jZWxsPT1nW2RdW2Yrbl0uY2VsbDspe2ZvcihjPTA7YzxpO2MrKylqW2QrY11bZituXT0xO24rK31oKGdbZF1bZl0uY2VsbCkuYXR0cigicm93c3BhbiIsaSkuYXR0cigiY29sc3BhbiIsbil9fX19ZnVuY3Rpb24gTihhKXt2YXIgYj1yKGEsImFvUHJlRHJhd0NhbGxiYWNrIiwicHJlRHJhdyIsW2FdKTtpZigtMSE9PWguaW5BcnJheSghMSxiKSlDKGEsITEpO2Vsc2V7dmFyIGI9W10sYz0wLGQ9YS5hc1N0cmlwZUNsYXNzZXMsZT1kLmxlbmd0aCxmPWEub0xhbmd1YWdlLGc9YS5pSW5pdERpc3BsYXlTdGFydCxqPSJzc3AiPT15KGEpLGk9YS5haURpc3BsYXk7YS5iRHJhd2luZz0hMDtnIT09ayYmLTEhPT1nJiYoYS5faURpc3BsYXlTdGFydD1qP2c6Zz49YS5mblJlY29yZHNEaXNwbGF5KCk/MDpnLGEuaUluaXREaXNwbGF5U3RhcnQ9DQogICAgICAgIC0xKTt2YXIgZz1hLl9pRGlzcGxheVN0YXJ0LG49YS5mbkRpc3BsYXlFbmQoKTtpZihhLmJEZWZlckxvYWRpbmcpYS5iRGVmZXJMb2FkaW5nPSExLGEuaURyYXcrKyxDKGEsITEpO2Vsc2UgaWYoail7aWYoIWEuYkRlc3Ryb3lpbmcmJiFrYihhKSlyZXR1cm59ZWxzZSBhLmlEcmF3Kys7aWYoMCE9PWkubGVuZ3RoKXtmPWo/YS5hb0RhdGEubGVuZ3RoOm47Zm9yKGo9aj8wOmc7ajxmO2orKyl7dmFyIGw9aVtqXSxxPWEuYW9EYXRhW2xdO251bGw9PT1xLm5UciYmR2EoYSxsKTtsPXEublRyO2lmKDAhPT1lKXt2YXIgdD1kW2MlZV07cS5fc1Jvd1N0cmlwZSE9dCYmKGgobCkucmVtb3ZlQ2xhc3MocS5fc1Jvd1N0cmlwZSkuYWRkQ2xhc3ModCkscS5fc1Jvd1N0cmlwZT10KX1yKGEsImFvUm93Q2FsbGJhY2siLG51bGwsW2wscS5fYURhdGEsYyxqXSk7Yi5wdXNoKGwpO2MrK319ZWxzZSBjPWYuc1plcm9SZWNvcmRzLDE9PWEuaURyYXcmJiJhamF4Ij09eShhKT9jPWYuc0xvYWRpbmdSZWNvcmRzOg0KICAgICAgICBmLnNFbXB0eVRhYmxlJiYwPT09YS5mblJlY29yZHNUb3RhbCgpJiYoYz1mLnNFbXB0eVRhYmxlKSxiWzBdPWgoIjx0ci8+Iix7ImNsYXNzIjplP2RbMF06IiJ9KS5hcHBlbmQoaCgiPHRkIC8+Iix7dmFsaWduOiJ0b3AiLGNvbFNwYW46YWEoYSksImNsYXNzIjphLm9DbGFzc2VzLnNSb3dFbXB0eX0pLmh0bWwoYykpWzBdO3IoYSwiYW9IZWFkZXJDYWxsYmFjayIsImhlYWRlciIsW2goYS5uVEhlYWQpLmNoaWxkcmVuKCJ0ciIpWzBdLEphKGEpLGcsbixpXSk7cihhLCJhb0Zvb3RlckNhbGxiYWNrIiwiZm9vdGVyIixbaChhLm5URm9vdCkuY2hpbGRyZW4oInRyIilbMF0sSmEoYSksZyxuLGldKTtkPWgoYS5uVEJvZHkpO2QuY2hpbGRyZW4oKS5kZXRhY2goKTtkLmFwcGVuZChoKGIpKTtyKGEsImFvRHJhd0NhbGxiYWNrIiwiZHJhdyIsW2FdKTthLmJTb3J0ZWQ9ITE7YS5iRmlsdGVyZWQ9ITE7YS5iRHJhd2luZz0hMX19ZnVuY3Rpb24gUyhhLGIpe3ZhciBjPWEub0ZlYXR1cmVzLGQ9Yy5iRmlsdGVyOw0KICAgICAgICBjLmJTb3J0JiZsYihhKTtkP2ZhKGEsYS5vUHJldmlvdXNTZWFyY2gpOmEuYWlEaXNwbGF5PWEuYWlEaXNwbGF5TWFzdGVyLnNsaWNlKCk7ITAhPT1iJiYoYS5faURpc3BsYXlTdGFydD0wKTthLl9kcmF3SG9sZD1iO04oYSk7YS5fZHJhd0hvbGQ9ITF9ZnVuY3Rpb24gbWIoYSl7dmFyIGI9YS5vQ2xhc3NlcyxjPWgoYS5uVGFibGUpLGM9aCgiPGRpdi8+IikuaW5zZXJ0QmVmb3JlKGMpLGQ9YS5vRmVhdHVyZXMsZT1oKCI8ZGl2Lz4iLHtpZDphLnNUYWJsZUlkKyJfd3JhcHBlciIsImNsYXNzIjpiLnNXcmFwcGVyKyhhLm5URm9vdD8iIjoiICIrYi5zTm9Gb290ZXIpfSk7YS5uSG9sZGluZz1jWzBdO2EublRhYmxlV3JhcHBlcj1lWzBdO2EublRhYmxlUmVpbnNlcnRCZWZvcmU9YS5uVGFibGUubmV4dFNpYmxpbmc7Zm9yKHZhciBmPWEuc0RvbS5zcGxpdCgiIiksZyxqLGksbixsLHEsaz0wO2s8Zi5sZW5ndGg7aysrKXtnPW51bGw7aj1mW2tdO2lmKCI8Ij09ail7aT1oKCI8ZGl2Lz4iKVswXTsNCiAgICAgICAgbj1mW2srMV07aWYoIiciPT1ufHwnIic9PW4pe2w9IiI7Zm9yKHE9MjtmW2srcV0hPW47KWwrPWZbaytxXSxxKys7IkgiPT1sP2w9Yi5zSlVJSGVhZGVyOiJGIj09bCYmKGw9Yi5zSlVJRm9vdGVyKTstMSE9bC5pbmRleE9mKCIuIik/KG49bC5zcGxpdCgiLiIpLGkuaWQ9blswXS5zdWJzdHIoMSxuWzBdLmxlbmd0aC0xKSxpLmNsYXNzTmFtZT1uWzFdKToiIyI9PWwuY2hhckF0KDApP2kuaWQ9bC5zdWJzdHIoMSxsLmxlbmd0aC0xKTppLmNsYXNzTmFtZT1sO2srPXF9ZS5hcHBlbmQoaSk7ZT1oKGkpfWVsc2UgaWYoIj4iPT1qKWU9ZS5wYXJlbnQoKTtlbHNlIGlmKCJsIj09aiYmZC5iUGFnaW5hdGUmJmQuYkxlbmd0aENoYW5nZSlnPW5iKGEpO2Vsc2UgaWYoImYiPT1qJiZkLmJGaWx0ZXIpZz1vYihhKTtlbHNlIGlmKCJyIj09aiYmZC5iUHJvY2Vzc2luZylnPXBiKGEpO2Vsc2UgaWYoInQiPT1qKWc9cWIoYSk7ZWxzZSBpZigiaSI9PWomJmQuYkluZm8pZz1yYihhKTtlbHNlIGlmKCJwIj09DQogICAgICAgIGomJmQuYlBhZ2luYXRlKWc9c2IoYSk7ZWxzZSBpZigwIT09bS5leHQuZmVhdHVyZS5sZW5ndGgpe2k9bS5leHQuZmVhdHVyZTtxPTA7Zm9yKG49aS5sZW5ndGg7cTxuO3ErKylpZihqPT1pW3FdLmNGZWF0dXJlKXtnPWlbcV0uZm5Jbml0KGEpO2JyZWFrfX1nJiYoaT1hLmFhbkZlYXR1cmVzLGlbal18fChpW2pdPVtdKSxpW2pdLnB1c2goZyksZS5hcHBlbmQoZykpfWMucmVwbGFjZVdpdGgoZSk7YS5uSG9sZGluZz1udWxsfWZ1bmN0aW9uIGRhKGEsYil7dmFyIGM9aChiKS5jaGlsZHJlbigidHIiKSxkLGUsZixnLGosaSxuLGwscSxrO2Euc3BsaWNlKDAsYS5sZW5ndGgpO2Y9MDtmb3IoaT1jLmxlbmd0aDtmPGk7ZisrKWEucHVzaChbXSk7Zj0wO2ZvcihpPWMubGVuZ3RoO2Y8aTtmKyspe2Q9Y1tmXTtmb3IoZT1kLmZpcnN0Q2hpbGQ7ZTspe2lmKCJURCI9PWUubm9kZU5hbWUudG9VcHBlckNhc2UoKXx8IlRIIj09ZS5ub2RlTmFtZS50b1VwcGVyQ2FzZSgpKXtsPTEqZS5nZXRBdHRyaWJ1dGUoImNvbHNwYW4iKTsNCiAgICAgICAgcT0xKmUuZ2V0QXR0cmlidXRlKCJyb3dzcGFuIik7bD0hbHx8MD09PWx8fDE9PT1sPzE6bDtxPSFxfHwwPT09cXx8MT09PXE/MTpxO2c9MDtmb3Ioaj1hW2ZdO2pbZ107KWcrKztuPWc7az0xPT09bD8hMDohMTtmb3Ioaj0wO2o8bDtqKyspZm9yKGc9MDtnPHE7ZysrKWFbZitnXVtuK2pdPXtjZWxsOmUsdW5pcXVlOmt9LGFbZitnXS5uVHI9ZH1lPWUubmV4dFNpYmxpbmd9fX1mdW5jdGlvbiByYShhLGIsYyl7dmFyIGQ9W107Y3x8KGM9YS5hb0hlYWRlcixiJiYoYz1bXSxkYShjLGIpKSk7Zm9yKHZhciBiPTAsZT1jLmxlbmd0aDtiPGU7YisrKWZvcih2YXIgZj0wLGc9Y1tiXS5sZW5ndGg7ZjxnO2YrKylpZihjW2JdW2ZdLnVuaXF1ZSYmKCFkW2ZdfHwhYS5iU29ydENlbGxzVG9wKSlkW2ZdPWNbYl1bZl0uY2VsbDtyZXR1cm4gZH1mdW5jdGlvbiBzYShhLGIsYyl7cihhLCJhb1NlcnZlclBhcmFtcyIsInNlcnZlclBhcmFtcyIsW2JdKTtpZihiJiZoLmlzQXJyYXkoYikpe3ZhciBkPXt9LA0KICAgICAgICBlPS8oLio/KVxbXF0kLztoLmVhY2goYixmdW5jdGlvbihhLGIpe3ZhciBjPWIubmFtZS5tYXRjaChlKTtjPyhjPWNbMF0sZFtjXXx8KGRbY109W10pLGRbY10ucHVzaChiLnZhbHVlKSk6ZFtiLm5hbWVdPWIudmFsdWV9KTtiPWR9dmFyIGYsZz1hLmFqYXgsaj1hLm9JbnN0YW5jZSxpPWZ1bmN0aW9uKGIpe3IoYSxudWxsLCJ4aHIiLFthLGIsYS5qcVhIUl0pO2MoYil9O2lmKGguaXNQbGFpbk9iamVjdChnKSYmZy5kYXRhKXtmPWcuZGF0YTt2YXIgbj1oLmlzRnVuY3Rpb24oZik/ZihiLGEpOmYsYj1oLmlzRnVuY3Rpb24oZikmJm4/bjpoLmV4dGVuZCghMCxiLG4pO2RlbGV0ZSBnLmRhdGF9bj17ZGF0YTpiLHN1Y2Nlc3M6ZnVuY3Rpb24oYil7dmFyIGM9Yi5lcnJvcnx8Yi5zRXJyb3I7YyYmSihhLDAsYyk7YS5qc29uPWI7aShiKX0sZGF0YVR5cGU6Impzb24iLGNhY2hlOiExLHR5cGU6YS5zU2VydmVyTWV0aG9kLGVycm9yOmZ1bmN0aW9uKGIsYyl7dmFyIGQ9cihhLG51bGwsInhociIsDQogICAgICAgIFthLG51bGwsYS5qcVhIUl0pOy0xPT09aC5pbkFycmF5KCEwLGQpJiYoInBhcnNlcmVycm9yIj09Yz9KKGEsMCwiSW52YWxpZCBKU09OIHJlc3BvbnNlIiwxKTo0PT09Yi5yZWFkeVN0YXRlJiZKKGEsMCwiQWpheCBlcnJvciIsNykpO0MoYSwhMSl9fTthLm9BamF4RGF0YT1iO3IoYSxudWxsLCJwcmVYaHIiLFthLGJdKTthLmZuU2VydmVyRGF0YT9hLmZuU2VydmVyRGF0YS5jYWxsKGosYS5zQWpheFNvdXJjZSxoLm1hcChiLGZ1bmN0aW9uKGEsYil7cmV0dXJue25hbWU6Yix2YWx1ZTphfX0pLGksYSk6YS5zQWpheFNvdXJjZXx8InN0cmluZyI9PT10eXBlb2YgZz9hLmpxWEhSPWguYWpheChoLmV4dGVuZChuLHt1cmw6Z3x8YS5zQWpheFNvdXJjZX0pKTpoLmlzRnVuY3Rpb24oZyk/YS5qcVhIUj1nLmNhbGwoaixiLGksYSk6KGEuanFYSFI9aC5hamF4KGguZXh0ZW5kKG4sZykpLGcuZGF0YT1mKX1mdW5jdGlvbiBrYihhKXtyZXR1cm4gYS5iQWpheERhdGFHZXQ/KGEuaURyYXcrKyxDKGEsDQogICAgICAgICEwKSxzYShhLHRiKGEpLGZ1bmN0aW9uKGIpe3ViKGEsYil9KSwhMSk6ITB9ZnVuY3Rpb24gdGIoYSl7dmFyIGI9YS5hb0NvbHVtbnMsYz1iLmxlbmd0aCxkPWEub0ZlYXR1cmVzLGU9YS5vUHJldmlvdXNTZWFyY2gsZj1hLmFvUHJlU2VhcmNoQ29scyxnLGo9W10saSxuLGwsaz1WKGEpO2c9YS5faURpc3BsYXlTdGFydDtpPSExIT09ZC5iUGFnaW5hdGU/YS5faURpc3BsYXlMZW5ndGg6LTE7dmFyIHQ9ZnVuY3Rpb24oYSxiKXtqLnB1c2goe25hbWU6YSx2YWx1ZTpifSl9O3QoInNFY2hvIixhLmlEcmF3KTt0KCJpQ29sdW1ucyIsYyk7dCgic0NvbHVtbnMiLEQoYiwic05hbWUiKS5qb2luKCIsIikpO3QoImlEaXNwbGF5U3RhcnQiLGcpO3QoImlEaXNwbGF5TGVuZ3RoIixpKTt2YXIgcGE9e2RyYXc6YS5pRHJhdyxjb2x1bW5zOltdLG9yZGVyOltdLHN0YXJ0OmcsbGVuZ3RoOmksc2VhcmNoOnt2YWx1ZTplLnNTZWFyY2gscmVnZXg6ZS5iUmVnZXh9fTtmb3IoZz0wO2c8YztnKyspbj1iW2ddLA0KICAgICAgICBsPWZbZ10saT0iZnVuY3Rpb24iPT10eXBlb2Ygbi5tRGF0YT8iZnVuY3Rpb24iOm4ubURhdGEscGEuY29sdW1ucy5wdXNoKHtkYXRhOmksbmFtZTpuLnNOYW1lLHNlYXJjaGFibGU6bi5iU2VhcmNoYWJsZSxvcmRlcmFibGU6bi5iU29ydGFibGUsc2VhcmNoOnt2YWx1ZTpsLnNTZWFyY2gscmVnZXg6bC5iUmVnZXh9fSksdCgibURhdGFQcm9wXyIrZyxpKSxkLmJGaWx0ZXImJih0KCJzU2VhcmNoXyIrZyxsLnNTZWFyY2gpLHQoImJSZWdleF8iK2csbC5iUmVnZXgpLHQoImJTZWFyY2hhYmxlXyIrZyxuLmJTZWFyY2hhYmxlKSksZC5iU29ydCYmdCgiYlNvcnRhYmxlXyIrZyxuLmJTb3J0YWJsZSk7ZC5iRmlsdGVyJiYodCgic1NlYXJjaCIsZS5zU2VhcmNoKSx0KCJiUmVnZXgiLGUuYlJlZ2V4KSk7ZC5iU29ydCYmKGguZWFjaChrLGZ1bmN0aW9uKGEsYil7cGEub3JkZXIucHVzaCh7Y29sdW1uOmIuY29sLGRpcjpiLmRpcn0pO3QoImlTb3J0Q29sXyIrYSxiLmNvbCk7dCgic1NvcnREaXJfIisNCiAgICAgICAgYSxiLmRpcil9KSx0KCJpU29ydGluZ0NvbHMiLGsubGVuZ3RoKSk7Yj1tLmV4dC5sZWdhY3kuYWpheDtyZXR1cm4gbnVsbD09PWI/YS5zQWpheFNvdXJjZT9qOnBhOmI/ajpwYX1mdW5jdGlvbiB1YihhLGIpe3ZhciBjPXRhKGEsYiksZD1iLnNFY2hvIT09az9iLnNFY2hvOmIuZHJhdyxlPWIuaVRvdGFsUmVjb3JkcyE9PWs/Yi5pVG90YWxSZWNvcmRzOmIucmVjb3Jkc1RvdGFsLGY9Yi5pVG90YWxEaXNwbGF5UmVjb3JkcyE9PWs/Yi5pVG90YWxEaXNwbGF5UmVjb3JkczpiLnJlY29yZHNGaWx0ZXJlZDtpZihkKXtpZigxKmQ8YS5pRHJhdylyZXR1cm47YS5pRHJhdz0xKmR9bmEoYSk7YS5faVJlY29yZHNUb3RhbD1wYXJzZUludChlLDEwKTthLl9pUmVjb3Jkc0Rpc3BsYXk9cGFyc2VJbnQoZiwxMCk7ZD0wO2ZvcihlPWMubGVuZ3RoO2Q8ZTtkKyspTShhLGNbZF0pO2EuYWlEaXNwbGF5PWEuYWlEaXNwbGF5TWFzdGVyLnNsaWNlKCk7YS5iQWpheERhdGFHZXQ9ITE7TihhKTthLl9iSW5pdENvbXBsZXRlfHwNCiAgICB1YShhLGIpO2EuYkFqYXhEYXRhR2V0PSEwO0MoYSwhMSl9ZnVuY3Rpb24gdGEoYSxiKXt2YXIgYz1oLmlzUGxhaW5PYmplY3QoYS5hamF4KSYmYS5hamF4LmRhdGFTcmMhPT1rP2EuYWpheC5kYXRhU3JjOmEuc0FqYXhEYXRhUHJvcDtyZXR1cm4iZGF0YSI9PT1jP2IuYWFEYXRhfHxiW2NdOiIiIT09Yz9RKGMpKGIpOmJ9ZnVuY3Rpb24gb2IoYSl7dmFyIGI9YS5vQ2xhc3NlcyxjPWEuc1RhYmxlSWQsZD1hLm9MYW5ndWFnZSxlPWEub1ByZXZpb3VzU2VhcmNoLGY9YS5hYW5GZWF0dXJlcyxnPSc8aW5wdXQgdHlwZT0ic2VhcmNoIiBjbGFzcz0iJytiLnNGaWx0ZXJJbnB1dCsnIi8+JyxqPWQuc1NlYXJjaCxqPWoubWF0Y2goL19JTlBVVF8vKT9qLnJlcGxhY2UoIl9JTlBVVF8iLGcpOmorZyxiPWgoIjxkaXYvPiIse2lkOiFmLmY/YysiX2ZpbHRlciI6bnVsbCwiY2xhc3MiOmIuc0ZpbHRlcn0pLmFwcGVuZChoKCI8bGFiZWwvPiIpLmFwcGVuZChqKSksZj1mdW5jdGlvbigpe3ZhciBiPSF0aGlzLnZhbHVlPw0KICAgICAgICAiIjp0aGlzLnZhbHVlO2IhPWUuc1NlYXJjaCYmKGZhKGEse3NTZWFyY2g6YixiUmVnZXg6ZS5iUmVnZXgsYlNtYXJ0OmUuYlNtYXJ0LGJDYXNlSW5zZW5zaXRpdmU6ZS5iQ2FzZUluc2Vuc2l0aXZlfSksYS5faURpc3BsYXlTdGFydD0wLE4oYSkpfSxnPW51bGwhPT1hLnNlYXJjaERlbGF5P2Euc2VhcmNoRGVsYXk6InNzcCI9PT15KGEpPzQwMDowLGk9aCgiaW5wdXQiLGIpLnZhbChlLnNTZWFyY2gpLmF0dHIoInBsYWNlaG9sZGVyIixkLnNTZWFyY2hQbGFjZWhvbGRlcikub24oImtleXVwLkRUIHNlYXJjaC5EVCBpbnB1dC5EVCBwYXN0ZS5EVCBjdXQuRFQiLGc/TmEoZixnKTpmKS5vbigia2V5cHJlc3MuRFQiLGZ1bmN0aW9uKGEpe2lmKDEzPT1hLmtleUNvZGUpcmV0dXJuITF9KS5hdHRyKCJhcmlhLWNvbnRyb2xzIixjKTtoKGEublRhYmxlKS5vbigic2VhcmNoLmR0LkRUIixmdW5jdGlvbihiLGMpe2lmKGE9PT1jKXRyeXtpWzBdIT09Ry5hY3RpdmVFbGVtZW50JiZpLnZhbChlLnNTZWFyY2gpfWNhdGNoKGQpe319KTsNCiAgICAgICAgcmV0dXJuIGJbMF19ZnVuY3Rpb24gZmEoYSxiLGMpe3ZhciBkPWEub1ByZXZpb3VzU2VhcmNoLGU9YS5hb1ByZVNlYXJjaENvbHMsZj1mdW5jdGlvbihhKXtkLnNTZWFyY2g9YS5zU2VhcmNoO2QuYlJlZ2V4PWEuYlJlZ2V4O2QuYlNtYXJ0PWEuYlNtYXJ0O2QuYkNhc2VJbnNlbnNpdGl2ZT1hLmJDYXNlSW5zZW5zaXRpdmV9O0ZhKGEpO2lmKCJzc3AiIT15KGEpKXt2YihhLGIuc1NlYXJjaCxjLGIuYkVzY2FwZVJlZ2V4IT09az8hYi5iRXNjYXBlUmVnZXg6Yi5iUmVnZXgsYi5iU21hcnQsYi5iQ2FzZUluc2Vuc2l0aXZlKTtmKGIpO2ZvcihiPTA7YjxlLmxlbmd0aDtiKyspd2IoYSxlW2JdLnNTZWFyY2gsYixlW2JdLmJFc2NhcGVSZWdleCE9PWs/IWVbYl0uYkVzY2FwZVJlZ2V4OmVbYl0uYlJlZ2V4LGVbYl0uYlNtYXJ0LGVbYl0uYkNhc2VJbnNlbnNpdGl2ZSk7eGIoYSl9ZWxzZSBmKGIpO2EuYkZpbHRlcmVkPSEwO3IoYSxudWxsLCJzZWFyY2giLFthXSl9ZnVuY3Rpb24geGIoYSl7Zm9yKHZhciBiPQ0KICAgICAgICBtLmV4dC5zZWFyY2gsYz1hLmFpRGlzcGxheSxkLGUsZj0wLGc9Yi5sZW5ndGg7ZjxnO2YrKyl7Zm9yKHZhciBqPVtdLGk9MCxuPWMubGVuZ3RoO2k8bjtpKyspZT1jW2ldLGQ9YS5hb0RhdGFbZV0sYltmXShhLGQuX2FGaWx0ZXJEYXRhLGUsZC5fYURhdGEsaSkmJmoucHVzaChlKTtjLmxlbmd0aD0wO2gubWVyZ2UoYyxqKX19ZnVuY3Rpb24gd2IoYSxiLGMsZCxlLGYpe2lmKCIiIT09Yil7Zm9yKHZhciBnPVtdLGo9YS5haURpc3BsYXksZD1PYShiLGQsZSxmKSxlPTA7ZTxqLmxlbmd0aDtlKyspYj1hLmFvRGF0YVtqW2VdXS5fYUZpbHRlckRhdGFbY10sZC50ZXN0KGIpJiZnLnB1c2goaltlXSk7YS5haURpc3BsYXk9Z319ZnVuY3Rpb24gdmIoYSxiLGMsZCxlLGYpe3ZhciBkPU9hKGIsZCxlLGYpLGY9YS5vUHJldmlvdXNTZWFyY2guc1NlYXJjaCxnPWEuYWlEaXNwbGF5TWFzdGVyLGosZT1bXTswIT09bS5leHQuc2VhcmNoLmxlbmd0aCYmKGM9ITApO2o9eWIoYSk7aWYoMD49Yi5sZW5ndGgpYS5haURpc3BsYXk9DQogICAgICAgIGcuc2xpY2UoKTtlbHNle2lmKGp8fGN8fGYubGVuZ3RoPmIubGVuZ3RofHwwIT09Yi5pbmRleE9mKGYpfHxhLmJTb3J0ZWQpYS5haURpc3BsYXk9Zy5zbGljZSgpO2I9YS5haURpc3BsYXk7Zm9yKGM9MDtjPGIubGVuZ3RoO2MrKylkLnRlc3QoYS5hb0RhdGFbYltjXV0uX3NGaWx0ZXJSb3cpJiZlLnB1c2goYltjXSk7YS5haURpc3BsYXk9ZX19ZnVuY3Rpb24gT2EoYSxiLGMsZCl7YT1iP2E6UGEoYSk7YyYmKGE9Il4oPz0uKj8iK2gubWFwKGEubWF0Y2goLyJbXiJdKyJ8W14gXSsvZyl8fFsiIl0sZnVuY3Rpb24oYSl7aWYoJyInPT09YS5jaGFyQXQoMCkpdmFyIGI9YS5tYXRjaCgvXiIoLiopIiQvKSxhPWI/YlsxXTphO3JldHVybiBhLnJlcGxhY2UoJyInLCIiKX0pLmpvaW4oIikoPz0uKj8iKSsiKS4qJCIpO3JldHVybiBSZWdFeHAoYSxkPyJpIjoiIil9ZnVuY3Rpb24geWIoYSl7dmFyIGI9YS5hb0NvbHVtbnMsYyxkLGUsZixnLGosaSxoLGw9bS5leHQudHlwZS5zZWFyY2g7Yz0hMTsNCiAgICAgICAgZD0wO2ZvcihmPWEuYW9EYXRhLmxlbmd0aDtkPGY7ZCsrKWlmKGg9YS5hb0RhdGFbZF0sIWguX2FGaWx0ZXJEYXRhKXtqPVtdO2U9MDtmb3IoZz1iLmxlbmd0aDtlPGc7ZSsrKWM9YltlXSxjLmJTZWFyY2hhYmxlPyhpPUIoYSxkLGUsImZpbHRlciIpLGxbYy5zVHlwZV0mJihpPWxbYy5zVHlwZV0oaSkpLG51bGw9PT1pJiYoaT0iIiksInN0cmluZyIhPT10eXBlb2YgaSYmaS50b1N0cmluZyYmKGk9aS50b1N0cmluZygpKSk6aT0iIixpLmluZGV4T2YmJi0xIT09aS5pbmRleE9mKCImIikmJih2YS5pbm5lckhUTUw9aSxpPVdiP3ZhLnRleHRDb250ZW50OnZhLmlubmVyVGV4dCksaS5yZXBsYWNlJiYoaT1pLnJlcGxhY2UoL1tcclxuXS9nLCIiKSksai5wdXNoKGkpO2guX2FGaWx0ZXJEYXRhPWo7aC5fc0ZpbHRlclJvdz1qLmpvaW4oIiAgIik7Yz0hMH1yZXR1cm4gY31mdW5jdGlvbiB6YihhKXtyZXR1cm57c2VhcmNoOmEuc1NlYXJjaCxzbWFydDphLmJTbWFydCxyZWdleDphLmJSZWdleCwNCiAgICAgICAgY2FzZUluc2Vuc2l0aXZlOmEuYkNhc2VJbnNlbnNpdGl2ZX19ZnVuY3Rpb24gQWIoYSl7cmV0dXJue3NTZWFyY2g6YS5zZWFyY2gsYlNtYXJ0OmEuc21hcnQsYlJlZ2V4OmEucmVnZXgsYkNhc2VJbnNlbnNpdGl2ZTphLmNhc2VJbnNlbnNpdGl2ZX19ZnVuY3Rpb24gcmIoYSl7dmFyIGI9YS5zVGFibGVJZCxjPWEuYWFuRmVhdHVyZXMuaSxkPWgoIjxkaXYvPiIseyJjbGFzcyI6YS5vQ2xhc3Nlcy5zSW5mbyxpZDohYz9iKyJfaW5mbyI6bnVsbH0pO2N8fChhLmFvRHJhd0NhbGxiYWNrLnB1c2goe2ZuOkJiLHNOYW1lOiJpbmZvcm1hdGlvbiJ9KSxkLmF0dHIoInJvbGUiLCJzdGF0dXMiKS5hdHRyKCJhcmlhLWxpdmUiLCJwb2xpdGUiKSxoKGEublRhYmxlKS5hdHRyKCJhcmlhLWRlc2NyaWJlZGJ5IixiKyJfaW5mbyIpKTtyZXR1cm4gZFswXX1mdW5jdGlvbiBCYihhKXt2YXIgYj1hLmFhbkZlYXR1cmVzLmk7aWYoMCE9PWIubGVuZ3RoKXt2YXIgYz1hLm9MYW5ndWFnZSxkPWEuX2lEaXNwbGF5U3RhcnQrDQogICAgICAgIDEsZT1hLmZuRGlzcGxheUVuZCgpLGY9YS5mblJlY29yZHNUb3RhbCgpLGc9YS5mblJlY29yZHNEaXNwbGF5KCksaj1nP2Muc0luZm86Yy5zSW5mb0VtcHR5O2chPT1mJiYoais9IiAiK2Muc0luZm9GaWx0ZXJlZCk7ais9Yy5zSW5mb1Bvc3RGaXg7aj1DYihhLGopO2M9Yy5mbkluZm9DYWxsYmFjaztudWxsIT09YyYmKGo9Yy5jYWxsKGEub0luc3RhbmNlLGEsZCxlLGYsZyxqKSk7aChiKS5odG1sKGopfX1mdW5jdGlvbiBDYihhLGIpe3ZhciBjPWEuZm5Gb3JtYXROdW1iZXIsZD1hLl9pRGlzcGxheVN0YXJ0KzEsZT1hLl9pRGlzcGxheUxlbmd0aCxmPWEuZm5SZWNvcmRzRGlzcGxheSgpLGc9LTE9PT1lO3JldHVybiBiLnJlcGxhY2UoL19TVEFSVF8vZyxjLmNhbGwoYSxkKSkucmVwbGFjZSgvX0VORF8vZyxjLmNhbGwoYSxhLmZuRGlzcGxheUVuZCgpKSkucmVwbGFjZSgvX01BWF8vZyxjLmNhbGwoYSxhLmZuUmVjb3Jkc1RvdGFsKCkpKS5yZXBsYWNlKC9fVE9UQUxfL2csYy5jYWxsKGEsDQogICAgICAgIGYpKS5yZXBsYWNlKC9fUEFHRV8vZyxjLmNhbGwoYSxnPzE6TWF0aC5jZWlsKGQvZSkpKS5yZXBsYWNlKC9fUEFHRVNfL2csYy5jYWxsKGEsZz8xOk1hdGguY2VpbChmL2UpKSl9ZnVuY3Rpb24gZ2EoYSl7dmFyIGIsYyxkPWEuaUluaXREaXNwbGF5U3RhcnQsZT1hLmFvQ29sdW1ucyxmO2M9YS5vRmVhdHVyZXM7dmFyIGc9YS5iRGVmZXJMb2FkaW5nO2lmKGEuYkluaXRpYWxpc2VkKXttYihhKTtqYihhKTtlYShhLGEuYW9IZWFkZXIpO2VhKGEsYS5hb0Zvb3Rlcik7QyhhLCEwKTtjLmJBdXRvV2lkdGgmJkVhKGEpO2I9MDtmb3IoYz1lLmxlbmd0aDtiPGM7YisrKWY9ZVtiXSxmLnNXaWR0aCYmKGYublRoLnN0eWxlLndpZHRoPXYoZi5zV2lkdGgpKTtyKGEsbnVsbCwicHJlSW5pdCIsW2FdKTtTKGEpO2U9eShhKTtpZigic3NwIiE9ZXx8ZykiYWpheCI9PWU/c2EoYSxbXSxmdW5jdGlvbihjKXt2YXIgZj10YShhLGMpO2ZvcihiPTA7YjxmLmxlbmd0aDtiKyspTShhLGZbYl0pO2EuaUluaXREaXNwbGF5U3RhcnQ9DQogICAgICAgIGQ7UyhhKTtDKGEsITEpO3VhKGEsYyl9LGEpOihDKGEsITEpLHVhKGEpKX1lbHNlIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtnYShhKX0sMjAwKX1mdW5jdGlvbiB1YShhLGIpe2EuX2JJbml0Q29tcGxldGU9ITA7KGJ8fGEub0luaXQuYWFEYXRhKSYmWShhKTtyKGEsbnVsbCwicGx1Z2luLWluaXQiLFthLGJdKTtyKGEsImFvSW5pdENvbXBsZXRlIiwiaW5pdCIsW2EsYl0pfWZ1bmN0aW9uIFFhKGEsYil7dmFyIGM9cGFyc2VJbnQoYiwxMCk7YS5faURpc3BsYXlMZW5ndGg9YztSYShhKTtyKGEsbnVsbCwibGVuZ3RoIixbYSxjXSl9ZnVuY3Rpb24gbmIoYSl7Zm9yKHZhciBiPWEub0NsYXNzZXMsYz1hLnNUYWJsZUlkLGQ9YS5hTGVuZ3RoTWVudSxlPWguaXNBcnJheShkWzBdKSxmPWU/ZFswXTpkLGQ9ZT9kWzFdOmQsZT1oKCI8c2VsZWN0Lz4iLHtuYW1lOmMrIl9sZW5ndGgiLCJhcmlhLWNvbnRyb2xzIjpjLCJjbGFzcyI6Yi5zTGVuZ3RoU2VsZWN0fSksZz0wLGo9Zi5sZW5ndGg7ZzxqO2crKyllWzBdW2ddPQ0KICAgICAgICBuZXcgT3B0aW9uKCJudW1iZXIiPT09dHlwZW9mIGRbZ10/YS5mbkZvcm1hdE51bWJlcihkW2ddKTpkW2ddLGZbZ10pO3ZhciBpPWgoIjxkaXY+PGxhYmVsLz48L2Rpdj4iKS5hZGRDbGFzcyhiLnNMZW5ndGgpO2EuYWFuRmVhdHVyZXMubHx8KGlbMF0uaWQ9YysiX2xlbmd0aCIpO2kuY2hpbGRyZW4oKS5hcHBlbmQoYS5vTGFuZ3VhZ2Uuc0xlbmd0aE1lbnUucmVwbGFjZSgiX01FTlVfIixlWzBdLm91dGVySFRNTCkpO2goInNlbGVjdCIsaSkudmFsKGEuX2lEaXNwbGF5TGVuZ3RoKS5vbigiY2hhbmdlLkRUIixmdW5jdGlvbigpe1FhKGEsaCh0aGlzKS52YWwoKSk7TihhKX0pO2goYS5uVGFibGUpLm9uKCJsZW5ndGguZHQuRFQiLGZ1bmN0aW9uKGIsYyxkKXthPT09YyYmaCgic2VsZWN0IixpKS52YWwoZCl9KTtyZXR1cm4gaVswXX1mdW5jdGlvbiBzYihhKXt2YXIgYj1hLnNQYWdpbmF0aW9uVHlwZSxjPW0uZXh0LnBhZ2VyW2JdLGQ9ImZ1bmN0aW9uIj09PXR5cGVvZiBjLGU9ZnVuY3Rpb24oYSl7TihhKX0sDQogICAgICAgIGI9aCgiPGRpdi8+IikuYWRkQ2xhc3MoYS5vQ2xhc3Nlcy5zUGFnaW5nK2IpWzBdLGY9YS5hYW5GZWF0dXJlcztkfHxjLmZuSW5pdChhLGIsZSk7Zi5wfHwoYi5pZD1hLnNUYWJsZUlkKyJfcGFnaW5hdGUiLGEuYW9EcmF3Q2FsbGJhY2sucHVzaCh7Zm46ZnVuY3Rpb24oYSl7aWYoZCl7dmFyIGI9YS5faURpc3BsYXlTdGFydCxpPWEuX2lEaXNwbGF5TGVuZ3RoLGg9YS5mblJlY29yZHNEaXNwbGF5KCksbD0tMT09PWksYj1sPzA6TWF0aC5jZWlsKGIvaSksaT1sPzE6TWF0aC5jZWlsKGgvaSksaD1jKGIsaSksayxsPTA7Zm9yKGs9Zi5wLmxlbmd0aDtsPGs7bCsrKU1hKGEsInBhZ2VCdXR0b24iKShhLGYucFtsXSxsLGgsYixpKX1lbHNlIGMuZm5VcGRhdGUoYSxlKX0sc05hbWU6InBhZ2luYXRpb24ifSkpO3JldHVybiBifWZ1bmN0aW9uIFNhKGEsYixjKXt2YXIgZD1hLl9pRGlzcGxheVN0YXJ0LGU9YS5faURpc3BsYXlMZW5ndGgsZj1hLmZuUmVjb3Jkc0Rpc3BsYXkoKTswPT09Znx8LTE9PT0NCiAgICBlP2Q9MDoibnVtYmVyIj09PXR5cGVvZiBiPyhkPWIqZSxkPmYmJihkPTApKToiZmlyc3QiPT1iP2Q9MDoicHJldmlvdXMiPT1iPyhkPTA8PWU/ZC1lOjAsMD5kJiYoZD0wKSk6Im5leHQiPT1iP2QrZTxmJiYoZCs9ZSk6Imxhc3QiPT1iP2Q9TWF0aC5mbG9vcigoZi0xKS9lKSplOkooYSwwLCJVbmtub3duIHBhZ2luZyBhY3Rpb246ICIrYiw1KTtiPWEuX2lEaXNwbGF5U3RhcnQhPT1kO2EuX2lEaXNwbGF5U3RhcnQ9ZDtiJiYocihhLG51bGwsInBhZ2UiLFthXSksYyYmTihhKSk7cmV0dXJuIGJ9ZnVuY3Rpb24gcGIoYSl7cmV0dXJuIGgoIjxkaXYvPiIse2lkOiFhLmFhbkZlYXR1cmVzLnI/YS5zVGFibGVJZCsiX3Byb2Nlc3NpbmciOm51bGwsImNsYXNzIjphLm9DbGFzc2VzLnNQcm9jZXNzaW5nfSkuaHRtbChhLm9MYW5ndWFnZS5zUHJvY2Vzc2luZykuaW5zZXJ0QmVmb3JlKGEublRhYmxlKVswXX1mdW5jdGlvbiBDKGEsYil7YS5vRmVhdHVyZXMuYlByb2Nlc3NpbmcmJmgoYS5hYW5GZWF0dXJlcy5yKS5jc3MoImRpc3BsYXkiLA0KICAgICAgICBiPyJibG9jayI6Im5vbmUiKTtyKGEsbnVsbCwicHJvY2Vzc2luZyIsW2EsYl0pfWZ1bmN0aW9uIHFiKGEpe3ZhciBiPWgoYS5uVGFibGUpO2IuYXR0cigicm9sZSIsImdyaWQiKTt2YXIgYz1hLm9TY3JvbGw7aWYoIiI9PT1jLnNYJiYiIj09PWMuc1kpcmV0dXJuIGEublRhYmxlO3ZhciBkPWMuc1gsZT1jLnNZLGY9YS5vQ2xhc3NlcyxnPWIuY2hpbGRyZW4oImNhcHRpb24iKSxqPWcubGVuZ3RoP2dbMF0uX2NhcHRpb25TaWRlOm51bGwsaT1oKGJbMF0uY2xvbmVOb2RlKCExKSksbj1oKGJbMF0uY2xvbmVOb2RlKCExKSksbD1iLmNoaWxkcmVuKCJ0Zm9vdCIpO2wubGVuZ3RofHwobD1udWxsKTtpPWgoIjxkaXYvPiIseyJjbGFzcyI6Zi5zU2Nyb2xsV3JhcHBlcn0pLmFwcGVuZChoKCI8ZGl2Lz4iLHsiY2xhc3MiOmYuc1Njcm9sbEhlYWR9KS5jc3Moe292ZXJmbG93OiJoaWRkZW4iLHBvc2l0aW9uOiJyZWxhdGl2ZSIsYm9yZGVyOjAsd2lkdGg6ZD8hZD9udWxsOnYoZCk6IjEwMCUifSkuYXBwZW5kKGgoIjxkaXYvPiIsDQogICAgICAgIHsiY2xhc3MiOmYuc1Njcm9sbEhlYWRJbm5lcn0pLmNzcyh7ImJveC1zaXppbmciOiJjb250ZW50LWJveCIsd2lkdGg6Yy5zWElubmVyfHwiMTAwJSJ9KS5hcHBlbmQoaS5yZW1vdmVBdHRyKCJpZCIpLmNzcygibWFyZ2luLWxlZnQiLDApLmFwcGVuZCgidG9wIj09PWo/ZzpudWxsKS5hcHBlbmQoYi5jaGlsZHJlbigidGhlYWQiKSkpKSkuYXBwZW5kKGgoIjxkaXYvPiIseyJjbGFzcyI6Zi5zU2Nyb2xsQm9keX0pLmNzcyh7cG9zaXRpb246InJlbGF0aXZlIixvdmVyZmxvdzoiYXV0byIsd2lkdGg6IWQ/bnVsbDp2KGQpfSkuYXBwZW5kKGIpKTtsJiZpLmFwcGVuZChoKCI8ZGl2Lz4iLHsiY2xhc3MiOmYuc1Njcm9sbEZvb3R9KS5jc3Moe292ZXJmbG93OiJoaWRkZW4iLGJvcmRlcjowLHdpZHRoOmQ/IWQ/bnVsbDp2KGQpOiIxMDAlIn0pLmFwcGVuZChoKCI8ZGl2Lz4iLHsiY2xhc3MiOmYuc1Njcm9sbEZvb3RJbm5lcn0pLmFwcGVuZChuLnJlbW92ZUF0dHIoImlkIikuY3NzKCJtYXJnaW4tbGVmdCIsDQogICAgICAgIDApLmFwcGVuZCgiYm90dG9tIj09PWo/ZzpudWxsKS5hcHBlbmQoYi5jaGlsZHJlbigidGZvb3QiKSkpKSk7dmFyIGI9aS5jaGlsZHJlbigpLGs9YlswXSxmPWJbMV0sdD1sP2JbMl06bnVsbDtpZihkKWgoZikub24oInNjcm9sbC5EVCIsZnVuY3Rpb24oKXt2YXIgYT10aGlzLnNjcm9sbExlZnQ7ay5zY3JvbGxMZWZ0PWE7bCYmKHQuc2Nyb2xsTGVmdD1hKX0pO2goZikuY3NzKGUmJmMuYkNvbGxhcHNlPyJtYXgtaGVpZ2h0IjoiaGVpZ2h0IixlKTthLm5TY3JvbGxIZWFkPWs7YS5uU2Nyb2xsQm9keT1mO2EublNjcm9sbEZvb3Q9dDthLmFvRHJhd0NhbGxiYWNrLnB1c2goe2ZuOmthLHNOYW1lOiJzY3JvbGxpbmcifSk7cmV0dXJuIGlbMF19ZnVuY3Rpb24ga2EoYSl7dmFyIGI9YS5vU2Nyb2xsLGM9Yi5zWCxkPWIuc1hJbm5lcixlPWIuc1ksYj1iLmlCYXJXaWR0aCxmPWgoYS5uU2Nyb2xsSGVhZCksZz1mWzBdLnN0eWxlLGo9Zi5jaGlsZHJlbigiZGl2IiksaT1qWzBdLnN0eWxlLG49ai5jaGlsZHJlbigidGFibGUiKSwNCiAgICAgICAgaj1hLm5TY3JvbGxCb2R5LGw9aChqKSxxPWouc3R5bGUsdD1oKGEublNjcm9sbEZvb3QpLmNoaWxkcmVuKCJkaXYiKSxtPXQuY2hpbGRyZW4oInRhYmxlIiksbz1oKGEublRIZWFkKSxwPWgoYS5uVGFibGUpLHM9cFswXSxyPXMuc3R5bGUsdT1hLm5URm9vdD9oKGEublRGb290KTpudWxsLHg9YS5vQnJvd3NlcixUPXguYlNjcm9sbE92ZXJzaXplLFhiPUQoYS5hb0NvbHVtbnMsIm5UaCIpLE8sSyxQLHcsVGE9W10seT1bXSx6PVtdLEE9W10sQixDPWZ1bmN0aW9uKGEpe2E9YS5zdHlsZTthLnBhZGRpbmdUb3A9IjAiO2EucGFkZGluZ0JvdHRvbT0iMCI7YS5ib3JkZXJUb3BXaWR0aD0iMCI7YS5ib3JkZXJCb3R0b21XaWR0aD0iMCI7YS5oZWlnaHQ9MH07Sz1qLnNjcm9sbEhlaWdodD5qLmNsaWVudEhlaWdodDtpZihhLnNjcm9sbEJhclZpcyE9PUsmJmEuc2Nyb2xsQmFyVmlzIT09aylhLnNjcm9sbEJhclZpcz1LLFkoYSk7ZWxzZXthLnNjcm9sbEJhclZpcz1LO3AuY2hpbGRyZW4oInRoZWFkLCB0Zm9vdCIpLnJlbW92ZSgpOw0KICAgICAgICB1JiYoUD11LmNsb25lKCkucHJlcGVuZFRvKHApLE89dS5maW5kKCJ0ciIpLFA9UC5maW5kKCJ0ciIpKTt3PW8uY2xvbmUoKS5wcmVwZW5kVG8ocCk7bz1vLmZpbmQoInRyIik7Sz13LmZpbmQoInRyIik7dy5maW5kKCJ0aCwgdGQiKS5yZW1vdmVBdHRyKCJ0YWJpbmRleCIpO2N8fChxLndpZHRoPSIxMDAlIixmWzBdLnN0eWxlLndpZHRoPSIxMDAlIik7aC5lYWNoKHJhKGEsdyksZnVuY3Rpb24oYixjKXtCPVooYSxiKTtjLnN0eWxlLndpZHRoPWEuYW9Db2x1bW5zW0JdLnNXaWR0aH0pO3UmJkgoZnVuY3Rpb24oYSl7YS5zdHlsZS53aWR0aD0iIn0sUCk7Zj1wLm91dGVyV2lkdGgoKTtpZigiIj09PWMpe3Iud2lkdGg9IjEwMCUiO2lmKFQmJihwLmZpbmQoInRib2R5IikuaGVpZ2h0KCk+ai5vZmZzZXRIZWlnaHR8fCJzY3JvbGwiPT1sLmNzcygib3ZlcmZsb3cteSIpKSlyLndpZHRoPXYocC5vdXRlcldpZHRoKCktYik7Zj1wLm91dGVyV2lkdGgoKX1lbHNlIiIhPT1kJiYoci53aWR0aD0NCiAgICAgICAgICAgIHYoZCksZj1wLm91dGVyV2lkdGgoKSk7SChDLEspO0goZnVuY3Rpb24oYSl7ei5wdXNoKGEuaW5uZXJIVE1MKTtUYS5wdXNoKHYoaChhKS5jc3MoIndpZHRoIikpKX0sSyk7SChmdW5jdGlvbihhLGIpe2lmKGguaW5BcnJheShhLFhiKSE9PS0xKWEuc3R5bGUud2lkdGg9VGFbYl19LG8pO2goSykuaGVpZ2h0KDApO3UmJihIKEMsUCksSChmdW5jdGlvbihhKXtBLnB1c2goYS5pbm5lckhUTUwpO3kucHVzaCh2KGgoYSkuY3NzKCJ3aWR0aCIpKSl9LFApLEgoZnVuY3Rpb24oYSxiKXthLnN0eWxlLndpZHRoPXlbYl19LE8pLGgoUCkuaGVpZ2h0KDApKTtIKGZ1bmN0aW9uKGEsYil7YS5pbm5lckhUTUw9JzxkaXYgY2xhc3M9ImRhdGFUYWJsZXNfc2l6aW5nIiBzdHlsZT0iaGVpZ2h0OjA7b3ZlcmZsb3c6aGlkZGVuOyI+Jyt6W2JdKyI8L2Rpdj4iO2Euc3R5bGUud2lkdGg9VGFbYl19LEspO3UmJkgoZnVuY3Rpb24oYSxiKXthLmlubmVySFRNTD0nPGRpdiBjbGFzcz0iZGF0YVRhYmxlc19zaXppbmciIHN0eWxlPSJoZWlnaHQ6MDtvdmVyZmxvdzpoaWRkZW47Ij4nKw0KICAgICAgICAgICAgQVtiXSsiPC9kaXY+IjthLnN0eWxlLndpZHRoPXlbYl19LFApO2lmKHAub3V0ZXJXaWR0aCgpPGYpe089ai5zY3JvbGxIZWlnaHQ+ai5vZmZzZXRIZWlnaHR8fCJzY3JvbGwiPT1sLmNzcygib3ZlcmZsb3cteSIpP2YrYjpmO2lmKFQmJihqLnNjcm9sbEhlaWdodD5qLm9mZnNldEhlaWdodHx8InNjcm9sbCI9PWwuY3NzKCJvdmVyZmxvdy15IikpKXIud2lkdGg9dihPLWIpOygiIj09PWN8fCIiIT09ZCkmJkooYSwxLCJQb3NzaWJsZSBjb2x1bW4gbWlzYWxpZ25tZW50Iiw2KX1lbHNlIE89IjEwMCUiO3Eud2lkdGg9dihPKTtnLndpZHRoPXYoTyk7dSYmKGEublNjcm9sbEZvb3Quc3R5bGUud2lkdGg9dihPKSk7IWUmJlQmJihxLmhlaWdodD12KHMub2Zmc2V0SGVpZ2h0K2IpKTtjPXAub3V0ZXJXaWR0aCgpO25bMF0uc3R5bGUud2lkdGg9dihjKTtpLndpZHRoPXYoYyk7ZD1wLmhlaWdodCgpPmouY2xpZW50SGVpZ2h0fHwic2Nyb2xsIj09bC5jc3MoIm92ZXJmbG93LXkiKTtlPSJwYWRkaW5nIisNCiAgICAgICAgICAgICh4LmJTY3JvbGxiYXJMZWZ0PyJMZWZ0IjoiUmlnaHQiKTtpW2VdPWQ/YisicHgiOiIwcHgiO3UmJihtWzBdLnN0eWxlLndpZHRoPXYoYyksdFswXS5zdHlsZS53aWR0aD12KGMpLHRbMF0uc3R5bGVbZV09ZD9iKyJweCI6IjBweCIpO3AuY2hpbGRyZW4oImNvbGdyb3VwIikuaW5zZXJ0QmVmb3JlKHAuY2hpbGRyZW4oInRoZWFkIikpO2wuc2Nyb2xsKCk7aWYoKGEuYlNvcnRlZHx8YS5iRmlsdGVyZWQpJiYhYS5fZHJhd0hvbGQpai5zY3JvbGxUb3A9MH19ZnVuY3Rpb24gSChhLGIsYyl7Zm9yKHZhciBkPTAsZT0wLGY9Yi5sZW5ndGgsZyxqO2U8Zjspe2c9YltlXS5maXJzdENoaWxkO2ZvcihqPWM/Y1tlXS5maXJzdENoaWxkOm51bGw7ZzspMT09PWcubm9kZVR5cGUmJihjP2EoZyxqLGQpOmEoZyxkKSxkKyspLGc9Zy5uZXh0U2libGluZyxqPWM/ai5uZXh0U2libGluZzpudWxsO2UrK319ZnVuY3Rpb24gRWEoYSl7dmFyIGI9YS5uVGFibGUsYz1hLmFvQ29sdW1ucyxkPWEub1Njcm9sbCwNCiAgICAgICAgZT1kLnNZLGY9ZC5zWCxnPWQuc1hJbm5lcixqPWMubGVuZ3RoLGk9bGEoYSwiYlZpc2libGUiKSxuPWgoInRoIixhLm5USGVhZCksbD1iLmdldEF0dHJpYnV0ZSgid2lkdGgiKSxrPWIucGFyZW50Tm9kZSx0PSExLG0sbyxwPWEub0Jyb3dzZXIsZD1wLmJTY3JvbGxPdmVyc2l6ZTsobT1iLnN0eWxlLndpZHRoKSYmLTEhPT1tLmluZGV4T2YoIiUiKSYmKGw9bSk7Zm9yKG09MDttPGkubGVuZ3RoO20rKylvPWNbaVttXV0sbnVsbCE9PW8uc1dpZHRoJiYoby5zV2lkdGg9RGIoby5zV2lkdGhPcmlnLGspLHQ9ITApO2lmKGR8fCF0JiYhZiYmIWUmJmo9PWFhKGEpJiZqPT1uLmxlbmd0aClmb3IobT0wO208ajttKyspaT1aKGEsbSksbnVsbCE9PWkmJihjW2ldLnNXaWR0aD12KG4uZXEobSkud2lkdGgoKSkpO2Vsc2V7aj1oKGIpLmNsb25lKCkuY3NzKCJ2aXNpYmlsaXR5IiwiaGlkZGVuIikucmVtb3ZlQXR0cigiaWQiKTtqLmZpbmQoInRib2R5IHRyIikucmVtb3ZlKCk7dmFyIHM9aCgiPHRyLz4iKS5hcHBlbmRUbyhqLmZpbmQoInRib2R5IikpOw0KICAgICAgICBqLmZpbmQoInRoZWFkLCB0Zm9vdCIpLnJlbW92ZSgpO2ouYXBwZW5kKGgoYS5uVEhlYWQpLmNsb25lKCkpLmFwcGVuZChoKGEublRGb290KS5jbG9uZSgpKTtqLmZpbmQoInRmb290IHRoLCB0Zm9vdCB0ZCIpLmNzcygid2lkdGgiLCIiKTtuPXJhKGEsai5maW5kKCJ0aGVhZCIpWzBdKTtmb3IobT0wO208aS5sZW5ndGg7bSsrKW89Y1tpW21dXSxuW21dLnN0eWxlLndpZHRoPW51bGwhPT1vLnNXaWR0aE9yaWcmJiIiIT09by5zV2lkdGhPcmlnP3Yoby5zV2lkdGhPcmlnKToiIixvLnNXaWR0aE9yaWcmJmYmJmgoblttXSkuYXBwZW5kKGgoIjxkaXYvPiIpLmNzcyh7d2lkdGg6by5zV2lkdGhPcmlnLG1hcmdpbjowLHBhZGRpbmc6MCxib3JkZXI6MCxoZWlnaHQ6MX0pKTtpZihhLmFvRGF0YS5sZW5ndGgpZm9yKG09MDttPGkubGVuZ3RoO20rKyl0PWlbbV0sbz1jW3RdLGgoRWIoYSx0KSkuY2xvbmUoITEpLmFwcGVuZChvLnNDb250ZW50UGFkZGluZykuYXBwZW5kVG8ocyk7aCgiW25hbWVdIiwNCiAgICAgICAgICAgIGopLnJlbW92ZUF0dHIoIm5hbWUiKTtvPWgoIjxkaXYvPiIpLmNzcyhmfHxlP3twb3NpdGlvbjoiYWJzb2x1dGUiLHRvcDowLGxlZnQ6MCxoZWlnaHQ6MSxyaWdodDowLG92ZXJmbG93OiJoaWRkZW4ifTp7fSkuYXBwZW5kKGopLmFwcGVuZFRvKGspO2YmJmc/ai53aWR0aChnKTpmPyhqLmNzcygid2lkdGgiLCJhdXRvIiksai5yZW1vdmVBdHRyKCJ3aWR0aCIpLGoud2lkdGgoKTxrLmNsaWVudFdpZHRoJiZsJiZqLndpZHRoKGsuY2xpZW50V2lkdGgpKTplP2oud2lkdGgoay5jbGllbnRXaWR0aCk6bCYmai53aWR0aChsKTtmb3IobT1lPTA7bTxpLmxlbmd0aDttKyspaz1oKG5bbV0pLGc9ay5vdXRlcldpZHRoKCktay53aWR0aCgpLGs9cC5iQm91bmRpbmc/TWF0aC5jZWlsKG5bbV0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGgpOmsub3V0ZXJXaWR0aCgpLGUrPWssY1tpW21dXS5zV2lkdGg9dihrLWcpO2Iuc3R5bGUud2lkdGg9dihlKTtvLnJlbW92ZSgpfWwmJihiLnN0eWxlLndpZHRoPQ0KICAgICAgICB2KGwpKTtpZigobHx8ZikmJiFhLl9yZXN6RXZ0KWI9ZnVuY3Rpb24oKXtoKEUpLm9uKCJyZXNpemUuRFQtIithLnNJbnN0YW5jZSxOYShmdW5jdGlvbigpe1koYSl9KSl9LGQ/c2V0VGltZW91dChiLDFFMyk6YigpLGEuX3Jlc3pFdnQ9ITB9ZnVuY3Rpb24gRGIoYSxiKXtpZighYSlyZXR1cm4gMDt2YXIgYz1oKCI8ZGl2Lz4iKS5jc3MoIndpZHRoIix2KGEpKS5hcHBlbmRUbyhifHxHLmJvZHkpLGQ9Y1swXS5vZmZzZXRXaWR0aDtjLnJlbW92ZSgpO3JldHVybiBkfWZ1bmN0aW9uIEViKGEsYil7dmFyIGM9RmIoYSxiKTtpZigwPmMpcmV0dXJuIG51bGw7dmFyIGQ9YS5hb0RhdGFbY107cmV0dXJuIWQublRyP2goIjx0ZC8+IikuaHRtbChCKGEsYyxiLCJkaXNwbGF5IikpWzBdOmQuYW5DZWxsc1tiXX1mdW5jdGlvbiBGYihhLGIpe2Zvcih2YXIgYyxkPS0xLGU9LTEsZj0wLGc9YS5hb0RhdGEubGVuZ3RoO2Y8ZztmKyspYz1CKGEsZixiLCJkaXNwbGF5IikrIiIsYz1jLnJlcGxhY2UoWWIsDQogICAgICAgICIiKSxjPWMucmVwbGFjZSgvJm5ic3A7L2csIiAiKSxjLmxlbmd0aD5kJiYoZD1jLmxlbmd0aCxlPWYpO3JldHVybiBlfWZ1bmN0aW9uIHYoYSl7cmV0dXJuIG51bGw9PT1hPyIwcHgiOiJudW1iZXIiPT10eXBlb2YgYT8wPmE/IjBweCI6YSsicHgiOmEubWF0Y2goL1xkJC8pP2ErInB4IjphfWZ1bmN0aW9uIFYoYSl7dmFyIGIsYyxkPVtdLGU9YS5hb0NvbHVtbnMsZixnLGosaTtiPWEuYWFTb3J0aW5nRml4ZWQ7Yz1oLmlzUGxhaW5PYmplY3QoYik7dmFyIG49W107Zj1mdW5jdGlvbihhKXthLmxlbmd0aCYmIWguaXNBcnJheShhWzBdKT9uLnB1c2goYSk6aC5tZXJnZShuLGEpfTtoLmlzQXJyYXkoYikmJmYoYik7YyYmYi5wcmUmJmYoYi5wcmUpO2YoYS5hYVNvcnRpbmcpO2MmJmIucG9zdCYmZihiLnBvc3QpO2ZvcihhPTA7YTxuLmxlbmd0aDthKyspe2k9blthXVswXTtmPWVbaV0uYURhdGFTb3J0O2I9MDtmb3IoYz1mLmxlbmd0aDtiPGM7YisrKWc9ZltiXSxqPWVbZ10uc1R5cGV8fA0KICAgICAgICAic3RyaW5nIixuW2FdLl9pZHg9PT1rJiYoblthXS5faWR4PWguaW5BcnJheShuW2FdWzFdLGVbZ10uYXNTb3J0aW5nKSksZC5wdXNoKHtzcmM6aSxjb2w6ZyxkaXI6blthXVsxXSxpbmRleDpuW2FdLl9pZHgsdHlwZTpqLGZvcm1hdHRlcjptLmV4dC50eXBlLm9yZGVyW2orIi1wcmUiXX0pfXJldHVybiBkfWZ1bmN0aW9uIGxiKGEpe3ZhciBiLGMsZD1bXSxlPW0uZXh0LnR5cGUub3JkZXIsZj1hLmFvRGF0YSxnPTAsaixpPWEuYWlEaXNwbGF5TWFzdGVyLGg7RmEoYSk7aD1WKGEpO2I9MDtmb3IoYz1oLmxlbmd0aDtiPGM7YisrKWo9aFtiXSxqLmZvcm1hdHRlciYmZysrLEdiKGEsai5jb2wpO2lmKCJzc3AiIT15KGEpJiYwIT09aC5sZW5ndGgpe2I9MDtmb3IoYz1pLmxlbmd0aDtiPGM7YisrKWRbaVtiXV09YjtnPT09aC5sZW5ndGg/aS5zb3J0KGZ1bmN0aW9uKGEsYil7dmFyIGMsZSxnLGosaT1oLmxlbmd0aCxrPWZbYV0uX2FTb3J0RGF0YSxtPWZbYl0uX2FTb3J0RGF0YTtmb3IoZz0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwO2c8aTtnKyspaWYoaj1oW2ddLGM9a1tqLmNvbF0sZT1tW2ouY29sXSxjPWM8ZT8tMTpjPmU/MTowLDAhPT1jKXJldHVybiJhc2MiPT09ai5kaXI/YzotYztjPWRbYV07ZT1kW2JdO3JldHVybiBjPGU/LTE6Yz5lPzE6MH0pOmkuc29ydChmdW5jdGlvbihhLGIpe3ZhciBjLGcsaixpLGs9aC5sZW5ndGgsbT1mW2FdLl9hU29ydERhdGEsbz1mW2JdLl9hU29ydERhdGE7Zm9yKGo9MDtqPGs7aisrKWlmKGk9aFtqXSxjPW1baS5jb2xdLGc9b1tpLmNvbF0saT1lW2kudHlwZSsiLSIraS5kaXJdfHxlWyJzdHJpbmctIitpLmRpcl0sYz1pKGMsZyksMCE9PWMpcmV0dXJuIGM7Yz1kW2FdO2c9ZFtiXTtyZXR1cm4gYzxnPy0xOmM+Zz8xOjB9KX1hLmJTb3J0ZWQ9ITB9ZnVuY3Rpb24gSGIoYSl7Zm9yKHZhciBiLGMsZD1hLmFvQ29sdW1ucyxlPVYoYSksYT1hLm9MYW5ndWFnZS5vQXJpYSxmPTAsZz1kLmxlbmd0aDtmPGc7ZisrKXtjPWRbZl07dmFyIGo9Yy5hc1NvcnRpbmc7Yj1jLnNUaXRsZS5yZXBsYWNlKC88Lio/Pi9nLA0KICAgICAgICAiIik7dmFyIGk9Yy5uVGg7aS5yZW1vdmVBdHRyaWJ1dGUoImFyaWEtc29ydCIpO2MuYlNvcnRhYmxlJiYoMDxlLmxlbmd0aCYmZVswXS5jb2w9PWY/KGkuc2V0QXR0cmlidXRlKCJhcmlhLXNvcnQiLCJhc2MiPT1lWzBdLmRpcj8iYXNjZW5kaW5nIjoiZGVzY2VuZGluZyIpLGM9altlWzBdLmluZGV4KzFdfHxqWzBdKTpjPWpbMF0sYis9ImFzYyI9PT1jP2Euc1NvcnRBc2NlbmRpbmc6YS5zU29ydERlc2NlbmRpbmcpO2kuc2V0QXR0cmlidXRlKCJhcmlhLWxhYmVsIixiKX19ZnVuY3Rpb24gVWEoYSxiLGMsZCl7dmFyIGU9YS5hYVNvcnRpbmcsZj1hLmFvQ29sdW1uc1tiXS5hc1NvcnRpbmcsZz1mdW5jdGlvbihhLGIpe3ZhciBjPWEuX2lkeDtjPT09ayYmKGM9aC5pbkFycmF5KGFbMV0sZikpO3JldHVybiBjKzE8Zi5sZW5ndGg/YysxOmI/bnVsbDowfTsibnVtYmVyIj09PXR5cGVvZiBlWzBdJiYoZT1hLmFhU29ydGluZz1bZV0pO2MmJmEub0ZlYXR1cmVzLmJTb3J0TXVsdGk/KGM9aC5pbkFycmF5KGIsDQogICAgICAgIEQoZSwiMCIpKSwtMSE9PWM/KGI9ZyhlW2NdLCEwKSxudWxsPT09YiYmMT09PWUubGVuZ3RoJiYoYj0wKSxudWxsPT09Yj9lLnNwbGljZShjLDEpOihlW2NdWzFdPWZbYl0sZVtjXS5faWR4PWIpKTooZS5wdXNoKFtiLGZbMF0sMF0pLGVbZS5sZW5ndGgtMV0uX2lkeD0wKSk6ZS5sZW5ndGgmJmVbMF1bMF09PWI/KGI9ZyhlWzBdKSxlLmxlbmd0aD0xLGVbMF1bMV09ZltiXSxlWzBdLl9pZHg9Yik6KGUubGVuZ3RoPTAsZS5wdXNoKFtiLGZbMF1dKSxlWzBdLl9pZHg9MCk7UyhhKTsiZnVuY3Rpb24iPT10eXBlb2YgZCYmZChhKX1mdW5jdGlvbiBMYShhLGIsYyxkKXt2YXIgZT1hLmFvQ29sdW1uc1tjXTtWYShiLHt9LGZ1bmN0aW9uKGIpeyExIT09ZS5iU29ydGFibGUmJihhLm9GZWF0dXJlcy5iUHJvY2Vzc2luZz8oQyhhLCEwKSxzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7VWEoYSxjLGIuc2hpZnRLZXksZCk7InNzcCIhPT15KGEpJiZDKGEsITEpfSwwKSk6VWEoYSxjLGIuc2hpZnRLZXksZCkpfSl9DQogICAgZnVuY3Rpb24gd2EoYSl7dmFyIGI9YS5hTGFzdFNvcnQsYz1hLm9DbGFzc2VzLnNTb3J0Q29sdW1uLGQ9VihhKSxlPWEub0ZlYXR1cmVzLGYsZztpZihlLmJTb3J0JiZlLmJTb3J0Q2xhc3Nlcyl7ZT0wO2ZvcihmPWIubGVuZ3RoO2U8ZjtlKyspZz1iW2VdLnNyYyxoKEQoYS5hb0RhdGEsImFuQ2VsbHMiLGcpKS5yZW1vdmVDbGFzcyhjKygyPmU/ZSsxOjMpKTtlPTA7Zm9yKGY9ZC5sZW5ndGg7ZTxmO2UrKylnPWRbZV0uc3JjLGgoRChhLmFvRGF0YSwiYW5DZWxscyIsZykpLmFkZENsYXNzKGMrKDI+ZT9lKzE6MykpfWEuYUxhc3RTb3J0PWR9ZnVuY3Rpb24gR2IoYSxiKXt2YXIgYz1hLmFvQ29sdW1uc1tiXSxkPW0uZXh0Lm9yZGVyW2Muc1NvcnREYXRhVHlwZV0sZTtkJiYoZT1kLmNhbGwoYS5vSW5zdGFuY2UsYSxiLCQoYSxiKSkpO2Zvcih2YXIgZixnPW0uZXh0LnR5cGUub3JkZXJbYy5zVHlwZSsiLXByZSJdLGo9MCxpPWEuYW9EYXRhLmxlbmd0aDtqPGk7aisrKWlmKGM9YS5hb0RhdGFbal0sDQogICAgICAgIGMuX2FTb3J0RGF0YXx8KGMuX2FTb3J0RGF0YT1bXSksIWMuX2FTb3J0RGF0YVtiXXx8ZClmPWQ/ZVtqXTpCKGEsaixiLCJzb3J0IiksYy5fYVNvcnREYXRhW2JdPWc/ZyhmKTpmfWZ1bmN0aW9uIHhhKGEpe2lmKGEub0ZlYXR1cmVzLmJTdGF0ZVNhdmUmJiFhLmJEZXN0cm95aW5nKXt2YXIgYj17dGltZTorbmV3IERhdGUsc3RhcnQ6YS5faURpc3BsYXlTdGFydCxsZW5ndGg6YS5faURpc3BsYXlMZW5ndGgsb3JkZXI6aC5leHRlbmQoITAsW10sYS5hYVNvcnRpbmcpLHNlYXJjaDp6YihhLm9QcmV2aW91c1NlYXJjaCksY29sdW1uczpoLm1hcChhLmFvQ29sdW1ucyxmdW5jdGlvbihiLGQpe3JldHVybnt2aXNpYmxlOmIuYlZpc2libGUsc2VhcmNoOnpiKGEuYW9QcmVTZWFyY2hDb2xzW2RdKX19KX07cihhLCJhb1N0YXRlU2F2ZVBhcmFtcyIsInN0YXRlU2F2ZVBhcmFtcyIsW2EsYl0pO2Eub1NhdmVkU3RhdGU9YjthLmZuU3RhdGVTYXZlQ2FsbGJhY2suY2FsbChhLm9JbnN0YW5jZSxhLA0KICAgICAgICBiKX19ZnVuY3Rpb24gSWIoYSxiLGMpe3ZhciBkLGUsZj1hLmFvQ29sdW1ucyxiPWZ1bmN0aW9uKGIpe2lmKGImJmIudGltZSl7dmFyIGc9cihhLCJhb1N0YXRlTG9hZFBhcmFtcyIsInN0YXRlTG9hZFBhcmFtcyIsW2EsYl0pO2lmKC0xPT09aC5pbkFycmF5KCExLGcpJiYoZz1hLmlTdGF0ZUR1cmF0aW9uLCEoMDxnJiZiLnRpbWU8K25ldyBEYXRlLTFFMypnKSYmIShiLmNvbHVtbnMmJmYubGVuZ3RoIT09Yi5jb2x1bW5zLmxlbmd0aCkpKXthLm9Mb2FkZWRTdGF0ZT1oLmV4dGVuZCghMCx7fSxiKTtiLnN0YXJ0IT09ayYmKGEuX2lEaXNwbGF5U3RhcnQ9Yi5zdGFydCxhLmlJbml0RGlzcGxheVN0YXJ0PWIuc3RhcnQpO2IubGVuZ3RoIT09ayYmKGEuX2lEaXNwbGF5TGVuZ3RoPWIubGVuZ3RoKTtiLm9yZGVyIT09ayYmKGEuYWFTb3J0aW5nPVtdLGguZWFjaChiLm9yZGVyLGZ1bmN0aW9uKGIsYyl7YS5hYVNvcnRpbmcucHVzaChjWzBdPj1mLmxlbmd0aD9bMCxjWzFdXTpjKX0pKTtiLnNlYXJjaCE9PQ0KICAgIGsmJmguZXh0ZW5kKGEub1ByZXZpb3VzU2VhcmNoLEFiKGIuc2VhcmNoKSk7aWYoYi5jb2x1bW5zKXtkPTA7Zm9yKGU9Yi5jb2x1bW5zLmxlbmd0aDtkPGU7ZCsrKWc9Yi5jb2x1bW5zW2RdLGcudmlzaWJsZSE9PWsmJihmW2RdLmJWaXNpYmxlPWcudmlzaWJsZSksZy5zZWFyY2ghPT1rJiZoLmV4dGVuZChhLmFvUHJlU2VhcmNoQ29sc1tkXSxBYihnLnNlYXJjaCkpfXIoYSwiYW9TdGF0ZUxvYWRlZCIsInN0YXRlTG9hZGVkIixbYSxiXSl9fWMoKX07aWYoYS5vRmVhdHVyZXMuYlN0YXRlU2F2ZSl7dmFyIGc9YS5mblN0YXRlTG9hZENhbGxiYWNrLmNhbGwoYS5vSW5zdGFuY2UsYSxiKTtnIT09ayYmYihnKX1lbHNlIGMoKX1mdW5jdGlvbiB5YShhKXt2YXIgYj1tLnNldHRpbmdzLGE9aC5pbkFycmF5KGEsRChiLCJuVGFibGUiKSk7cmV0dXJuLTEhPT1hP2JbYV06bnVsbH1mdW5jdGlvbiBKKGEsYixjLGQpe2M9IkRhdGFUYWJsZXMgd2FybmluZzogIisoYT8idGFibGUgaWQ9IithLnNUYWJsZUlkKw0KICAgICAgICAiIC0gIjoiIikrYztkJiYoYys9Ii4gRm9yIG1vcmUgaW5mb3JtYXRpb24gYWJvdXQgdGhpcyBlcnJvciwgcGxlYXNlIHNlZSBodHRwOi8vZGF0YXRhYmxlcy5uZXQvdG4vIitkKTtpZihiKUUuY29uc29sZSYmY29uc29sZS5sb2cmJmNvbnNvbGUubG9nKGMpO2Vsc2UgaWYoYj1tLmV4dCxiPWIuc0Vyck1vZGV8fGIuZXJyTW9kZSxhJiZyKGEsbnVsbCwiZXJyb3IiLFthLGQsY10pLCJhbGVydCI9PWIpYWxlcnQoYyk7ZWxzZXtpZigidGhyb3ciPT1iKXRocm93IEVycm9yKGMpOyJmdW5jdGlvbiI9PXR5cGVvZiBiJiZiKGEsZCxjKX19ZnVuY3Rpb24gRihhLGIsYyxkKXtoLmlzQXJyYXkoYyk/aC5lYWNoKGMsZnVuY3Rpb24oYyxkKXtoLmlzQXJyYXkoZCk/RihhLGIsZFswXSxkWzFdKTpGKGEsYixkKX0pOihkPT09ayYmKGQ9YyksYltjXSE9PWsmJihhW2RdPWJbY10pKX1mdW5jdGlvbiBKYihhLGIsYyl7dmFyIGQsZTtmb3IoZSBpbiBiKWIuaGFzT3duUHJvcGVydHkoZSkmJihkPWJbZV0sDQogICAgICAgIGguaXNQbGFpbk9iamVjdChkKT8oaC5pc1BsYWluT2JqZWN0KGFbZV0pfHwoYVtlXT17fSksaC5leHRlbmQoITAsYVtlXSxkKSk6YVtlXT1jJiYiZGF0YSIhPT1lJiYiYWFEYXRhIiE9PWUmJmguaXNBcnJheShkKT9kLnNsaWNlKCk6ZCk7cmV0dXJuIGF9ZnVuY3Rpb24gVmEoYSxiLGMpe2goYSkub24oImNsaWNrLkRUIixiLGZ1bmN0aW9uKGIpe2EuYmx1cigpO2MoYil9KS5vbigia2V5cHJlc3MuRFQiLGIsZnVuY3Rpb24oYSl7MTM9PT1hLndoaWNoJiYoYS5wcmV2ZW50RGVmYXVsdCgpLGMoYSkpfSkub24oInNlbGVjdHN0YXJ0LkRUIixmdW5jdGlvbigpe3JldHVybiExfSl9ZnVuY3Rpb24geihhLGIsYyxkKXtjJiZhW2JdLnB1c2goe2ZuOmMsc05hbWU6ZH0pfWZ1bmN0aW9uIHIoYSxiLGMsZCl7dmFyIGU9W107YiYmKGU9aC5tYXAoYVtiXS5zbGljZSgpLnJldmVyc2UoKSxmdW5jdGlvbihiKXtyZXR1cm4gYi5mbi5hcHBseShhLm9JbnN0YW5jZSxkKX0pKTtudWxsIT09YyYmKGI9aC5FdmVudChjKw0KICAgICAgICAiLmR0IiksaChhLm5UYWJsZSkudHJpZ2dlcihiLGQpLGUucHVzaChiLnJlc3VsdCkpO3JldHVybiBlfWZ1bmN0aW9uIFJhKGEpe3ZhciBiPWEuX2lEaXNwbGF5U3RhcnQsYz1hLmZuRGlzcGxheUVuZCgpLGQ9YS5faURpc3BsYXlMZW5ndGg7Yj49YyYmKGI9Yy1kKTtiLT1iJWQ7aWYoLTE9PT1kfHwwPmIpYj0wO2EuX2lEaXNwbGF5U3RhcnQ9Yn1mdW5jdGlvbiBNYShhLGIpe3ZhciBjPWEucmVuZGVyZXIsZD1tLmV4dC5yZW5kZXJlcltiXTtyZXR1cm4gaC5pc1BsYWluT2JqZWN0KGMpJiZjW2JdP2RbY1tiXV18fGQuXzoic3RyaW5nIj09PXR5cGVvZiBjP2RbY118fGQuXzpkLl99ZnVuY3Rpb24geShhKXtyZXR1cm4gYS5vRmVhdHVyZXMuYlNlcnZlclNpZGU/InNzcCI6YS5hamF4fHxhLnNBamF4U291cmNlPyJhamF4IjoiZG9tIn1mdW5jdGlvbiBoYShhLGIpe3ZhciBjPVtdLGM9S2IubnVtYmVyc19sZW5ndGgsZD1NYXRoLmZsb29yKGMvMik7Yjw9Yz9jPVcoMCxiKTphPD1kPyhjPVcoMCwNCiAgICAgICAgYy0yKSxjLnB1c2goImVsbGlwc2lzIiksYy5wdXNoKGItMSkpOihhPj1iLTEtZD9jPVcoYi0oYy0yKSxiKTooYz1XKGEtZCsyLGErZC0xKSxjLnB1c2goImVsbGlwc2lzIiksYy5wdXNoKGItMSkpLGMuc3BsaWNlKDAsMCwiZWxsaXBzaXMiKSxjLnNwbGljZSgwLDAsMCkpO2MuRFRfZWw9InNwYW4iO3JldHVybiBjfWZ1bmN0aW9uIGNiKGEpe2guZWFjaCh7bnVtOmZ1bmN0aW9uKGIpe3JldHVybiB6YShiLGEpfSwibnVtLWZtdCI6ZnVuY3Rpb24oYil7cmV0dXJuIHphKGIsYSxXYSl9LCJodG1sLW51bSI6ZnVuY3Rpb24oYil7cmV0dXJuIHphKGIsYSxBYSl9LCJodG1sLW51bS1mbXQiOmZ1bmN0aW9uKGIpe3JldHVybiB6YShiLGEsQWEsV2EpfX0sZnVuY3Rpb24oYixjKXt4LnR5cGUub3JkZXJbYithKyItcHJlIl09YztiLm1hdGNoKC9eaHRtbFwtLykmJih4LnR5cGUuc2VhcmNoW2IrYV09eC50eXBlLnNlYXJjaC5odG1sKX0pfWZ1bmN0aW9uIExiKGEpe3JldHVybiBmdW5jdGlvbigpe3ZhciBiPQ0KICAgICAgICBbeWEodGhpc1ttLmV4dC5pQXBpSW5kZXhdKV0uY29uY2F0KEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cykpO3JldHVybiBtLmV4dC5pbnRlcm5hbFthXS5hcHBseSh0aGlzLGIpfX12YXIgbT1mdW5jdGlvbihhKXt0aGlzLiQ9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5hcGkoITApLiQoYSxiKX07dGhpcy5fPWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuYXBpKCEwKS5yb3dzKGEsYikuZGF0YSgpfTt0aGlzLmFwaT1mdW5jdGlvbihhKXtyZXR1cm4gYT9uZXcgcyh5YSh0aGlzW3guaUFwaUluZGV4XSkpOm5ldyBzKHRoaXMpfTt0aGlzLmZuQWRkRGF0YT1mdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuYXBpKCEwKSxkPWguaXNBcnJheShhKSYmKGguaXNBcnJheShhWzBdKXx8aC5pc1BsYWluT2JqZWN0KGFbMF0pKT9jLnJvd3MuYWRkKGEpOmMucm93LmFkZChhKTsoYj09PWt8fGIpJiZjLmRyYXcoKTtyZXR1cm4gZC5mbGF0dGVuKCkudG9BcnJheSgpfTt0aGlzLmZuQWRqdXN0Q29sdW1uU2l6aW5nPQ0KICAgICAgICBmdW5jdGlvbihhKXt2YXIgYj10aGlzLmFwaSghMCkuY29sdW1ucy5hZGp1c3QoKSxjPWIuc2V0dGluZ3MoKVswXSxkPWMub1Njcm9sbDthPT09a3x8YT9iLmRyYXcoITEpOigiIiE9PWQuc1h8fCIiIT09ZC5zWSkmJmthKGMpfTt0aGlzLmZuQ2xlYXJUYWJsZT1mdW5jdGlvbihhKXt2YXIgYj10aGlzLmFwaSghMCkuY2xlYXIoKTsoYT09PWt8fGEpJiZiLmRyYXcoKX07dGhpcy5mbkNsb3NlPWZ1bmN0aW9uKGEpe3RoaXMuYXBpKCEwKS5yb3coYSkuY2hpbGQuaGlkZSgpfTt0aGlzLmZuRGVsZXRlUm93PWZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzLmFwaSghMCksYT1kLnJvd3MoYSksZT1hLnNldHRpbmdzKClbMF0saD1lLmFvRGF0YVthWzBdWzBdXTthLnJlbW92ZSgpO2ImJmIuY2FsbCh0aGlzLGUsaCk7KGM9PT1rfHxjKSYmZC5kcmF3KCk7cmV0dXJuIGh9O3RoaXMuZm5EZXN0cm95PWZ1bmN0aW9uKGEpe3RoaXMuYXBpKCEwKS5kZXN0cm95KGEpfTt0aGlzLmZuRHJhdz1mdW5jdGlvbihhKXt0aGlzLmFwaSghMCkuZHJhdyhhKX07DQogICAgICAgIHRoaXMuZm5GaWx0ZXI9ZnVuY3Rpb24oYSxiLGMsZCxlLGgpe2U9dGhpcy5hcGkoITApO251bGw9PT1ifHxiPT09az9lLnNlYXJjaChhLGMsZCxoKTplLmNvbHVtbihiKS5zZWFyY2goYSxjLGQsaCk7ZS5kcmF3KCl9O3RoaXMuZm5HZXREYXRhPWZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5hcGkoITApO2lmKGEhPT1rKXt2YXIgZD1hLm5vZGVOYW1lP2Eubm9kZU5hbWUudG9Mb3dlckNhc2UoKToiIjtyZXR1cm4gYiE9PWt8fCJ0ZCI9PWR8fCJ0aCI9PWQ/Yy5jZWxsKGEsYikuZGF0YSgpOmMucm93KGEpLmRhdGEoKXx8bnVsbH1yZXR1cm4gYy5kYXRhKCkudG9BcnJheSgpfTt0aGlzLmZuR2V0Tm9kZXM9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5hcGkoITApO3JldHVybiBhIT09az9iLnJvdyhhKS5ub2RlKCk6Yi5yb3dzKCkubm9kZXMoKS5mbGF0dGVuKCkudG9BcnJheSgpfTt0aGlzLmZuR2V0UG9zaXRpb249ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5hcGkoITApLGM9YS5ub2RlTmFtZS50b1VwcGVyQ2FzZSgpOw0KICAgICAgICAgICAgcmV0dXJuIlRSIj09Yz9iLnJvdyhhKS5pbmRleCgpOiJURCI9PWN8fCJUSCI9PWM/KGE9Yi5jZWxsKGEpLmluZGV4KCksW2Eucm93LGEuY29sdW1uVmlzaWJsZSxhLmNvbHVtbl0pOm51bGx9O3RoaXMuZm5Jc09wZW49ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuYXBpKCEwKS5yb3coYSkuY2hpbGQuaXNTaG93bigpfTt0aGlzLmZuT3Blbj1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHRoaXMuYXBpKCEwKS5yb3coYSkuY2hpbGQoYixjKS5zaG93KCkuY2hpbGQoKVswXX07dGhpcy5mblBhZ2VDaGFuZ2U9ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmFwaSghMCkucGFnZShhKTsoYj09PWt8fGIpJiZjLmRyYXcoITEpfTt0aGlzLmZuU2V0Q29sdW1uVmlzPWZ1bmN0aW9uKGEsYixjKXthPXRoaXMuYXBpKCEwKS5jb2x1bW4oYSkudmlzaWJsZShiKTsoYz09PWt8fGMpJiZhLmNvbHVtbnMuYWRqdXN0KCkuZHJhdygpfTt0aGlzLmZuU2V0dGluZ3M9ZnVuY3Rpb24oKXtyZXR1cm4geWEodGhpc1t4LmlBcGlJbmRleF0pfTsNCiAgICAgICAgdGhpcy5mblNvcnQ9ZnVuY3Rpb24oYSl7dGhpcy5hcGkoITApLm9yZGVyKGEpLmRyYXcoKX07dGhpcy5mblNvcnRMaXN0ZW5lcj1mdW5jdGlvbihhLGIsYyl7dGhpcy5hcGkoITApLm9yZGVyLmxpc3RlbmVyKGEsYixjKX07dGhpcy5mblVwZGF0ZT1mdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBoPXRoaXMuYXBpKCEwKTtjPT09a3x8bnVsbD09PWM/aC5yb3coYikuZGF0YShhKTpoLmNlbGwoYixjKS5kYXRhKGEpOyhlPT09a3x8ZSkmJmguY29sdW1ucy5hZGp1c3QoKTsoZD09PWt8fGQpJiZoLmRyYXcoKTtyZXR1cm4gMH07dGhpcy5mblZlcnNpb25DaGVjaz14LmZuVmVyc2lvbkNoZWNrO3ZhciBiPXRoaXMsYz1hPT09ayxkPXRoaXMubGVuZ3RoO2MmJihhPXt9KTt0aGlzLm9BcGk9dGhpcy5pbnRlcm5hbD14LmludGVybmFsO2Zvcih2YXIgZSBpbiBtLmV4dC5pbnRlcm5hbCllJiYodGhpc1tlXT1MYihlKSk7dGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGU9e30sZz0xPGQ/SmIoZSxhLCEwKToNCiAgICAgICAgICAgIGEsaj0wLGksZT10aGlzLmdldEF0dHJpYnV0ZSgiaWQiKSxuPSExLGw9bS5kZWZhdWx0cyxxPWgodGhpcyk7aWYoInRhYmxlIiE9dGhpcy5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpKUoobnVsbCwwLCJOb24tdGFibGUgbm9kZSBpbml0aWFsaXNhdGlvbiAoIit0aGlzLm5vZGVOYW1lKyIpIiwyKTtlbHNle2RiKGwpO2ViKGwuY29sdW1uKTtJKGwsbCwhMCk7SShsLmNvbHVtbixsLmNvbHVtbiwhMCk7SShsLGguZXh0ZW5kKGcscS5kYXRhKCkpKTt2YXIgdD1tLnNldHRpbmdzLGo9MDtmb3IoaT10Lmxlbmd0aDtqPGk7aisrKXt2YXIgbz10W2pdO2lmKG8ublRhYmxlPT10aGlzfHxvLm5USGVhZC5wYXJlbnROb2RlPT10aGlzfHxvLm5URm9vdCYmby5uVEZvb3QucGFyZW50Tm9kZT09dGhpcyl7dmFyIHM9Zy5iUmV0cmlldmUhPT1rP2cuYlJldHJpZXZlOmwuYlJldHJpZXZlO2lmKGN8fHMpcmV0dXJuIG8ub0luc3RhbmNlO2lmKGcuYkRlc3Ryb3khPT1rP2cuYkRlc3Ryb3k6bC5iRGVzdHJveSl7by5vSW5zdGFuY2UuZm5EZXN0cm95KCk7DQogICAgICAgICAgICBicmVha31lbHNle0oobywwLCJDYW5ub3QgcmVpbml0aWFsaXNlIERhdGFUYWJsZSIsMyk7cmV0dXJufX1pZihvLnNUYWJsZUlkPT10aGlzLmlkKXt0LnNwbGljZShqLDEpO2JyZWFrfX1pZihudWxsPT09ZXx8IiI9PT1lKXRoaXMuaWQ9ZT0iRGF0YVRhYmxlc19UYWJsZV8iK20uZXh0Ll91bmlxdWUrKzt2YXIgcD1oLmV4dGVuZCghMCx7fSxtLm1vZGVscy5vU2V0dGluZ3Mse3NEZXN0cm95V2lkdGg6cVswXS5zdHlsZS53aWR0aCxzSW5zdGFuY2U6ZSxzVGFibGVJZDplfSk7cC5uVGFibGU9dGhpcztwLm9BcGk9Yi5pbnRlcm5hbDtwLm9Jbml0PWc7dC5wdXNoKHApO3Aub0luc3RhbmNlPTE9PT1iLmxlbmd0aD9iOnEuZGF0YVRhYmxlKCk7ZGIoZyk7Zy5vTGFuZ3VhZ2UmJkNhKGcub0xhbmd1YWdlKTtnLmFMZW5ndGhNZW51JiYhZy5pRGlzcGxheUxlbmd0aCYmKGcuaURpc3BsYXlMZW5ndGg9aC5pc0FycmF5KGcuYUxlbmd0aE1lbnVbMF0pP2cuYUxlbmd0aE1lbnVbMF1bMF06Zy5hTGVuZ3RoTWVudVswXSk7DQogICAgICAgICAgICBnPUpiKGguZXh0ZW5kKCEwLHt9LGwpLGcpO0YocC5vRmVhdHVyZXMsZywiYlBhZ2luYXRlIGJMZW5ndGhDaGFuZ2UgYkZpbHRlciBiU29ydCBiU29ydE11bHRpIGJJbmZvIGJQcm9jZXNzaW5nIGJBdXRvV2lkdGggYlNvcnRDbGFzc2VzIGJTZXJ2ZXJTaWRlIGJEZWZlclJlbmRlciIuc3BsaXQoIiAiKSk7RihwLGcsWyJhc1N0cmlwZUNsYXNzZXMiLCJhamF4IiwiZm5TZXJ2ZXJEYXRhIiwiZm5Gb3JtYXROdW1iZXIiLCJzU2VydmVyTWV0aG9kIiwiYWFTb3J0aW5nIiwiYWFTb3J0aW5nRml4ZWQiLCJhTGVuZ3RoTWVudSIsInNQYWdpbmF0aW9uVHlwZSIsInNBamF4U291cmNlIiwic0FqYXhEYXRhUHJvcCIsImlTdGF0ZUR1cmF0aW9uIiwic0RvbSIsImJTb3J0Q2VsbHNUb3AiLCJpVGFiSW5kZXgiLCJmblN0YXRlTG9hZENhbGxiYWNrIiwiZm5TdGF0ZVNhdmVDYWxsYmFjayIsInJlbmRlcmVyIiwic2VhcmNoRGVsYXkiLCJyb3dJZCIsWyJpQ29va2llRHVyYXRpb24iLCJpU3RhdGVEdXJhdGlvbiJdLA0KICAgICAgICAgICAgICAgIFsib1NlYXJjaCIsIm9QcmV2aW91c1NlYXJjaCJdLFsiYW9TZWFyY2hDb2xzIiwiYW9QcmVTZWFyY2hDb2xzIl0sWyJpRGlzcGxheUxlbmd0aCIsIl9pRGlzcGxheUxlbmd0aCJdXSk7RihwLm9TY3JvbGwsZyxbWyJzU2Nyb2xsWCIsInNYIl0sWyJzU2Nyb2xsWElubmVyIiwic1hJbm5lciJdLFsic1Njcm9sbFkiLCJzWSJdLFsiYlNjcm9sbENvbGxhcHNlIiwiYkNvbGxhcHNlIl1dKTtGKHAub0xhbmd1YWdlLGcsImZuSW5mb0NhbGxiYWNrIik7eihwLCJhb0RyYXdDYWxsYmFjayIsZy5mbkRyYXdDYWxsYmFjaywidXNlciIpO3oocCwiYW9TZXJ2ZXJQYXJhbXMiLGcuZm5TZXJ2ZXJQYXJhbXMsInVzZXIiKTt6KHAsImFvU3RhdGVTYXZlUGFyYW1zIixnLmZuU3RhdGVTYXZlUGFyYW1zLCJ1c2VyIik7eihwLCJhb1N0YXRlTG9hZFBhcmFtcyIsZy5mblN0YXRlTG9hZFBhcmFtcywidXNlciIpO3oocCwiYW9TdGF0ZUxvYWRlZCIsZy5mblN0YXRlTG9hZGVkLCJ1c2VyIik7eihwLCJhb1Jvd0NhbGxiYWNrIiwNCiAgICAgICAgICAgICAgICBnLmZuUm93Q2FsbGJhY2ssInVzZXIiKTt6KHAsImFvUm93Q3JlYXRlZENhbGxiYWNrIixnLmZuQ3JlYXRlZFJvdywidXNlciIpO3oocCwiYW9IZWFkZXJDYWxsYmFjayIsZy5mbkhlYWRlckNhbGxiYWNrLCJ1c2VyIik7eihwLCJhb0Zvb3RlckNhbGxiYWNrIixnLmZuRm9vdGVyQ2FsbGJhY2ssInVzZXIiKTt6KHAsImFvSW5pdENvbXBsZXRlIixnLmZuSW5pdENvbXBsZXRlLCJ1c2VyIik7eihwLCJhb1ByZURyYXdDYWxsYmFjayIsZy5mblByZURyYXdDYWxsYmFjaywidXNlciIpO3Aucm93SWRGbj1RKGcucm93SWQpO2ZiKHApO3ZhciB1PXAub0NsYXNzZXM7aC5leHRlbmQodSxtLmV4dC5jbGFzc2VzLGcub0NsYXNzZXMpO3EuYWRkQ2xhc3ModS5zVGFibGUpO3AuaUluaXREaXNwbGF5U3RhcnQ9PT1rJiYocC5pSW5pdERpc3BsYXlTdGFydD1nLmlEaXNwbGF5U3RhcnQscC5faURpc3BsYXlTdGFydD1nLmlEaXNwbGF5U3RhcnQpO251bGwhPT1nLmlEZWZlckxvYWRpbmcmJihwLmJEZWZlckxvYWRpbmc9DQogICAgICAgICAgICAgICAgITAsZT1oLmlzQXJyYXkoZy5pRGVmZXJMb2FkaW5nKSxwLl9pUmVjb3Jkc0Rpc3BsYXk9ZT9nLmlEZWZlckxvYWRpbmdbMF06Zy5pRGVmZXJMb2FkaW5nLHAuX2lSZWNvcmRzVG90YWw9ZT9nLmlEZWZlckxvYWRpbmdbMV06Zy5pRGVmZXJMb2FkaW5nKTt2YXIgdj1wLm9MYW5ndWFnZTtoLmV4dGVuZCghMCx2LGcub0xhbmd1YWdlKTt2LnNVcmwmJihoLmFqYXgoe2RhdGFUeXBlOiJqc29uIix1cmw6di5zVXJsLHN1Y2Nlc3M6ZnVuY3Rpb24oYSl7Q2EoYSk7SShsLm9MYW5ndWFnZSxhKTtoLmV4dGVuZCh0cnVlLHYsYSk7Z2EocCl9LGVycm9yOmZ1bmN0aW9uKCl7Z2EocCl9fSksbj0hMCk7bnVsbD09PWcuYXNTdHJpcGVDbGFzc2VzJiYocC5hc1N0cmlwZUNsYXNzZXM9W3Uuc1N0cmlwZU9kZCx1LnNTdHJpcGVFdmVuXSk7dmFyIGU9cC5hc1N0cmlwZUNsYXNzZXMseD1xLmNoaWxkcmVuKCJ0Ym9keSIpLmZpbmQoInRyIikuZXEoMCk7LTEhPT1oLmluQXJyYXkoITAsaC5tYXAoZSxmdW5jdGlvbihhKXtyZXR1cm4geC5oYXNDbGFzcyhhKX0pKSYmDQogICAgICAgICAgICAoaCgidGJvZHkgdHIiLHRoaXMpLnJlbW92ZUNsYXNzKGUuam9pbigiICIpKSxwLmFzRGVzdHJveVN0cmlwZXM9ZS5zbGljZSgpKTtlPVtdO3Q9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZSgidGhlYWQiKTswIT09dC5sZW5ndGgmJihkYShwLmFvSGVhZGVyLHRbMF0pLGU9cmEocCkpO2lmKG51bGw9PT1nLmFvQ29sdW1ucyl7dD1bXTtqPTA7Zm9yKGk9ZS5sZW5ndGg7ajxpO2orKyl0LnB1c2gobnVsbCl9ZWxzZSB0PWcuYW9Db2x1bW5zO2o9MDtmb3IoaT10Lmxlbmd0aDtqPGk7aisrKURhKHAsZT9lW2pdOm51bGwpO2hiKHAsZy5hb0NvbHVtbkRlZnMsdCxmdW5jdGlvbihhLGIpe2phKHAsYSxiKX0pO2lmKHgubGVuZ3RoKXt2YXIgdz1mdW5jdGlvbihhLGIpe3JldHVybiBhLmdldEF0dHJpYnV0ZSgiZGF0YS0iK2IpIT09bnVsbD9iOm51bGx9O2goeFswXSkuY2hpbGRyZW4oInRoLCB0ZCIpLmVhY2goZnVuY3Rpb24oYSxiKXt2YXIgYz1wLmFvQ29sdW1uc1thXTtpZihjLm1EYXRhPT09DQogICAgICAgICAgICAgICAgYSl7dmFyIGQ9dyhiLCJzb3J0Iil8fHcoYiwib3JkZXIiKSxlPXcoYiwiZmlsdGVyIil8fHcoYiwic2VhcmNoIik7aWYoZCE9PW51bGx8fGUhPT1udWxsKXtjLm1EYXRhPXtfOmErIi5kaXNwbGF5Iixzb3J0OmQhPT1udWxsP2ErIi5AZGF0YS0iK2Q6ayx0eXBlOmQhPT1udWxsP2ErIi5AZGF0YS0iK2Q6ayxmaWx0ZXI6ZSE9PW51bGw/YSsiLkBkYXRhLSIrZTprfTtqYShwLGEpfX19KX12YXIgVD1wLm9GZWF0dXJlcyxlPWZ1bmN0aW9uKCl7aWYoZy5hYVNvcnRpbmc9PT1rKXt2YXIgYT1wLmFhU29ydGluZztqPTA7Zm9yKGk9YS5sZW5ndGg7ajxpO2orKylhW2pdWzFdPXAuYW9Db2x1bW5zW2pdLmFzU29ydGluZ1swXX13YShwKTtULmJTb3J0JiZ6KHAsImFvRHJhd0NhbGxiYWNrIixmdW5jdGlvbigpe2lmKHAuYlNvcnRlZCl7dmFyIGE9VihwKSxiPXt9O2guZWFjaChhLGZ1bmN0aW9uKGEsYyl7YltjLnNyY109Yy5kaXJ9KTtyKHAsbnVsbCwib3JkZXIiLFtwLGEsYl0pO0hiKHApfX0pOw0KICAgICAgICAgICAgICAgIHoocCwiYW9EcmF3Q2FsbGJhY2siLGZ1bmN0aW9uKCl7KHAuYlNvcnRlZHx8eShwKT09PSJzc3AifHxULmJEZWZlclJlbmRlcikmJndhKHApfSwic2MiKTt2YXIgYT1xLmNoaWxkcmVuKCJjYXB0aW9uIikuZWFjaChmdW5jdGlvbigpe3RoaXMuX2NhcHRpb25TaWRlPWgodGhpcykuY3NzKCJjYXB0aW9uLXNpZGUiKX0pLGI9cS5jaGlsZHJlbigidGhlYWQiKTtiLmxlbmd0aD09PTAmJihiPWgoIjx0aGVhZC8+IikuYXBwZW5kVG8ocSkpO3AublRIZWFkPWJbMF07Yj1xLmNoaWxkcmVuKCJ0Ym9keSIpO2IubGVuZ3RoPT09MCYmKGI9aCgiPHRib2R5Lz4iKS5hcHBlbmRUbyhxKSk7cC5uVEJvZHk9YlswXTtiPXEuY2hpbGRyZW4oInRmb290Iik7aWYoYi5sZW5ndGg9PT0wJiZhLmxlbmd0aD4wJiYocC5vU2Nyb2xsLnNYIT09IiJ8fHAub1Njcm9sbC5zWSE9PSIiKSliPWgoIjx0Zm9vdC8+IikuYXBwZW5kVG8ocSk7aWYoYi5sZW5ndGg9PT0wfHxiLmNoaWxkcmVuKCkubGVuZ3RoPT09MClxLmFkZENsYXNzKHUuc05vRm9vdGVyKTsNCiAgICAgICAgICAgICAgICBlbHNlIGlmKGIubGVuZ3RoPjApe3AublRGb290PWJbMF07ZGEocC5hb0Zvb3RlcixwLm5URm9vdCl9aWYoZy5hYURhdGEpZm9yKGo9MDtqPGcuYWFEYXRhLmxlbmd0aDtqKyspTShwLGcuYWFEYXRhW2pdKTtlbHNlKHAuYkRlZmVyTG9hZGluZ3x8eShwKT09ImRvbSIpJiZtYShwLGgocC5uVEJvZHkpLmNoaWxkcmVuKCJ0ciIpKTtwLmFpRGlzcGxheT1wLmFpRGlzcGxheU1hc3Rlci5zbGljZSgpO3AuYkluaXRpYWxpc2VkPXRydWU7bj09PWZhbHNlJiZnYShwKX07Zy5iU3RhdGVTYXZlPyhULmJTdGF0ZVNhdmU9ITAseihwLCJhb0RyYXdDYWxsYmFjayIseGEsInN0YXRlX3NhdmUiKSxJYihwLGcsZSkpOmUoKX19KTtiPW51bGw7cmV0dXJuIHRoaXN9LHgscyxvLHUsWGE9e30sTWI9L1tcclxuXS9nLEFhPS88Lio/Pi9nLFpiPS9eXGR7Miw0fVtcLlwvXC1dXGR7MSwyfVtcLlwvXC1dXGR7MSwyfShbVCBdezF9XGR7MSwyfVs6XC5dXGR7Mn0oW1wuOl1cZHsyfSk/KT8kLywkYj1SZWdFeHAoIihcXC98XFwufFxcKnxcXCt8XFw/fFxcfHxcXCh8XFwpfFxcW3xcXF18XFx7fFxcfXxcXFxcfFxcJHxcXF58XFwtKSIsDQogICAgICAgICJnIiksV2E9L1snLCTCo+KCrMKlJVx1MjAwOVx1MjAyRlx1MjBCRFx1MjBhOVx1MjBCQXJma10vZ2ksTD1mdW5jdGlvbihhKXtyZXR1cm4hYXx8ITA9PT1hfHwiLSI9PT1hPyEwOiExfSxOYj1mdW5jdGlvbihhKXt2YXIgYj1wYXJzZUludChhLDEwKTtyZXR1cm4haXNOYU4oYikmJmlzRmluaXRlKGEpP2I6bnVsbH0sT2I9ZnVuY3Rpb24oYSxiKXtYYVtiXXx8KFhhW2JdPVJlZ0V4cChQYShiKSwiZyIpKTtyZXR1cm4ic3RyaW5nIj09PXR5cGVvZiBhJiYiLiIhPT1iP2EucmVwbGFjZSgvXC4vZywiIikucmVwbGFjZShYYVtiXSwiLiIpOmF9LFlhPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD0ic3RyaW5nIj09PXR5cGVvZiBhO2lmKEwoYSkpcmV0dXJuITA7YiYmZCYmKGE9T2IoYSxiKSk7YyYmZCYmKGE9YS5yZXBsYWNlKFdhLCIiKSk7cmV0dXJuIWlzTmFOKHBhcnNlRmxvYXQoYSkpJiZpc0Zpbml0ZShhKX0sUGI9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBMKGEpPyEwOiEoTChhKXx8InN0cmluZyI9PT0NCiAgICAgICAgdHlwZW9mIGEpP251bGw6WWEoYS5yZXBsYWNlKEFhLCIiKSxiLGMpPyEwOm51bGx9LEQ9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPVtdLGU9MCxmPWEubGVuZ3RoO2lmKGMhPT1rKWZvcig7ZTxmO2UrKylhW2VdJiZhW2VdW2JdJiZkLnB1c2goYVtlXVtiXVtjXSk7ZWxzZSBmb3IoO2U8ZjtlKyspYVtlXSYmZC5wdXNoKGFbZV1bYl0pO3JldHVybiBkfSxpYT1mdW5jdGlvbihhLGIsYyxkKXt2YXIgZT1bXSxmPTAsZz1iLmxlbmd0aDtpZihkIT09aylmb3IoO2Y8ZztmKyspYVtiW2ZdXVtjXSYmZS5wdXNoKGFbYltmXV1bY11bZF0pO2Vsc2UgZm9yKDtmPGc7ZisrKWUucHVzaChhW2JbZl1dW2NdKTtyZXR1cm4gZX0sVz1mdW5jdGlvbihhLGIpe3ZhciBjPVtdLGQ7Yj09PWs/KGI9MCxkPWEpOihkPWIsYj1hKTtmb3IodmFyIGU9YjtlPGQ7ZSsrKWMucHVzaChlKTtyZXR1cm4gY30sUWI9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPVtdLGM9MCxkPWEubGVuZ3RoO2M8ZDtjKyspYVtjXSYmYi5wdXNoKGFbY10pOw0KICAgICAgICByZXR1cm4gYn0scWE9ZnVuY3Rpb24oYSl7dmFyIGI7YTp7aWYoISgyPmEubGVuZ3RoKSl7Yj1hLnNsaWNlKCkuc29ydCgpO2Zvcih2YXIgYz1iWzBdLGQ9MSxlPWIubGVuZ3RoO2Q8ZTtkKyspe2lmKGJbZF09PT1jKXtiPSExO2JyZWFrIGF9Yz1iW2RdfX1iPSEwfWlmKGIpcmV0dXJuIGEuc2xpY2UoKTtiPVtdO3ZhciBlPWEubGVuZ3RoLGYsZz0wLGQ9MDthOmZvcig7ZDxlO2QrKyl7Yz1hW2RdO2ZvcihmPTA7ZjxnO2YrKylpZihiW2ZdPT09Yyljb250aW51ZSBhO2IucHVzaChjKTtnKyt9cmV0dXJuIGJ9O20udXRpbD17dGhyb3R0bGU6ZnVuY3Rpb24oYSxiKXt2YXIgYz1iIT09az9iOjIwMCxkLGU7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGI9dGhpcyxnPStuZXcgRGF0ZSxqPWFyZ3VtZW50cztkJiZnPGQrYz8oY2xlYXJUaW1lb3V0KGUpLGU9c2V0VGltZW91dChmdW5jdGlvbigpe2Q9azthLmFwcGx5KGIsail9LGMpKTooZD1nLGEuYXBwbHkoYixqKSl9fSxlc2NhcGVSZWdleDpmdW5jdGlvbihhKXtyZXR1cm4gYS5yZXBsYWNlKCRiLA0KICAgICAgICAiXFwkMSIpfX07dmFyIEE9ZnVuY3Rpb24oYSxiLGMpe2FbYl0hPT1rJiYoYVtjXT1hW2JdKX0sYmE9L1xbLio/XF0kLyxVPS9cKFwpJC8sUGE9bS51dGlsLmVzY2FwZVJlZ2V4LHZhPWgoIjxkaXY+IilbMF0sV2I9dmEudGV4dENvbnRlbnQhPT1rLFliPS88Lio/Pi9nLE5hPW0udXRpbC50aHJvdHRsZSxSYj1bXSx3PUFycmF5LnByb3RvdHlwZSxhYz1mdW5jdGlvbihhKXt2YXIgYixjLGQ9bS5zZXR0aW5ncyxlPWgubWFwKGQsZnVuY3Rpb24oYSl7cmV0dXJuIGEublRhYmxlfSk7aWYoYSl7aWYoYS5uVGFibGUmJmEub0FwaSlyZXR1cm5bYV07aWYoYS5ub2RlTmFtZSYmInRhYmxlIj09PWEubm9kZU5hbWUudG9Mb3dlckNhc2UoKSlyZXR1cm4gYj1oLmluQXJyYXkoYSxlKSwtMSE9PWI/W2RbYl1dOm51bGw7aWYoYSYmImZ1bmN0aW9uIj09PXR5cGVvZiBhLnNldHRpbmdzKXJldHVybiBhLnNldHRpbmdzKCkudG9BcnJheSgpOyJzdHJpbmciPT09dHlwZW9mIGE/Yz1oKGEpOmEgaW5zdGFuY2VvZg0KICAgICAgICBoJiYoYz1hKX1lbHNlIHJldHVybltdO2lmKGMpcmV0dXJuIGMubWFwKGZ1bmN0aW9uKCl7Yj1oLmluQXJyYXkodGhpcyxlKTtyZXR1cm4tMSE9PWI/ZFtiXTpudWxsfSkudG9BcnJheSgpfTtzPWZ1bmN0aW9uKGEsYil7aWYoISh0aGlzIGluc3RhbmNlb2YgcykpcmV0dXJuIG5ldyBzKGEsYik7dmFyIGM9W10sZD1mdW5jdGlvbihhKXsoYT1hYyhhKSkmJihjPWMuY29uY2F0KGEpKX07aWYoaC5pc0FycmF5KGEpKWZvcih2YXIgZT0wLGY9YS5sZW5ndGg7ZTxmO2UrKylkKGFbZV0pO2Vsc2UgZChhKTt0aGlzLmNvbnRleHQ9cWEoYyk7YiYmaC5tZXJnZSh0aGlzLGIpO3RoaXMuc2VsZWN0b3I9e3Jvd3M6bnVsbCxjb2xzOm51bGwsb3B0czpudWxsfTtzLmV4dGVuZCh0aGlzLHRoaXMsUmIpfTttLkFwaT1zO2guZXh0ZW5kKHMucHJvdG90eXBlLHthbnk6ZnVuY3Rpb24oKXtyZXR1cm4gMCE9PXRoaXMuY291bnQoKX0sY29uY2F0OncuY29uY2F0LGNvbnRleHQ6W10sY291bnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5mbGF0dGVuKCkubGVuZ3RofSwNCiAgICAgICAgZWFjaDpmdW5jdGlvbihhKXtmb3IodmFyIGI9MCxjPXRoaXMubGVuZ3RoO2I8YztiKyspYS5jYWxsKHRoaXMsdGhpc1tiXSxiLHRoaXMpO3JldHVybiB0aGlzfSxlcTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNvbnRleHQ7cmV0dXJuIGIubGVuZ3RoPmE/bmV3IHMoYlthXSx0aGlzW2FdKTpudWxsfSxmaWx0ZXI6ZnVuY3Rpb24oYSl7dmFyIGI9W107aWYody5maWx0ZXIpYj13LmZpbHRlci5jYWxsKHRoaXMsYSx0aGlzKTtlbHNlIGZvcih2YXIgYz0wLGQ9dGhpcy5sZW5ndGg7YzxkO2MrKylhLmNhbGwodGhpcyx0aGlzW2NdLGMsdGhpcykmJmIucHVzaCh0aGlzW2NdKTtyZXR1cm4gbmV3IHModGhpcy5jb250ZXh0LGIpfSxmbGF0dGVuOmZ1bmN0aW9uKCl7dmFyIGE9W107cmV0dXJuIG5ldyBzKHRoaXMuY29udGV4dCxhLmNvbmNhdC5hcHBseShhLHRoaXMudG9BcnJheSgpKSl9LGpvaW46dy5qb2luLGluZGV4T2Y6dy5pbmRleE9mfHxmdW5jdGlvbihhLGIpe2Zvcih2YXIgYz1ifHwwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkPXRoaXMubGVuZ3RoO2M8ZDtjKyspaWYodGhpc1tjXT09PWEpcmV0dXJuIGM7cmV0dXJuLTF9LGl0ZXJhdG9yOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPVtdLGYsZyxqLGgsbixsPXRoaXMuY29udGV4dCxtLG8sdT10aGlzLnNlbGVjdG9yOyJzdHJpbmciPT09dHlwZW9mIGEmJihkPWMsYz1iLGI9YSxhPSExKTtnPTA7Zm9yKGo9bC5sZW5ndGg7ZzxqO2crKyl7dmFyIHI9bmV3IHMobFtnXSk7aWYoInRhYmxlIj09PWIpZj1jLmNhbGwocixsW2ddLGcpLGYhPT1rJiZlLnB1c2goZik7ZWxzZSBpZigiY29sdW1ucyI9PT1ifHwicm93cyI9PT1iKWY9Yy5jYWxsKHIsbFtnXSx0aGlzW2ddLGcpLGYhPT1rJiZlLnB1c2goZik7ZWxzZSBpZigiY29sdW1uIj09PWJ8fCJjb2x1bW4tcm93cyI9PT1ifHwicm93Ij09PWJ8fCJjZWxsIj09PWIpe289dGhpc1tnXTsiY29sdW1uLXJvd3MiPT09YiYmKG09QmEobFtnXSx1Lm9wdHMpKTtoPTA7Zm9yKG49by5sZW5ndGg7aDxuO2grKylmPW9baF0sZj0NCiAgICAgICAgICAgICJjZWxsIj09PWI/Yy5jYWxsKHIsbFtnXSxmLnJvdyxmLmNvbHVtbixnLGgpOmMuY2FsbChyLGxbZ10sZixnLGgsbSksZiE9PWsmJmUucHVzaChmKX19cmV0dXJuIGUubGVuZ3RofHxkPyhhPW5ldyBzKGwsYT9lLmNvbmNhdC5hcHBseShbXSxlKTplKSxiPWEuc2VsZWN0b3IsYi5yb3dzPXUucm93cyxiLmNvbHM9dS5jb2xzLGIub3B0cz11Lm9wdHMsYSk6dGhpc30sbGFzdEluZGV4T2Y6dy5sYXN0SW5kZXhPZnx8ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5pbmRleE9mLmFwcGx5KHRoaXMudG9BcnJheS5yZXZlcnNlKCksYXJndW1lbnRzKX0sbGVuZ3RoOjAsbWFwOmZ1bmN0aW9uKGEpe3ZhciBiPVtdO2lmKHcubWFwKWI9dy5tYXAuY2FsbCh0aGlzLGEsdGhpcyk7ZWxzZSBmb3IodmFyIGM9MCxkPXRoaXMubGVuZ3RoO2M8ZDtjKyspYi5wdXNoKGEuY2FsbCh0aGlzLHRoaXNbY10sYykpO3JldHVybiBuZXcgcyh0aGlzLmNvbnRleHQsYil9LHBsdWNrOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLm1hcChmdW5jdGlvbihiKXtyZXR1cm4gYlthXX0pfSwNCiAgICAgICAgcG9wOncucG9wLHB1c2g6dy5wdXNoLHJlZHVjZTp3LnJlZHVjZXx8ZnVuY3Rpb24oYSxiKXtyZXR1cm4gZ2IodGhpcyxhLGIsMCx0aGlzLmxlbmd0aCwxKX0scmVkdWNlUmlnaHQ6dy5yZWR1Y2VSaWdodHx8ZnVuY3Rpb24oYSxiKXtyZXR1cm4gZ2IodGhpcyxhLGIsdGhpcy5sZW5ndGgtMSwtMSwtMSl9LHJldmVyc2U6dy5yZXZlcnNlLHNlbGVjdG9yOm51bGwsc2hpZnQ6dy5zaGlmdCxzbGljZTpmdW5jdGlvbigpe3JldHVybiBuZXcgcyh0aGlzLmNvbnRleHQsdGhpcyl9LHNvcnQ6dy5zb3J0LHNwbGljZTp3LnNwbGljZSx0b0FycmF5OmZ1bmN0aW9uKCl7cmV0dXJuIHcuc2xpY2UuY2FsbCh0aGlzKX0sdG8kOmZ1bmN0aW9uKCl7cmV0dXJuIGgodGhpcyl9LHRvSlF1ZXJ5OmZ1bmN0aW9uKCl7cmV0dXJuIGgodGhpcyl9LHVuaXF1ZTpmdW5jdGlvbigpe3JldHVybiBuZXcgcyh0aGlzLmNvbnRleHQscWEodGhpcykpfSx1bnNoaWZ0OncudW5zaGlmdH0pO3MuZXh0ZW5kPWZ1bmN0aW9uKGEsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLGMpe2lmKGMubGVuZ3RoJiZiJiYoYiBpbnN0YW5jZW9mIHN8fGIuX19kdF93cmFwcGVyKSl7dmFyIGQsZSxmLGc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBmdW5jdGlvbigpe3ZhciBkPWIuYXBwbHkoYSxhcmd1bWVudHMpO3MuZXh0ZW5kKGQsZCxjLm1ldGhvZEV4dCk7cmV0dXJuIGR9fTtkPTA7Zm9yKGU9Yy5sZW5ndGg7ZDxlO2QrKylmPWNbZF0sYltmLm5hbWVdPSJmdW5jdGlvbiI9PT10eXBlb2YgZi52YWw/ZyhhLGYudmFsLGYpOmguaXNQbGFpbk9iamVjdChmLnZhbCk/e306Zi52YWwsYltmLm5hbWVdLl9fZHRfd3JhcHBlcj0hMCxzLmV4dGVuZChhLGJbZi5uYW1lXSxmLnByb3BFeHQpfX07cy5yZWdpc3Rlcj1vPWZ1bmN0aW9uKGEsYil7aWYoaC5pc0FycmF5KGEpKWZvcih2YXIgYz0wLGQ9YS5sZW5ndGg7YzxkO2MrKylzLnJlZ2lzdGVyKGFbY10sYik7ZWxzZSBmb3IodmFyIGU9YS5zcGxpdCgiLiIpLGY9UmIsZyxqLGM9MCxkPWUubGVuZ3RoO2M8ZDtjKyspe2c9KGo9LTEhPT0NCiAgICAgICAgZVtjXS5pbmRleE9mKCIoKSIpKT9lW2NdLnJlcGxhY2UoIigpIiwiIik6ZVtjXTt2YXIgaTthOntpPTA7Zm9yKHZhciBuPWYubGVuZ3RoO2k8bjtpKyspaWYoZltpXS5uYW1lPT09Zyl7aT1mW2ldO2JyZWFrIGF9aT1udWxsfWl8fChpPXtuYW1lOmcsdmFsOnt9LG1ldGhvZEV4dDpbXSxwcm9wRXh0OltdfSxmLnB1c2goaSkpO2M9PT1kLTE/aS52YWw9YjpmPWo/aS5tZXRob2RFeHQ6aS5wcm9wRXh0fX07cy5yZWdpc3RlclBsdXJhbD11PWZ1bmN0aW9uKGEsYixjKXtzLnJlZ2lzdGVyKGEsYyk7cy5yZWdpc3RlcihiLGZ1bmN0aW9uKCl7dmFyIGE9Yy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuIGE9PT10aGlzP3RoaXM6YSBpbnN0YW5jZW9mIHM/YS5sZW5ndGg/aC5pc0FycmF5KGFbMF0pP25ldyBzKGEuY29udGV4dCxhWzBdKTphWzBdOms6YX0pfTtvKCJ0YWJsZXMoKSIsZnVuY3Rpb24oYSl7dmFyIGI7aWYoYSl7Yj1zO3ZhciBjPXRoaXMuY29udGV4dDtpZigibnVtYmVyIj09PQ0KICAgICAgICB0eXBlb2YgYSlhPVtjW2FdXTtlbHNlIHZhciBkPWgubWFwKGMsZnVuY3Rpb24oYSl7cmV0dXJuIGEublRhYmxlfSksYT1oKGQpLmZpbHRlcihhKS5tYXAoZnVuY3Rpb24oKXt2YXIgYT1oLmluQXJyYXkodGhpcyxkKTtyZXR1cm4gY1thXX0pLnRvQXJyYXkoKTtiPW5ldyBiKGEpfWVsc2UgYj10aGlzO3JldHVybiBifSk7bygidGFibGUoKSIsZnVuY3Rpb24oYSl7dmFyIGE9dGhpcy50YWJsZXMoYSksYj1hLmNvbnRleHQ7cmV0dXJuIGIubGVuZ3RoP25ldyBzKGJbMF0pOmF9KTt1KCJ0YWJsZXMoKS5ub2RlcygpIiwidGFibGUoKS5ub2RlKCkiLGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXRlcmF0b3IoInRhYmxlIixmdW5jdGlvbihhKXtyZXR1cm4gYS5uVGFibGV9LDEpfSk7dSgidGFibGVzKCkuYm9keSgpIiwidGFibGUoKS5ib2R5KCkiLGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXRlcmF0b3IoInRhYmxlIixmdW5jdGlvbihhKXtyZXR1cm4gYS5uVEJvZHl9LDEpfSk7dSgidGFibGVzKCkuaGVhZGVyKCkiLA0KICAgICAgICAidGFibGUoKS5oZWFkZXIoKSIsZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pdGVyYXRvcigidGFibGUiLGZ1bmN0aW9uKGEpe3JldHVybiBhLm5USGVhZH0sMSl9KTt1KCJ0YWJsZXMoKS5mb290ZXIoKSIsInRhYmxlKCkuZm9vdGVyKCkiLGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXRlcmF0b3IoInRhYmxlIixmdW5jdGlvbihhKXtyZXR1cm4gYS5uVEZvb3R9LDEpfSk7dSgidGFibGVzKCkuY29udGFpbmVycygpIiwidGFibGUoKS5jb250YWluZXIoKSIsZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pdGVyYXRvcigidGFibGUiLGZ1bmN0aW9uKGEpe3JldHVybiBhLm5UYWJsZVdyYXBwZXJ9LDEpfSk7bygiZHJhdygpIixmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5pdGVyYXRvcigidGFibGUiLGZ1bmN0aW9uKGIpeyJwYWdlIj09PWE/TihiKTooInN0cmluZyI9PT10eXBlb2YgYSYmKGE9ImZ1bGwtaG9sZCI9PT1hPyExOiEwKSxTKGIsITE9PT1hKSl9KX0pO28oInBhZ2UoKSIsZnVuY3Rpb24oYSl7cmV0dXJuIGE9PT0NCiAgICBrP3RoaXMucGFnZS5pbmZvKCkucGFnZTp0aGlzLml0ZXJhdG9yKCJ0YWJsZSIsZnVuY3Rpb24oYil7U2EoYixhKX0pfSk7bygicGFnZS5pbmZvKCkiLGZ1bmN0aW9uKCl7aWYoMD09PXRoaXMuY29udGV4dC5sZW5ndGgpcmV0dXJuIGs7dmFyIGE9dGhpcy5jb250ZXh0WzBdLGI9YS5faURpc3BsYXlTdGFydCxjPWEub0ZlYXR1cmVzLmJQYWdpbmF0ZT9hLl9pRGlzcGxheUxlbmd0aDotMSxkPWEuZm5SZWNvcmRzRGlzcGxheSgpLGU9LTE9PT1jO3JldHVybntwYWdlOmU/MDpNYXRoLmZsb29yKGIvYykscGFnZXM6ZT8xOk1hdGguY2VpbChkL2MpLHN0YXJ0OmIsZW5kOmEuZm5EaXNwbGF5RW5kKCksbGVuZ3RoOmMscmVjb3Jkc1RvdGFsOmEuZm5SZWNvcmRzVG90YWwoKSxyZWNvcmRzRGlzcGxheTpkLHNlcnZlclNpZGU6InNzcCI9PT15KGEpfX0pO28oInBhZ2UubGVuKCkiLGZ1bmN0aW9uKGEpe3JldHVybiBhPT09az8wIT09dGhpcy5jb250ZXh0Lmxlbmd0aD90aGlzLmNvbnRleHRbMF0uX2lEaXNwbGF5TGVuZ3RoOg0KICAgICAgICBrOnRoaXMuaXRlcmF0b3IoInRhYmxlIixmdW5jdGlvbihiKXtRYShiLGEpfSl9KTt2YXIgU2I9ZnVuY3Rpb24oYSxiLGMpe2lmKGMpe3ZhciBkPW5ldyBzKGEpO2Qub25lKCJkcmF3IixmdW5jdGlvbigpe2MoZC5hamF4Lmpzb24oKSl9KX1pZigic3NwIj09eShhKSlTKGEsYik7ZWxzZXtDKGEsITApO3ZhciBlPWEuanFYSFI7ZSYmNCE9PWUucmVhZHlTdGF0ZSYmZS5hYm9ydCgpO3NhKGEsW10sZnVuY3Rpb24oYyl7bmEoYSk7Zm9yKHZhciBjPXRhKGEsYyksZD0wLGU9Yy5sZW5ndGg7ZDxlO2QrKylNKGEsY1tkXSk7UyhhLGIpO0MoYSwhMSl9KX19O28oImFqYXguanNvbigpIixmdW5jdGlvbigpe3ZhciBhPXRoaXMuY29udGV4dDtpZigwPGEubGVuZ3RoKXJldHVybiBhWzBdLmpzb259KTtvKCJhamF4LnBhcmFtcygpIixmdW5jdGlvbigpe3ZhciBhPXRoaXMuY29udGV4dDtpZigwPGEubGVuZ3RoKXJldHVybiBhWzBdLm9BamF4RGF0YX0pO28oImFqYXgucmVsb2FkKCkiLGZ1bmN0aW9uKGEsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYil7cmV0dXJuIHRoaXMuaXRlcmF0b3IoInRhYmxlIixmdW5jdGlvbihjKXtTYihjLCExPT09YixhKX0pfSk7bygiYWpheC51cmwoKSIsZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jb250ZXh0O2lmKGE9PT1rKXtpZigwPT09Yi5sZW5ndGgpcmV0dXJuIGs7Yj1iWzBdO3JldHVybiBiLmFqYXg/aC5pc1BsYWluT2JqZWN0KGIuYWpheCk/Yi5hamF4LnVybDpiLmFqYXg6Yi5zQWpheFNvdXJjZX1yZXR1cm4gdGhpcy5pdGVyYXRvcigidGFibGUiLGZ1bmN0aW9uKGIpe2guaXNQbGFpbk9iamVjdChiLmFqYXgpP2IuYWpheC51cmw9YTpiLmFqYXg9YX0pfSk7bygiYWpheC51cmwoKS5sb2FkKCkiLGZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuaXRlcmF0b3IoInRhYmxlIixmdW5jdGlvbihjKXtTYihjLCExPT09YixhKX0pfSk7dmFyIFphPWZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9W10sZyxqLGksbixsLG07aT10eXBlb2YgYjtpZighYnx8InN0cmluZyI9PT1pfHwiZnVuY3Rpb24iPT09DQogICAgICAgIGl8fGIubGVuZ3RoPT09ayliPVtiXTtpPTA7Zm9yKG49Yi5sZW5ndGg7aTxuO2krKyl7aj1iW2ldJiZiW2ldLnNwbGl0JiYhYltpXS5tYXRjaCgvW1xbXCg6XS8pP2JbaV0uc3BsaXQoIiwiKTpbYltpXV07bD0wO2ZvcihtPWoubGVuZ3RoO2w8bTtsKyspKGc9Yygic3RyaW5nIj09PXR5cGVvZiBqW2xdP2gudHJpbShqW2xdKTpqW2xdKSkmJmcubGVuZ3RoJiYoZj1mLmNvbmNhdChnKSl9YT14LnNlbGVjdG9yW2FdO2lmKGEubGVuZ3RoKXtpPTA7Zm9yKG49YS5sZW5ndGg7aTxuO2krKylmPWFbaV0oZCxlLGYpfXJldHVybiBxYShmKX0sJGE9ZnVuY3Rpb24oYSl7YXx8KGE9e30pO2EuZmlsdGVyJiZhLnNlYXJjaD09PWsmJihhLnNlYXJjaD1hLmZpbHRlcik7cmV0dXJuIGguZXh0ZW5kKHtzZWFyY2g6Im5vbmUiLG9yZGVyOiJjdXJyZW50IixwYWdlOiJhbGwifSxhKX0sYWI9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPTAsYz1hLmxlbmd0aDtiPGM7YisrKWlmKDA8YVtiXS5sZW5ndGgpcmV0dXJuIGFbMF09DQogICAgICAgIGFbYl0sYVswXS5sZW5ndGg9MSxhLmxlbmd0aD0xLGEuY29udGV4dD1bYS5jb250ZXh0W2JdXSxhO2EubGVuZ3RoPTA7cmV0dXJuIGF9LEJhPWZ1bmN0aW9uKGEsYil7dmFyIGMsZCxlLGY9W10sZz1hLmFpRGlzcGxheTtjPWEuYWlEaXNwbGF5TWFzdGVyO3ZhciBqPWIuc2VhcmNoO2Q9Yi5vcmRlcjtlPWIucGFnZTtpZigic3NwIj09eShhKSlyZXR1cm4icmVtb3ZlZCI9PT1qP1tdOlcoMCxjLmxlbmd0aCk7aWYoImN1cnJlbnQiPT1lKXtjPWEuX2lEaXNwbGF5U3RhcnQ7Zm9yKGQ9YS5mbkRpc3BsYXlFbmQoKTtjPGQ7YysrKWYucHVzaChnW2NdKX1lbHNlIGlmKCJjdXJyZW50Ij09ZHx8ImFwcGxpZWQiPT1kKWY9Im5vbmUiPT1qP2Muc2xpY2UoKToiYXBwbGllZCI9PWo/Zy5zbGljZSgpOmgubWFwKGMsZnVuY3Rpb24oYSl7cmV0dXJuLTE9PT1oLmluQXJyYXkoYSxnKT9hOm51bGx9KTtlbHNlIGlmKCJpbmRleCI9PWR8fCJvcmlnaW5hbCI9PWQpe2M9MDtmb3IoZD1hLmFvRGF0YS5sZW5ndGg7YzwNCiAgICBkO2MrKykibm9uZSI9PWo/Zi5wdXNoKGMpOihlPWguaW5BcnJheShjLGcpLCgtMT09PWUmJiJyZW1vdmVkIj09anx8MDw9ZSYmImFwcGxpZWQiPT1qKSYmZi5wdXNoKGMpKX1yZXR1cm4gZn07bygicm93cygpIixmdW5jdGlvbihhLGIpe2E9PT1rP2E9IiI6aC5pc1BsYWluT2JqZWN0KGEpJiYoYj1hLGE9IiIpO3ZhciBiPSRhKGIpLGM9dGhpcy5pdGVyYXRvcigidGFibGUiLGZ1bmN0aW9uKGMpe3ZhciBlPWIsZjtyZXR1cm4gWmEoInJvdyIsYSxmdW5jdGlvbihhKXt2YXIgYj1OYihhKTtpZihiIT09bnVsbCYmIWUpcmV0dXJuW2JdO2Z8fChmPUJhKGMsZSkpO2lmKGIhPT1udWxsJiZoLmluQXJyYXkoYixmKSE9PS0xKXJldHVybltiXTtpZihhPT09bnVsbHx8YT09PWt8fGE9PT0iIilyZXR1cm4gZjtpZih0eXBlb2YgYT09PSJmdW5jdGlvbiIpcmV0dXJuIGgubWFwKGYsZnVuY3Rpb24oYil7dmFyIGU9Yy5hb0RhdGFbYl07cmV0dXJuIGEoYixlLl9hRGF0YSxlLm5Ucik/YjpudWxsfSk7DQogICAgICAgIGI9UWIoaWEoYy5hb0RhdGEsZiwiblRyIikpO2lmKGEubm9kZU5hbWUpe2lmKGEuX0RUX1Jvd0luZGV4IT09aylyZXR1cm5bYS5fRFRfUm93SW5kZXhdO2lmKGEuX0RUX0NlbGxJbmRleClyZXR1cm5bYS5fRFRfQ2VsbEluZGV4LnJvd107Yj1oKGEpLmNsb3Nlc3QoIipbZGF0YS1kdC1yb3ddIik7cmV0dXJuIGIubGVuZ3RoP1tiLmRhdGEoImR0LXJvdyIpXTpbXX1pZih0eXBlb2YgYT09PSJzdHJpbmciJiZhLmNoYXJBdCgwKT09PSIjIil7dmFyIGk9Yy5hSWRzW2EucmVwbGFjZSgvXiMvLCIiKV07aWYoaSE9PWspcmV0dXJuW2kuaWR4XX1yZXR1cm4gaChiKS5maWx0ZXIoYSkubWFwKGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX0RUX1Jvd0luZGV4fSkudG9BcnJheSgpfSxjLGUpfSwxKTtjLnNlbGVjdG9yLnJvd3M9YTtjLnNlbGVjdG9yLm9wdHM9YjtyZXR1cm4gY30pO28oInJvd3MoKS5ub2RlcygpIixmdW5jdGlvbigpe3JldHVybiB0aGlzLml0ZXJhdG9yKCJyb3ciLGZ1bmN0aW9uKGEsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIpe3JldHVybiBhLmFvRGF0YVtiXS5uVHJ8fGt9LDEpfSk7bygicm93cygpLmRhdGEoKSIsZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pdGVyYXRvcighMCwicm93cyIsZnVuY3Rpb24oYSxiKXtyZXR1cm4gaWEoYS5hb0RhdGEsYiwiX2FEYXRhIil9LDEpfSk7dSgicm93cygpLmNhY2hlKCkiLCJyb3coKS5jYWNoZSgpIixmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5pdGVyYXRvcigicm93IixmdW5jdGlvbihiLGMpe3ZhciBkPWIuYW9EYXRhW2NdO3JldHVybiJzZWFyY2giPT09YT9kLl9hRmlsdGVyRGF0YTpkLl9hU29ydERhdGF9LDEpfSk7dSgicm93cygpLmludmFsaWRhdGUoKSIsInJvdygpLmludmFsaWRhdGUoKSIsZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuaXRlcmF0b3IoInJvdyIsZnVuY3Rpb24oYixjKXtjYShiLGMsYSl9KX0pO3UoInJvd3MoKS5pbmRleGVzKCkiLCJyb3coKS5pbmRleCgpIixmdW5jdGlvbigpe3JldHVybiB0aGlzLml0ZXJhdG9yKCJyb3ciLGZ1bmN0aW9uKGEsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIpe3JldHVybiBifSwxKX0pO3UoInJvd3MoKS5pZHMoKSIsInJvdygpLmlkKCkiLGZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1bXSxjPXRoaXMuY29udGV4dCxkPTAsZT1jLmxlbmd0aDtkPGU7ZCsrKWZvcih2YXIgZj0wLGc9dGhpc1tkXS5sZW5ndGg7ZjxnO2YrKyl7dmFyIGg9Y1tkXS5yb3dJZEZuKGNbZF0uYW9EYXRhW3RoaXNbZF1bZl1dLl9hRGF0YSk7Yi5wdXNoKCghMD09PWE/IiMiOiIiKStoKX1yZXR1cm4gbmV3IHMoYyxiKX0pO3UoInJvd3MoKS5yZW1vdmUoKSIsInJvdygpLnJlbW92ZSgpIixmdW5jdGlvbigpe3ZhciBhPXRoaXM7dGhpcy5pdGVyYXRvcigicm93IixmdW5jdGlvbihiLGMsZCl7dmFyIGU9Yi5hb0RhdGEsZj1lW2NdLGcsaCxpLG4sbDtlLnNwbGljZShjLDEpO2c9MDtmb3IoaD1lLmxlbmd0aDtnPGg7ZysrKWlmKGk9ZVtnXSxsPWkuYW5DZWxscyxudWxsIT09aS5uVHImJihpLm5Uci5fRFRfUm93SW5kZXg9ZyksbnVsbCE9PWwpe2k9MDtmb3Iobj1sLmxlbmd0aDtpPA0KICAgIG47aSsrKWxbaV0uX0RUX0NlbGxJbmRleC5yb3c9Z31vYShiLmFpRGlzcGxheU1hc3RlcixjKTtvYShiLmFpRGlzcGxheSxjKTtvYShhW2RdLGMsITEpOzA8Yi5faVJlY29yZHNEaXNwbGF5JiZiLl9pUmVjb3Jkc0Rpc3BsYXktLTtSYShiKTtjPWIucm93SWRGbihmLl9hRGF0YSk7YyE9PWsmJmRlbGV0ZSBiLmFJZHNbY119KTt0aGlzLml0ZXJhdG9yKCJ0YWJsZSIsZnVuY3Rpb24oYSl7Zm9yKHZhciBjPTAsZD1hLmFvRGF0YS5sZW5ndGg7YzxkO2MrKylhLmFvRGF0YVtjXS5pZHg9Y30pO3JldHVybiB0aGlzfSk7bygicm93cy5hZGQoKSIsZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5pdGVyYXRvcigidGFibGUiLGZ1bmN0aW9uKGIpe3ZhciBjLGYsZyxoPVtdO2Y9MDtmb3IoZz1hLmxlbmd0aDtmPGc7ZisrKWM9YVtmXSxjLm5vZGVOYW1lJiYiVFIiPT09Yy5ub2RlTmFtZS50b1VwcGVyQ2FzZSgpP2gucHVzaChtYShiLGMpWzBdKTpoLnB1c2goTShiLGMpKTtyZXR1cm4gaH0sMSksYz10aGlzLnJvd3MoLTEpOw0KICAgICAgICBjLnBvcCgpO2gubWVyZ2UoYyxiKTtyZXR1cm4gY30pO28oInJvdygpIixmdW5jdGlvbihhLGIpe3JldHVybiBhYih0aGlzLnJvd3MoYSxiKSl9KTtvKCJyb3coKS5kYXRhKCkiLGZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY29udGV4dDtpZihhPT09aylyZXR1cm4gYi5sZW5ndGgmJnRoaXMubGVuZ3RoP2JbMF0uYW9EYXRhW3RoaXNbMF1dLl9hRGF0YTprO2JbMF0uYW9EYXRhW3RoaXNbMF1dLl9hRGF0YT1hO2NhKGJbMF0sdGhpc1swXSwiZGF0YSIpO3JldHVybiB0aGlzfSk7bygicm93KCkubm9kZSgpIixmdW5jdGlvbigpe3ZhciBhPXRoaXMuY29udGV4dDtyZXR1cm4gYS5sZW5ndGgmJnRoaXMubGVuZ3RoP2FbMF0uYW9EYXRhW3RoaXNbMF1dLm5Ucnx8bnVsbDpudWxsfSk7bygicm93LmFkZCgpIixmdW5jdGlvbihhKXthIGluc3RhbmNlb2YgaCYmYS5sZW5ndGgmJihhPWFbMF0pO3ZhciBiPXRoaXMuaXRlcmF0b3IoInRhYmxlIixmdW5jdGlvbihiKXtyZXR1cm4gYS5ub2RlTmFtZSYmDQogICAgIlRSIj09PWEubm9kZU5hbWUudG9VcHBlckNhc2UoKT9tYShiLGEpWzBdOk0oYixhKX0pO3JldHVybiB0aGlzLnJvdyhiWzBdKX0pO3ZhciBiYj1mdW5jdGlvbihhLGIpe3ZhciBjPWEuY29udGV4dDtpZihjLmxlbmd0aCYmKGM9Y1swXS5hb0RhdGFbYiE9PWs/YjphWzBdXSkmJmMuX2RldGFpbHMpYy5fZGV0YWlscy5yZW1vdmUoKSxjLl9kZXRhaWxzU2hvdz1rLGMuX2RldGFpbHM9a30sVGI9ZnVuY3Rpb24oYSxiKXt2YXIgYz1hLmNvbnRleHQ7aWYoYy5sZW5ndGgmJmEubGVuZ3RoKXt2YXIgZD1jWzBdLmFvRGF0YVthWzBdXTtpZihkLl9kZXRhaWxzKXsoZC5fZGV0YWlsc1Nob3c9Yik/ZC5fZGV0YWlscy5pbnNlcnRBZnRlcihkLm5Ucik6ZC5fZGV0YWlscy5kZXRhY2goKTt2YXIgZT1jWzBdLGY9bmV3IHMoZSksZz1lLmFvRGF0YTtmLm9mZigiZHJhdy5kdC5EVF9kZXRhaWxzIGNvbHVtbi12aXNpYmlsaXR5LmR0LkRUX2RldGFpbHMgZGVzdHJveS5kdC5EVF9kZXRhaWxzIik7MDxEKGcsDQogICAgICAgICJfZGV0YWlscyIpLmxlbmd0aCYmKGYub24oImRyYXcuZHQuRFRfZGV0YWlscyIsZnVuY3Rpb24oYSxiKXtlPT09YiYmZi5yb3dzKHtwYWdlOiJjdXJyZW50In0pLmVxKDApLmVhY2goZnVuY3Rpb24oYSl7YT1nW2FdO2EuX2RldGFpbHNTaG93JiZhLl9kZXRhaWxzLmluc2VydEFmdGVyKGEublRyKX0pfSksZi5vbigiY29sdW1uLXZpc2liaWxpdHkuZHQuRFRfZGV0YWlscyIsZnVuY3Rpb24oYSxiKXtpZihlPT09Yilmb3IodmFyIGMsZD1hYShiKSxmPTAsaD1nLmxlbmd0aDtmPGg7ZisrKWM9Z1tmXSxjLl9kZXRhaWxzJiZjLl9kZXRhaWxzLmNoaWxkcmVuKCJ0ZFtjb2xzcGFuXSIpLmF0dHIoImNvbHNwYW4iLGQpfSksZi5vbigiZGVzdHJveS5kdC5EVF9kZXRhaWxzIixmdW5jdGlvbihhLGIpe2lmKGU9PT1iKWZvcih2YXIgYz0wLGQ9Zy5sZW5ndGg7YzxkO2MrKylnW2NdLl9kZXRhaWxzJiZiYihmLGMpfSkpfX19O28oInJvdygpLmNoaWxkKCkiLGZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5jb250ZXh0Ow0KICAgICAgICBpZihhPT09aylyZXR1cm4gYy5sZW5ndGgmJnRoaXMubGVuZ3RoP2NbMF0uYW9EYXRhW3RoaXNbMF1dLl9kZXRhaWxzOms7aWYoITA9PT1hKXRoaXMuY2hpbGQuc2hvdygpO2Vsc2UgaWYoITE9PT1hKWJiKHRoaXMpO2Vsc2UgaWYoYy5sZW5ndGgmJnRoaXMubGVuZ3RoKXt2YXIgZD1jWzBdLGM9Y1swXS5hb0RhdGFbdGhpc1swXV0sZT1bXSxmPWZ1bmN0aW9uKGEsYil7aWYoaC5pc0FycmF5KGEpfHxhIGluc3RhbmNlb2YgaClmb3IodmFyIGM9MCxrPWEubGVuZ3RoO2M8aztjKyspZihhW2NdLGIpO2Vsc2UgYS5ub2RlTmFtZSYmInRyIj09PWEubm9kZU5hbWUudG9Mb3dlckNhc2UoKT9lLnB1c2goYSk6KGM9aCgiPHRyPjx0ZC8+PC90cj4iKS5hZGRDbGFzcyhiKSxoKCJ0ZCIsYykuYWRkQ2xhc3MoYikuaHRtbChhKVswXS5jb2xTcGFuPWFhKGQpLGUucHVzaChjWzBdKSl9O2YoYSxiKTtjLl9kZXRhaWxzJiZjLl9kZXRhaWxzLmRldGFjaCgpO2MuX2RldGFpbHM9aChlKTtjLl9kZXRhaWxzU2hvdyYmDQogICAgICAgIGMuX2RldGFpbHMuaW5zZXJ0QWZ0ZXIoYy5uVHIpfXJldHVybiB0aGlzfSk7byhbInJvdygpLmNoaWxkLnNob3coKSIsInJvdygpLmNoaWxkKCkuc2hvdygpIl0sZnVuY3Rpb24oKXtUYih0aGlzLCEwKTtyZXR1cm4gdGhpc30pO28oWyJyb3coKS5jaGlsZC5oaWRlKCkiLCJyb3coKS5jaGlsZCgpLmhpZGUoKSJdLGZ1bmN0aW9uKCl7VGIodGhpcywhMSk7cmV0dXJuIHRoaXN9KTtvKFsicm93KCkuY2hpbGQucmVtb3ZlKCkiLCJyb3coKS5jaGlsZCgpLnJlbW92ZSgpIl0sZnVuY3Rpb24oKXtiYih0aGlzKTtyZXR1cm4gdGhpc30pO28oInJvdygpLmNoaWxkLmlzU2hvd24oKSIsZnVuY3Rpb24oKXt2YXIgYT10aGlzLmNvbnRleHQ7cmV0dXJuIGEubGVuZ3RoJiZ0aGlzLmxlbmd0aD9hWzBdLmFvRGF0YVt0aGlzWzBdXS5fZGV0YWlsc1Nob3d8fCExOiExfSk7dmFyIGJjPS9eKFteOl0rKToobmFtZXx2aXNJZHh8dmlzaWJsZSkkLyxVYj1mdW5jdGlvbihhLGIsYyxkLGUpe2Zvcih2YXIgYz0NCiAgICAgICAgW10sZD0wLGY9ZS5sZW5ndGg7ZDxmO2QrKyljLnB1c2goQihhLGVbZF0sYikpO3JldHVybiBjfTtvKCJjb2x1bW5zKCkiLGZ1bmN0aW9uKGEsYil7YT09PWs/YT0iIjpoLmlzUGxhaW5PYmplY3QoYSkmJihiPWEsYT0iIik7dmFyIGI9JGEoYiksYz10aGlzLml0ZXJhdG9yKCJ0YWJsZSIsZnVuY3Rpb24oYyl7dmFyIGU9YSxmPWIsZz1jLmFvQ29sdW1ucyxqPUQoZywic05hbWUiKSxpPUQoZywiblRoIik7cmV0dXJuIFphKCJjb2x1bW4iLGUsZnVuY3Rpb24oYSl7dmFyIGI9TmIoYSk7aWYoYT09PSIiKXJldHVybiBXKGcubGVuZ3RoKTtpZihiIT09bnVsbClyZXR1cm5bYj49MD9iOmcubGVuZ3RoK2JdO2lmKHR5cGVvZiBhPT09ImZ1bmN0aW9uIil7dmFyIGU9QmEoYyxmKTtyZXR1cm4gaC5tYXAoZyxmdW5jdGlvbihiLGYpe3JldHVybiBhKGYsVWIoYyxmLDAsMCxlKSxpW2ZdKT9mOm51bGx9KX12YXIgaz10eXBlb2YgYT09PSJzdHJpbmciP2EubWF0Y2goYmMpOiIiO2lmKGspc3dpdGNoKGtbMl0pe2Nhc2UgInZpc0lkeCI6Y2FzZSAidmlzaWJsZSI6Yj0NCiAgICAgICAgcGFyc2VJbnQoa1sxXSwxMCk7aWYoYjwwKXt2YXIgbT1oLm1hcChnLGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuYlZpc2libGU/YjpudWxsfSk7cmV0dXJuW21bbS5sZW5ndGgrYl1dfXJldHVybltaKGMsYildO2Nhc2UgIm5hbWUiOnJldHVybiBoLm1hcChqLGZ1bmN0aW9uKGEsYil7cmV0dXJuIGE9PT1rWzFdP2I6bnVsbH0pO2RlZmF1bHQ6cmV0dXJuW119aWYoYS5ub2RlTmFtZSYmYS5fRFRfQ2VsbEluZGV4KXJldHVyblthLl9EVF9DZWxsSW5kZXguY29sdW1uXTtiPWgoaSkuZmlsdGVyKGEpLm1hcChmdW5jdGlvbigpe3JldHVybiBoLmluQXJyYXkodGhpcyxpKX0pLnRvQXJyYXkoKTtpZihiLmxlbmd0aHx8IWEubm9kZU5hbWUpcmV0dXJuIGI7Yj1oKGEpLmNsb3Nlc3QoIipbZGF0YS1kdC1jb2x1bW5dIik7cmV0dXJuIGIubGVuZ3RoP1tiLmRhdGEoImR0LWNvbHVtbiIpXTpbXX0sYyxmKX0sMSk7Yy5zZWxlY3Rvci5jb2xzPWE7Yy5zZWxlY3Rvci5vcHRzPWI7cmV0dXJuIGN9KTt1KCJjb2x1bW5zKCkuaGVhZGVyKCkiLA0KICAgICAgICAiY29sdW1uKCkuaGVhZGVyKCkiLGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXRlcmF0b3IoImNvbHVtbiIsZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS5hb0NvbHVtbnNbYl0ublRofSwxKX0pO3UoImNvbHVtbnMoKS5mb290ZXIoKSIsImNvbHVtbigpLmZvb3RlcigpIixmdW5jdGlvbigpe3JldHVybiB0aGlzLml0ZXJhdG9yKCJjb2x1bW4iLGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuYW9Db2x1bW5zW2JdLm5UZn0sMSl9KTt1KCJjb2x1bW5zKCkuZGF0YSgpIiwiY29sdW1uKCkuZGF0YSgpIixmdW5jdGlvbigpe3JldHVybiB0aGlzLml0ZXJhdG9yKCJjb2x1bW4tcm93cyIsVWIsMSl9KTt1KCJjb2x1bW5zKCkuZGF0YVNyYygpIiwiY29sdW1uKCkuZGF0YVNyYygpIixmdW5jdGlvbigpe3JldHVybiB0aGlzLml0ZXJhdG9yKCJjb2x1bW4iLGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuYW9Db2x1bW5zW2JdLm1EYXRhfSwxKX0pO3UoImNvbHVtbnMoKS5jYWNoZSgpIiwiY29sdW1uKCkuY2FjaGUoKSIsDQogICAgICAgIGZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLml0ZXJhdG9yKCJjb2x1bW4tcm93cyIsZnVuY3Rpb24oYixjLGQsZSxmKXtyZXR1cm4gaWEoYi5hb0RhdGEsZiwic2VhcmNoIj09PWE/Il9hRmlsdGVyRGF0YSI6Il9hU29ydERhdGEiLGMpfSwxKX0pO3UoImNvbHVtbnMoKS5ub2RlcygpIiwiY29sdW1uKCkubm9kZXMoKSIsZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pdGVyYXRvcigiY29sdW1uLXJvd3MiLGZ1bmN0aW9uKGEsYixjLGQsZSl7cmV0dXJuIGlhKGEuYW9EYXRhLGUsImFuQ2VsbHMiLGIpfSwxKX0pO3UoImNvbHVtbnMoKS52aXNpYmxlKCkiLCJjb2x1bW4oKS52aXNpYmxlKCkiLGZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5pdGVyYXRvcigiY29sdW1uIixmdW5jdGlvbihiLGMpe2lmKGE9PT1rKXJldHVybiBiLmFvQ29sdW1uc1tjXS5iVmlzaWJsZTt2YXIgZj1iLmFvQ29sdW1ucyxnPWZbY10saj1iLmFvRGF0YSxpLG4sbDtpZihhIT09ayYmZy5iVmlzaWJsZSE9PWEpe2lmKGEpe3ZhciBtPQ0KICAgICAgICBoLmluQXJyYXkoITAsRChmLCJiVmlzaWJsZSIpLGMrMSk7aT0wO2ZvcihuPWoubGVuZ3RoO2k8bjtpKyspbD1qW2ldLm5UcixmPWpbaV0uYW5DZWxscyxsJiZsLmluc2VydEJlZm9yZShmW2NdLGZbbV18fG51bGwpfWVsc2UgaChEKGIuYW9EYXRhLCJhbkNlbGxzIixjKSkuZGV0YWNoKCk7Zy5iVmlzaWJsZT1hO2VhKGIsYi5hb0hlYWRlcik7ZWEoYixiLmFvRm9vdGVyKTt4YShiKX19KTthIT09ayYmKHRoaXMuaXRlcmF0b3IoImNvbHVtbiIsZnVuY3Rpb24oYyxlKXtyKGMsbnVsbCwiY29sdW1uLXZpc2liaWxpdHkiLFtjLGUsYSxiXSl9KSwoYj09PWt8fGIpJiZ0aGlzLmNvbHVtbnMuYWRqdXN0KCkpO3JldHVybiBjfSk7dSgiY29sdW1ucygpLmluZGV4ZXMoKSIsImNvbHVtbigpLmluZGV4KCkiLGZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLml0ZXJhdG9yKCJjb2x1bW4iLGZ1bmN0aW9uKGIsYyl7cmV0dXJuInZpc2libGUiPT09YT8kKGIsYyk6Y30sMSl9KTtvKCJjb2x1bW5zLmFkanVzdCgpIiwNCiAgICAgICAgZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pdGVyYXRvcigidGFibGUiLGZ1bmN0aW9uKGEpe1koYSl9LDEpfSk7bygiY29sdW1uLmluZGV4KCkiLGZ1bmN0aW9uKGEsYil7aWYoMCE9PXRoaXMuY29udGV4dC5sZW5ndGgpe3ZhciBjPXRoaXMuY29udGV4dFswXTtpZigiZnJvbVZpc2libGUiPT09YXx8InRvRGF0YSI9PT1hKXJldHVybiBaKGMsYik7aWYoImZyb21EYXRhIj09PWF8fCJ0b1Zpc2libGUiPT09YSlyZXR1cm4gJChjLGIpfX0pO28oImNvbHVtbigpIixmdW5jdGlvbihhLGIpe3JldHVybiBhYih0aGlzLmNvbHVtbnMoYSxiKSl9KTtvKCJjZWxscygpIixmdW5jdGlvbihhLGIsYyl7aC5pc1BsYWluT2JqZWN0KGEpJiYoYS5yb3c9PT1rPyhjPWEsYT1udWxsKTooYz1iLGI9bnVsbCkpO2guaXNQbGFpbk9iamVjdChiKSYmKGM9YixiPW51bGwpO2lmKG51bGw9PT1ifHxiPT09aylyZXR1cm4gdGhpcy5pdGVyYXRvcigidGFibGUiLGZ1bmN0aW9uKGIpe3ZhciBkPWEsZT0kYShjKSxmPQ0KICAgICAgICBiLmFvRGF0YSxnPUJhKGIsZSksaj1RYihpYShmLGcsImFuQ2VsbHMiKSksaT1oKFtdLmNvbmNhdC5hcHBseShbXSxqKSksbCxuPWIuYW9Db2x1bW5zLmxlbmd0aCxtLG8sdSxzLHIsdjtyZXR1cm4gWmEoImNlbGwiLGQsZnVuY3Rpb24oYSl7dmFyIGM9dHlwZW9mIGE9PT0iZnVuY3Rpb24iO2lmKGE9PT1udWxsfHxhPT09a3x8Yyl7bT1bXTtvPTA7Zm9yKHU9Zy5sZW5ndGg7bzx1O28rKyl7bD1nW29dO2ZvcihzPTA7czxuO3MrKyl7cj17cm93OmwsY29sdW1uOnN9O2lmKGMpe3Y9ZltsXTthKHIsQihiLGwscyksdi5hbkNlbGxzP3YuYW5DZWxsc1tzXTpudWxsKSYmbS5wdXNoKHIpfWVsc2UgbS5wdXNoKHIpfX1yZXR1cm4gbX1pZihoLmlzUGxhaW5PYmplY3QoYSkpcmV0dXJuW2FdO2M9aS5maWx0ZXIoYSkubWFwKGZ1bmN0aW9uKGEsYil7cmV0dXJue3JvdzpiLl9EVF9DZWxsSW5kZXgucm93LGNvbHVtbjpiLl9EVF9DZWxsSW5kZXguY29sdW1ufX0pLnRvQXJyYXkoKTtpZihjLmxlbmd0aHx8DQogICAgICAgICFhLm5vZGVOYW1lKXJldHVybiBjO3Y9aChhKS5jbG9zZXN0KCIqW2RhdGEtZHQtcm93XSIpO3JldHVybiB2Lmxlbmd0aD9be3Jvdzp2LmRhdGEoImR0LXJvdyIpLGNvbHVtbjp2LmRhdGEoImR0LWNvbHVtbiIpfV06W119LGIsZSl9KTt2YXIgZD10aGlzLmNvbHVtbnMoYixjKSxlPXRoaXMucm93cyhhLGMpLGYsZyxqLGksbixsPXRoaXMuaXRlcmF0b3IoInRhYmxlIixmdW5jdGlvbihhLGIpe2Y9W107Zz0wO2ZvcihqPWVbYl0ubGVuZ3RoO2c8ajtnKyspe2k9MDtmb3Iobj1kW2JdLmxlbmd0aDtpPG47aSsrKWYucHVzaCh7cm93OmVbYl1bZ10sY29sdW1uOmRbYl1baV19KX1yZXR1cm4gZn0sMSk7aC5leHRlbmQobC5zZWxlY3Rvcix7Y29sczpiLHJvd3M6YSxvcHRzOmN9KTtyZXR1cm4gbH0pO3UoImNlbGxzKCkubm9kZXMoKSIsImNlbGwoKS5ub2RlKCkiLGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXRlcmF0b3IoImNlbGwiLGZ1bmN0aW9uKGEsYixjKXtyZXR1cm4oYT1hLmFvRGF0YVtiXSkmJg0KICAgIGEuYW5DZWxscz9hLmFuQ2VsbHNbY106a30sMSl9KTtvKCJjZWxscygpLmRhdGEoKSIsZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pdGVyYXRvcigiY2VsbCIsZnVuY3Rpb24oYSxiLGMpe3JldHVybiBCKGEsYixjKX0sMSl9KTt1KCJjZWxscygpLmNhY2hlKCkiLCJjZWxsKCkuY2FjaGUoKSIsZnVuY3Rpb24oYSl7YT0ic2VhcmNoIj09PWE/Il9hRmlsdGVyRGF0YSI6Il9hU29ydERhdGEiO3JldHVybiB0aGlzLml0ZXJhdG9yKCJjZWxsIixmdW5jdGlvbihiLGMsZCl7cmV0dXJuIGIuYW9EYXRhW2NdW2FdW2RdfSwxKX0pO3UoImNlbGxzKCkucmVuZGVyKCkiLCJjZWxsKCkucmVuZGVyKCkiLGZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLml0ZXJhdG9yKCJjZWxsIixmdW5jdGlvbihiLGMsZCl7cmV0dXJuIEIoYixjLGQsYSl9LDEpfSk7dSgiY2VsbHMoKS5pbmRleGVzKCkiLCJjZWxsKCkuaW5kZXgoKSIsZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pdGVyYXRvcigiY2VsbCIsZnVuY3Rpb24oYSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIsYyl7cmV0dXJue3JvdzpiLGNvbHVtbjpjLGNvbHVtblZpc2libGU6JChhLGMpfX0sMSl9KTt1KCJjZWxscygpLmludmFsaWRhdGUoKSIsImNlbGwoKS5pbnZhbGlkYXRlKCkiLGZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLml0ZXJhdG9yKCJjZWxsIixmdW5jdGlvbihiLGMsZCl7Y2EoYixjLGEsZCl9KX0pO28oImNlbGwoKSIsZnVuY3Rpb24oYSxiLGMpe3JldHVybiBhYih0aGlzLmNlbGxzKGEsYixjKSl9KTtvKCJjZWxsKCkuZGF0YSgpIixmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNvbnRleHQsYz10aGlzWzBdO2lmKGE9PT1rKXJldHVybiBiLmxlbmd0aCYmYy5sZW5ndGg/QihiWzBdLGNbMF0ucm93LGNbMF0uY29sdW1uKTprO2liKGJbMF0sY1swXS5yb3csY1swXS5jb2x1bW4sYSk7Y2EoYlswXSxjWzBdLnJvdywiZGF0YSIsY1swXS5jb2x1bW4pO3JldHVybiB0aGlzfSk7bygib3JkZXIoKSIsZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNvbnRleHQ7aWYoYT09PWspcmV0dXJuIDAhPT0NCiAgICBjLmxlbmd0aD9jWzBdLmFhU29ydGluZzprOyJudW1iZXIiPT09dHlwZW9mIGE/YT1bW2EsYl1dOmEubGVuZ3RoJiYhaC5pc0FycmF5KGFbMF0pJiYoYT1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpKTtyZXR1cm4gdGhpcy5pdGVyYXRvcigidGFibGUiLGZ1bmN0aW9uKGIpe2IuYWFTb3J0aW5nPWEuc2xpY2UoKX0pfSk7bygib3JkZXIubGlzdGVuZXIoKSIsZnVuY3Rpb24oYSxiLGMpe3JldHVybiB0aGlzLml0ZXJhdG9yKCJ0YWJsZSIsZnVuY3Rpb24oZCl7TGEoZCxhLGIsYyl9KX0pO28oIm9yZGVyLmZpeGVkKCkiLGZ1bmN0aW9uKGEpe2lmKCFhKXt2YXIgYj10aGlzLmNvbnRleHQsYj1iLmxlbmd0aD9iWzBdLmFhU29ydGluZ0ZpeGVkOms7cmV0dXJuIGguaXNBcnJheShiKT97cHJlOmJ9OmJ9cmV0dXJuIHRoaXMuaXRlcmF0b3IoInRhYmxlIixmdW5jdGlvbihiKXtiLmFhU29ydGluZ0ZpeGVkPWguZXh0ZW5kKCEwLHt9LGEpfSl9KTtvKFsiY29sdW1ucygpLm9yZGVyKCkiLA0KICAgICAgICAiY29sdW1uKCkub3JkZXIoKSJdLGZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7cmV0dXJuIHRoaXMuaXRlcmF0b3IoInRhYmxlIixmdW5jdGlvbihjLGQpe3ZhciBlPVtdO2guZWFjaChiW2RdLGZ1bmN0aW9uKGIsYyl7ZS5wdXNoKFtjLGFdKX0pO2MuYWFTb3J0aW5nPWV9KX0pO28oInNlYXJjaCgpIixmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT10aGlzLmNvbnRleHQ7cmV0dXJuIGE9PT1rPzAhPT1lLmxlbmd0aD9lWzBdLm9QcmV2aW91c1NlYXJjaC5zU2VhcmNoOms6dGhpcy5pdGVyYXRvcigidGFibGUiLGZ1bmN0aW9uKGUpe2Uub0ZlYXR1cmVzLmJGaWx0ZXImJmZhKGUsaC5leHRlbmQoe30sZS5vUHJldmlvdXNTZWFyY2gse3NTZWFyY2g6YSsiIixiUmVnZXg6bnVsbD09PWI/ITE6YixiU21hcnQ6bnVsbD09PWM/ITA6YyxiQ2FzZUluc2Vuc2l0aXZlOm51bGw9PT1kPyEwOmR9KSwxKX0pfSk7dSgiY29sdW1ucygpLnNlYXJjaCgpIiwiY29sdW1uKCkuc2VhcmNoKCkiLGZ1bmN0aW9uKGEsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYixjLGQpe3JldHVybiB0aGlzLml0ZXJhdG9yKCJjb2x1bW4iLGZ1bmN0aW9uKGUsZil7dmFyIGc9ZS5hb1ByZVNlYXJjaENvbHM7aWYoYT09PWspcmV0dXJuIGdbZl0uc1NlYXJjaDtlLm9GZWF0dXJlcy5iRmlsdGVyJiYoaC5leHRlbmQoZ1tmXSx7c1NlYXJjaDphKyIiLGJSZWdleDpudWxsPT09Yj8hMTpiLGJTbWFydDpudWxsPT09Yz8hMDpjLGJDYXNlSW5zZW5zaXRpdmU6bnVsbD09PWQ/ITA6ZH0pLGZhKGUsZS5vUHJldmlvdXNTZWFyY2gsMSkpfSl9KTtvKCJzdGF0ZSgpIixmdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbnRleHQubGVuZ3RoP3RoaXMuY29udGV4dFswXS5vU2F2ZWRTdGF0ZTpudWxsfSk7bygic3RhdGUuY2xlYXIoKSIsZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pdGVyYXRvcigidGFibGUiLGZ1bmN0aW9uKGEpe2EuZm5TdGF0ZVNhdmVDYWxsYmFjay5jYWxsKGEub0luc3RhbmNlLGEse30pfSl9KTtvKCJzdGF0ZS5sb2FkZWQoKSIsZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb250ZXh0Lmxlbmd0aD8NCiAgICAgICAgdGhpcy5jb250ZXh0WzBdLm9Mb2FkZWRTdGF0ZTpudWxsfSk7bygic3RhdGUuc2F2ZSgpIixmdW5jdGlvbigpe3JldHVybiB0aGlzLml0ZXJhdG9yKCJ0YWJsZSIsZnVuY3Rpb24oYSl7eGEoYSl9KX0pO20udmVyc2lvbkNoZWNrPW0uZm5WZXJzaW9uQ2hlY2s9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPW0udmVyc2lvbi5zcGxpdCgiLiIpLGE9YS5zcGxpdCgiLiIpLGMsZCxlPTAsZj1hLmxlbmd0aDtlPGY7ZSsrKWlmKGM9cGFyc2VJbnQoYltlXSwxMCl8fDAsZD1wYXJzZUludChhW2VdLDEwKXx8MCxjIT09ZClyZXR1cm4gYz5kO3JldHVybiEwfTttLmlzRGF0YVRhYmxlPW0uZm5Jc0RhdGFUYWJsZT1mdW5jdGlvbihhKXt2YXIgYj1oKGEpLmdldCgwKSxjPSExO2lmKGEgaW5zdGFuY2VvZiBtLkFwaSlyZXR1cm4hMDtoLmVhY2gobS5zZXR0aW5ncyxmdW5jdGlvbihhLGUpe3ZhciBmPWUublNjcm9sbEhlYWQ/aCgidGFibGUiLGUublNjcm9sbEhlYWQpWzBdOm51bGwsZz1lLm5TY3JvbGxGb290Pw0KICAgICAgICBoKCJ0YWJsZSIsZS5uU2Nyb2xsRm9vdClbMF06bnVsbDtpZihlLm5UYWJsZT09PWJ8fGY9PT1ifHxnPT09YiljPSEwfSk7cmV0dXJuIGN9O20udGFibGVzPW0uZm5UYWJsZXM9ZnVuY3Rpb24oYSl7dmFyIGI9ITE7aC5pc1BsYWluT2JqZWN0KGEpJiYoYj1hLmFwaSxhPWEudmlzaWJsZSk7dmFyIGM9aC5tYXAobS5zZXR0aW5ncyxmdW5jdGlvbihiKXtpZighYXx8YSYmaChiLm5UYWJsZSkuaXMoIjp2aXNpYmxlIikpcmV0dXJuIGIublRhYmxlfSk7cmV0dXJuIGI/bmV3IHMoYyk6Y307bS5jYW1lbFRvSHVuZ2FyaWFuPUk7bygiJCgpIixmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMucm93cyhiKS5ub2RlcygpLGM9aChjKTtyZXR1cm4gaChbXS5jb25jYXQoYy5maWx0ZXIoYSkudG9BcnJheSgpLGMuZmluZChhKS50b0FycmF5KCkpKX0pO2guZWFjaChbIm9uIiwib25lIiwib2ZmIl0sZnVuY3Rpb24oYSxiKXtvKGIrIigpIixmdW5jdGlvbigpe3ZhciBhPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7DQogICAgICAgIGFbMF09aC5tYXAoYVswXS5zcGxpdCgvXHMvKSxmdW5jdGlvbihhKXtyZXR1cm4hYS5tYXRjaCgvXC5kdFxiLyk/YSsiLmR0IjphfSkuam9pbigiICIpO3ZhciBkPWgodGhpcy50YWJsZXMoKS5ub2RlcygpKTtkW2JdLmFwcGx5KGQsYSk7cmV0dXJuIHRoaXN9KX0pO28oImNsZWFyKCkiLGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXRlcmF0b3IoInRhYmxlIixmdW5jdGlvbihhKXtuYShhKX0pfSk7bygic2V0dGluZ3MoKSIsZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHModGhpcy5jb250ZXh0LHRoaXMuY29udGV4dCl9KTtvKCJpbml0KCkiLGZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5jb250ZXh0O3JldHVybiBhLmxlbmd0aD9hWzBdLm9Jbml0Om51bGx9KTtvKCJkYXRhKCkiLGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXRlcmF0b3IoInRhYmxlIixmdW5jdGlvbihhKXtyZXR1cm4gRChhLmFvRGF0YSwiX2FEYXRhIil9KS5mbGF0dGVuKCl9KTtvKCJkZXN0cm95KCkiLGZ1bmN0aW9uKGEpe2E9YXx8DQogICAgICAgICExO3JldHVybiB0aGlzLml0ZXJhdG9yKCJ0YWJsZSIsZnVuY3Rpb24oYil7dmFyIGM9Yi5uVGFibGVXcmFwcGVyLnBhcmVudE5vZGUsZD1iLm9DbGFzc2VzLGU9Yi5uVGFibGUsZj1iLm5UQm9keSxnPWIublRIZWFkLGo9Yi5uVEZvb3QsaT1oKGUpLGY9aChmKSxrPWgoYi5uVGFibGVXcmFwcGVyKSxsPWgubWFwKGIuYW9EYXRhLGZ1bmN0aW9uKGEpe3JldHVybiBhLm5Ucn0pLG87Yi5iRGVzdHJveWluZz0hMDtyKGIsImFvRGVzdHJveUNhbGxiYWNrIiwiZGVzdHJveSIsW2JdKTthfHwobmV3IHMoYikpLmNvbHVtbnMoKS52aXNpYmxlKCEwKTtrLm9mZigiLkRUIikuZmluZCgiOm5vdCh0Ym9keSAqKSIpLm9mZigiLkRUIik7aChFKS5vZmYoIi5EVC0iK2Iuc0luc3RhbmNlKTtlIT1nLnBhcmVudE5vZGUmJihpLmNoaWxkcmVuKCJ0aGVhZCIpLmRldGFjaCgpLGkuYXBwZW5kKGcpKTtqJiZlIT1qLnBhcmVudE5vZGUmJihpLmNoaWxkcmVuKCJ0Zm9vdCIpLmRldGFjaCgpLGkuYXBwZW5kKGopKTsNCiAgICAgICAgYi5hYVNvcnRpbmc9W107Yi5hYVNvcnRpbmdGaXhlZD1bXTt3YShiKTtoKGwpLnJlbW92ZUNsYXNzKGIuYXNTdHJpcGVDbGFzc2VzLmpvaW4oIiAiKSk7aCgidGgsIHRkIixnKS5yZW1vdmVDbGFzcyhkLnNTb3J0YWJsZSsiICIrZC5zU29ydGFibGVBc2MrIiAiK2Quc1NvcnRhYmxlRGVzYysiICIrZC5zU29ydGFibGVOb25lKTtmLmNoaWxkcmVuKCkuZGV0YWNoKCk7Zi5hcHBlbmQobCk7Zz1hPyJyZW1vdmUiOiJkZXRhY2giO2lbZ10oKTtrW2ddKCk7IWEmJmMmJihjLmluc2VydEJlZm9yZShlLGIublRhYmxlUmVpbnNlcnRCZWZvcmUpLGkuY3NzKCJ3aWR0aCIsYi5zRGVzdHJveVdpZHRoKS5yZW1vdmVDbGFzcyhkLnNUYWJsZSksKG89Yi5hc0Rlc3Ryb3lTdHJpcGVzLmxlbmd0aCkmJmYuY2hpbGRyZW4oKS5lYWNoKGZ1bmN0aW9uKGEpe2godGhpcykuYWRkQ2xhc3MoYi5hc0Rlc3Ryb3lTdHJpcGVzW2Elb10pfSkpO2M9aC5pbkFycmF5KGIsbS5zZXR0aW5ncyk7LTEhPT1jJiZtLnNldHRpbmdzLnNwbGljZShjLA0KICAgICAgICAgICAgMSl9KX0pO2guZWFjaChbImNvbHVtbiIsInJvdyIsImNlbGwiXSxmdW5jdGlvbihhLGIpe28oYisicygpLmV2ZXJ5KCkiLGZ1bmN0aW9uKGEpe3ZhciBkPXRoaXMuc2VsZWN0b3Iub3B0cyxlPXRoaXM7cmV0dXJuIHRoaXMuaXRlcmF0b3IoYixmdW5jdGlvbihmLGcsaCxpLG4pe2EuY2FsbChlW2JdKGcsImNlbGwiPT09Yj9oOmQsImNlbGwiPT09Yj9kOmspLGcsaCxpLG4pfSl9KX0pO28oImkxOG4oKSIsZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXMuY29udGV4dFswXSxhPVEoYSkoZC5vTGFuZ3VhZ2UpO2E9PT1rJiYoYT1iKTtjIT09ayYmaC5pc1BsYWluT2JqZWN0KGEpJiYoYT1hW2NdIT09az9hW2NdOmEuXyk7cmV0dXJuIGEucmVwbGFjZSgiJWQiLGMpfSk7bS52ZXJzaW9uPSIxLjEwLjE2IjttLnNldHRpbmdzPVtdO20ubW9kZWxzPXt9O20ubW9kZWxzLm9TZWFyY2g9e2JDYXNlSW5zZW5zaXRpdmU6ITAsc1NlYXJjaDoiIixiUmVnZXg6ITEsYlNtYXJ0OiEwfTttLm1vZGVscy5vUm93PQ0KICAgICAgICB7blRyOm51bGwsYW5DZWxsczpudWxsLF9hRGF0YTpbXSxfYVNvcnREYXRhOm51bGwsX2FGaWx0ZXJEYXRhOm51bGwsX3NGaWx0ZXJSb3c6bnVsbCxfc1Jvd1N0cmlwZToiIixzcmM6bnVsbCxpZHg6LTF9O20ubW9kZWxzLm9Db2x1bW49e2lkeDpudWxsLGFEYXRhU29ydDpudWxsLGFzU29ydGluZzpudWxsLGJTZWFyY2hhYmxlOm51bGwsYlNvcnRhYmxlOm51bGwsYlZpc2libGU6bnVsbCxfc01hbnVhbFR5cGU6bnVsbCxfYkF0dHJTcmM6ITEsZm5DcmVhdGVkQ2VsbDpudWxsLGZuR2V0RGF0YTpudWxsLGZuU2V0RGF0YTpudWxsLG1EYXRhOm51bGwsbVJlbmRlcjpudWxsLG5UaDpudWxsLG5UZjpudWxsLHNDbGFzczpudWxsLHNDb250ZW50UGFkZGluZzpudWxsLHNEZWZhdWx0Q29udGVudDpudWxsLHNOYW1lOm51bGwsc1NvcnREYXRhVHlwZToic3RkIixzU29ydGluZ0NsYXNzOm51bGwsc1NvcnRpbmdDbGFzc0pVSTpudWxsLHNUaXRsZTpudWxsLHNUeXBlOm51bGwsc1dpZHRoOm51bGwsDQogICAgICAgIHNXaWR0aE9yaWc6bnVsbH07bS5kZWZhdWx0cz17YWFEYXRhOm51bGwsYWFTb3J0aW5nOltbMCwiYXNjIl1dLGFhU29ydGluZ0ZpeGVkOltdLGFqYXg6bnVsbCxhTGVuZ3RoTWVudTpbMTAsMjUsNTAsMTAwXSxhb0NvbHVtbnM6bnVsbCxhb0NvbHVtbkRlZnM6bnVsbCxhb1NlYXJjaENvbHM6W10sYXNTdHJpcGVDbGFzc2VzOm51bGwsYkF1dG9XaWR0aDohMCxiRGVmZXJSZW5kZXI6ITEsYkRlc3Ryb3k6ITEsYkZpbHRlcjohMCxiSW5mbzohMCxiTGVuZ3RoQ2hhbmdlOiEwLGJQYWdpbmF0ZTohMCxiUHJvY2Vzc2luZzohMSxiUmV0cmlldmU6ITEsYlNjcm9sbENvbGxhcHNlOiExLGJTZXJ2ZXJTaWRlOiExLGJTb3J0OiEwLGJTb3J0TXVsdGk6ITAsYlNvcnRDZWxsc1RvcDohMSxiU29ydENsYXNzZXM6ITAsYlN0YXRlU2F2ZTohMSxmbkNyZWF0ZWRSb3c6bnVsbCxmbkRyYXdDYWxsYmFjazpudWxsLGZuRm9vdGVyQ2FsbGJhY2s6bnVsbCxmbkZvcm1hdE51bWJlcjpmdW5jdGlvbihhKXtyZXR1cm4gYS50b1N0cmluZygpLnJlcGxhY2UoL1xCKD89KFxkezN9KSsoPyFcZCkpL2csDQogICAgICAgIHRoaXMub0xhbmd1YWdlLnNUaG91c2FuZHMpfSxmbkhlYWRlckNhbGxiYWNrOm51bGwsZm5JbmZvQ2FsbGJhY2s6bnVsbCxmbkluaXRDb21wbGV0ZTpudWxsLGZuUHJlRHJhd0NhbGxiYWNrOm51bGwsZm5Sb3dDYWxsYmFjazpudWxsLGZuU2VydmVyRGF0YTpudWxsLGZuU2VydmVyUGFyYW1zOm51bGwsZm5TdGF0ZUxvYWRDYWxsYmFjazpmdW5jdGlvbihhKXt0cnl7cmV0dXJuIEpTT04ucGFyc2UoKC0xPT09YS5pU3RhdGVEdXJhdGlvbj9zZXNzaW9uU3RvcmFnZTpsb2NhbFN0b3JhZ2UpLmdldEl0ZW0oIkRhdGFUYWJsZXNfIithLnNJbnN0YW5jZSsiXyIrbG9jYXRpb24ucGF0aG5hbWUpKX1jYXRjaChiKXt9fSxmblN0YXRlTG9hZFBhcmFtczpudWxsLGZuU3RhdGVMb2FkZWQ6bnVsbCxmblN0YXRlU2F2ZUNhbGxiYWNrOmZ1bmN0aW9uKGEsYil7dHJ5eygtMT09PWEuaVN0YXRlRHVyYXRpb24/c2Vzc2lvblN0b3JhZ2U6bG9jYWxTdG9yYWdlKS5zZXRJdGVtKCJEYXRhVGFibGVzXyIrYS5zSW5zdGFuY2UrDQogICAgICAgICJfIitsb2NhdGlvbi5wYXRobmFtZSxKU09OLnN0cmluZ2lmeShiKSl9Y2F0Y2goYyl7fX0sZm5TdGF0ZVNhdmVQYXJhbXM6bnVsbCxpU3RhdGVEdXJhdGlvbjo3MjAwLGlEZWZlckxvYWRpbmc6bnVsbCxpRGlzcGxheUxlbmd0aDoxMCxpRGlzcGxheVN0YXJ0OjAsaVRhYkluZGV4OjAsb0NsYXNzZXM6e30sb0xhbmd1YWdlOntvQXJpYTp7c1NvcnRBc2NlbmRpbmc6IjogYWN0aXZhdGUgdG8gc29ydCBjb2x1bW4gYXNjZW5kaW5nIixzU29ydERlc2NlbmRpbmc6IjogYWN0aXZhdGUgdG8gc29ydCBjb2x1bW4gZGVzY2VuZGluZyJ9LG9QYWdpbmF0ZTp7c0ZpcnN0OiJGaXJzdCIsc0xhc3Q6Ikxhc3QiLHNOZXh0OiJOZXh0IixzUHJldmlvdXM6IlByZXZpb3VzIn0sc0VtcHR5VGFibGU6Ik5vIGRhdGEgYXZhaWxhYmxlIGluIHRhYmxlIixzSW5mbzoiU2hvd2luZyBfU1RBUlRfIHRvIF9FTkRfIG9mIF9UT1RBTF8gZW50cmllcyIsc0luZm9FbXB0eToiU2hvd2luZyAwIHRvIDAgb2YgMCBlbnRyaWVzIiwNCiAgICAgICAgc0luZm9GaWx0ZXJlZDoiKGZpbHRlcmVkIGZyb20gX01BWF8gdG90YWwgZW50cmllcykiLHNJbmZvUG9zdEZpeDoiIixzRGVjaW1hbDoiIixzVGhvdXNhbmRzOiIsIixzTGVuZ3RoTWVudToiU2hvdyBfTUVOVV8gZW50cmllcyIsc0xvYWRpbmdSZWNvcmRzOiJMb2FkaW5nLi4uIixzUHJvY2Vzc2luZzoiUHJvY2Vzc2luZy4uLiIsc1NlYXJjaDoiU2VhcmNoOiIsc1NlYXJjaFBsYWNlaG9sZGVyOiIiLHNVcmw6IiIsc1plcm9SZWNvcmRzOiJObyBtYXRjaGluZyByZWNvcmRzIGZvdW5kIn0sb1NlYXJjaDpoLmV4dGVuZCh7fSxtLm1vZGVscy5vU2VhcmNoKSxzQWpheERhdGFQcm9wOiJkYXRhIixzQWpheFNvdXJjZTpudWxsLHNEb206ImxmcnRpcCIsc2VhcmNoRGVsYXk6bnVsbCxzUGFnaW5hdGlvblR5cGU6InNpbXBsZV9udW1iZXJzIixzU2Nyb2xsWDoiIixzU2Nyb2xsWElubmVyOiIiLHNTY3JvbGxZOiIiLHNTZXJ2ZXJNZXRob2Q6IkdFVCIscmVuZGVyZXI6bnVsbCxyb3dJZDoiRFRfUm93SWQifTsNCiAgICBYKG0uZGVmYXVsdHMpO20uZGVmYXVsdHMuY29sdW1uPXthRGF0YVNvcnQ6bnVsbCxpRGF0YVNvcnQ6LTEsYXNTb3J0aW5nOlsiYXNjIiwiZGVzYyJdLGJTZWFyY2hhYmxlOiEwLGJTb3J0YWJsZTohMCxiVmlzaWJsZTohMCxmbkNyZWF0ZWRDZWxsOm51bGwsbURhdGE6bnVsbCxtUmVuZGVyOm51bGwsc0NlbGxUeXBlOiJ0ZCIsc0NsYXNzOiIiLHNDb250ZW50UGFkZGluZzoiIixzRGVmYXVsdENvbnRlbnQ6bnVsbCxzTmFtZToiIixzU29ydERhdGFUeXBlOiJzdGQiLHNUaXRsZTpudWxsLHNUeXBlOm51bGwsc1dpZHRoOm51bGx9O1gobS5kZWZhdWx0cy5jb2x1bW4pO20ubW9kZWxzLm9TZXR0aW5ncz17b0ZlYXR1cmVzOntiQXV0b1dpZHRoOm51bGwsYkRlZmVyUmVuZGVyOm51bGwsYkZpbHRlcjpudWxsLGJJbmZvOm51bGwsYkxlbmd0aENoYW5nZTpudWxsLGJQYWdpbmF0ZTpudWxsLGJQcm9jZXNzaW5nOm51bGwsYlNlcnZlclNpZGU6bnVsbCxiU29ydDpudWxsLGJTb3J0TXVsdGk6bnVsbCwNCiAgICAgICAgYlNvcnRDbGFzc2VzOm51bGwsYlN0YXRlU2F2ZTpudWxsfSxvU2Nyb2xsOntiQ29sbGFwc2U6bnVsbCxpQmFyV2lkdGg6MCxzWDpudWxsLHNYSW5uZXI6bnVsbCxzWTpudWxsfSxvTGFuZ3VhZ2U6e2ZuSW5mb0NhbGxiYWNrOm51bGx9LG9Ccm93c2VyOntiU2Nyb2xsT3ZlcnNpemU6ITEsYlNjcm9sbGJhckxlZnQ6ITEsYkJvdW5kaW5nOiExLGJhcldpZHRoOjB9LGFqYXg6bnVsbCxhYW5GZWF0dXJlczpbXSxhb0RhdGE6W10sYWlEaXNwbGF5OltdLGFpRGlzcGxheU1hc3RlcjpbXSxhSWRzOnt9LGFvQ29sdW1uczpbXSxhb0hlYWRlcjpbXSxhb0Zvb3RlcjpbXSxvUHJldmlvdXNTZWFyY2g6e30sYW9QcmVTZWFyY2hDb2xzOltdLGFhU29ydGluZzpudWxsLGFhU29ydGluZ0ZpeGVkOltdLGFzU3RyaXBlQ2xhc3NlczpudWxsLGFzRGVzdHJveVN0cmlwZXM6W10sc0Rlc3Ryb3lXaWR0aDowLGFvUm93Q2FsbGJhY2s6W10sYW9IZWFkZXJDYWxsYmFjazpbXSxhb0Zvb3RlckNhbGxiYWNrOltdLA0KICAgICAgICBhb0RyYXdDYWxsYmFjazpbXSxhb1Jvd0NyZWF0ZWRDYWxsYmFjazpbXSxhb1ByZURyYXdDYWxsYmFjazpbXSxhb0luaXRDb21wbGV0ZTpbXSxhb1N0YXRlU2F2ZVBhcmFtczpbXSxhb1N0YXRlTG9hZFBhcmFtczpbXSxhb1N0YXRlTG9hZGVkOltdLHNUYWJsZUlkOiIiLG5UYWJsZTpudWxsLG5USGVhZDpudWxsLG5URm9vdDpudWxsLG5UQm9keTpudWxsLG5UYWJsZVdyYXBwZXI6bnVsbCxiRGVmZXJMb2FkaW5nOiExLGJJbml0aWFsaXNlZDohMSxhb09wZW5Sb3dzOltdLHNEb206bnVsbCxzZWFyY2hEZWxheTpudWxsLHNQYWdpbmF0aW9uVHlwZToidHdvX2J1dHRvbiIsaVN0YXRlRHVyYXRpb246MCxhb1N0YXRlU2F2ZTpbXSxhb1N0YXRlTG9hZDpbXSxvU2F2ZWRTdGF0ZTpudWxsLG9Mb2FkZWRTdGF0ZTpudWxsLHNBamF4U291cmNlOm51bGwsc0FqYXhEYXRhUHJvcDpudWxsLGJBamF4RGF0YUdldDohMCxqcVhIUjpudWxsLGpzb246ayxvQWpheERhdGE6ayxmblNlcnZlckRhdGE6bnVsbCwNCiAgICAgICAgYW9TZXJ2ZXJQYXJhbXM6W10sc1NlcnZlck1ldGhvZDpudWxsLGZuRm9ybWF0TnVtYmVyOm51bGwsYUxlbmd0aE1lbnU6bnVsbCxpRHJhdzowLGJEcmF3aW5nOiExLGlEcmF3RXJyb3I6LTEsX2lEaXNwbGF5TGVuZ3RoOjEwLF9pRGlzcGxheVN0YXJ0OjAsX2lSZWNvcmRzVG90YWw6MCxfaVJlY29yZHNEaXNwbGF5OjAsb0NsYXNzZXM6e30sYkZpbHRlcmVkOiExLGJTb3J0ZWQ6ITEsYlNvcnRDZWxsc1RvcDpudWxsLG9Jbml0Om51bGwsYW9EZXN0cm95Q2FsbGJhY2s6W10sZm5SZWNvcmRzVG90YWw6ZnVuY3Rpb24oKXtyZXR1cm4ic3NwIj09eSh0aGlzKT8xKnRoaXMuX2lSZWNvcmRzVG90YWw6dGhpcy5haURpc3BsYXlNYXN0ZXIubGVuZ3RofSxmblJlY29yZHNEaXNwbGF5OmZ1bmN0aW9uKCl7cmV0dXJuInNzcCI9PXkodGhpcyk/MSp0aGlzLl9pUmVjb3Jkc0Rpc3BsYXk6dGhpcy5haURpc3BsYXkubGVuZ3RofSxmbkRpc3BsYXlFbmQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLl9pRGlzcGxheUxlbmd0aCwNCiAgICAgICAgICAgIGI9dGhpcy5faURpc3BsYXlTdGFydCxjPWIrYSxkPXRoaXMuYWlEaXNwbGF5Lmxlbmd0aCxlPXRoaXMub0ZlYXR1cmVzLGY9ZS5iUGFnaW5hdGU7cmV0dXJuIGUuYlNlcnZlclNpZGU/ITE9PT1mfHwtMT09PWE/YitkOk1hdGgubWluKGIrYSx0aGlzLl9pUmVjb3Jkc0Rpc3BsYXkpOiFmfHxjPmR8fC0xPT09YT9kOmN9LG9JbnN0YW5jZTpudWxsLHNJbnN0YW5jZTpudWxsLGlUYWJJbmRleDowLG5TY3JvbGxIZWFkOm51bGwsblNjcm9sbEZvb3Q6bnVsbCxhTGFzdFNvcnQ6W10sb1BsdWdpbnM6e30scm93SWRGbjpudWxsLHJvd0lkOm51bGx9O20uZXh0PXg9e2J1dHRvbnM6e30sY2xhc3Nlczp7fSxidWlsZGVyOiItc291cmNlLSIsZXJyTW9kZToiYWxlcnQiLGZlYXR1cmU6W10sc2VhcmNoOltdLHNlbGVjdG9yOntjZWxsOltdLGNvbHVtbjpbXSxyb3c6W119LGludGVybmFsOnt9LGxlZ2FjeTp7YWpheDpudWxsfSxwYWdlcjp7fSxyZW5kZXJlcjp7cGFnZUJ1dHRvbjp7fSxoZWFkZXI6e319LA0KICAgICAgICBvcmRlcjp7fSx0eXBlOntkZXRlY3Q6W10sc2VhcmNoOnt9LG9yZGVyOnt9fSxfdW5pcXVlOjAsZm5WZXJzaW9uQ2hlY2s6bS5mblZlcnNpb25DaGVjayxpQXBpSW5kZXg6MCxvSlVJQ2xhc3Nlczp7fSxzVmVyc2lvbjptLnZlcnNpb259O2guZXh0ZW5kKHgse2FmbkZpbHRlcmluZzp4LnNlYXJjaCxhVHlwZXM6eC50eXBlLmRldGVjdCxvZm5TZWFyY2g6eC50eXBlLnNlYXJjaCxvU29ydDp4LnR5cGUub3JkZXIsYWZuU29ydERhdGE6eC5vcmRlcixhb0ZlYXR1cmVzOnguZmVhdHVyZSxvQXBpOnguaW50ZXJuYWwsb1N0ZENsYXNzZXM6eC5jbGFzc2VzLG9QYWdpbmF0aW9uOngucGFnZXJ9KTtoLmV4dGVuZChtLmV4dC5jbGFzc2VzLHtzVGFibGU6ImRhdGFUYWJsZSIsc05vRm9vdGVyOiJuby1mb290ZXIiLHNQYWdlQnV0dG9uOiJwYWdpbmF0ZV9idXR0b24iLHNQYWdlQnV0dG9uQWN0aXZlOiJjdXJyZW50IixzUGFnZUJ1dHRvbkRpc2FibGVkOiJkaXNhYmxlZCIsc1N0cmlwZU9kZDoib2RkIiwNCiAgICAgICAgc1N0cmlwZUV2ZW46ImV2ZW4iLHNSb3dFbXB0eToiZGF0YVRhYmxlc19lbXB0eSIsc1dyYXBwZXI6ImRhdGFUYWJsZXNfd3JhcHBlciIsc0ZpbHRlcjoiZGF0YVRhYmxlc19maWx0ZXIiLHNJbmZvOiJkYXRhVGFibGVzX2luZm8iLHNQYWdpbmc6ImRhdGFUYWJsZXNfcGFnaW5hdGUgcGFnaW5nXyIsc0xlbmd0aDoiZGF0YVRhYmxlc19sZW5ndGgiLHNQcm9jZXNzaW5nOiJkYXRhVGFibGVzX3Byb2Nlc3NpbmciLHNTb3J0QXNjOiJzb3J0aW5nX2FzYyIsc1NvcnREZXNjOiJzb3J0aW5nX2Rlc2MiLHNTb3J0YWJsZToic29ydGluZyIsc1NvcnRhYmxlQXNjOiJzb3J0aW5nX2FzY19kaXNhYmxlZCIsc1NvcnRhYmxlRGVzYzoic29ydGluZ19kZXNjX2Rpc2FibGVkIixzU29ydGFibGVOb25lOiJzb3J0aW5nX2Rpc2FibGVkIixzU29ydENvbHVtbjoic29ydGluZ18iLHNGaWx0ZXJJbnB1dDoiIixzTGVuZ3RoU2VsZWN0OiIiLHNTY3JvbGxXcmFwcGVyOiJkYXRhVGFibGVzX3Njcm9sbCIsc1Njcm9sbEhlYWQ6ImRhdGFUYWJsZXNfc2Nyb2xsSGVhZCIsDQogICAgICAgIHNTY3JvbGxIZWFkSW5uZXI6ImRhdGFUYWJsZXNfc2Nyb2xsSGVhZElubmVyIixzU2Nyb2xsQm9keToiZGF0YVRhYmxlc19zY3JvbGxCb2R5IixzU2Nyb2xsRm9vdDoiZGF0YVRhYmxlc19zY3JvbGxGb290IixzU2Nyb2xsRm9vdElubmVyOiJkYXRhVGFibGVzX3Njcm9sbEZvb3RJbm5lciIsc0hlYWRlclRIOiIiLHNGb290ZXJUSDoiIixzU29ydEpVSUFzYzoiIixzU29ydEpVSURlc2M6IiIsc1NvcnRKVUk6IiIsc1NvcnRKVUlBc2NBbGxvd2VkOiIiLHNTb3J0SlVJRGVzY0FsbG93ZWQ6IiIsc1NvcnRKVUlXcmFwcGVyOiIiLHNTb3J0SWNvbjoiIixzSlVJSGVhZGVyOiIiLHNKVUlGb290ZXI6IiJ9KTt2YXIgS2I9bS5leHQucGFnZXI7aC5leHRlbmQoS2Ise3NpbXBsZTpmdW5jdGlvbigpe3JldHVyblsicHJldmlvdXMiLCJuZXh0Il19LGZ1bGw6ZnVuY3Rpb24oKXtyZXR1cm5bImZpcnN0IiwicHJldmlvdXMiLCJuZXh0IiwibGFzdCJdfSxudW1iZXJzOmZ1bmN0aW9uKGEsYil7cmV0dXJuW2hhKGEsDQogICAgICAgIGIpXX0sc2ltcGxlX251bWJlcnM6ZnVuY3Rpb24oYSxiKXtyZXR1cm5bInByZXZpb3VzIixoYShhLGIpLCJuZXh0Il19LGZ1bGxfbnVtYmVyczpmdW5jdGlvbihhLGIpe3JldHVyblsiZmlyc3QiLCJwcmV2aW91cyIsaGEoYSxiKSwibmV4dCIsImxhc3QiXX0sZmlyc3RfbGFzdF9udW1iZXJzOmZ1bmN0aW9uKGEsYil7cmV0dXJuWyJmaXJzdCIsaGEoYSxiKSwibGFzdCJdfSxfbnVtYmVyczpoYSxudW1iZXJzX2xlbmd0aDo3fSk7aC5leHRlbmQoITAsbS5leHQucmVuZGVyZXIse3BhZ2VCdXR0b246e186ZnVuY3Rpb24oYSxiLGMsZCxlLGYpe3ZhciBnPWEub0NsYXNzZXMsaj1hLm9MYW5ndWFnZS5vUGFnaW5hdGUsaT1hLm9MYW5ndWFnZS5vQXJpYS5wYWdpbmF0ZXx8e30sbixsLG09MCxvPWZ1bmN0aW9uKGIsZCl7dmFyIGsscyx1LHIsdj1mdW5jdGlvbihiKXtTYShhLGIuZGF0YS5hY3Rpb24sdHJ1ZSl9O2s9MDtmb3Iocz1kLmxlbmd0aDtrPHM7aysrKXtyPWRba107aWYoaC5pc0FycmF5KHIpKXt1PQ0KICAgICAgICBoKCI8Iisoci5EVF9lbHx8ImRpdiIpKyIvPiIpLmFwcGVuZFRvKGIpO28odSxyKX1lbHNle249bnVsbDtsPSIiO3N3aXRjaChyKXtjYXNlICJlbGxpcHNpcyI6Yi5hcHBlbmQoJzxzcGFuIGNsYXNzPSJlbGxpcHNpcyI+JiN4MjAyNjs8L3NwYW4+Jyk7YnJlYWs7Y2FzZSAiZmlyc3QiOm49ai5zRmlyc3Q7bD1yKyhlPjA/IiI6IiAiK2cuc1BhZ2VCdXR0b25EaXNhYmxlZCk7YnJlYWs7Y2FzZSAicHJldmlvdXMiOm49ai5zUHJldmlvdXM7bD1yKyhlPjA/IiI6IiAiK2cuc1BhZ2VCdXR0b25EaXNhYmxlZCk7YnJlYWs7Y2FzZSAibmV4dCI6bj1qLnNOZXh0O2w9cisoZTxmLTE/IiI6IiAiK2cuc1BhZ2VCdXR0b25EaXNhYmxlZCk7YnJlYWs7Y2FzZSAibGFzdCI6bj1qLnNMYXN0O2w9cisoZTxmLTE/IiI6IiAiK2cuc1BhZ2VCdXR0b25EaXNhYmxlZCk7YnJlYWs7ZGVmYXVsdDpuPXIrMTtsPWU9PT1yP2cuc1BhZ2VCdXR0b25BY3RpdmU6IiJ9aWYobiE9PW51bGwpe3U9aCgiPGE+Iix7ImNsYXNzIjpnLnNQYWdlQnV0dG9uKw0KICAgICIgIitsLCJhcmlhLWNvbnRyb2xzIjphLnNUYWJsZUlkLCJhcmlhLWxhYmVsIjppW3JdLCJkYXRhLWR0LWlkeCI6bSx0YWJpbmRleDphLmlUYWJJbmRleCxpZDpjPT09MCYmdHlwZW9mIHI9PT0ic3RyaW5nIj9hLnNUYWJsZUlkKyJfIityOm51bGx9KS5odG1sKG4pLmFwcGVuZFRvKGIpO1ZhKHUse2FjdGlvbjpyfSx2KTttKyt9fX19LHM7dHJ5e3M9aChiKS5maW5kKEcuYWN0aXZlRWxlbWVudCkuZGF0YSgiZHQtaWR4Iil9Y2F0Y2godSl7fW8oaChiKS5lbXB0eSgpLGQpO3MhPT1rJiZoKGIpLmZpbmQoIltkYXRhLWR0LWlkeD0iK3MrIl0iKS5mb2N1cygpfX19KTtoLmV4dGVuZChtLmV4dC50eXBlLmRldGVjdCxbZnVuY3Rpb24oYSxiKXt2YXIgYz1iLm9MYW5ndWFnZS5zRGVjaW1hbDtyZXR1cm4gWWEoYSxjKT8ibnVtIitjOm51bGx9LGZ1bmN0aW9uKGEpe2lmKGEmJiEoYSBpbnN0YW5jZW9mIERhdGUpJiYhWmIudGVzdChhKSlyZXR1cm4gbnVsbDt2YXIgYj1EYXRlLnBhcnNlKGEpOw0KICAgICAgICByZXR1cm4gbnVsbCE9PWImJiFpc05hTihiKXx8TChhKT8iZGF0ZSI6bnVsbH0sZnVuY3Rpb24oYSxiKXt2YXIgYz1iLm9MYW5ndWFnZS5zRGVjaW1hbDtyZXR1cm4gWWEoYSxjLCEwKT8ibnVtLWZtdCIrYzpudWxsfSxmdW5jdGlvbihhLGIpe3ZhciBjPWIub0xhbmd1YWdlLnNEZWNpbWFsO3JldHVybiBQYihhLGMpPyJodG1sLW51bSIrYzpudWxsfSxmdW5jdGlvbihhLGIpe3ZhciBjPWIub0xhbmd1YWdlLnNEZWNpbWFsO3JldHVybiBQYihhLGMsITApPyJodG1sLW51bS1mbXQiK2M6bnVsbH0sZnVuY3Rpb24oYSl7cmV0dXJuIEwoYSl8fCJzdHJpbmciPT09dHlwZW9mIGEmJi0xIT09YS5pbmRleE9mKCI8Iik/Imh0bWwiOm51bGx9XSk7aC5leHRlbmQobS5leHQudHlwZS5zZWFyY2gse2h0bWw6ZnVuY3Rpb24oYSl7cmV0dXJuIEwoYSk/YToic3RyaW5nIj09PXR5cGVvZiBhP2EucmVwbGFjZShNYiwiICIpLnJlcGxhY2UoQWEsIiIpOiIifSxzdHJpbmc6ZnVuY3Rpb24oYSl7cmV0dXJuIEwoYSk/DQogICAgICAgIGE6InN0cmluZyI9PT10eXBlb2YgYT9hLnJlcGxhY2UoTWIsIiAiKTphfX0pO3ZhciB6YT1mdW5jdGlvbihhLGIsYyxkKXtpZigwIT09YSYmKCFhfHwiLSI9PT1hKSlyZXR1cm4tSW5maW5pdHk7YiYmKGE9T2IoYSxiKSk7YS5yZXBsYWNlJiYoYyYmKGE9YS5yZXBsYWNlKGMsIiIpKSxkJiYoYT1hLnJlcGxhY2UoZCwiIikpKTtyZXR1cm4gMSphfTtoLmV4dGVuZCh4LnR5cGUub3JkZXIseyJkYXRlLXByZSI6ZnVuY3Rpb24oYSl7cmV0dXJuIERhdGUucGFyc2UoYSl8fC1JbmZpbml0eX0sImh0bWwtcHJlIjpmdW5jdGlvbihhKXtyZXR1cm4gTChhKT8iIjphLnJlcGxhY2U/YS5yZXBsYWNlKC88Lio/Pi9nLCIiKS50b0xvd2VyQ2FzZSgpOmErIiJ9LCJzdHJpbmctcHJlIjpmdW5jdGlvbihhKXtyZXR1cm4gTChhKT8iIjoic3RyaW5nIj09PXR5cGVvZiBhP2EudG9Mb3dlckNhc2UoKTohYS50b1N0cmluZz8iIjphLnRvU3RyaW5nKCl9LCJzdHJpbmctYXNjIjpmdW5jdGlvbihhLGIpe3JldHVybiBhPA0KICAgIGI/LTE6YT5iPzE6MH0sInN0cmluZy1kZXNjIjpmdW5jdGlvbihhLGIpe3JldHVybiBhPGI/MTphPmI/LTE6MH19KTtjYigiIik7aC5leHRlbmQoITAsbS5leHQucmVuZGVyZXIse2hlYWRlcjp7XzpmdW5jdGlvbihhLGIsYyxkKXtoKGEublRhYmxlKS5vbigib3JkZXIuZHQuRFQiLGZ1bmN0aW9uKGUsZixnLGgpe2lmKGE9PT1mKXtlPWMuaWR4O2IucmVtb3ZlQ2xhc3MoYy5zU29ydGluZ0NsYXNzKyIgIitkLnNTb3J0QXNjKyIgIitkLnNTb3J0RGVzYykuYWRkQ2xhc3MoaFtlXT09ImFzYyI/ZC5zU29ydEFzYzpoW2VdPT0iZGVzYyI/ZC5zU29ydERlc2M6Yy5zU29ydGluZ0NsYXNzKX19KX0sanF1ZXJ5dWk6ZnVuY3Rpb24oYSxiLGMsZCl7aCgiPGRpdi8+IikuYWRkQ2xhc3MoZC5zU29ydEpVSVdyYXBwZXIpLmFwcGVuZChiLmNvbnRlbnRzKCkpLmFwcGVuZChoKCI8c3Bhbi8+IikuYWRkQ2xhc3MoZC5zU29ydEljb24rIiAiK2Muc1NvcnRpbmdDbGFzc0pVSSkpLmFwcGVuZFRvKGIpOw0KICAgICAgICBoKGEublRhYmxlKS5vbigib3JkZXIuZHQuRFQiLGZ1bmN0aW9uKGUsZixnLGgpe2lmKGE9PT1mKXtlPWMuaWR4O2IucmVtb3ZlQ2xhc3MoZC5zU29ydEFzYysiICIrZC5zU29ydERlc2MpLmFkZENsYXNzKGhbZV09PSJhc2MiP2Quc1NvcnRBc2M6aFtlXT09ImRlc2MiP2Quc1NvcnREZXNjOmMuc1NvcnRpbmdDbGFzcyk7Yi5maW5kKCJzcGFuLiIrZC5zU29ydEljb24pLnJlbW92ZUNsYXNzKGQuc1NvcnRKVUlBc2MrIiAiK2Quc1NvcnRKVUlEZXNjKyIgIitkLnNTb3J0SlVJKyIgIitkLnNTb3J0SlVJQXNjQWxsb3dlZCsiICIrZC5zU29ydEpVSURlc2NBbGxvd2VkKS5hZGRDbGFzcyhoW2VdPT0iYXNjIj9kLnNTb3J0SlVJQXNjOmhbZV09PSJkZXNjIj9kLnNTb3J0SlVJRGVzYzpjLnNTb3J0aW5nQ2xhc3NKVUkpfX0pfX19KTt2YXIgVmI9ZnVuY3Rpb24oYSl7cmV0dXJuInN0cmluZyI9PT10eXBlb2YgYT9hLnJlcGxhY2UoLzwvZywiJmx0OyIpLnJlcGxhY2UoLz4vZywiJmd0OyIpLnJlcGxhY2UoLyIvZywNCiAgICAgICAgIiZxdW90OyIpOmF9O20ucmVuZGVyPXtudW1iZXI6ZnVuY3Rpb24oYSxiLGMsZCxlKXtyZXR1cm57ZGlzcGxheTpmdW5jdGlvbihmKXtpZigibnVtYmVyIiE9PXR5cGVvZiBmJiYic3RyaW5nIiE9PXR5cGVvZiBmKXJldHVybiBmO3ZhciBnPTA+Zj8iLSI6IiIsaD1wYXJzZUZsb2F0KGYpO2lmKGlzTmFOKGgpKXJldHVybiBWYihmKTtoPWgudG9GaXhlZChjKTtmPU1hdGguYWJzKGgpO2g9cGFyc2VJbnQoZiwxMCk7Zj1jP2IrKGYtaCkudG9GaXhlZChjKS5zdWJzdHJpbmcoMik6IiI7cmV0dXJuIGcrKGR8fCIiKStoLnRvU3RyaW5nKCkucmVwbGFjZSgvXEIoPz0oXGR7M30pKyg/IVxkKSkvZyxhKStmKyhlfHwiIil9fX0sdGV4dDpmdW5jdGlvbigpe3JldHVybntkaXNwbGF5OlZifX19O2guZXh0ZW5kKG0uZXh0LmludGVybmFsLHtfZm5FeHRlcm5BcGlGdW5jOkxiLF9mbkJ1aWxkQWpheDpzYSxfZm5BamF4VXBkYXRlOmtiLF9mbkFqYXhQYXJhbWV0ZXJzOnRiLF9mbkFqYXhVcGRhdGVEcmF3OnViLA0KICAgICAgICBfZm5BamF4RGF0YVNyYzp0YSxfZm5BZGRDb2x1bW46RGEsX2ZuQ29sdW1uT3B0aW9uczpqYSxfZm5BZGp1c3RDb2x1bW5TaXppbmc6WSxfZm5WaXNpYmxlVG9Db2x1bW5JbmRleDpaLF9mbkNvbHVtbkluZGV4VG9WaXNpYmxlOiQsX2ZuVmlzYmxlQ29sdW1uczphYSxfZm5HZXRDb2x1bW5zOmxhLF9mbkNvbHVtblR5cGVzOkZhLF9mbkFwcGx5Q29sdW1uRGVmczpoYixfZm5IdW5nYXJpYW5NYXA6WCxfZm5DYW1lbFRvSHVuZ2FyaWFuOkksX2ZuTGFuZ3VhZ2VDb21wYXQ6Q2EsX2ZuQnJvd3NlckRldGVjdDpmYixfZm5BZGREYXRhOk0sX2ZuQWRkVHI6bWEsX2ZuTm9kZVRvRGF0YUluZGV4OmZ1bmN0aW9uKGEsYil7cmV0dXJuIGIuX0RUX1Jvd0luZGV4IT09az9iLl9EVF9Sb3dJbmRleDpudWxsfSxfZm5Ob2RlVG9Db2x1bW5JbmRleDpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIGguaW5BcnJheShjLGEuYW9EYXRhW2JdLmFuQ2VsbHMpfSxfZm5HZXRDZWxsRGF0YTpCLF9mblNldENlbGxEYXRhOmliLA0KICAgICAgICBfZm5TcGxpdE9iak5vdGF0aW9uOklhLF9mbkdldE9iamVjdERhdGFGbjpRLF9mblNldE9iamVjdERhdGFGbjpSLF9mbkdldERhdGFNYXN0ZXI6SmEsX2ZuQ2xlYXJUYWJsZTpuYSxfZm5EZWxldGVJbmRleDpvYSxfZm5JbnZhbGlkYXRlOmNhLF9mbkdldFJvd0VsZW1lbnRzOkhhLF9mbkNyZWF0ZVRyOkdhLF9mbkJ1aWxkSGVhZDpqYixfZm5EcmF3SGVhZDplYSxfZm5EcmF3Ok4sX2ZuUmVEcmF3OlMsX2ZuQWRkT3B0aW9uc0h0bWw6bWIsX2ZuRGV0ZWN0SGVhZGVyOmRhLF9mbkdldFVuaXF1ZVRoczpyYSxfZm5GZWF0dXJlSHRtbEZpbHRlcjpvYixfZm5GaWx0ZXJDb21wbGV0ZTpmYSxfZm5GaWx0ZXJDdXN0b206eGIsX2ZuRmlsdGVyQ29sdW1uOndiLF9mbkZpbHRlcjp2YixfZm5GaWx0ZXJDcmVhdGVTZWFyY2g6T2EsX2ZuRXNjYXBlUmVnZXg6UGEsX2ZuRmlsdGVyRGF0YTp5YixfZm5GZWF0dXJlSHRtbEluZm86cmIsX2ZuVXBkYXRlSW5mbzpCYixfZm5JbmZvTWFjcm9zOkNiLF9mbkluaXRpYWxpc2U6Z2EsDQogICAgICAgIF9mbkluaXRDb21wbGV0ZTp1YSxfZm5MZW5ndGhDaGFuZ2U6UWEsX2ZuRmVhdHVyZUh0bWxMZW5ndGg6bmIsX2ZuRmVhdHVyZUh0bWxQYWdpbmF0ZTpzYixfZm5QYWdlQ2hhbmdlOlNhLF9mbkZlYXR1cmVIdG1sUHJvY2Vzc2luZzpwYixfZm5Qcm9jZXNzaW5nRGlzcGxheTpDLF9mbkZlYXR1cmVIdG1sVGFibGU6cWIsX2ZuU2Nyb2xsRHJhdzprYSxfZm5BcHBseVRvQ2hpbGRyZW46SCxfZm5DYWxjdWxhdGVDb2x1bW5XaWR0aHM6RWEsX2ZuVGhyb3R0bGU6TmEsX2ZuQ29udmVydFRvV2lkdGg6RGIsX2ZuR2V0V2lkZXN0Tm9kZTpFYixfZm5HZXRNYXhMZW5TdHJpbmc6RmIsX2ZuU3RyaW5nVG9Dc3M6dixfZm5Tb3J0RmxhdHRlbjpWLF9mblNvcnQ6bGIsX2ZuU29ydEFyaWE6SGIsX2ZuU29ydExpc3RlbmVyOlVhLF9mblNvcnRBdHRhY2hMaXN0ZW5lcjpMYSxfZm5Tb3J0aW5nQ2xhc3Nlczp3YSxfZm5Tb3J0RGF0YTpHYixfZm5TYXZlU3RhdGU6eGEsX2ZuTG9hZFN0YXRlOkliLF9mblNldHRpbmdzRnJvbU5vZGU6eWEsDQogICAgICAgIF9mbkxvZzpKLF9mbk1hcDpGLF9mbkJpbmRBY3Rpb246VmEsX2ZuQ2FsbGJhY2tSZWc6eixfZm5DYWxsYmFja0ZpcmU6cixfZm5MZW5ndGhPdmVyZmxvdzpSYSxfZm5SZW5kZXJlcjpNYSxfZm5EYXRhU291cmNlOnksX2ZuUm93QXR0cmlidXRlczpLYSxfZm5DYWxjdWxhdGVFbmQ6ZnVuY3Rpb24oKXt9fSk7aC5mbi5kYXRhVGFibGU9bTttLiQ9aDtoLmZuLmRhdGFUYWJsZVNldHRpbmdzPW0uc2V0dGluZ3M7aC5mbi5kYXRhVGFibGVFeHQ9bS5leHQ7aC5mbi5EYXRhVGFibGU9ZnVuY3Rpb24oYSl7cmV0dXJuIGgodGhpcykuZGF0YVRhYmxlKGEpLmFwaSgpfTtoLmVhY2gobSxmdW5jdGlvbihhLGIpe2guZm4uRGF0YVRhYmxlW2FdPWJ9KTtyZXR1cm4gaC5mbi5kYXRhVGFibGV9KTsKLyohIEZpeGVkQ29sdW1ucyAzLjIuMy1kZXYNCiAqIMKpMjAxMC0yMDE2IFNwcnlNZWRpYSBMdGQgLSBkYXRhdGFibGVzLm5ldC9saWNlbnNlDQogKi8NCg0KLyoqDQogKiBAc3VtbWFyeSAgICAgRml4ZWRDb2x1bW5zDQogKiBAZGVzY3JpcHRpb24gRnJlZXplIGNvbHVtbnMgaW4gcGxhY2Ugb24gYSBzY3JvbGxpbmcgRGF0YVRhYmxlDQogKiBAdmVyc2lvbiAgICAgMy4yLjMtZGV2DQogKiBAZmlsZSAgICAgICAgZGF0YVRhYmxlcy5maXhlZENvbHVtbnMuanMNCiAqIEBhdXRob3IgICAgICBTcHJ5TWVkaWEgTHRkICh3d3cuc3ByeW1lZGlhLmNvLnVrKQ0KICogQGNvbnRhY3QgICAgIHd3dy5zcHJ5bWVkaWEuY28udWsvY29udGFjdA0KICogQGNvcHlyaWdodCAgIENvcHlyaWdodCAyMDEwLTIwMTYgU3ByeU1lZGlhIEx0ZC4NCiAqDQogKiBUaGlzIHNvdXJjZSBmaWxlIGlzIGZyZWUgc29mdHdhcmUsIGF2YWlsYWJsZSB1bmRlciB0aGUgZm9sbG93aW5nIGxpY2Vuc2U6DQogKiAgIE1JVCBsaWNlbnNlIC0gaHR0cDovL2RhdGF0YWJsZXMubmV0L2xpY2Vuc2UvbWl0DQogKg0KICogVGhpcyBzb3VyY2UgZmlsZSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLCBidXQNCiAqIFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YgTUVSQ0hBTlRBQklMSVRZDQogKiBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gU2VlIHRoZSBsaWNlbnNlIGZpbGVzIGZvciBkZXRhaWxzLg0KICoNCiAqIEZvciBkZXRhaWxzIHBsZWFzZSByZWZlciB0bzogaHR0cDovL3d3dy5kYXRhdGFibGVzLm5ldA0KICovDQooZnVuY3Rpb24oIGZhY3RvcnkgKXsNCiAgICBpZiAoIHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCApIHsNCiAgICAgICAgLy8gQU1EDQogICAgICAgIGRlZmluZSggWydqcXVlcnknLCAnZGF0YXRhYmxlcy5uZXQnXSwgZnVuY3Rpb24gKCAkICkgew0KICAgICAgICAgICAgcmV0dXJuIGZhY3RvcnkoICQsIHdpbmRvdywgZG9jdW1lbnQgKTsNCiAgICAgICAgfSApOw0KICAgIH0NCiAgICBlbHNlIGlmICggdHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICkgew0KICAgICAgICAvLyBDb21tb25KUw0KICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChyb290LCAkKSB7DQogICAgICAgICAgICBpZiAoICEgcm9vdCApIHsNCiAgICAgICAgICAgICAgICByb290ID0gd2luZG93Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoICEgJCB8fCAhICQuZm4uZGF0YVRhYmxlICkgew0KICAgICAgICAgICAgICAgICQgPSByZXF1aXJlKCdkYXRhdGFibGVzLm5ldCcpKHJvb3QsICQpLiQ7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiBmYWN0b3J5KCAkLCByb290LCByb290LmRvY3VtZW50ICk7DQogICAgICAgIH07DQogICAgfQ0KICAgIGVsc2Ugew0KICAgICAgICAvLyBCcm93c2VyDQogICAgICAgIGZhY3RvcnkoIGpRdWVyeSwgd2luZG93LCBkb2N1bWVudCApOw0KICAgIH0NCn0oZnVuY3Rpb24oICQsIHdpbmRvdywgZG9jdW1lbnQsIHVuZGVmaW5lZCApIHsNCiAgICAndXNlIHN0cmljdCc7DQogICAgdmFyIERhdGFUYWJsZSA9ICQuZm4uZGF0YVRhYmxlOw0KICAgIHZhciBfZmlyZWZveFNjcm9sbDsNCg0KICAgIC8qKg0KICAgICAqIFdoZW4gbWFraW5nIHVzZSBvZiBEYXRhVGFibGVzJyB4LWF4aXMgc2Nyb2xsaW5nIGZlYXR1cmUsIHlvdSBtYXkgd2lzaCB0bw0KICAgICAqIGZpeCB0aGUgbGVmdCBtb3N0IGNvbHVtbiBpbiBwbGFjZS4gVGhpcyBwbHVnLWluIGZvciBEYXRhVGFibGVzIHByb3ZpZGVzDQogICAgICogZXhhY3RseSB0aGlzIG9wdGlvbiAobm90ZSBmb3Igbm9uLXNjcm9sbGluZyB0YWJsZXMsIHBsZWFzZSB1c2UgdGhlDQogICAgICogRml4ZWRIZWFkZXIgcGx1Zy1pbiwgd2hpY2ggY2FuIGZpeCBoZWFkZXJzIGFuZCBmb290ZXJzKS4gS2V5DQogICAgICogZmVhdHVyZXMgaW5jbHVkZToNCiAgICAgKg0KICAgICAqICogRnJlZXplcyB0aGUgbGVmdCBvciByaWdodCBtb3N0IGNvbHVtbnMgdG8gdGhlIHNpZGUgb2YgdGhlIHRhYmxlDQogICAgICogKiBPcHRpb24gdG8gZnJlZXplIHR3byBvciBtb3JlIGNvbHVtbnMNCiAgICAgKiAqIEZ1bGwgaW50ZWdyYXRpb24gd2l0aCBEYXRhVGFibGVzJyBzY3JvbGxpbmcgb3B0aW9ucw0KICAgICAqICogU3BlZWQgLSBGaXhlZENvbHVtbnMgaXMgZmFzdCBpbiBpdHMgb3BlcmF0aW9uDQogICAgICoNCiAgICAgKiAgQGNsYXNzDQogICAgICogIEBjb25zdHJ1Y3Rvcg0KICAgICAqICBAZ2xvYmFsDQogICAgICogIEBwYXJhbSB7b2JqZWN0fSBkdCBEYXRhVGFibGVzIGluc3RhbmNlLiBXaXRoIERhdGFUYWJsZXMgMS4xMCB0aGlzIGNhbiBhbHNvDQogICAgICogICAgYmUgYSBqUXVlcnkgY29sbGVjdGlvbiwgYSBqUXVlcnkgc2VsZWN0b3IsIERhdGFUYWJsZXMgQVBJIGluc3RhbmNlIG9yDQogICAgICogICAgc2V0dGluZ3Mgb2JqZWN0Lg0KICAgICAqICBAcGFyYW0ge29iamVjdH0gW2luaXQ9e31dIENvbmZpZ3VyYXRpb24gb2JqZWN0IGZvciBGaXhlZENvbHVtbnMuIE9wdGlvbnMgYXJlDQogICAgICogICAgZGVmaW5lZCBieSB7QGxpbmsgRml4ZWRDb2x1bW5zLmRlZmF1bHRzfQ0KICAgICAqDQogICAgICogIEByZXF1aXJlcyBqUXVlcnkgMS43Kw0KICAgICAqICBAcmVxdWlyZXMgRGF0YVRhYmxlcyAxLjguMCsNCiAgICAgKg0KICAgICAqICBAZXhhbXBsZQ0KICAgICAqICAgICAgdmFyIHRhYmxlID0gJCgnI2V4YW1wbGUnKS5kYXRhVGFibGUoIHsNCiAqICAgICAgICAic2Nyb2xsWCI6ICIxMDAlIg0KICogICAgICB9ICk7DQogICAgICogICAgICBuZXcgJC5mbi5kYXRhVGFibGUuZml4ZWRDb2x1bW5zKCB0YWJsZSApOw0KICAgICAqLw0KICAgIHZhciBGaXhlZENvbHVtbnMgPSBmdW5jdGlvbiAoIGR0LCBpbml0ICkgew0KICAgICAgICB2YXIgdGhhdCA9IHRoaXM7DQoNCiAgICAgICAgLyogU2FuaXR5IGNoZWNrIC0geW91IGp1c3Qga25vdyBpdCB3aWxsIGhhcHBlbiAqLw0KICAgICAgICBpZiAoICEgKCB0aGlzIGluc3RhbmNlb2YgRml4ZWRDb2x1bW5zICkgKSB7DQogICAgICAgICAgICBhbGVydCggIkZpeGVkQ29sdW1ucyB3YXJuaW5nOiBGaXhlZENvbHVtbnMgbXVzdCBiZSBpbml0aWFsaXNlZCB3aXRoIHRoZSAnbmV3JyBrZXl3b3JkLiIgKTsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICggaW5pdCA9PT0gdW5kZWZpbmVkIHx8IGluaXQgPT09IHRydWUgKSB7DQogICAgICAgICAgICBpbml0ID0ge307DQogICAgICAgIH0NCg0KICAgICAgICAvLyBVc2UgdGhlIERhdGFUYWJsZXMgSHVuZ2FyaWFuIG5vdGF0aW9uIG1hcHBpbmcgbWV0aG9kLCBpZiBpdCBleGlzdHMgdG8NCiAgICAgICAgLy8gcHJvdmlkZSBmb3J3YXJkcyBjb21wYXRpYmlsaXR5IGZvciBjYW1lbCBjYXNlIHZhcmlhYmxlcw0KICAgICAgICB2YXIgY2FtZWxUb0h1bmdhcmlhbiA9ICQuZm4uZGF0YVRhYmxlLmNhbWVsVG9IdW5nYXJpYW47DQogICAgICAgIGlmICggY2FtZWxUb0h1bmdhcmlhbiApIHsNCiAgICAgICAgICAgIGNhbWVsVG9IdW5nYXJpYW4oIEZpeGVkQ29sdW1ucy5kZWZhdWx0cywgRml4ZWRDb2x1bW5zLmRlZmF1bHRzLCB0cnVlICk7DQogICAgICAgICAgICBjYW1lbFRvSHVuZ2FyaWFuKCBGaXhlZENvbHVtbnMuZGVmYXVsdHMsIGluaXQgKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIHYxLjEwIGFsbG93cyB0aGUgc2V0dGluZ3Mgb2JqZWN0IHRvIGJlIGdvdCBmb3JtIGEgbnVtYmVyIG9mIHNvdXJjZXMNCiAgICAgICAgdmFyIGR0U2V0dGluZ3MgPSBuZXcgJC5mbi5kYXRhVGFibGUuQXBpKCBkdCApLnNldHRpbmdzKClbMF07DQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIFNldHRpbmdzIG9iamVjdCB3aGljaCBjb250YWlucyBjdXN0b21pc2FibGUgaW5mb3JtYXRpb24gZm9yIEZpeGVkQ29sdW1ucyBpbnN0YW5jZQ0KICAgICAgICAgKiBAbmFtZXNwYWNlDQogICAgICAgICAqIEBleHRlbmRzIEZpeGVkQ29sdW1ucy5kZWZhdWx0cw0KICAgICAgICAgKiBAcHJpdmF0ZQ0KICAgICAgICAgKi8NCiAgICAgICAgdGhpcy5zID0gew0KICAgICAgICAgICAgLyoqDQogICAgICAgICAgICAgKiBEYXRhVGFibGVzIHNldHRpbmdzIG9iamVjdHMNCiAgICAgICAgICAgICAqICBAdHlwZSAgICAgb2JqZWN0DQogICAgICAgICAgICAgKiAgQGRlZmF1bHQgIE9idGFpbmVkIGZyb20gRGF0YVRhYmxlcyBpbnN0YW5jZQ0KICAgICAgICAgICAgICovDQogICAgICAgICAgICAiZHQiOiBkdFNldHRpbmdzLA0KDQogICAgICAgICAgICAvKioNCiAgICAgICAgICAgICAqIE51bWJlciBvZiBjb2x1bW5zIGluIHRoZSBEYXRhVGFibGUgLSBzdG9yZWQgZm9yIHF1aWNrIGFjY2Vzcw0KICAgICAgICAgICAgICogIEB0eXBlICAgICBpbnQNCiAgICAgICAgICAgICAqICBAZGVmYXVsdCAgT2J0YWluZWQgZnJvbSBEYXRhVGFibGVzIGluc3RhbmNlDQogICAgICAgICAgICAgKi8NCiAgICAgICAgICAgICJpVGFibGVDb2x1bW5zIjogZHRTZXR0aW5ncy5hb0NvbHVtbnMubGVuZ3RoLA0KDQogICAgICAgICAgICAvKioNCiAgICAgICAgICAgICAqIE9yaWdpbmFsIG91dGVyIHdpZHRocyBvZiB0aGUgY29sdW1ucyBhcyByZW5kZXJlZCBieSBEYXRhVGFibGVzIC0gdXNlZCB0byBjYWxjdWxhdGUNCiAgICAgICAgICAgICAqIHRoZSBGaXhlZENvbHVtbnMgZ3JpZCBib3VuZGluZyBib3gNCiAgICAgICAgICAgICAqICBAdHlwZSAgICAgYXJyYXkuPGludD4NCiAgICAgICAgICAgICAqICBAZGVmYXVsdCAgW10NCiAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgImFpT3V0ZXJXaWR0aHMiOiBbXSwNCg0KICAgICAgICAgICAgLyoqDQogICAgICAgICAgICAgKiBPcmlnaW5hbCBpbm5lciB3aWR0aHMgb2YgdGhlIGNvbHVtbnMgYXMgcmVuZGVyZWQgYnkgRGF0YVRhYmxlcyAtIHVzZWQgdG8gYXBwbHkgd2lkdGhzDQogICAgICAgICAgICAgKiB0byB0aGUgY29sdW1ucw0KICAgICAgICAgICAgICogIEB0eXBlICAgICBhcnJheS48aW50Pg0KICAgICAgICAgICAgICogIEBkZWZhdWx0ICBbXQ0KICAgICAgICAgICAgICovDQogICAgICAgICAgICAiYWlJbm5lcldpZHRocyI6IFtdLA0KDQoNCiAgICAgICAgICAgIC8qKg0KICAgICAgICAgICAgICogSXMgdGhlIGRvY3VtZW50IGxheW91dCByaWdodC10by1sZWZ0DQogICAgICAgICAgICAgKiBAdHlwZSBib29sZWFuDQogICAgICAgICAgICAgKi8NCiAgICAgICAgICAgIHJ0bDogJChkdFNldHRpbmdzLm5UYWJsZSkuY3NzKCdkaXJlY3Rpb24nKSA9PT0gJ3J0bCcNCiAgICAgICAgfTsNCg0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBET00gZWxlbWVudHMgdXNlZCBieSB0aGUgY2xhc3MgaW5zdGFuY2UNCiAgICAgICAgICogQG5hbWVzcGFjZQ0KICAgICAgICAgKiBAcHJpdmF0ZQ0KICAgICAgICAgKg0KICAgICAgICAgKi8NCiAgICAgICAgdGhpcy5kb20gPSB7DQogICAgICAgICAgICAvKioNCiAgICAgICAgICAgICAqIERhdGFUYWJsZXMgc2Nyb2xsaW5nIGVsZW1lbnQNCiAgICAgICAgICAgICAqICBAdHlwZSAgICAgbm9kZQ0KICAgICAgICAgICAgICogIEBkZWZhdWx0ICBudWxsDQogICAgICAgICAgICAgKi8NCiAgICAgICAgICAgICJzY3JvbGxlciI6IG51bGwsDQoNCiAgICAgICAgICAgIC8qKg0KICAgICAgICAgICAgICogRGF0YVRhYmxlcyBoZWFkZXIgdGFibGUNCiAgICAgICAgICAgICAqICBAdHlwZSAgICAgbm9kZQ0KICAgICAgICAgICAgICogIEBkZWZhdWx0ICBudWxsDQogICAgICAgICAgICAgKi8NCiAgICAgICAgICAgICJoZWFkZXIiOiBudWxsLA0KDQogICAgICAgICAgICAvKioNCiAgICAgICAgICAgICAqIERhdGFUYWJsZXMgYm9keSB0YWJsZQ0KICAgICAgICAgICAgICogIEB0eXBlICAgICBub2RlDQogICAgICAgICAgICAgKiAgQGRlZmF1bHQgIG51bGwNCiAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgImJvZHkiOiBudWxsLA0KDQogICAgICAgICAgICAvKioNCiAgICAgICAgICAgICAqIERhdGFUYWJsZXMgZm9vdGVyIHRhYmxlDQogICAgICAgICAgICAgKiAgQHR5cGUgICAgIG5vZGUNCiAgICAgICAgICAgICAqICBAZGVmYXVsdCAgbnVsbA0KICAgICAgICAgICAgICovDQogICAgICAgICAgICAiZm9vdGVyIjogbnVsbCwNCg0KICAgICAgICAgICAgLyoqDQogICAgICAgICAgICAgKiBEaXNwbGF5IGdyaWQgZWxlbWVudHMNCiAgICAgICAgICAgICAqIEBuYW1lc3BhY2UNCiAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgImdyaWQiOiB7DQogICAgICAgICAgICAgICAgLyoqDQogICAgICAgICAgICAgICAgICogR3JpZCB3cmFwcGVyLiBUaGlzIGlzIHRoZSBjb250YWluZXIgZWxlbWVudCBmb3IgdGhlIDN4MyBncmlkDQogICAgICAgICAgICAgICAgICogIEB0eXBlICAgICBub2RlDQogICAgICAgICAgICAgICAgICogIEBkZWZhdWx0ICBudWxsDQogICAgICAgICAgICAgICAgICovDQogICAgICAgICAgICAgICAgIndyYXBwZXIiOiBudWxsLA0KDQogICAgICAgICAgICAgICAgLyoqDQogICAgICAgICAgICAgICAgICogRGF0YVRhYmxlcyBzY3JvbGxpbmcgZWxlbWVudC4gVGhpcyBlbGVtZW50IGlzIHRoZSBEYXRhVGFibGVzDQogICAgICAgICAgICAgICAgICogY29tcG9uZW50IGluIHRoZSBkaXNwbGF5IGdyaWQgKG1ha2luZyB1cCB0aGUgbWFpbiB0YWJsZSAtIGkuZS4NCiAgICAgICAgICAgICAgICAgKiBub3QgdGhlIGZpeGVkIGNvbHVtbnMpLg0KICAgICAgICAgICAgICAgICAqICBAdHlwZSAgICAgbm9kZQ0KICAgICAgICAgICAgICAgICAqICBAZGVmYXVsdCAgbnVsbA0KICAgICAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgICAgICJkdCI6IG51bGwsDQoNCiAgICAgICAgICAgICAgICAvKioNCiAgICAgICAgICAgICAgICAgKiBMZWZ0IGZpeGVkIGNvbHVtbiBncmlkIGNvbXBvbmVudHMNCiAgICAgICAgICAgICAgICAgKiBAbmFtZXNwYWNlDQogICAgICAgICAgICAgICAgICovDQogICAgICAgICAgICAgICAgImxlZnQiOiB7DQogICAgICAgICAgICAgICAgICAgICJ3cmFwcGVyIjogbnVsbCwNCiAgICAgICAgICAgICAgICAgICAgImhlYWQiOiBudWxsLA0KICAgICAgICAgICAgICAgICAgICAiYm9keSI6IG51bGwsDQogICAgICAgICAgICAgICAgICAgICJmb290IjogbnVsbA0KICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAvKioNCiAgICAgICAgICAgICAgICAgKiBSaWdodCBmaXhlZCBjb2x1bW4gZ3JpZCBjb21wb25lbnRzDQogICAgICAgICAgICAgICAgICogQG5hbWVzcGFjZQ0KICAgICAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAgICAgIndyYXBwZXIiOiBudWxsLA0KICAgICAgICAgICAgICAgICAgICAiaGVhZCI6IG51bGwsDQogICAgICAgICAgICAgICAgICAgICJib2R5IjogbnVsbCwNCiAgICAgICAgICAgICAgICAgICAgImZvb3QiOiBudWxsDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgLyoqDQogICAgICAgICAgICAgKiBDbG9uZWQgdGFibGUgbm9kZXMNCiAgICAgICAgICAgICAqIEBuYW1lc3BhY2UNCiAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgImNsb25lIjogew0KICAgICAgICAgICAgICAgIC8qKg0KICAgICAgICAgICAgICAgICAqIExlZnQgY29sdW1uIGNsb25lZCB0YWJsZSBub2Rlcw0KICAgICAgICAgICAgICAgICAqIEBuYW1lc3BhY2UNCiAgICAgICAgICAgICAgICAgKi8NCiAgICAgICAgICAgICAgICAibGVmdCI6IHsNCiAgICAgICAgICAgICAgICAgICAgLyoqDQogICAgICAgICAgICAgICAgICAgICAqIENsb25lZCBoZWFkZXIgdGFibGUNCiAgICAgICAgICAgICAgICAgICAgICogIEB0eXBlICAgICBub2RlDQogICAgICAgICAgICAgICAgICAgICAqICBAZGVmYXVsdCAgbnVsbA0KICAgICAgICAgICAgICAgICAgICAgKi8NCiAgICAgICAgICAgICAgICAgICAgImhlYWRlciI6IG51bGwsDQoNCiAgICAgICAgICAgICAgICAgICAgLyoqDQogICAgICAgICAgICAgICAgICAgICAqIENsb25lZCBib2R5IHRhYmxlDQogICAgICAgICAgICAgICAgICAgICAqICBAdHlwZSAgICAgbm9kZQ0KICAgICAgICAgICAgICAgICAgICAgKiAgQGRlZmF1bHQgIG51bGwNCiAgICAgICAgICAgICAgICAgICAgICovDQogICAgICAgICAgICAgICAgICAgICJib2R5IjogbnVsbCwNCg0KICAgICAgICAgICAgICAgICAgICAvKioNCiAgICAgICAgICAgICAgICAgICAgICogQ2xvbmVkIGZvb3RlciB0YWJsZQ0KICAgICAgICAgICAgICAgICAgICAgKiAgQHR5cGUgICAgIG5vZGUNCiAgICAgICAgICAgICAgICAgICAgICogIEBkZWZhdWx0ICBudWxsDQogICAgICAgICAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgICAgICAgICAiZm9vdGVyIjogbnVsbA0KICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAvKioNCiAgICAgICAgICAgICAgICAgKiBSaWdodCBjb2x1bW4gY2xvbmVkIHRhYmxlIG5vZGVzDQogICAgICAgICAgICAgICAgICogQG5hbWVzcGFjZQ0KICAgICAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgICAgICJyaWdodCI6IHsNCiAgICAgICAgICAgICAgICAgICAgLyoqDQogICAgICAgICAgICAgICAgICAgICAqIENsb25lZCBoZWFkZXIgdGFibGUNCiAgICAgICAgICAgICAgICAgICAgICogIEB0eXBlICAgICBub2RlDQogICAgICAgICAgICAgICAgICAgICAqICBAZGVmYXVsdCAgbnVsbA0KICAgICAgICAgICAgICAgICAgICAgKi8NCiAgICAgICAgICAgICAgICAgICAgImhlYWRlciI6IG51bGwsDQoNCiAgICAgICAgICAgICAgICAgICAgLyoqDQogICAgICAgICAgICAgICAgICAgICAqIENsb25lZCBib2R5IHRhYmxlDQogICAgICAgICAgICAgICAgICAgICAqICBAdHlwZSAgICAgbm9kZQ0KICAgICAgICAgICAgICAgICAgICAgKiAgQGRlZmF1bHQgIG51bGwNCiAgICAgICAgICAgICAgICAgICAgICovDQogICAgICAgICAgICAgICAgICAgICJib2R5IjogbnVsbCwNCg0KICAgICAgICAgICAgICAgICAgICAvKioNCiAgICAgICAgICAgICAgICAgICAgICogQ2xvbmVkIGZvb3RlciB0YWJsZQ0KICAgICAgICAgICAgICAgICAgICAgKiAgQHR5cGUgICAgIG5vZGUNCiAgICAgICAgICAgICAgICAgICAgICogIEBkZWZhdWx0ICBudWxsDQogICAgICAgICAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgICAgICAgICAiZm9vdGVyIjogbnVsbA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfTsNCg0KICAgICAgICBpZiAoIGR0U2V0dGluZ3MuX29GaXhlZENvbHVtbnMgKSB7DQogICAgICAgICAgICB0aHJvdyAnRml4ZWRDb2x1bW5zIGFscmVhZHkgaW5pdGlhbGlzZWQgb24gdGhpcyB0YWJsZSc7DQogICAgICAgIH0NCg0KICAgICAgICAvKiBBdHRhY2ggdGhlIGluc3RhbmNlIHRvIHRoZSBEYXRhVGFibGVzIGluc3RhbmNlIHNvIGl0IGNhbiBiZSBhY2Nlc3NlZCBlYXNpbHkgKi8NCiAgICAgICAgZHRTZXR0aW5ncy5fb0ZpeGVkQ29sdW1ucyA9IHRoaXM7DQoNCiAgICAgICAgLyogTGV0J3MgZG8gaXQgKi8NCiAgICAgICAgaWYgKCAhIGR0U2V0dGluZ3MuX2JJbml0Q29tcGxldGUgKQ0KICAgICAgICB7DQogICAgICAgICAgICBkdFNldHRpbmdzLm9BcGkuX2ZuQ2FsbGJhY2tSZWcoIGR0U2V0dGluZ3MsICdhb0luaXRDb21wbGV0ZScsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICB0aGF0Ll9mbkNvbnN0cnVjdCggaW5pdCApOw0KICAgICAgICAgICAgfSwgJ0ZpeGVkQ29sdW1ucycgKTsNCiAgICAgICAgfQ0KICAgICAgICBlbHNlDQogICAgICAgIHsNCiAgICAgICAgICAgIHRoaXMuX2ZuQ29uc3RydWN0KCBpbml0ICk7DQogICAgICAgIH0NCiAgICB9Ow0KDQoNCg0KICAgICQuZXh0ZW5kKCBGaXhlZENvbHVtbnMucHJvdG90eXBlICwgew0KICAgICAgICAvKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqDQogICAgICAgICAqIFB1YmxpYyBtZXRob2RzDQogICAgICAgICAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICovDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIFVwZGF0ZSB0aGUgZml4ZWQgY29sdW1ucyAtIGluY2x1ZGluZyBoZWFkZXJzIGFuZCBmb290ZXJzLiBOb3RlIHRoYXQgRml4ZWRDb2x1bW5zIHdpbGwNCiAgICAgICAgICogYXV0b21hdGljYWxseSB1cGRhdGUgdGhlIGRpc3BsYXkgd2hlbmV2ZXIgdGhlIGhvc3QgRGF0YVRhYmxlIHJlZHJhd3MuDQogICAgICAgICAqICBAcmV0dXJucyB7dm9pZH0NCiAgICAgICAgICogIEBleGFtcGxlDQogICAgICAgICAqICAgICAgdmFyIHRhYmxlID0gJCgnI2V4YW1wbGUnKS5kYXRhVGFibGUoIHsNCgkgKiAgICAgICAgICAic2Nyb2xsWCI6ICIxMDAlIg0KCSAqICAgICAgfSApOw0KICAgICAgICAgKiAgICAgIHZhciBmYyA9IG5ldyAkLmZuLmRhdGFUYWJsZS5maXhlZENvbHVtbnMoIHRhYmxlICk7DQogICAgICAgICAqDQogICAgICAgICAqICAgICAgLy8gYXQgc29tZSBsYXRlciBwb2ludCB3aGVuIHRoZSB0YWJsZSBoYXMgYmVlbiBtYW5pcHVsYXRlZC4uLi4NCiAgICAgICAgICogICAgICBmYy5mblVwZGF0ZSgpOw0KICAgICAgICAgKi8NCiAgICAgICAgImZuVXBkYXRlIjogZnVuY3Rpb24gKCkNCiAgICAgICAgew0KICAgICAgICAgICAgdGhpcy5fZm5EcmF3KCB0cnVlICk7DQogICAgICAgIH0sDQoNCg0KICAgICAgICAvKioNCiAgICAgICAgICogUmVjYWxjdWxhdGUgdGhlIHJlc2l6ZXMgb2YgdGhlIDN4MyBncmlkIHRoYXQgRml4ZWRDb2x1bW5zIHVzZXMgZm9yIGRpc3BsYXkgb2YgdGhlIHRhYmxlLg0KICAgICAgICAgKiBUaGlzIGlzIHVzZWZ1bCBpZiB5b3UgdXBkYXRlIHRoZSB3aWR0aCBvZiB0aGUgdGFibGUgY29udGFpbmVyLiBOb3RlIHRoYXQgRml4ZWRDb2x1bW5zIHdpbGwNCiAgICAgICAgICogcGVyZm9ybSB0aGlzIGZ1bmN0aW9uIGF1dG9tYXRpY2FsbHkgd2hlbiB0aGUgd2luZG93LnJlc2l6ZSBldmVudCBpcyBmaXJlZC4NCiAgICAgICAgICogIEByZXR1cm5zIHt2b2lkfQ0KICAgICAgICAgKiAgQGV4YW1wbGUNCiAgICAgICAgICogICAgICB2YXIgdGFibGUgPSAkKCcjZXhhbXBsZScpLmRhdGFUYWJsZSggew0KCSAqICAgICAgICAgICJzY3JvbGxYIjogIjEwMCUiDQoJICogICAgICB9ICk7DQogICAgICAgICAqICAgICAgdmFyIGZjID0gbmV3ICQuZm4uZGF0YVRhYmxlLmZpeGVkQ29sdW1ucyggdGFibGUgKTsNCiAgICAgICAgICoNCiAgICAgICAgICogICAgICAvLyBSZXNpemUgdGhlIHRhYmxlIGNvbnRhaW5lciBhbmQgdGhlbiBoYXZlIEZpeGVkQ29sdW1ucyBhZGp1c3QgaXRzIGxheW91dC4uLi4NCiAgICAgICAgICogICAgICAkKCcjY29udGVudCcpLndpZHRoKCAxMjAwICk7DQogICAgICAgICAqICAgICAgZmMuZm5SZWRyYXdMYXlvdXQoKTsNCiAgICAgICAgICovDQogICAgICAgICJmblJlZHJhd0xheW91dCI6IGZ1bmN0aW9uICgpDQogICAgICAgIHsNCiAgICAgICAgICAgIHRoaXMuX2ZuQ29sQ2FsYygpOw0KICAgICAgICAgICAgdGhpcy5fZm5HcmlkTGF5b3V0KCk7DQogICAgICAgICAgICB0aGlzLmZuVXBkYXRlKCk7DQogICAgICAgIH0sDQoNCg0KICAgICAgICAvKioNCiAgICAgICAgICogTWFyayBhIHJvdyBzdWNoIHRoYXQgaXQncyBoZWlnaHQgc2hvdWxkIGJlIHJlY2FsY3VsYXRlZCB3aGVuIHVzaW5nICdzZW1pYXV0bycgcm93DQogICAgICAgICAqIGhlaWdodCBtYXRjaGluZy4gVGhpcyBmdW5jdGlvbiB3aWxsIGhhdmUgbm8gZWZmZWN0IHdoZW4gJ25vbmUnIG9yICdhdXRvJyByb3cgaGVpZ2h0DQogICAgICAgICAqIG1hdGNoaW5nIGlzIHVzZWQuDQogICAgICAgICAqICBAcGFyYW0gICB7Tm9kZX0gblRyIFRSIGVsZW1lbnQgdGhhdCBzaG91bGQgaGF2ZSBpdCdzIGhlaWdodCByZWNhbGN1bGF0ZWQNCiAgICAgICAgICogIEByZXR1cm5zIHt2b2lkfQ0KICAgICAgICAgKiAgQGV4YW1wbGUNCiAgICAgICAgICogICAgICB2YXIgdGFibGUgPSAkKCcjZXhhbXBsZScpLmRhdGFUYWJsZSggew0KCSAqICAgICAgICAgICJzY3JvbGxYIjogIjEwMCUiDQoJICogICAgICB9ICk7DQogICAgICAgICAqICAgICAgdmFyIGZjID0gbmV3ICQuZm4uZGF0YVRhYmxlLmZpeGVkQ29sdW1ucyggdGFibGUgKTsNCiAgICAgICAgICoNCiAgICAgICAgICogICAgICAvLyBtYW5pcHVsYXRlIHRoZSB0YWJsZSAtIG1hcmsgdGhlIHJvdyBhcyBuZWVkaW5nIGFuIHVwZGF0ZSB0aGVuIHVwZGF0ZSB0aGUgdGFibGUNCiAgICAgICAgICogICAgICAvLyB0aGlzIGFsbG93cyB0aGUgcmVkcmF3IHBlcmZvcm1lZCBieSBEYXRhVGFibGVzIGZuVXBkYXRlIHRvIHJlY2FsY3VsYXRlIHRoZSByb3cNCiAgICAgICAgICogICAgICAvLyBoZWlnaHQNCiAgICAgICAgICogICAgICBmYy5mblJlY2FsY3VsYXRlSGVpZ2h0KCk7DQogICAgICAgICAqICAgICAgdGFibGUuZm5VcGRhdGUoICQoJyNleGFtcGxlIHRib2R5IHRyOmVxKDApJylbMF0sIFsiaW5zZXJ0IGRhdGUiLCAxLCAyLCAzIC4uLiBdKTsNCiAgICAgICAgICovDQogICAgICAgICJmblJlY2FsY3VsYXRlSGVpZ2h0IjogZnVuY3Rpb24gKCBuVHIgKQ0KICAgICAgICB7DQogICAgICAgICAgICBkZWxldGUgblRyLl9EVFRDX2lIZWlnaHQ7DQogICAgICAgICAgICBuVHIuc3R5bGUuaGVpZ2h0ID0gJ2F1dG8nOw0KICAgICAgICB9LA0KDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIFNldCB0aGUgaGVpZ2h0IG9mIGEgZ2l2ZW4gcm93IC0gcHJvdmlkZXMgY3Jvc3MgYnJvd3NlciBjb21wYXRpYmlsaXR5DQogICAgICAgICAqICBAcGFyYW0gICB7Tm9kZX0gblRhcmdldCBUUiBlbGVtZW50IHRoYXQgc2hvdWxkIGhhdmUgaXQncyBoZWlnaHQgcmVjYWxjdWxhdGVkDQogICAgICAgICAqICBAcGFyYW0gICB7aW50fSBpSGVpZ2h0IEhlaWdodCBpbiBwaXhlbHMgdG8gc2V0DQogICAgICAgICAqICBAcmV0dXJucyB7dm9pZH0NCiAgICAgICAgICogIEBleGFtcGxlDQogICAgICAgICAqICAgICAgdmFyIHRhYmxlID0gJCgnI2V4YW1wbGUnKS5kYXRhVGFibGUoIHsNCgkgKiAgICAgICAgICAic2Nyb2xsWCI6ICIxMDAlIg0KCSAqICAgICAgfSApOw0KICAgICAgICAgKiAgICAgIHZhciBmYyA9IG5ldyAkLmZuLmRhdGFUYWJsZS5maXhlZENvbHVtbnMoIHRhYmxlICk7DQogICAgICAgICAqDQogICAgICAgICAqICAgICAgLy8gWW91IG1heSB3YW50IHRvIGRvIHRoaXMgYWZ0ZXIgbWFuaXB1bGF0aW5nIGEgcm93IGluIHRoZSBmaXhlZCBjb2x1bW4NCiAgICAgICAgICogICAgICBmYy5mblNldFJvd0hlaWdodCggJCgnI2V4YW1wbGUgdGJvZHkgdHI6ZXEoMCknKVswXSwgNTAgKTsNCiAgICAgICAgICovDQogICAgICAgICJmblNldFJvd0hlaWdodCI6IGZ1bmN0aW9uICggblRhcmdldCwgaUhlaWdodCApDQogICAgICAgIHsNCiAgICAgICAgICAgIG5UYXJnZXQuc3R5bGUuaGVpZ2h0ID0gaUhlaWdodCsicHgiOw0KICAgICAgICB9LA0KDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIEdldCBkYXRhIGluZGV4IGluZm9ybWF0aW9uIGFib3V0IGEgcm93IG9yIGNlbGwgaW4gdGhlIHRhYmxlIGJvZHkuDQogICAgICAgICAqIFRoaXMgZnVuY3Rpb24gaXMgZnVuY3Rpb25hbGx5IGlkZW50aWNhbCB0byBmbkdldFBvc2l0aW9uIGluIERhdGFUYWJsZXMsDQogICAgICAgICAqIHRha2luZyB0aGUgc2FtZSBwYXJhbWV0ZXIgKFRILCBURCBvciBUUiBub2RlKSBhbmQgcmV0dXJuaW5nIGV4YWN0bHkgdGhlDQogICAgICAgICAqIHRoZSBzYW1lIGluZm9ybWF0aW9uIChkYXRhIGluZGV4IGluZm9ybWF0aW9uKS4gVEhlIGRpZmZlcmVuY2UgYmV0d2Vlbg0KICAgICAgICAgKiB0aGUgdHdvIGlzIHRoYXQgdGhpcyBtZXRob2QgdGFrZXMgaW50byBhY2NvdW50IHRoZSBmaXhlZCBjb2x1bW5zIGluIHRoZQ0KICAgICAgICAgKiB0YWJsZSwgc28geW91IGNhbiBwYXNzIGluIG5vZGVzIGZyb20gdGhlIG1hc3RlciB0YWJsZSwgb3IgdGhlIGNsb25lZA0KICAgICAgICAgKiB0YWJsZXMgYW5kIGdldCB0aGUgaW5kZXggcG9zaXRpb24gZm9yIHRoZSBkYXRhIGluIHRoZSBtYWluIHRhYmxlLg0KICAgICAgICAgKiAgQHBhcmFtIHtub2RlfSBub2RlIFRSLCBUSCBvciBURCBlbGVtZW50IHRvIGdldCB0aGUgaW5mb3JtYXRpb24gYWJvdXQNCiAgICAgICAgICogIEByZXR1cm5zIHtpbnR9IElmIG5Ob2RlIGlzIGdpdmVuIGFzIGEgVFIsIHRoZW4gYSBzaW5nbGUgaW5kZXggaXMNCiAgICAgICAgICogICAgcmV0dXJuZWQsIG9yIGlmIGdpdmVuIGFzIGEgY2VsbCwgYW4gYXJyYXkgb2YgW3JvdyBpbmRleCwgY29sdW1uIGluZGV4DQogICAgICAgICAqICAgICh2aXNpYmxlKSwgY29sdW1uIGluZGV4IChhbGwpXSBpcyBnaXZlbi4NCiAgICAgICAgICovDQogICAgICAgICJmbkdldFBvc2l0aW9uIjogZnVuY3Rpb24gKCBub2RlICkNCiAgICAgICAgew0KICAgICAgICAgICAgdmFyIGlkeDsNCiAgICAgICAgICAgIHZhciBpbnN0ID0gdGhpcy5zLmR0Lm9JbnN0YW5jZTsNCg0KICAgICAgICAgICAgaWYgKCAhICQobm9kZSkucGFyZW50cygnLkRURkNfQ2xvbmVkJykubGVuZ3RoICkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAvLyBOb3QgaW4gYSBjbG9uZWQgdGFibGUNCiAgICAgICAgICAgICAgICByZXR1cm4gaW5zdC5mbkdldFBvc2l0aW9uKCBub2RlICk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgLy8gSXRzIGluIHRoZSBjbG9uZWQgdGFibGUsIHNvIG5lZWQgdG8gbG9vayB1cCBwb3NpdGlvbg0KICAgICAgICAgICAgICAgIGlmICggbm9kZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSAndHInICkgew0KICAgICAgICAgICAgICAgICAgICBpZHggPSAkKG5vZGUpLmluZGV4KCk7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBpbnN0LmZuR2V0UG9zaXRpb24oICQoJ3RyJywgdGhpcy5zLmR0Lm5UQm9keSlbIGlkeCBdICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIHZhciBjb2xJZHggPSAkKG5vZGUpLmluZGV4KCk7DQogICAgICAgICAgICAgICAgICAgIGlkeCA9ICQobm9kZS5wYXJlbnROb2RlKS5pbmRleCgpOw0KICAgICAgICAgICAgICAgICAgICB2YXIgcm93ID0gaW5zdC5mbkdldFBvc2l0aW9uKCAkKCd0cicsIHRoaXMucy5kdC5uVEJvZHkpWyBpZHggXSApOw0KDQogICAgICAgICAgICAgICAgICAgIHJldHVybiBbDQogICAgICAgICAgICAgICAgICAgICAgICByb3csDQogICAgICAgICAgICAgICAgICAgICAgICBjb2xJZHgsDQogICAgICAgICAgICAgICAgICAgICAgICBpbnN0Lm9BcGkuX2ZuVmlzaWJsZVRvQ29sdW1uSW5kZXgoIHRoaXMucy5kdCwgY29sSWR4ICkNCiAgICAgICAgICAgICAgICAgICAgXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCg0KDQogICAgICAgIC8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICoNCiAgICAgICAgICogUHJpdmF0ZSBtZXRob2RzICh0aGV5IGFyZSBvZiBjb3Vyc2UgcHVibGljIGluIEpTLCBidXQgcmVjb21tZW5kZWQgYXMgcHJpdmF0ZSkNCiAgICAgICAgICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKi8NCg0KICAgICAgICAvKioNCiAgICAgICAgICogSW5pdGlhbGlzYXRpb24gZm9yIEZpeGVkQ29sdW1ucw0KICAgICAgICAgKiAgQHBhcmFtICAge09iamVjdH0gb0luaXQgVXNlciBzZXR0aW5ncyBmb3IgaW5pdGlhbGlzYXRpb24NCiAgICAgICAgICogIEByZXR1cm5zIHt2b2lkfQ0KICAgICAgICAgKiAgQHByaXZhdGUNCiAgICAgICAgICovDQogICAgICAgICJfZm5Db25zdHJ1Y3QiOiBmdW5jdGlvbiAoIG9Jbml0ICkNCiAgICAgICAgew0KICAgICAgICAgICAgdmFyIGksIGlMZW4sIGlXaWR0aCwNCiAgICAgICAgICAgICAgICB0aGF0ID0gdGhpczsNCg0KICAgICAgICAgICAgLyogU2FuaXR5IGNoZWNraW5nICovDQogICAgICAgICAgICBpZiAoIHR5cGVvZiB0aGlzLnMuZHQub0luc3RhbmNlLmZuVmVyc2lvbkNoZWNrICE9ICdmdW5jdGlvbicgfHwNCiAgICAgICAgICAgICAgICB0aGlzLnMuZHQub0luc3RhbmNlLmZuVmVyc2lvbkNoZWNrKCAnMS44LjAnICkgIT09IHRydWUgKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGFsZXJ0KCAiRml4ZWRDb2x1bW5zICIrRml4ZWRDb2x1bW5zLlZFUlNJT04rIiByZXF1aXJlZCBEYXRhVGFibGVzIDEuOC4wIG9yIGxhdGVyLiAiKw0KICAgICAgICAgICAgICAgICAgICAiUGxlYXNlIHVwZ3JhZGUgeW91ciBEYXRhVGFibGVzIGluc3RhbGxhdGlvbiIgKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggdGhpcy5zLmR0Lm9TY3JvbGwuc1ggPT09ICIiICkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICB0aGlzLnMuZHQub0luc3RhbmNlLm9BcGkuX2ZuTG9nKCB0aGlzLnMuZHQsIDEsICJGaXhlZENvbHVtbnMgaXMgbm90IG5lZWRlZCAobm8gIisNCiAgICAgICAgICAgICAgICAgICAgIngtc2Nyb2xsaW5nIGluIERhdGFUYWJsZXMgZW5hYmxlZCksIHNvIG5vIGFjdGlvbiB3aWxsIGJlIHRha2VuLiBVc2UgJ0ZpeGVkSGVhZGVyJyBmb3IgIisNCiAgICAgICAgICAgICAgICAgICAgImNvbHVtbiBmaXhpbmcgd2hlbiBzY3JvbGxpbmcgaXMgbm90IGVuYWJsZWQiICk7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvKiBBcHBseSB0aGUgc2V0dGluZ3MgZnJvbSB0aGUgdXNlciAvIGRlZmF1bHRzICovDQogICAgICAgICAgICB0aGlzLnMgPSAkLmV4dGVuZCggdHJ1ZSwgdGhpcy5zLCBGaXhlZENvbHVtbnMuZGVmYXVsdHMsIG9Jbml0ICk7DQoNCiAgICAgICAgICAgIC8qIFNldCB1cCB0aGUgRE9NIGFzIHdlIG5lZWQgaXQgYW5kIGNhY2hlIG5vZGVzICovDQogICAgICAgICAgICB2YXIgY2xhc3NlcyA9IHRoaXMucy5kdC5vQ2xhc3NlczsNCiAgICAgICAgICAgIHRoaXMuZG9tLmdyaWQuZHQgPSAkKHRoaXMucy5kdC5uVGFibGUpLnBhcmVudHMoJ2Rpdi4nK2NsYXNzZXMuc1Njcm9sbFdyYXBwZXIpWzBdOw0KICAgICAgICAgICAgdGhpcy5kb20uc2Nyb2xsZXIgPSAkKCdkaXYuJytjbGFzc2VzLnNTY3JvbGxCb2R5LCB0aGlzLmRvbS5ncmlkLmR0IClbMF07DQoNCiAgICAgICAgICAgIC8qIFNldCB1cCB0aGUgRE9NIHRoYXQgd2Ugd2FudCBmb3IgdGhlIGZpeGVkIGNvbHVtbiBsYXlvdXQgZ3JpZCAqLw0KICAgICAgICAgICAgdGhpcy5fZm5Db2xDYWxjKCk7DQogICAgICAgICAgICB0aGlzLl9mbkdyaWRTZXR1cCgpOw0KDQogICAgICAgICAgICAvKiBFdmVudCBoYW5kbGVycyAqLw0KICAgICAgICAgICAgdmFyIG1vdXNlQ29udHJvbGxlcjsNCiAgICAgICAgICAgIHZhciBtb3VzZURvd24gPSBmYWxzZTsNCg0KICAgICAgICAgICAgLy8gV2hlbiB0aGUgbW91c2UgaXMgZG93biAoZHJhZyBzY3JvbGwpIHRoZSBtb3VzZSBjb250cm9sbGVyIGNhbm5vdA0KICAgICAgICAgICAgLy8gY2hhbmdlLCBhcyB0aGUgYnJvd3NlciBrZWVwcyB0aGUgb3JpZ2luYWwgZWxlbWVudCBhcyB0aGUgc2Nyb2xsaW5nIG9uZQ0KICAgICAgICAgICAgJCh0aGlzLnMuZHQublRhYmxlV3JhcHBlcikub24oICdtb3VzZWRvd24uRFRGQycsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICBtb3VzZURvd24gPSB0cnVlOw0KDQogICAgICAgICAgICAgICAgJChkb2N1bWVudCkub25lKCAnbW91c2V1cCcsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgbW91c2VEb3duID0gZmFsc2U7DQogICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICAvLyBXaGVuIHRoZSBib2R5IGlzIHNjcm9sbGVkIC0gc2Nyb2xsIHRoZSBsZWZ0IGFuZCByaWdodCBjb2x1bW5zDQogICAgICAgICAgICAkKHRoaXMuZG9tLnNjcm9sbGVyKQ0KICAgICAgICAgICAgICAgIC5vbiggJ21vdXNlb3Zlci5EVEZDIHRvdWNoc3RhcnQuRFRGQycsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCAhIG1vdXNlRG93biApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1vdXNlQ29udHJvbGxlciA9ICdtYWluJzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0gKQ0KICAgICAgICAgICAgICAgIC5vbiggJ3Njcm9sbC5EVEZDJywgZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCAhIG1vdXNlQ29udHJvbGxlciAmJiBlLm9yaWdpbmFsRXZlbnQgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBtb3VzZUNvbnRyb2xsZXIgPSAnbWFpbic7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICBpZiAoIG1vdXNlQ29udHJvbGxlciA9PT0gJ21haW4nICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGF0LnMuaUxlZnRDb2x1bW5zID4gMCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGF0LmRvbS5ncmlkLmxlZnQubGluZXIuc2Nyb2xsVG9wID0gdGhhdC5kb20uc2Nyb2xsZXIuc2Nyb2xsVG9wOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGF0LnMuaVJpZ2h0Q29sdW1ucyA+IDAgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5kb20uZ3JpZC5yaWdodC5saW5lci5zY3JvbGxUb3AgPSB0aGF0LmRvbS5zY3JvbGxlci5zY3JvbGxUb3A7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgIHZhciB3aGVlbFR5cGUgPSAnb253aGVlbCcgaW4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JykgPw0KICAgICAgICAgICAgICAgICd3aGVlbC5EVEZDJyA6DQogICAgICAgICAgICAgICAgJ21vdXNld2hlZWwuRFRGQyc7DQoNCiAgICAgICAgICAgIGlmICggdGhhdC5zLmlMZWZ0Q29sdW1ucyA+IDAgKSB7DQogICAgICAgICAgICAgICAgLy8gV2hlbiBzY3JvbGxpbmcgdGhlIGxlZnQgY29sdW1uLCBzY3JvbGwgdGhlIGJvZHkgYW5kIHJpZ2h0IGNvbHVtbg0KICAgICAgICAgICAgICAgICQodGhhdC5kb20uZ3JpZC5sZWZ0LmxpbmVyKQ0KICAgICAgICAgICAgICAgICAgICAub24oICdtb3VzZW92ZXIuRFRGQyB0b3VjaHN0YXJ0LkRURkMnLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoICEgbW91c2VEb3duICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vdXNlQ29udHJvbGxlciA9ICdsZWZ0JzsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSApDQogICAgICAgICAgICAgICAgICAgIC5vbiggJ3Njcm9sbC5EVEZDJywgZnVuY3Rpb24gKCBlICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAhIG1vdXNlQ29udHJvbGxlciAmJiBlLm9yaWdpbmFsRXZlbnQgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbW91c2VDb250cm9sbGVyID0gJ2xlZnQnOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIG1vdXNlQ29udHJvbGxlciA9PT0gJ2xlZnQnICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuZG9tLnNjcm9sbGVyLnNjcm9sbFRvcCA9IHRoYXQuZG9tLmdyaWQubGVmdC5saW5lci5zY3JvbGxUb3A7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGF0LnMuaVJpZ2h0Q29sdW1ucyA+IDAgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuZG9tLmdyaWQucmlnaHQubGluZXIuc2Nyb2xsVG9wID0gdGhhdC5kb20uZ3JpZC5sZWZ0LmxpbmVyLnNjcm9sbFRvcDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0gKQ0KICAgICAgICAgICAgICAgICAgICAub24oIHdoZWVsVHlwZSwgZnVuY3Rpb24oZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gUGFzcyBob3Jpem9udGFsIHNjcm9sbGluZyB0aHJvdWdoDQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgeERlbHRhID0gZS50eXBlID09PSAnd2hlZWwnID8NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtZS5vcmlnaW5hbEV2ZW50LmRlbHRhWCA6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5vcmlnaW5hbEV2ZW50LndoZWVsRGVsdGFYOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5kb20uc2Nyb2xsZXIuc2Nyb2xsTGVmdCAtPSB4RGVsdGE7DQogICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCB0aGF0LnMuaVJpZ2h0Q29sdW1ucyA+IDAgKSB7DQogICAgICAgICAgICAgICAgLy8gV2hlbiBzY3JvbGxpbmcgdGhlIHJpZ2h0IGNvbHVtbiwgc2Nyb2xsIHRoZSBib2R5IGFuZCB0aGUgbGVmdCBjb2x1bW4NCiAgICAgICAgICAgICAgICAkKHRoYXQuZG9tLmdyaWQucmlnaHQubGluZXIpDQogICAgICAgICAgICAgICAgICAgIC5vbiggJ21vdXNlb3Zlci5EVEZDIHRvdWNoc3RhcnQuRFRGQycsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggISBtb3VzZURvd24gKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbW91c2VDb250cm9sbGVyID0gJ3JpZ2h0JzsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSApDQogICAgICAgICAgICAgICAgICAgIC5vbiggJ3Njcm9sbC5EVEZDJywgZnVuY3Rpb24gKCBlICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAhIG1vdXNlQ29udHJvbGxlciAmJiBlLm9yaWdpbmFsRXZlbnQgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbW91c2VDb250cm9sbGVyID0gJ3JpZ2h0JzsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBtb3VzZUNvbnRyb2xsZXIgPT09ICdyaWdodCcgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5kb20uc2Nyb2xsZXIuc2Nyb2xsVG9wID0gdGhhdC5kb20uZ3JpZC5yaWdodC5saW5lci5zY3JvbGxUb3A7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGF0LnMuaUxlZnRDb2x1bW5zID4gMCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5kb20uZ3JpZC5sZWZ0LmxpbmVyLnNjcm9sbFRvcCA9IHRoYXQuZG9tLmdyaWQucmlnaHQubGluZXIuc2Nyb2xsVG9wOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSApDQogICAgICAgICAgICAgICAgICAgIC5vbiggd2hlZWxUeXBlLCBmdW5jdGlvbihlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBQYXNzIGhvcml6b250YWwgc2Nyb2xsaW5nIHRocm91Z2gNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4RGVsdGEgPSBlLnR5cGUgPT09ICd3aGVlbCcgPw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1lLm9yaWdpbmFsRXZlbnQuZGVsdGFYIDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLm9yaWdpbmFsRXZlbnQud2hlZWxEZWx0YVg7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGF0LmRvbS5zY3JvbGxlci5zY3JvbGxMZWZ0IC09IHhEZWx0YTsNCiAgICAgICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAkKHdpbmRvdykub24oICdyZXNpemUuRFRGQycsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICB0aGF0Ll9mbkdyaWRMYXlvdXQuY2FsbCggdGhhdCApOw0KICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICB2YXIgYkZpcnN0RHJhdyA9IHRydWU7DQogICAgICAgICAgICB2YXIganFUYWJsZSA9ICQodGhpcy5zLmR0Lm5UYWJsZSk7DQoNCiAgICAgICAgICAgIGpxVGFibGUNCiAgICAgICAgICAgICAgICAub24oICdkcmF3LmR0LkRURkMnLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoYXQuX2ZuQ29sQ2FsYygpOw0KICAgICAgICAgICAgICAgICAgICB0aGF0Ll9mbkRyYXcuY2FsbCggdGhhdCwgYkZpcnN0RHJhdyApOw0KICAgICAgICAgICAgICAgICAgICBiRmlyc3REcmF3ID0gZmFsc2U7DQogICAgICAgICAgICAgICAgfSApDQogICAgICAgICAgICAgICAgLm9uKCAnY29sdW1uLXNpemluZy5kdC5EVEZDJywgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGF0Ll9mbkNvbENhbGMoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhhdC5fZm5HcmlkTGF5b3V0KCB0aGF0ICk7DQogICAgICAgICAgICAgICAgfSApDQogICAgICAgICAgICAgICAgLm9uKCAnY29sdW1uLXZpc2liaWxpdHkuZHQuRFRGQycsIGZ1bmN0aW9uICggZSwgc2V0dGluZ3MsIGNvbHVtbiwgdmlzLCByZWNhbGMgKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICggcmVjYWxjID09PSB1bmRlZmluZWQgfHwgcmVjYWxjICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5fZm5Db2xDYWxjKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGF0Ll9mbkdyaWRMYXlvdXQoIHRoYXQgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuX2ZuRHJhdyggdHJ1ZSApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSApDQogICAgICAgICAgICAgICAgLm9uKCAnc2VsZWN0LmR0LkRURkMgZGVzZWxlY3QuZHQuRFRGQycsIGZ1bmN0aW9uICggZSwgZHQsIHR5cGUsIGluZGV4ZXMgKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICggZS5uYW1lc3BhY2UgPT09ICdkdCcgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGF0Ll9mbkRyYXcoIGZhbHNlICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9ICkNCiAgICAgICAgICAgICAgICAub24oICdkZXN0cm95LmR0LkRURkMnLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgIGpxVGFibGUub2ZmKCAnLkRURkMnICk7DQoNCiAgICAgICAgICAgICAgICAgICAgJCh0aGF0LmRvbS5zY3JvbGxlcikub2ZmKCAnLkRURkMnICk7DQogICAgICAgICAgICAgICAgICAgICQod2luZG93KS5vZmYoICcuRFRGQycgKTsNCiAgICAgICAgICAgICAgICAgICAgJCh0aGF0LnMuZHQublRhYmxlV3JhcHBlcikub2ZmKCAnLkRURkMnICk7DQoNCiAgICAgICAgICAgICAgICAgICAgJCh0aGF0LmRvbS5ncmlkLmxlZnQubGluZXIpLm9mZiggJy5EVEZDICcrd2hlZWxUeXBlICk7DQogICAgICAgICAgICAgICAgICAgICQodGhhdC5kb20uZ3JpZC5sZWZ0LndyYXBwZXIpLnJlbW92ZSgpOw0KDQogICAgICAgICAgICAgICAgICAgICQodGhhdC5kb20uZ3JpZC5yaWdodC5saW5lcikub2ZmKCAnLkRURkMgJyt3aGVlbFR5cGUgKTsNCiAgICAgICAgICAgICAgICAgICAgJCh0aGF0LmRvbS5ncmlkLnJpZ2h0LndyYXBwZXIpLnJlbW92ZSgpOw0KICAgICAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgLyogR2V0IHRoaW5ncyByaWdodCB0byBzdGFydCB3aXRoIC0gbm90ZSB0aGF0IGR1ZSB0byBhZGp1c3RpbmcgdGhlIGNvbHVtbnMsIHRoZXJlIG11c3QgYmUNCiAgICAgICAgICAgICAqIGFub3RoZXIgcmVkcmF3IG9mIHRoZSBtYWluIHRhYmxlLiBJdCBkb2Vzbid0IG5lZWQgdG8gYmUgYSBmdWxsIHJlZHJhdyBob3dldmVyLg0KICAgICAgICAgICAgICovDQogICAgICAgICAgICB0aGlzLl9mbkdyaWRMYXlvdXQoKTsNCiAgICAgICAgICAgIHRoaXMucy5kdC5vSW5zdGFuY2UuZm5EcmF3KGZhbHNlKTsNCiAgICAgICAgfSwNCg0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBDYWxjdWxhdGUgdGhlIGNvbHVtbiB3aWR0aHMgZm9yIHRoZSBncmlkIGxheW91dA0KICAgICAgICAgKiAgQHJldHVybnMge3ZvaWR9DQogICAgICAgICAqICBAcHJpdmF0ZQ0KICAgICAgICAgKi8NCiAgICAgICAgIl9mbkNvbENhbGMiOiBmdW5jdGlvbiAoKQ0KICAgICAgICB7DQogICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7DQogICAgICAgICAgICB2YXIgaUxlZnRXaWR0aCA9IDA7DQogICAgICAgICAgICB2YXIgaVJpZ2h0V2lkdGggPSAwOw0KDQogICAgICAgICAgICB0aGlzLnMuYWlJbm5lcldpZHRocyA9IFtdOw0KICAgICAgICAgICAgdGhpcy5zLmFpT3V0ZXJXaWR0aHMgPSBbXTsNCg0KICAgICAgICAgICAgJC5lYWNoKCB0aGlzLnMuZHQuYW9Db2x1bW5zLCBmdW5jdGlvbiAoaSwgY29sKSB7DQogICAgICAgICAgICAgICAgdmFyIHRoID0gJChjb2wublRoKTsNCiAgICAgICAgICAgICAgICB2YXIgYm9yZGVyOw0KDQogICAgICAgICAgICAgICAgaWYgKCAhIHRoLmZpbHRlcignOnZpc2libGUnKS5sZW5ndGggKSB7DQogICAgICAgICAgICAgICAgICAgIHRoYXQucy5haUlubmVyV2lkdGhzLnB1c2goIDAgKTsNCiAgICAgICAgICAgICAgICAgICAgdGhhdC5zLmFpT3V0ZXJXaWR0aHMucHVzaCggMCApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAvLyBJbm5lciB3aWR0aCBpcyB1c2VkIHRvIGFzc2lnbiB3aWR0aHMgdG8gY2VsbHMNCiAgICAgICAgICAgICAgICAgICAgLy8gT3V0ZXIgd2lkdGggaXMgdXNlZCB0byBjYWxjdWxhdGUgdGhlIGNvbnRhaW5lcg0KICAgICAgICAgICAgICAgICAgICB2YXIgaVdpZHRoID0gdGgub3V0ZXJXaWR0aCgpOw0KDQogICAgICAgICAgICAgICAgICAgIC8vIFdoZW4gd29ya2luZyB3aXRoIHRoZSBsZWZ0IG1vc3QtY2VsbCwgbmVlZCB0byBhZGQgb24gdGhlDQogICAgICAgICAgICAgICAgICAgIC8vIHRhYmxlJ3MgYm9yZGVyIHRvIHRoZSBvdXRlcldpZHRoLCBzaW5jZSB3ZSBuZWVkIHRvIHRha2UNCiAgICAgICAgICAgICAgICAgICAgLy8gYWNjb3VudCBvZiBpdCwgYnV0IGl0IGlzbid0IGluIGFueSBjZWxsDQogICAgICAgICAgICAgICAgICAgIGlmICggdGhhdC5zLmFpT3V0ZXJXaWR0aHMubGVuZ3RoID09PSAwICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYm9yZGVyID0gJCh0aGF0LnMuZHQublRhYmxlKS5jc3MoJ2JvcmRlci1sZWZ0LXdpZHRoJyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpV2lkdGggKz0gdHlwZW9mIGJvcmRlciA9PT0gJ3N0cmluZycgPyAxIDogcGFyc2VJbnQoIGJvcmRlciwgMTAgKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIC8vIExpa2V3aXNlIHdpdGggdGhlIGZpbmFsIGNvbHVtbiBvbiB0aGUgcmlnaHQNCiAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGF0LnMuYWlPdXRlcldpZHRocy5sZW5ndGggPT09IHRoYXQucy5kdC5hb0NvbHVtbnMubGVuZ3RoLTEgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBib3JkZXIgPSAkKHRoYXQucy5kdC5uVGFibGUpLmNzcygnYm9yZGVyLXJpZ2h0LXdpZHRoJyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpV2lkdGggKz0gdHlwZW9mIGJvcmRlciA9PT0gJ3N0cmluZycgPyAxIDogcGFyc2VJbnQoIGJvcmRlciwgMTAgKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIHRoYXQucy5haU91dGVyV2lkdGhzLnB1c2goIGlXaWR0aCApOw0KICAgICAgICAgICAgICAgICAgICB0aGF0LnMuYWlJbm5lcldpZHRocy5wdXNoKCB0aC53aWR0aCgpICk7DQoNCiAgICAgICAgICAgICAgICAgICAgaWYgKCBpIDwgdGhhdC5zLmlMZWZ0Q29sdW1ucyApDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlMZWZ0V2lkdGggKz0gaVdpZHRoOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgaWYgKCB0aGF0LnMuaVRhYmxlQ29sdW1ucy10aGF0LnMuaVJpZ2h0Q29sdW1ucyA8PSBpICkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgaVJpZ2h0V2lkdGggKz0gaVdpZHRoOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICB0aGlzLnMuaUxlZnRXaWR0aCA9IGlMZWZ0V2lkdGg7DQogICAgICAgICAgICB0aGlzLnMuaVJpZ2h0V2lkdGggPSBpUmlnaHRXaWR0aDsNCiAgICAgICAgfSwNCg0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBTZXQgdXAgdGhlIERPTSBmb3IgdGhlIGZpeGVkIGNvbHVtbi4gVGhlIHdheSB0aGUgbGF5b3V0IHdvcmtzIGlzIHRvIGNyZWF0ZSBhIDF4MyBncmlkDQogICAgICAgICAqIGZvciB0aGUgbGVmdCBjb2x1bW4sIHRoZSBEYXRhVGFibGUgKGZvciB3aGljaCB3ZSBqdXN0IHJldXNlIHRoZSBzY3JvbGxpbmcgZWxlbWVudCBEYXRhVGFibGUNCiAgICAgICAgICogcHV0cyBpbnRvIHRoZSBET00pIGFuZCB0aGUgcmlnaHQgY29sdW1uLiBJbiBlYWNoIG9mIGhlIHR3byBmaXhlZCBjb2x1bW4gZWxlbWVudHMgdGhlcmUgaXMgYQ0KICAgICAgICAgKiBncm91cGluZyB3cmFwcGVyIGVsZW1lbnQgYW5kIHRoZW4gYSBoZWFkLCBib2R5IGFuZCBmb290ZXIgd3JhcHBlci4gSW4gZWFjaCBvZiB0aGVzZSB3ZSB0aGVuDQogICAgICAgICAqIHBsYWNlIHRoZSBjbG9uZWQgaGVhZGVyLCBib2R5IG9yIGZvb3RlciB0YWJsZXMuIFRoaXMgZWZmZWN0aXZlbHkgZ2l2ZXMgYXMgM3gzIGdyaWQgc3RydWN0dXJlLg0KICAgICAgICAgKiAgQHJldHVybnMge3ZvaWR9DQogICAgICAgICAqICBAcHJpdmF0ZQ0KICAgICAgICAgKi8NCiAgICAgICAgIl9mbkdyaWRTZXR1cCI6IGZ1bmN0aW9uICgpDQogICAgICAgIHsNCiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpczsNCiAgICAgICAgICAgIHZhciBvT3ZlcmZsb3cgPSB0aGlzLl9mbkRUT3ZlcmZsb3coKTsNCiAgICAgICAgICAgIHZhciBibG9jazsNCg0KICAgICAgICAgICAgdGhpcy5kb20uYm9keSA9IHRoaXMucy5kdC5uVGFibGU7DQogICAgICAgICAgICB0aGlzLmRvbS5oZWFkZXIgPSB0aGlzLnMuZHQublRIZWFkLnBhcmVudE5vZGU7DQogICAgICAgICAgICB0aGlzLmRvbS5oZWFkZXIucGFyZW50Tm9kZS5wYXJlbnROb2RlLnN0eWxlLnBvc2l0aW9uID0gInJlbGF0aXZlIjsNCg0KICAgICAgICAgICAgdmFyIG5TV3JhcHBlciA9DQogICAgICAgICAgICAgICAgJCgnPGRpdiBjbGFzcz0iRFRGQ19TY3JvbGxXcmFwcGVyIiBzdHlsZT0icG9zaXRpb246cmVsYXRpdmU7IGNsZWFyOmJvdGg7Ij4nKw0KICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0iRFRGQ19MZWZ0V3JhcHBlciIgc3R5bGU9InBvc2l0aW9uOmFic29sdXRlOyB0b3A6MDsgbGVmdDowOyI+JysNCiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9IkRURkNfTGVmdEhlYWRXcmFwcGVyIiBzdHlsZT0icG9zaXRpb246cmVsYXRpdmU7IHRvcDowOyBsZWZ0OjA7IG92ZXJmbG93OmhpZGRlbjsiPjwvZGl2PicrDQogICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJEVEZDX0xlZnRCb2R5V3JhcHBlciIgc3R5bGU9InBvc2l0aW9uOnJlbGF0aXZlOyB0b3A6MDsgbGVmdDowOyBvdmVyZmxvdzpoaWRkZW47Ij4nKw0KICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0iRFRGQ19MZWZ0Qm9keUxpbmVyIiBzdHlsZT0icG9zaXRpb246cmVsYXRpdmU7IHRvcDowOyBsZWZ0OjA7IG92ZXJmbG93LXk6c2Nyb2xsOyBvdmVyZmxvdy14OmhpZGRlbiI+PC9kaXY+JysNCiAgICAgICAgICAgICAgICAgICAgJzwvZGl2PicrDQogICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJEVEZDX0xlZnRGb290V3JhcHBlciIgc3R5bGU9InBvc2l0aW9uOnJlbGF0aXZlOyB0b3A6MDsgbGVmdDowOyBvdmVyZmxvdzpoaWRkZW47Ij48L2Rpdj4nKw0KICAgICAgICAgICAgICAgICAgICAnPC9kaXY+JysNCiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9IkRURkNfUmlnaHRXcmFwcGVyIiBzdHlsZT0icG9zaXRpb246YWJzb2x1dGU7IHRvcDowOyByaWdodDowOyI+JysNCiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9IkRURkNfUmlnaHRIZWFkV3JhcHBlciIgc3R5bGU9InBvc2l0aW9uOnJlbGF0aXZlOyB0b3A6MDsgbGVmdDowOyI+JysNCiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9IkRURkNfUmlnaHRIZWFkQmxvY2tlciBEVEZDX0Jsb2NrZXIiIHN0eWxlPSJwb3NpdGlvbjphYnNvbHV0ZTsgdG9wOjA7IGJvdHRvbTowOyI+PC9kaXY+JysNCiAgICAgICAgICAgICAgICAgICAgJzwvZGl2PicrDQogICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJEVEZDX1JpZ2h0Qm9keVdyYXBwZXIiIHN0eWxlPSJwb3NpdGlvbjpyZWxhdGl2ZTsgdG9wOjA7IGxlZnQ6MDsgb3ZlcmZsb3c6aGlkZGVuOyI+JysNCiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9IkRURkNfUmlnaHRCb2R5TGluZXIiIHN0eWxlPSJwb3NpdGlvbjpyZWxhdGl2ZTsgdG9wOjA7IGxlZnQ6MDsgb3ZlcmZsb3cteTpzY3JvbGw7IG92ZXJmbG93LXg6IGhpZGRlbiI+PC9kaXY+JysNCiAgICAgICAgICAgICAgICAgICAgJzwvZGl2PicrDQogICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJEVEZDX1JpZ2h0Rm9vdFdyYXBwZXIiIHN0eWxlPSJwb3NpdGlvbjpyZWxhdGl2ZTsgdG9wOjA7IGxlZnQ6MDsiPicrDQogICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJEVEZDX1JpZ2h0Rm9vdEJsb2NrZXIgRFRGQ19CbG9ja2VyIiBzdHlsZT0icG9zaXRpb246YWJzb2x1dGU7IHRvcDowOyBib3R0b206MDsiPjwvZGl2PicrDQogICAgICAgICAgICAgICAgICAgICc8L2Rpdj4nKw0KICAgICAgICAgICAgICAgICAgICAnPC9kaXY+JysNCiAgICAgICAgICAgICAgICAgICAgJzwvZGl2PicpWzBdOw0KICAgICAgICAgICAgdmFyIG5MZWZ0ID0gblNXcmFwcGVyLmNoaWxkTm9kZXNbMF07DQogICAgICAgICAgICB2YXIgblJpZ2h0ID0gblNXcmFwcGVyLmNoaWxkTm9kZXNbMV07DQoNCiAgICAgICAgICAgIHRoaXMuZG9tLmdyaWQuZHQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoIG5TV3JhcHBlciwgdGhpcy5kb20uZ3JpZC5kdCApOw0KICAgICAgICAgICAgblNXcmFwcGVyLmFwcGVuZENoaWxkKCB0aGlzLmRvbS5ncmlkLmR0ICk7DQoNCiAgICAgICAgICAgIHRoaXMuZG9tLmdyaWQud3JhcHBlciA9IG5TV3JhcHBlcjsNCg0KICAgICAgICAgICAgaWYgKCB0aGlzLnMuaUxlZnRDb2x1bW5zID4gMCApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgdGhpcy5kb20uZ3JpZC5sZWZ0LndyYXBwZXIgPSBuTGVmdDsNCiAgICAgICAgICAgICAgICB0aGlzLmRvbS5ncmlkLmxlZnQuaGVhZCA9IG5MZWZ0LmNoaWxkTm9kZXNbMF07DQogICAgICAgICAgICAgICAgdGhpcy5kb20uZ3JpZC5sZWZ0LmJvZHkgPSBuTGVmdC5jaGlsZE5vZGVzWzFdOw0KICAgICAgICAgICAgICAgIHRoaXMuZG9tLmdyaWQubGVmdC5saW5lciA9ICQoJ2Rpdi5EVEZDX0xlZnRCb2R5TGluZXInLCBuU1dyYXBwZXIpWzBdOw0KDQogICAgICAgICAgICAgICAgblNXcmFwcGVyLmFwcGVuZENoaWxkKCBuTGVmdCApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIHRoaXMucy5pUmlnaHRDb2x1bW5zID4gMCApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgdGhpcy5kb20uZ3JpZC5yaWdodC53cmFwcGVyID0gblJpZ2h0Ow0KICAgICAgICAgICAgICAgIHRoaXMuZG9tLmdyaWQucmlnaHQuaGVhZCA9IG5SaWdodC5jaGlsZE5vZGVzWzBdOw0KICAgICAgICAgICAgICAgIHRoaXMuZG9tLmdyaWQucmlnaHQuYm9keSA9IG5SaWdodC5jaGlsZE5vZGVzWzFdOw0KICAgICAgICAgICAgICAgIHRoaXMuZG9tLmdyaWQucmlnaHQubGluZXIgPSAkKCdkaXYuRFRGQ19SaWdodEJvZHlMaW5lcicsIG5TV3JhcHBlcilbMF07DQoNCiAgICAgICAgICAgICAgICAvLyBuUmlnaHQuc3R5bGUucmlnaHQgPSBvT3ZlcmZsb3cuYmFyKyJweCI7DQogICAgICAgICAgICAgICAgdmFyIGRhdGFUYWJsZVNjcm9sbFBhbmUgPSAkKCQodGhpcy5kb20uZ3JpZC5kdClbMF0pDQogICAgICAgICAgICAgICAgdmFyIHJpZ2h0UG9zaSA9IGRhdGFUYWJsZVNjcm9sbFBhbmUud2lkdGgoKSAtDQogICAgICAgICAgICAgICAgICAgIGRhdGFUYWJsZVNjcm9sbFBhbmUuY2hpbGRyZW4oJy5kYXRhVGFibGVzX3Njcm9sbEJvZHknKS5jaGlsZHJlbigndGFibGUnKS53aWR0aCgpOw0KDQogICAgICAgICAgICAgICAgaWYgKHJpZ2h0UG9zaSA8IDApDQogICAgICAgICAgICAgICAgICAgIHJpZ2h0UG9zaSA9IDA7DQoNCiAgICAgICAgICAgICAgICBuUmlnaHQuc3R5bGUucmlnaHQgPSByaWdodFBvc2kgKyAicHgiOw0KDQogICAgICAgICAgICAgICAgYmxvY2sgPSAkKCdkaXYuRFRGQ19SaWdodEhlYWRCbG9ja2VyJywgblNXcmFwcGVyKVswXTsNCiAgICAgICAgICAgICAgICBibG9jay5zdHlsZS53aWR0aCA9IG9PdmVyZmxvdy5iYXIrInB4IjsNCiAgICAgICAgICAgICAgICAvLyBibG9jay5zdHlsZS5yaWdodCA9IC1vT3ZlcmZsb3cuYmFyKyJweCI7DQoNCiAgICAgICAgICAgICAgICBibG9jay5zdHlsZS5yaWdodCA9IHJpZ2h0UG9zaSArInB4IjsNCg0KICAgICAgICAgICAgICAgIHRoaXMuZG9tLmdyaWQucmlnaHQuaGVhZEJsb2NrID0gYmxvY2s7DQoNCiAgICAgICAgICAgICAgICBibG9jayA9ICQoJ2Rpdi5EVEZDX1JpZ2h0Rm9vdEJsb2NrZXInLCBuU1dyYXBwZXIpWzBdOw0KICAgICAgICAgICAgICAgIGJsb2NrLnN0eWxlLndpZHRoID0gb092ZXJmbG93LmJhcisicHgiOw0KICAgICAgICAgICAgICAgIC8vIGJsb2NrLnN0eWxlLnJpZ2h0ID0gLW9PdmVyZmxvdy5iYXIrInB4IjsNCiAgICAgICAgICAgICAgICBibG9jay5zdHlsZS5yaWdodCA9IHJpZ2h0UG9zaSsicHgiOw0KICAgICAgICAgICAgICAgIHRoaXMuZG9tLmdyaWQucmlnaHQuZm9vdEJsb2NrID0gYmxvY2s7DQoNCiAgICAgICAgICAgICAgICBuU1dyYXBwZXIuYXBwZW5kQ2hpbGQoIG5SaWdodCApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIHRoaXMucy5kdC5uVEZvb3QgKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHRoaXMuZG9tLmZvb3RlciA9IHRoaXMucy5kdC5uVEZvb3QucGFyZW50Tm9kZTsNCiAgICAgICAgICAgICAgICBpZiAoIHRoaXMucy5pTGVmdENvbHVtbnMgPiAwICkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZG9tLmdyaWQubGVmdC5mb290ID0gbkxlZnQuY2hpbGROb2Rlc1syXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKCB0aGlzLnMuaVJpZ2h0Q29sdW1ucyA+IDAgKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kb20uZ3JpZC5yaWdodC5mb290ID0gblJpZ2h0LmNoaWxkTm9kZXNbMl07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBSVEwgc3VwcG9ydCAtIHN3YXAgdGhlIHBvc2l0aW9uIG9mIHRoZSBsZWZ0IGFuZCByaWdodCBjb2x1bW5zICgjNDgpDQogICAgICAgICAgICBpZiAoIHRoaXMucy5ydGwgKSB7DQogICAgICAgICAgICAgICAgJCgnZGl2LkRURkNfUmlnaHRIZWFkQmxvY2tlcicsIG5TV3JhcHBlcikuY3NzKCB7DQogICAgICAgICAgICAgICAgICAgIGxlZnQ6IC1vT3ZlcmZsb3cuYmFyKydweCcsDQogICAgICAgICAgICAgICAgICAgIHJpZ2h0OiAnJw0KICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBTdHlsZSBhbmQgcG9zaXRpb24gdGhlIGdyaWQgdXNlZCBmb3IgdGhlIEZpeGVkQ29sdW1ucyBsYXlvdXQNCiAgICAgICAgICogIEByZXR1cm5zIHt2b2lkfQ0KICAgICAgICAgKiAgQHByaXZhdGUNCiAgICAgICAgICovDQogICAgICAgICJfZm5HcmlkTGF5b3V0IjogZnVuY3Rpb24gKCkNCiAgICAgICAgew0KICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzOw0KICAgICAgICAgICAgdmFyIG9HcmlkID0gdGhpcy5kb20uZ3JpZDsNCiAgICAgICAgICAgIHZhciBpV2lkdGggPSAkKG9HcmlkLndyYXBwZXIpLndpZHRoKCk7DQogICAgICAgICAgICB2YXIgaUJvZHlIZWlnaHQgPSAkKHRoaXMucy5kdC5uVGFibGUucGFyZW50Tm9kZSkub3V0ZXJIZWlnaHQoKTsNCiAgICAgICAgICAgIHZhciBpRnVsbEhlaWdodCA9ICQodGhpcy5zLmR0Lm5UYWJsZS5wYXJlbnROb2RlLnBhcmVudE5vZGUpLm91dGVySGVpZ2h0KCk7DQogICAgICAgICAgICB2YXIgb092ZXJmbG93ID0gdGhpcy5fZm5EVE92ZXJmbG93KCk7DQogICAgICAgICAgICB2YXIgaUxlZnRXaWR0aCA9IHRoaXMucy5pTGVmdFdpZHRoOw0KICAgICAgICAgICAgdmFyIGlSaWdodFdpZHRoID0gdGhpcy5zLmlSaWdodFdpZHRoOw0KICAgICAgICAgICAgdmFyIHJ0bCA9ICQodGhpcy5kb20uYm9keSkuY3NzKCdkaXJlY3Rpb24nKSA9PT0gJ3J0bCc7DQogICAgICAgICAgICB2YXIgd3JhcHBlcjsNCiAgICAgICAgICAgIHZhciBzY3JvbGxiYXJBZGp1c3QgPSBmdW5jdGlvbiAoIG5vZGUsIHdpZHRoICkgew0KICAgICAgICAgICAgICAgIGlmICggISBvT3ZlcmZsb3cuYmFyICkgew0KICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGVyZSBpcyBubyBzY3JvbGxiYXIgKE1hY3MpIHdlIG5lZWQgdG8gaGlkZSB0aGUgYXV0byBzY3JvbGxiYXINCiAgICAgICAgICAgICAgICAgICAgbm9kZS5zdHlsZS53aWR0aCA9ICh3aWR0aCsyMCkrInB4IjsNCiAgICAgICAgICAgICAgICAgICAgbm9kZS5zdHlsZS5wYWRkaW5nUmlnaHQgPSAiMjBweCI7DQogICAgICAgICAgICAgICAgICAgIG5vZGUuc3R5bGUuYm94U2l6aW5nID0gImJvcmRlci1ib3giOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBlbHNlIGlmICggdGhhdC5fZmlyZWZveFNjcm9sbEVycm9yKCkgKSB7DQogICAgICAgICAgICAgICAgICAgIC8vIFNlZSB0aGUgYWJvdmUgZnVuY3Rpb24gZm9yIHdoeSB0aGlzIGlzIHJlcXVpcmVkDQogICAgICAgICAgICAgICAgICAgIGlmICggJChub2RlKS5oZWlnaHQoKSA+IDM0ICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5zdHlsZS53aWR0aCA9ICh3aWR0aCtvT3ZlcmZsb3cuYmFyKSsicHgiOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAvLyBPdGhlcndpc2UganVzdCBvdmVyZmxvdyBieSB0aGUgc2Nyb2xsYmFyDQogICAgICAgICAgICAgICAgICAgIG5vZGUuc3R5bGUud2lkdGggPSAod2lkdGgrb092ZXJmbG93LmJhcikrInB4IjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICAvLyBXaGVuIHggc2Nyb2xsaW5nIC0gZG9uJ3QgcGFpbnQgdGhlIGZpeGVkIGNvbHVtbnMgb3ZlciB0aGUgeCBzY3JvbGxiYXINCiAgICAgICAgICAgIGlmICggb092ZXJmbG93LnggKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlCb2R5SGVpZ2h0IC09IG9PdmVyZmxvdy5iYXI7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIG9HcmlkLndyYXBwZXIuc3R5bGUuaGVpZ2h0ID0gaUZ1bGxIZWlnaHQrInB4IjsNCg0KICAgICAgICAgICAgaWYgKCB0aGlzLnMuaUxlZnRDb2x1bW5zID4gMCApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgd3JhcHBlciA9IG9HcmlkLmxlZnQud3JhcHBlcjsNCiAgICAgICAgICAgICAgICB3cmFwcGVyLnN0eWxlLndpZHRoID0gaUxlZnRXaWR0aCsncHgnOw0KICAgICAgICAgICAgICAgIHdyYXBwZXIuc3R5bGUuaGVpZ2h0ID0gJzFweCc7DQoNCiAgICAgICAgICAgICAgICAvLyBTd2FwIHRoZSBwb3NpdGlvbiBvZiB0aGUgbGVmdCBhbmQgcmlnaHQgY29sdW1ucyBmb3IgcnRsICgjNDgpDQogICAgICAgICAgICAgICAgLy8gVGhpcyBpcyBhbHdheXMgdXAgYWdhaW5zdCB0aGUgZWRnZSwgc2Nyb2xsYmFyIG9uIHRoZSBmYXIgc2lkZQ0KICAgICAgICAgICAgICAgIGlmICggcnRsICkgew0KICAgICAgICAgICAgICAgICAgICB3cmFwcGVyLnN0eWxlLmxlZnQgPSAnJzsNCiAgICAgICAgICAgICAgICAgICAgd3JhcHBlci5zdHlsZS5yaWdodCA9IDA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICB3cmFwcGVyLnN0eWxlLmxlZnQgPSAwOw0KICAgICAgICAgICAgICAgICAgICB3cmFwcGVyLnN0eWxlLnJpZ2h0ID0gJyc7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgb0dyaWQubGVmdC5ib2R5LnN0eWxlLmhlaWdodCA9IGlCb2R5SGVpZ2h0KyJweCI7DQogICAgICAgICAgICAgICAgaWYgKCBvR3JpZC5sZWZ0LmZvb3QgKSB7DQogICAgICAgICAgICAgICAgICAgIG9HcmlkLmxlZnQuZm9vdC5zdHlsZS50b3AgPSAob092ZXJmbG93LnggPyBvT3ZlcmZsb3cuYmFyIDogMCkrInB4IjsgLy8gc2hpZnQgZm9vdGVyIGZvciBzY3JvbGxiYXINCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBzY3JvbGxiYXJBZGp1c3QoIG9HcmlkLmxlZnQubGluZXIsIGlMZWZ0V2lkdGggKTsNCiAgICAgICAgICAgICAgICBvR3JpZC5sZWZ0LmxpbmVyLnN0eWxlLmhlaWdodCA9IGlCb2R5SGVpZ2h0KyJweCI7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggdGhpcy5zLmlSaWdodENvbHVtbnMgPiAwICkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICB3cmFwcGVyID0gb0dyaWQucmlnaHQud3JhcHBlcjsNCiAgICAgICAgICAgICAgICB3cmFwcGVyLnN0eWxlLndpZHRoID0gaVJpZ2h0V2lkdGgrJ3B4JzsNCiAgICAgICAgICAgICAgICB3cmFwcGVyLnN0eWxlLmhlaWdodCA9ICcxcHgnOw0KDQogICAgICAgICAgICAgICAgdmFyIGRhdGFUYWJsZVNjcm9sbFBhbmUgPSAkKCQob0dyaWQuZHQpWzBdKQ0KICAgICAgICAgICAgICAgIHZhciByaWdodFBvc2kgPSBkYXRhVGFibGVTY3JvbGxQYW5lLndpZHRoKCkgLQ0KICAgICAgICAgICAgICAgICAgICBkYXRhVGFibGVTY3JvbGxQYW5lLmNoaWxkcmVuKCcuZGF0YVRhYmxlc19zY3JvbGxCb2R5JykuY2hpbGRyZW4oJ3RhYmxlJykud2lkdGgoKTsNCg0KICAgICAgICAgICAgICAgIGlmIChyaWdodFBvc2kgPCAwKQ0KICAgICAgICAgICAgICAgICAgICByaWdodFBvc2kgPSAwOw0KDQogICAgICAgICAgICAgICAgLy8gTmVlZCB0byB0YWtlIGFjY291bnQgb2YgdGhlIHZlcnRpY2FsIHNjcm9sbGJhcg0KICAgICAgICAgICAgICAgIGlmICggdGhpcy5zLnJ0bCApIHsNCiAgICAgICAgICAgICAgICAgICAgd3JhcHBlci5zdHlsZS5sZWZ0ID0gb092ZXJmbG93LnkgPyBvT3ZlcmZsb3cuYmFyKydweCcgOiAwOw0KICAgICAgICAgICAgICAgICAgICB3cmFwcGVyLnN0eWxlLnJpZ2h0ID0gJyc7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICB3cmFwcGVyLnN0eWxlLmxlZnQgPSAnJzsNCiAgICAgICAgICAgICAgICAgICAgLy8gd3JhcHBlci5zdHlsZS5yaWdodCA9IG9PdmVyZmxvdy55ID8gb092ZXJmbG93LmJhcisncHgnIDogMDsNCg0KICAgICAgICAgICAgICAgICAgICB3cmFwcGVyLnN0eWxlLnJpZ2h0ID0gcmlnaHRQb3NpICsgInB4IjsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBvR3JpZC5yaWdodC5ib2R5LnN0eWxlLmhlaWdodCA9IGlCb2R5SGVpZ2h0KyJweCI7DQogICAgICAgICAgICAgICAgaWYgKCBvR3JpZC5yaWdodC5mb290ICkgew0KICAgICAgICAgICAgICAgICAgICBvR3JpZC5yaWdodC5mb290LnN0eWxlLnRvcCA9IChvT3ZlcmZsb3cueCA/IG9PdmVyZmxvdy5iYXIgOiAwKSsicHgiOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHNjcm9sbGJhckFkanVzdCggb0dyaWQucmlnaHQubGluZXIsIGlSaWdodFdpZHRoICk7DQogICAgICAgICAgICAgICAgb0dyaWQucmlnaHQubGluZXIuc3R5bGUuaGVpZ2h0ID0gaUJvZHlIZWlnaHQrInB4IjsNCg0KICAgICAgICAgICAgICAgIG9HcmlkLnJpZ2h0LmhlYWRCbG9jay5zdHlsZS5kaXNwbGF5ID0gb092ZXJmbG93LnkgPyAnYmxvY2snIDogJ25vbmUnOw0KICAgICAgICAgICAgICAgIG9HcmlkLnJpZ2h0LmZvb3RCbG9jay5zdHlsZS5kaXNwbGF5ID0gb092ZXJmbG93LnkgPyAnYmxvY2snIDogJ25vbmUnOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIEdldCBpbmZvcm1hdGlvbiBhYm91dCB0aGUgRGF0YVRhYmxlJ3Mgc2Nyb2xsaW5nIHN0YXRlIC0gc3BlY2lmaWNhbGx5IGlmIHRoZSB0YWJsZSBpcyBzY3JvbGxpbmcNCiAgICAgICAgICogb24gZWl0aGVyIHRoZSB4IG9yIHkgYXhpcywgYW5kIGFsc28gdGhlIHNjcm9sbGJhciB3aWR0aC4NCiAgICAgICAgICogIEByZXR1cm5zIHtvYmplY3R9IEluZm9ybWF0aW9uIGFib3V0IHRoZSBEYXRhVGFibGVzIHNjcm9sbGluZyBzdGF0ZSB3aXRoIHRoZSBwcm9wZXJ0aWVzOg0KICAgICAgICAgKiAgICAneCcsICd5JyBhbmQgJ2JhcicNCiAgICAgICAgICogIEBwcml2YXRlDQogICAgICAgICAqLw0KICAgICAgICAiX2ZuRFRPdmVyZmxvdyI6IGZ1bmN0aW9uICgpDQogICAgICAgIHsNCiAgICAgICAgICAgIHZhciBuVGFibGUgPSB0aGlzLnMuZHQublRhYmxlOw0KICAgICAgICAgICAgdmFyIG5UYWJsZVNjcm9sbEJvZHkgPSBuVGFibGUucGFyZW50Tm9kZTsNCiAgICAgICAgICAgIHZhciBvdXQgPSB7DQogICAgICAgICAgICAgICAgIngiOiBmYWxzZSwNCiAgICAgICAgICAgICAgICAieSI6IGZhbHNlLA0KICAgICAgICAgICAgICAgICJiYXIiOiB0aGlzLnMuZHQub1Njcm9sbC5pQmFyV2lkdGgNCiAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgIGlmICggblRhYmxlLm9mZnNldFdpZHRoID4gblRhYmxlU2Nyb2xsQm9keS5jbGllbnRXaWR0aCApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgb3V0LnggPSB0cnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIG5UYWJsZS5vZmZzZXRIZWlnaHQgPiBuVGFibGVTY3JvbGxCb2R5LmNsaWVudEhlaWdodCApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgb3V0LnkgPSB0cnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gb3V0Ow0KICAgICAgICB9LA0KDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIENsb25lIGFuZCBwb3NpdGlvbiB0aGUgZml4ZWQgY29sdW1ucw0KICAgICAgICAgKiAgQHJldHVybnMge3ZvaWR9DQogICAgICAgICAqICBAcGFyYW0gICB7Qm9vbGVhbn0gYkFsbCBJbmRpY2F0ZSBpZiB0aGUgaGVhZGVyIGFuZCBmb290ZXIgc2hvdWxkIGJlIHVwZGF0ZWQgYXMgd2VsbCAodHJ1ZSkNCiAgICAgICAgICogIEBwcml2YXRlDQogICAgICAgICAqLw0KICAgICAgICAiX2ZuRHJhdyI6IGZ1bmN0aW9uICggYkFsbCApDQogICAgICAgIHsNCiAgICAgICAgICAgIHRoaXMuX2ZuR3JpZExheW91dCgpOw0KICAgICAgICAgICAgdGhpcy5fZm5DbG9uZUxlZnQoIGJBbGwgKTsNCiAgICAgICAgICAgIHRoaXMuX2ZuQ2xvbmVSaWdodCggYkFsbCApOw0KDQogICAgICAgICAgICAvKiBEcmF3IGNhbGxiYWNrIGZ1bmN0aW9uICovDQogICAgICAgICAgICBpZiAoIHRoaXMucy5mbkRyYXdDYWxsYmFjayAhPT0gbnVsbCApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgdGhpcy5zLmZuRHJhd0NhbGxiYWNrLmNhbGwoIHRoaXMsIHRoaXMuZG9tLmNsb25lLmxlZnQsIHRoaXMuZG9tLmNsb25lLnJpZ2h0ICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8qIEV2ZW50IHRyaWdnZXJpbmcgKi8NCiAgICAgICAgICAgICQodGhpcykudHJpZ2dlciggJ2RyYXcuZHRmYycsIHsNCiAgICAgICAgICAgICAgICAibGVmdENsb25lIjogdGhpcy5kb20uY2xvbmUubGVmdCwNCiAgICAgICAgICAgICAgICAicmlnaHRDbG9uZSI6IHRoaXMuZG9tLmNsb25lLnJpZ2h0DQogICAgICAgICAgICB9ICk7DQogICAgICAgIH0sDQoNCg0KICAgICAgICAvKioNCiAgICAgICAgICogQ2xvbmUgdGhlIHJpZ2h0IGNvbHVtbnMNCiAgICAgICAgICogIEByZXR1cm5zIHt2b2lkfQ0KICAgICAgICAgKiAgQHBhcmFtICAge0Jvb2xlYW59IGJBbGwgSW5kaWNhdGUgaWYgdGhlIGhlYWRlciBhbmQgZm9vdGVyIHNob3VsZCBiZSB1cGRhdGVkIGFzIHdlbGwgKHRydWUpDQogICAgICAgICAqICBAcHJpdmF0ZQ0KICAgICAgICAgKi8NCiAgICAgICAgIl9mbkNsb25lUmlnaHQiOiBmdW5jdGlvbiAoIGJBbGwgKQ0KICAgICAgICB7DQogICAgICAgICAgICBpZiAoIHRoaXMucy5pUmlnaHRDb2x1bW5zIDw9IDAgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXMsDQogICAgICAgICAgICAgICAgaSwganEsDQogICAgICAgICAgICAgICAgYWlDb2x1bW5zID0gW107DQoNCiAgICAgICAgICAgIGZvciAoIGk9dGhpcy5zLmlUYWJsZUNvbHVtbnMtdGhpcy5zLmlSaWdodENvbHVtbnMgOyBpPHRoaXMucy5pVGFibGVDb2x1bW5zIDsgaSsrICkgew0KICAgICAgICAgICAgICAgIGlmICggdGhpcy5zLmR0LmFvQ29sdW1uc1tpXS5iVmlzaWJsZSApIHsNCiAgICAgICAgICAgICAgICAgICAgYWlDb2x1bW5zLnB1c2goIGkgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuX2ZuQ2xvbmUoIHRoaXMuZG9tLmNsb25lLnJpZ2h0LCB0aGlzLmRvbS5ncmlkLnJpZ2h0LCBhaUNvbHVtbnMsIGJBbGwgKTsNCiAgICAgICAgfSwNCg0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBDbG9uZSB0aGUgbGVmdCBjb2x1bW5zDQogICAgICAgICAqICBAcmV0dXJucyB7dm9pZH0NCiAgICAgICAgICogIEBwYXJhbSAgIHtCb29sZWFufSBiQWxsIEluZGljYXRlIGlmIHRoZSBoZWFkZXIgYW5kIGZvb3RlciBzaG91bGQgYmUgdXBkYXRlZCBhcyB3ZWxsICh0cnVlKQ0KICAgICAgICAgKiAgQHByaXZhdGUNCiAgICAgICAgICovDQogICAgICAgICJfZm5DbG9uZUxlZnQiOiBmdW5jdGlvbiAoIGJBbGwgKQ0KICAgICAgICB7DQogICAgICAgICAgICBpZiAoIHRoaXMucy5pTGVmdENvbHVtbnMgPD0gMCApIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcywNCiAgICAgICAgICAgICAgICBpLCBqcSwNCiAgICAgICAgICAgICAgICBhaUNvbHVtbnMgPSBbXTsNCg0KICAgICAgICAgICAgZm9yICggaT0wIDsgaTx0aGlzLnMuaUxlZnRDb2x1bW5zIDsgaSsrICkgew0KICAgICAgICAgICAgICAgIGlmICggdGhpcy5zLmR0LmFvQ29sdW1uc1tpXS5iVmlzaWJsZSApIHsNCiAgICAgICAgICAgICAgICAgICAgYWlDb2x1bW5zLnB1c2goIGkgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHRoaXMuX2ZuQ2xvbmUoIHRoaXMuZG9tLmNsb25lLmxlZnQsIHRoaXMuZG9tLmdyaWQubGVmdCwgYWlDb2x1bW5zLCBiQWxsICk7DQogICAgICAgIH0sDQoNCg0KICAgICAgICAvKioNCiAgICAgICAgICogTWFrZSBhIGNvcHkgb2YgdGhlIGxheW91dCBvYmplY3QgZm9yIGEgaGVhZGVyIG9yIGZvb3RlciBlbGVtZW50IGZyb20gRGF0YVRhYmxlcy4gTm90ZSB0aGF0DQogICAgICAgICAqIHRoaXMgbWV0aG9kIHdpbGwgY2xvbmUgdGhlIG5vZGVzIGluIHRoZSBsYXlvdXQgb2JqZWN0Lg0KICAgICAgICAgKiAgQHJldHVybnMge0FycmF5fSBDb3B5IG9mIHRoZSBsYXlvdXQgYXJyYXkNCiAgICAgICAgICogIEBwYXJhbSAgIHtPYmplY3R9IGFvT3JpZ2luYWwgTGF5b3V0IGFycmF5IGZyb20gRGF0YVRhYmxlcyAoYW9IZWFkZXIgb3IgYW9Gb290ZXIpDQogICAgICAgICAqICBAcGFyYW0gICB7T2JqZWN0fSBhaUNvbHVtbnMgQ29sdW1ucyB0byBjb3B5DQogICAgICAgICAqICBAcGFyYW0gICB7Ym9vbGVhbn0gZXZlbnRzIENvcHkgY2VsbCBldmVudHMgb3Igbm90DQogICAgICAgICAqICBAcHJpdmF0ZQ0KICAgICAgICAgKi8NCiAgICAgICAgIl9mbkNvcHlMYXlvdXQiOiBmdW5jdGlvbiAoIGFvT3JpZ2luYWwsIGFpQ29sdW1ucywgZXZlbnRzICkNCiAgICAgICAgew0KICAgICAgICAgICAgdmFyIGFSZXR1cm4gPSBbXTsNCiAgICAgICAgICAgIHZhciBhQ2xvbmVzID0gW107DQogICAgICAgICAgICB2YXIgYUNsb25lZCA9IFtdOw0KDQogICAgICAgICAgICBmb3IgKCB2YXIgaT0wLCBpTGVuPWFvT3JpZ2luYWwubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICB2YXIgYVJvdyA9IFtdOw0KICAgICAgICAgICAgICAgIGFSb3cublRyID0gJChhb09yaWdpbmFsW2ldLm5UcikuY2xvbmUoZXZlbnRzLCBmYWxzZSlbMF07DQoNCiAgICAgICAgICAgICAgICBmb3IgKCB2YXIgaj0wLCBqTGVuPXRoaXMucy5pVGFibGVDb2x1bW5zIDsgajxqTGVuIDsgaisrICkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGlmICggJC5pbkFycmF5KCBqLCBhaUNvbHVtbnMgKSA9PT0gLTEgKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIHZhciBpQ2xvbmVkID0gJC5pbkFycmF5KCBhb09yaWdpbmFsW2ldW2pdLmNlbGwsIGFDbG9uZWQgKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCBpQ2xvbmVkID09PSAtMSApDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuQ2xvbmUgPSAkKGFvT3JpZ2luYWxbaV1bal0uY2VsbCkuY2xvbmUoZXZlbnRzLCBmYWxzZSlbMF07DQogICAgICAgICAgICAgICAgICAgICAgICBhQ2xvbmVzLnB1c2goIG5DbG9uZSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUNsb25lZC5wdXNoKCBhb09yaWdpbmFsW2ldW2pdLmNlbGwgKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgYVJvdy5wdXNoKCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgImNlbGwiOiBuQ2xvbmUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgInVuaXF1ZSI6IGFvT3JpZ2luYWxbaV1bal0udW5pcXVlDQogICAgICAgICAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBhUm93LnB1c2goIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiY2VsbCI6IGFDbG9uZXNbIGlDbG9uZWQgXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidW5pcXVlIjogYW9PcmlnaW5hbFtpXVtqXS51bmlxdWUNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGFSZXR1cm4ucHVzaCggYVJvdyApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gYVJldHVybjsNCiAgICAgICAgfSwNCg0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBDbG9uZSB0aGUgRGF0YVRhYmxlIG5vZGVzIGFuZCBwbGFjZSB0aGVtIGluIHRoZSBET00gKHNpemVkIGNvcnJlY3RseSkNCiAgICAgICAgICogIEByZXR1cm5zIHt2b2lkfQ0KICAgICAgICAgKiAgQHBhcmFtICAge09iamVjdH0gb0Nsb25lIE9iamVjdCBjb250YWluaW5nIHRoZSBoZWFkZXIsIGZvb3RlciBhbmQgYm9keSBjbG9uZWQgRE9NIGVsZW1lbnRzDQogICAgICAgICAqICBAcGFyYW0gICB7T2JqZWN0fSBvR3JpZCBHcmlkIG9iamVjdCBjb250YWluaW5nIHRoZSBkaXNwbGF5IGdyaWQgZWxlbWVudHMgZm9yIHRoZSBjbG9uZWQNCiAgICAgICAgICogICAgICAgICAgICAgICAgICAgIGNvbHVtbiAobGVmdCBvciByaWdodCkNCiAgICAgICAgICogIEBwYXJhbSAgIHtBcnJheX0gYWlDb2x1bW5zIENvbHVtbiBpbmRleGVzIHdoaWNoIHNob3VsZCBiZSBvcGVyYXRlZCBvbiBmcm9tIHRoZSBEYXRhVGFibGUNCiAgICAgICAgICogIEBwYXJhbSAgIHtCb29sZWFufSBiQWxsIEluZGljYXRlIGlmIHRoZSBoZWFkZXIgYW5kIGZvb3RlciBzaG91bGQgYmUgdXBkYXRlZCBhcyB3ZWxsICh0cnVlKQ0KICAgICAgICAgKiAgQHByaXZhdGUNCiAgICAgICAgICovDQogICAgICAgICJfZm5DbG9uZSI6IGZ1bmN0aW9uICggb0Nsb25lLCBvR3JpZCwgYWlDb2x1bW5zLCBiQWxsICkNCiAgICAgICAgew0KICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzLA0KICAgICAgICAgICAgICAgIGksIGlMZW4sIGosIGpMZW4sIGpxLCBuVGFyZ2V0LCBpQ29sdW1uLCBuQ2xvbmUsIGlJbmRleCwgYW9DbG9uZUxheW91dCwNCiAgICAgICAgICAgICAgICBqcUNsb25lVGhlYWQsIGFvRml4ZWRIZWFkZXIsDQogICAgICAgICAgICAgICAgZHQgPSB0aGlzLnMuZHQ7DQoNCiAgICAgICAgICAgIC8qDQogICAgICAgICAgICAgKiBIZWFkZXINCiAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgaWYgKCBiQWxsICkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAkKG9DbG9uZS5oZWFkZXIpLnJlbW92ZSgpOw0KDQogICAgICAgICAgICAgICAgb0Nsb25lLmhlYWRlciA9ICQodGhpcy5kb20uaGVhZGVyKS5jbG9uZSh0cnVlLCBmYWxzZSlbMF07DQogICAgICAgICAgICAgICAgb0Nsb25lLmhlYWRlci5jbGFzc05hbWUgKz0gIiBEVEZDX0Nsb25lZCI7DQogICAgICAgICAgICAgICAgb0Nsb25lLmhlYWRlci5zdHlsZS53aWR0aCA9ICIxMDAlIjsNCiAgICAgICAgICAgICAgICBvR3JpZC5oZWFkLmFwcGVuZENoaWxkKCBvQ2xvbmUuaGVhZGVyICk7DQoNCiAgICAgICAgICAgICAgICAvKiBDb3B5IHRoZSBEYXRhVGFibGVzIGxheW91dCBjYWNoZSBmb3IgdGhlIGhlYWRlciBmb3Igb3VyIGZsb2F0aW5nIGNvbHVtbiAqLw0KICAgICAgICAgICAgICAgIGFvQ2xvbmVMYXlvdXQgPSB0aGlzLl9mbkNvcHlMYXlvdXQoIGR0LmFvSGVhZGVyLCBhaUNvbHVtbnMsIHRydWUgKTsNCiAgICAgICAgICAgICAgICBqcUNsb25lVGhlYWQgPSAkKCc+dGhlYWQnLCBvQ2xvbmUuaGVhZGVyKTsNCiAgICAgICAgICAgICAgICBqcUNsb25lVGhlYWQuZW1wdHkoKTsNCg0KICAgICAgICAgICAgICAgIC8qIEFkZCB0aGUgY3JlYXRlZCBjbG9uZWQgVFIgZWxlbWVudHMgdG8gdGhlIHRhYmxlICovDQogICAgICAgICAgICAgICAgZm9yICggaT0wLCBpTGVuPWFvQ2xvbmVMYXlvdXQubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGpxQ2xvbmVUaGVhZFswXS5hcHBlbmRDaGlsZCggYW9DbG9uZUxheW91dFtpXS5uVHIgKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAvKiBVc2UgdGhlIGhhbmR5IF9mbkRyYXdIZWFkIGZ1bmN0aW9uIGluIERhdGFUYWJsZXMgdG8gZG8gdGhlIHJvd3NwYW4vY29sc3Bhbg0KICAgICAgICAgICAgICAgICAqIGNhbGN1bGF0aW9ucyBmb3IgdXMNCiAgICAgICAgICAgICAgICAgKi8NCiAgICAgICAgICAgICAgICBkdC5vQXBpLl9mbkRyYXdIZWFkKCBkdCwgYW9DbG9uZUxheW91dCwgdHJ1ZSApOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIC8qIFRvIGVuc3VyZSB0aGF0IHdlIGNvcHkgY2VsbCBjbGFzc2VzIGV4YWN0bHksIHJlZ2FyZGxlc3Mgb2YgY29sc3BhbiwgbXVsdGlwbGUgcm93cw0KICAgICAgICAgICAgICAgICAqIGV0Yywgd2UgbWFrZSBhIGNvcHkgb2YgdGhlIGhlYWRlciBmcm9tIHRoZSBEYXRhVGFibGUgYWdhaW4sIGJ1dCBkb24ndCBpbnNlcnQgdGhlDQogICAgICAgICAgICAgICAgICogY2xvbmVkIGNlbGxzLCBqdXN0IGNvcHkgdGhlIGNsYXNzZXMgYWNyb3NzLiBUbyBnZXQgdGhlIG1hdGNoaW5nIGxheW91dCBmb3IgdGhlDQogICAgICAgICAgICAgICAgICogZml4ZWQgY29tcG9uZW50LCB3ZSB1c2UgdGhlIERhdGFUYWJsZXMgX2ZuRGV0ZWN0SGVhZGVyIG1ldGhvZCwgYWxsb3dpbmcgMToxIG1hcHBpbmcNCiAgICAgICAgICAgICAgICAgKi8NCiAgICAgICAgICAgICAgICBhb0Nsb25lTGF5b3V0ID0gdGhpcy5fZm5Db3B5TGF5b3V0KCBkdC5hb0hlYWRlciwgYWlDb2x1bW5zLCBmYWxzZSApOw0KICAgICAgICAgICAgICAgIGFvRml4ZWRIZWFkZXI9W107DQoNCiAgICAgICAgICAgICAgICBkdC5vQXBpLl9mbkRldGVjdEhlYWRlciggYW9GaXhlZEhlYWRlciwgJCgnPnRoZWFkJywgb0Nsb25lLmhlYWRlcilbMF0gKTsNCg0KICAgICAgICAgICAgICAgIGZvciAoIGk9MCwgaUxlbj1hb0Nsb25lTGF5b3V0Lmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBmb3IgKCBqPTAsIGpMZW49YW9DbG9uZUxheW91dFtpXS5sZW5ndGggOyBqPGpMZW4gOyBqKysgKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBhb0ZpeGVkSGVhZGVyW2ldW2pdLmNlbGwuY2xhc3NOYW1lID0gYW9DbG9uZUxheW91dFtpXVtqXS5jZWxsLmNsYXNzTmFtZTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgalF1ZXJ5IFVJIHRoZW1pbmcgaXMgdXNlZCB3ZSBuZWVkIHRvIGNvcHkgdGhvc2UgZWxlbWVudHMgYXMgd2VsbA0KICAgICAgICAgICAgICAgICAgICAgICAgJCgnc3Bhbi5EYXRhVGFibGVzX3NvcnRfaWNvbicsIGFvRml4ZWRIZWFkZXJbaV1bal0uY2VsbCkuZWFjaCggZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xhc3NOYW1lID0gJCgnc3Bhbi5EYXRhVGFibGVzX3NvcnRfaWNvbicsIGFvQ2xvbmVMYXlvdXRbaV1bal0uY2VsbClbMF0uY2xhc3NOYW1lOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5fZm5FcXVhbGlzZUhlaWdodHMoICd0aGVhZCcsIHRoaXMuZG9tLmhlYWRlciwgb0Nsb25lLmhlYWRlciApOw0KDQogICAgICAgICAgICAvKg0KICAgICAgICAgICAgICogQm9keQ0KICAgICAgICAgICAgICovDQogICAgICAgICAgICBpZiAoIHRoaXMucy5zSGVpZ2h0TWF0Y2ggPT0gJ2F1dG8nICkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAvKiBSZW1vdmUgYW55IGhlaWdodHMgd2hpY2ggaGF2ZSBiZWVuIGFwcGxpZWQgYWxyZWFkeSBhbmQgbGV0IHRoZSBicm93c2VyIGZpZ3VyZSBpdCBvdXQgKi8NCiAgICAgICAgICAgICAgICAkKCc+dGJvZHk+dHInLCB0aGF0LmRvbS5ib2R5KS5jc3MoJ2hlaWdodCcsICdhdXRvJyk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggb0Nsb25lLmJvZHkgIT09IG51bGwgKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICQob0Nsb25lLmJvZHkpLnJlbW92ZSgpOw0KICAgICAgICAgICAgICAgIG9DbG9uZS5ib2R5ID0gbnVsbDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgb0Nsb25lLmJvZHkgPSAkKHRoaXMuZG9tLmJvZHkpLmNsb25lKHRydWUpWzBdOw0KICAgICAgICAgICAgb0Nsb25lLmJvZHkuY2xhc3NOYW1lICs9ICIgRFRGQ19DbG9uZWQiOw0KICAgICAgICAgICAgb0Nsb25lLmJvZHkuc3R5bGUucGFkZGluZ0JvdHRvbSA9IGR0Lm9TY3JvbGwuaUJhcldpZHRoKyJweCI7DQogICAgICAgICAgICBvQ2xvbmUuYm9keS5zdHlsZS5tYXJnaW5Cb3R0b20gPSAoZHQub1Njcm9sbC5pQmFyV2lkdGgqMikrInB4IjsgLyogRm9yIElFICovDQogICAgICAgICAgICBpZiAoIG9DbG9uZS5ib2R5LmdldEF0dHJpYnV0ZSgnaWQnKSAhPT0gbnVsbCApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgb0Nsb25lLmJvZHkucmVtb3ZlQXR0cmlidXRlKCdpZCcpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAkKCc+dGhlYWQ+dHInLCBvQ2xvbmUuYm9keSkuZW1wdHkoKTsNCiAgICAgICAgICAgICQoJz50Zm9vdCcsIG9DbG9uZS5ib2R5KS5yZW1vdmUoKTsNCg0KICAgICAgICAgICAgdmFyIG5Cb2R5ID0gJCgndGJvZHknLCBvQ2xvbmUuYm9keSlbMF07DQogICAgICAgICAgICAkKG5Cb2R5KS5lbXB0eSgpOw0KICAgICAgICAgICAgaWYgKCBkdC5haURpc3BsYXkubGVuZ3RoID4gMCApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgLyogQ29weSB0aGUgRGF0YVRhYmxlcycgaGVhZGVyIGVsZW1lbnRzIHRvIGZvcmNlIHRoZSBjb2x1bW4gd2lkdGggaW4gZXhhY3RseSB0aGUNCiAgICAgICAgICAgICAgICAgKiBzYW1lIHdheSB0aGF0IERhdGFUYWJsZXMgZG9lcyBpdCAtIGhhdmUgdGhlIGhlYWRlciBlbGVtZW50LCBhcHBseSB0aGUgd2lkdGggYW5kDQogICAgICAgICAgICAgICAgICogY29sYXBzZSBpdCBkb3duDQogICAgICAgICAgICAgICAgICovDQogICAgICAgICAgICAgICAgdmFyIG5Jbm5lclRoZWFkID0gJCgnPnRoZWFkPnRyJywgb0Nsb25lLmJvZHkpWzBdOw0KICAgICAgICAgICAgICAgIGZvciAoIGlJbmRleD0wIDsgaUluZGV4PGFpQ29sdW1ucy5sZW5ndGggOyBpSW5kZXgrKyApDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBpQ29sdW1uID0gYWlDb2x1bW5zW2lJbmRleF07DQoNCiAgICAgICAgICAgICAgICAgICAgbkNsb25lID0gJChkdC5hb0NvbHVtbnNbaUNvbHVtbl0ublRoKS5jbG9uZSh0cnVlKVswXTsNCiAgICAgICAgICAgICAgICAgICAgbkNsb25lLmlubmVySFRNTCA9ICIiOw0KDQogICAgICAgICAgICAgICAgICAgIHZhciBvU3R5bGUgPSBuQ2xvbmUuc3R5bGU7DQogICAgICAgICAgICAgICAgICAgIG9TdHlsZS5wYWRkaW5nVG9wID0gIjAiOw0KICAgICAgICAgICAgICAgICAgICBvU3R5bGUucGFkZGluZ0JvdHRvbSA9ICIwIjsNCiAgICAgICAgICAgICAgICAgICAgb1N0eWxlLmJvcmRlclRvcFdpZHRoID0gIjAiOw0KICAgICAgICAgICAgICAgICAgICBvU3R5bGUuYm9yZGVyQm90dG9tV2lkdGggPSAiMCI7DQogICAgICAgICAgICAgICAgICAgIG9TdHlsZS5oZWlnaHQgPSAwOw0KICAgICAgICAgICAgICAgICAgICBvU3R5bGUud2lkdGggPSB0aGF0LnMuYWlJbm5lcldpZHRoc1tpQ29sdW1uXSsicHgiOw0KDQogICAgICAgICAgICAgICAgICAgIG5Jbm5lclRoZWFkLmFwcGVuZENoaWxkKCBuQ2xvbmUgKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAvKiBBZGQgaW4gdGhlIHRib2R5IGVsZW1lbnRzLCBjbG9uaW5nIGZvcm0gdGhlIG1hc3RlciB0YWJsZSAqLw0KICAgICAgICAgICAgICAgICQoJz50Ym9keT50cicsIHRoYXQuZG9tLmJvZHkpLmVhY2goIGZ1bmN0aW9uICh6KSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBpID0gdGhhdC5zLmR0Lm9GZWF0dXJlcy5iU2VydmVyU2lkZT09PWZhbHNlID8NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQucy5kdC5haURpc3BsYXlbIHRoYXQucy5kdC5faURpc3BsYXlTdGFydCt6IF0gOiB6Ow0KDQogICAgICAgICAgICAgICAgICAgIHZhciBhVGRzOw0KDQogICAgICAgICAgICAgICAgICAgIGlmIChpID49IHRoYXQucy5kdC5hb0RhdGEubGVuZ3RoIHx8IF8uaXNVbmRlZmluZWQodGhhdC5zLmR0LmFvRGF0YVsgaSBdLmFuQ2VsbHMpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgYVRkcyA9IHRoYXQucy5kdC5hb0RhdGFbIGkgLSAxIF0uYW5DZWxsczsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFUZHMgPSAkKHRoaXMpLmNoaWxkcmVuKCd0ZCwgdGgnKTsNCiAgICAgICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgICAgICAgICAgYVRkcyA9IHRoYXQucy5kdC5hb0RhdGFbIGkgXS5hbkNlbGxzOw0KDQogICAgICAgICAgICAgICAgICAgIHZhciBuID0gdGhpcy5jbG9uZU5vZGUoZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICBuLnJlbW92ZUF0dHJpYnV0ZSgnaWQnKTsNCiAgICAgICAgICAgICAgICAgICAgbi5zZXRBdHRyaWJ1dGUoICdkYXRhLWR0LXJvdycsIGkgKTsNCg0KICAgICAgICAgICAgICAgICAgICBmb3IgKCBpSW5kZXg9MCA7IGlJbmRleDxhaUNvbHVtbnMubGVuZ3RoIDsgaUluZGV4KysgKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBpQ29sdW1uID0gYWlDb2x1bW5zW2lJbmRleF07DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggYVRkcy5sZW5ndGggPiAwICkNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuQ2xvbmUgPSAkKCBhVGRzW2lDb2x1bW5dICkuY2xvbmUodHJ1ZSwgdHJ1ZSlbMF07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbkNsb25lLnNldEF0dHJpYnV0ZSggJ2RhdGEtZHQtcm93JywgaSApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5DbG9uZS5zZXRBdHRyaWJ1dGUoICdkYXRhLWR0LWNvbHVtbicsIGR0Lm9BcGkuX2ZuVmlzaWJsZVRvQ29sdW1uSW5kZXgoIGR0LCBpQ29sdW1uICkgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLmFwcGVuZENoaWxkKCBuQ2xvbmUgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBuQm9keS5hcHBlbmRDaGlsZCggbiApOw0KICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAkKCc+dGJvZHk+dHInLCB0aGF0LmRvbS5ib2R5KS5lYWNoKCBmdW5jdGlvbiAoeikgew0KICAgICAgICAgICAgICAgICAgICBuQ2xvbmUgPSB0aGlzLmNsb25lTm9kZSh0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgbkNsb25lLmNsYXNzTmFtZSArPSAnIERURkNfTm9EYXRhJzsNCiAgICAgICAgICAgICAgICAgICAgJCgndGQnLCBuQ2xvbmUpLmh0bWwoJycpOw0KICAgICAgICAgICAgICAgICAgICBuQm9keS5hcHBlbmRDaGlsZCggbkNsb25lICk7DQogICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBvQ2xvbmUuYm9keS5zdHlsZS53aWR0aCA9ICIxMDAlIjsNCiAgICAgICAgICAgIG9DbG9uZS5ib2R5LnN0eWxlLm1hcmdpbiA9ICIwIjsNCiAgICAgICAgICAgIG9DbG9uZS5ib2R5LnN0eWxlLnBhZGRpbmcgPSAiMCI7DQoNCiAgICAgICAgICAgIC8vIEludGVyb3Agd2l0aCBTY3JvbGxlciAtIG5lZWQgdG8gdXNlIGEgaGVpZ2h0IGZvcmNpbmcgZWxlbWVudCBpbiB0aGUNCiAgICAgICAgICAgIC8vIHNjcm9sbGluZyBhcmVhIGluIHRoZSBzYW1lIHdheSB0aGF0IFNjcm9sbGVyIGRvZXMgaW4gdGhlIGJvZHkgc2Nyb2xsLg0KICAgICAgICAgICAgaWYgKCBkdC5vU2Nyb2xsZXIgIT09IHVuZGVmaW5lZCApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgdmFyIHNjcm9sbGVyRm9yY2VyID0gZHQub1Njcm9sbGVyLmRvbS5mb3JjZTsNCg0KICAgICAgICAgICAgICAgIGlmICggISBvR3JpZC5mb3JjZXIgKSB7DQogICAgICAgICAgICAgICAgICAgIG9HcmlkLmZvcmNlciA9IHNjcm9sbGVyRm9yY2VyLmNsb25lTm9kZSggdHJ1ZSApOw0KICAgICAgICAgICAgICAgICAgICBvR3JpZC5saW5lci5hcHBlbmRDaGlsZCggb0dyaWQuZm9yY2VyICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBvR3JpZC5mb3JjZXIuc3R5bGUuaGVpZ2h0ID0gc2Nyb2xsZXJGb3JjZXIuc3R5bGUuaGVpZ2h0Ow0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgb0dyaWQubGluZXIuYXBwZW5kQ2hpbGQoIG9DbG9uZS5ib2R5ICk7DQoNCiAgICAgICAgICAgIHRoaXMuX2ZuRXF1YWxpc2VIZWlnaHRzKCAndGJvZHknLCB0aGF0LmRvbS5ib2R5LCBvQ2xvbmUuYm9keSApOw0KDQogICAgICAgICAgICAvKg0KICAgICAgICAgICAgICogRm9vdGVyDQogICAgICAgICAgICAgKi8NCiAgICAgICAgICAgIGlmICggZHQublRGb290ICE9PSBudWxsICkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpZiAoIGJBbGwgKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCBvQ2xvbmUuZm9vdGVyICE9PSBudWxsICkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgb0Nsb25lLmZvb3Rlci5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKCBvQ2xvbmUuZm9vdGVyICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgb0Nsb25lLmZvb3RlciA9ICQodGhpcy5kb20uZm9vdGVyKS5jbG9uZSh0cnVlLCB0cnVlKVswXTsNCiAgICAgICAgICAgICAgICAgICAgb0Nsb25lLmZvb3Rlci5jbGFzc05hbWUgKz0gIiBEVEZDX0Nsb25lZCI7DQogICAgICAgICAgICAgICAgICAgIG9DbG9uZS5mb290ZXIuc3R5bGUud2lkdGggPSAiMTAwJSI7DQogICAgICAgICAgICAgICAgICAgIG9HcmlkLmZvb3QuYXBwZW5kQ2hpbGQoIG9DbG9uZS5mb290ZXIgKTsNCg0KICAgICAgICAgICAgICAgICAgICAvKiBDb3B5IHRoZSBmb290ZXIganVzdCBsaWtlIHdlIGRvIGZvciB0aGUgaGVhZGVyICovDQogICAgICAgICAgICAgICAgICAgIGFvQ2xvbmVMYXlvdXQgPSB0aGlzLl9mbkNvcHlMYXlvdXQoIGR0LmFvRm9vdGVyLCBhaUNvbHVtbnMsIHRydWUgKTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGpxQ2xvbmVUZm9vdCA9ICQoJz50Zm9vdCcsIG9DbG9uZS5mb290ZXIpOw0KICAgICAgICAgICAgICAgICAgICBqcUNsb25lVGZvb3QuZW1wdHkoKTsNCg0KICAgICAgICAgICAgICAgICAgICBmb3IgKCBpPTAsIGlMZW49YW9DbG9uZUxheW91dC5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBqcUNsb25lVGZvb3RbMF0uYXBwZW5kQ2hpbGQoIGFvQ2xvbmVMYXlvdXRbaV0ublRyICk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZHQub0FwaS5fZm5EcmF3SGVhZCggZHQsIGFvQ2xvbmVMYXlvdXQsIHRydWUgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgYW9DbG9uZUxheW91dCA9IHRoaXMuX2ZuQ29weUxheW91dCggZHQuYW9Gb290ZXIsIGFpQ29sdW1ucywgZmFsc2UgKTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFvQ3VyckZvb3Rlcj1bXTsNCg0KICAgICAgICAgICAgICAgICAgICBkdC5vQXBpLl9mbkRldGVjdEhlYWRlciggYW9DdXJyRm9vdGVyLCAkKCc+dGZvb3QnLCBvQ2xvbmUuZm9vdGVyKVswXSApOw0KDQogICAgICAgICAgICAgICAgICAgIGZvciAoIGk9MCwgaUxlbj1hb0Nsb25lTGF5b3V0Lmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoIGo9MCwgakxlbj1hb0Nsb25lTGF5b3V0W2ldLmxlbmd0aCA7IGo8akxlbiA7IGorKyApDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYW9DdXJyRm9vdGVyW2ldW2pdLmNlbGwuY2xhc3NOYW1lID0gYW9DbG9uZUxheW91dFtpXVtqXS5jZWxsLmNsYXNzTmFtZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB0aGlzLl9mbkVxdWFsaXNlSGVpZ2h0cyggJ3Rmb290JywgdGhpcy5kb20uZm9vdGVyLCBvQ2xvbmUuZm9vdGVyICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8qIEVxdWFsaXNlIHRoZSBjb2x1bW4gd2lkdGhzIGJldHdlZW4gdGhlIGhlYWRlciBmb290ZXIgYW5kIGJvZHkgLSBib2R5IGdldCdzIHByaW9yaXR5ICovDQogICAgICAgICAgICB2YXIgYW5VbmlxdWUgPSBkdC5vQXBpLl9mbkdldFVuaXF1ZVRocyggZHQsICQoJz50aGVhZCcsIG9DbG9uZS5oZWFkZXIpWzBdICk7DQogICAgICAgICAgICAkKGFuVW5pcXVlKS5lYWNoKCBmdW5jdGlvbiAoaSkgew0KICAgICAgICAgICAgICAgIGlDb2x1bW4gPSBhaUNvbHVtbnNbaV07DQogICAgICAgICAgICAgICAgdGhpcy5zdHlsZS53aWR0aCA9IHRoYXQucy5haUlubmVyV2lkdGhzW2lDb2x1bW5dKyJweCI7DQogICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgIGlmICggdGhhdC5zLmR0Lm5URm9vdCAhPT0gbnVsbCApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgYW5VbmlxdWUgPSBkdC5vQXBpLl9mbkdldFVuaXF1ZVRocyggZHQsICQoJz50Zm9vdCcsIG9DbG9uZS5mb290ZXIpWzBdICk7DQogICAgICAgICAgICAgICAgJChhblVuaXF1ZSkuZWFjaCggZnVuY3Rpb24gKGkpIHsNCiAgICAgICAgICAgICAgICAgICAgaUNvbHVtbiA9IGFpQ29sdW1uc1tpXTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdHlsZS53aWR0aCA9IHRoYXQucy5haUlubmVyV2lkdGhzW2lDb2x1bW5dKyJweCI7DQogICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIEZyb20gYSBnaXZlbiB0YWJsZSBub2RlIChUSEVBRCBldGMpLCBnZXQgYSBsaXN0IG9mIFRSIGRpcmVjdCBjaGlsZCBlbGVtZW50cw0KICAgICAgICAgKiAgQHBhcmFtICAge05vZGV9IG5JbiBUYWJsZSBlbGVtZW50IHRvIHNlYXJjaCBmb3IgVFIgZWxlbWVudHMgKFRIRUFELCBUQk9EWSBvciBURk9PVCBlbGVtZW50KQ0KICAgICAgICAgKiAgQHJldHVybnMge0FycmF5fSBMaXN0IG9mIFRSIGVsZW1lbnRzIGZvdW5kDQogICAgICAgICAqICBAcHJpdmF0ZQ0KICAgICAgICAgKi8NCiAgICAgICAgIl9mbkdldFRyTm9kZXMiOiBmdW5jdGlvbiAoIG5JbiApDQogICAgICAgIHsNCiAgICAgICAgICAgIHZhciBhT3V0ID0gW107DQogICAgICAgICAgICBmb3IgKCB2YXIgaT0wLCBpTGVuPW5Jbi5jaGlsZE5vZGVzLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWYgKCBuSW4uY2hpbGROb2Rlc1tpXS5ub2RlTmFtZS50b1VwcGVyQ2FzZSgpID09ICJUUiIgKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgYU91dC5wdXNoKCBuSW4uY2hpbGROb2Rlc1tpXSApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBhT3V0Ow0KICAgICAgICB9LA0KDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIEVxdWFsaXNlIHRoZSBoZWlnaHRzIG9mIHRoZSByb3dzIGluIGEgZ2l2ZW4gdGFibGUgbm9kZSBpbiBhIGNyb3NzIGJyb3dzZXIgd2F5DQogICAgICAgICAqICBAcmV0dXJucyB7dm9pZH0NCiAgICAgICAgICogIEBwYXJhbSAgIHtTdHJpbmd9IG5vZGVOYW1lIE5vZGUgdHlwZSAtIHRoZWFkLCB0Ym9keSBvciB0Zm9vdA0KICAgICAgICAgKiAgQHBhcmFtICAge05vZGV9IG9yaWdpbmFsIE9yaWdpbmFsIG5vZGUgdG8gdGFrZSB0aGUgaGVpZ2h0cyBmcm9tDQogICAgICAgICAqICBAcGFyYW0gICB7Tm9kZX0gY2xvbmUgQ29weSB0aGUgaGVpZ2h0cyB0bw0KICAgICAgICAgKiAgQHByaXZhdGUNCiAgICAgICAgICovDQogICAgICAgICJfZm5FcXVhbGlzZUhlaWdodHMiOiBmdW5jdGlvbiAoIG5vZGVOYW1lLCBvcmlnaW5hbCwgY2xvbmUgKQ0KICAgICAgICB7DQogICAgICAgICAgICBpZiAoIHRoaXMucy5zSGVpZ2h0TWF0Y2ggPT0gJ25vbmUnICYmIG5vZGVOYW1lICE9PSAndGhlYWQnICYmIG5vZGVOYW1lICE9PSAndGZvb3QnICkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcywNCiAgICAgICAgICAgICAgICBpLCBpTGVuLCBpSGVpZ2h0LCBpSGVpZ2h0MiwgaUhlaWdodE9yaWdpbmFsLCBpSGVpZ2h0Q2xvbmUsDQogICAgICAgICAgICAgICAgcm9vdE9yaWdpbmFsID0gb3JpZ2luYWwuZ2V0RWxlbWVudHNCeVRhZ05hbWUobm9kZU5hbWUpWzBdLA0KICAgICAgICAgICAgICAgIHJvb3RDbG9uZSAgICA9IGNsb25lLmdldEVsZW1lbnRzQnlUYWdOYW1lKG5vZGVOYW1lKVswXSwNCiAgICAgICAgICAgICAgICBqcUJveEhhY2sgICAgPSAkKCc+Jytub2RlTmFtZSsnPnRyOmVxKDApJywgb3JpZ2luYWwpLmNoaWxkcmVuKCc6Zmlyc3QnKSwNCiAgICAgICAgICAgICAgICBpQm94SGFjayAgICAgPSBqcUJveEhhY2sub3V0ZXJIZWlnaHQoKSAtIGpxQm94SGFjay5oZWlnaHQoKSwNCiAgICAgICAgICAgICAgICBhbk9yaWdpbmFsICAgPSB0aGlzLl9mbkdldFRyTm9kZXMoIHJvb3RPcmlnaW5hbCApLA0KICAgICAgICAgICAgICAgIGFuQ2xvbmUgICAgICA9IHRoaXMuX2ZuR2V0VHJOb2Rlcyggcm9vdENsb25lICksDQogICAgICAgICAgICAgICAgaGVpZ2h0cyAgICAgID0gW107DQoNCiAgICAgICAgICAgIGZvciAoIGk9MCwgaUxlbj1hbkNsb25lLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaUhlaWdodE9yaWdpbmFsID0gYW5PcmlnaW5hbFtpXS5vZmZzZXRIZWlnaHQ7DQogICAgICAgICAgICAgICAgaUhlaWdodENsb25lID0gYW5DbG9uZVtpXS5vZmZzZXRIZWlnaHQ7DQogICAgICAgICAgICAgICAgaUhlaWdodCA9IGlIZWlnaHRDbG9uZSA+IGlIZWlnaHRPcmlnaW5hbCA/IGlIZWlnaHRDbG9uZSA6IGlIZWlnaHRPcmlnaW5hbDsNCg0KICAgICAgICAgICAgICAgIGlmICggdGhpcy5zLnNIZWlnaHRNYXRjaCA9PSAnc2VtaWF1dG8nICkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGFuT3JpZ2luYWxbaV0uX0RUVENfaUhlaWdodCA9IGlIZWlnaHQ7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgaGVpZ2h0cy5wdXNoKCBpSGVpZ2h0ICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGZvciAoIGk9MCwgaUxlbj1hbkNsb25lLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgYW5DbG9uZVtpXS5zdHlsZS5oZWlnaHQgPSBoZWlnaHRzW2ldKyJweCI7DQogICAgICAgICAgICAgICAgYW5PcmlnaW5hbFtpXS5zdHlsZS5oZWlnaHQgPSBoZWlnaHRzW2ldKyJweCI7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIERldGVybWluZSBpZiB0aGUgVUEgc3VmZmVycyBmcm9tIEZpcmVmb3gncyBvdmVyZmxvdzpzY3JvbGwgc2Nyb2xsYmFycw0KICAgICAgICAgKiBub3QgYmVpbmcgc2hvd24gYnVnLg0KICAgICAgICAgKg0KICAgICAgICAgKiBGaXJlZm94IGRvZXNuJ3QgZHJhdyBzY3JvbGxiYXJzLCBldmVuIGlmIGl0IGlzIHRvbGQgdG8gdXNpbmcNCiAgICAgICAgICogb3ZlcmZsb3c6c2Nyb2xsLCBpZiB0aGUgZGl2IGlzIGxlc3MgdGhhbiAzNHB4IGhlaWdodC4gU2VlIGJ1Z3MgMjkyMjg0IGFuZA0KICAgICAgICAgKiA3ODE4ODUuIFVzaW5nIFVBIGRldGVjdGlvbiBoZXJlIHNpbmNlIHRoaXMgaXMgcGFydGljdWxhcmx5IGhhcmQgdG8gZGV0ZWN0DQogICAgICAgICAqIHVzaW5nIG9iamVjdHMgLSBpdHMgYSBzdHJhaWdodCB1cCByZW5kZXJpbmcgZXJyb3IgaW4gRmlyZWZveC4NCiAgICAgICAgICoNCiAgICAgICAgICogQHJldHVybiB7Ym9vbGVhbn0gVHJ1ZSBpZiBGaXJlZm94IGVycm9yIGlzIHByZXNlbnQsIGZhbHNlIG90aGVyd2lzZQ0KICAgICAgICAgKi8NCiAgICAgICAgX2ZpcmVmb3hTY3JvbGxFcnJvcjogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgaWYgKCBfZmlyZWZveFNjcm9sbCA9PT0gdW5kZWZpbmVkICkgew0KICAgICAgICAgICAgICAgIHZhciB0ZXN0ID0gJCgnPGRpdi8+JykNCiAgICAgICAgICAgICAgICAgICAgLmNzcyggew0KICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsDQogICAgICAgICAgICAgICAgICAgICAgICB0b3A6IDAsDQogICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAxMCwNCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiA1MCwNCiAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJmbG93OiAnc2Nyb2xsJw0KICAgICAgICAgICAgICAgICAgICB9ICkNCiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZFRvKCAnYm9keScgKTsNCg0KICAgICAgICAgICAgICAgIC8vIE1ha2Ugc3VyZSB0aGlzIGRvZXNuJ3QgYXBwbHkgb24gTWFjcyB3aXRoIDAgd2lkdGggc2Nyb2xsYmFycw0KICAgICAgICAgICAgICAgIF9maXJlZm94U2Nyb2xsID0gKA0KICAgICAgICAgICAgICAgICAgICB0ZXN0WzBdLmNsaWVudFdpZHRoID09PSB0ZXN0WzBdLm9mZnNldFdpZHRoICYmIHRoaXMuX2ZuRFRPdmVyZmxvdygpLmJhciAhPT0gMA0KICAgICAgICAgICAgICAgICk7DQoNCiAgICAgICAgICAgICAgICB0ZXN0LnJlbW92ZSgpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gX2ZpcmVmb3hTY3JvbGw7DQogICAgICAgIH0NCiAgICB9ICk7DQoNCg0KDQogICAgLyogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqDQogICAgICogU3RhdGljcw0KICAgICAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKi8NCg0KICAgIC8qKg0KICAgICAqIEZpeGVkQ29sdW1ucyBkZWZhdWx0IHNldHRpbmdzIGZvciBpbml0aWFsaXNhdGlvbg0KICAgICAqICBAbmFtZSBGaXhlZENvbHVtbnMuZGVmYXVsdHMNCiAgICAgKiAgQG5hbWVzcGFjZQ0KICAgICAqICBAc3RhdGljDQogICAgICovDQogICAgRml4ZWRDb2x1bW5zLmRlZmF1bHRzID0gLyoqIEBsZW5kcyBGaXhlZENvbHVtbnMuZGVmYXVsdHMgKi97DQogICAgICAgIC8qKg0KICAgICAgICAgKiBOdW1iZXIgb2YgbGVmdCBoYW5kIGNvbHVtbnMgdG8gZml4IGluIHBvc2l0aW9uDQogICAgICAgICAqICBAdHlwZSAgICAgaW50DQogICAgICAgICAqICBAZGVmYXVsdCAgMQ0KICAgICAgICAgKiAgQHN0YXRpYw0KICAgICAgICAgKiAgQGV4YW1wbGUNCiAgICAgICAgICogICAgICB2YXIgID0gJCgnI2V4YW1wbGUnKS5kYXRhVGFibGUoIHsNCgkgKiAgICAgICAgICAic2Nyb2xsWCI6ICIxMDAlIg0KCSAqICAgICAgfSApOw0KICAgICAgICAgKiAgICAgIG5ldyAkLmZuLmRhdGFUYWJsZS5maXhlZENvbHVtbnMoIHRhYmxlLCB7DQoJICogICAgICAgICAgImxlZnRDb2x1bW5zIjogMg0KCSAqICAgICAgfSApOw0KICAgICAgICAgKi8NCiAgICAgICAgImlMZWZ0Q29sdW1ucyI6IDEsDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIE51bWJlciBvZiByaWdodCBoYW5kIGNvbHVtbnMgdG8gZml4IGluIHBvc2l0aW9uDQogICAgICAgICAqICBAdHlwZSAgICAgaW50DQogICAgICAgICAqICBAZGVmYXVsdCAgMA0KICAgICAgICAgKiAgQHN0YXRpYw0KICAgICAgICAgKiAgQGV4YW1wbGUNCiAgICAgICAgICogICAgICB2YXIgdGFibGUgPSAkKCcjZXhhbXBsZScpLmRhdGFUYWJsZSggew0KCSAqICAgICAgICAgICJzY3JvbGxYIjogIjEwMCUiDQoJICogICAgICB9ICk7DQogICAgICAgICAqICAgICAgbmV3ICQuZm4uZGF0YVRhYmxlLmZpeGVkQ29sdW1ucyggdGFibGUsIHsNCgkgKiAgICAgICAgICAicmlnaHRDb2x1bW5zIjogMQ0KCSAqICAgICAgfSApOw0KICAgICAgICAgKi8NCiAgICAgICAgImlSaWdodENvbHVtbnMiOiAwLA0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBEcmF3IGNhbGxiYWNrIGZ1bmN0aW9uIHdoaWNoIGlzIGNhbGxlZCB3aGVuIEZpeGVkQ29sdW1ucyBoYXMgcmVkcmF3biB0aGUgZml4ZWQgYXNzZXRzDQogICAgICAgICAqICBAdHlwZSAgICAgZnVuY3Rpb24ob2JqZWN0LCBvYmplY3QpOnZvaWQNCiAgICAgICAgICogIEBkZWZhdWx0ICBudWxsDQogICAgICAgICAqICBAc3RhdGljDQogICAgICAgICAqICBAZXhhbXBsZQ0KICAgICAgICAgKiAgICAgIHZhciB0YWJsZSA9ICQoJyNleGFtcGxlJykuZGF0YVRhYmxlKCB7DQoJICogICAgICAgICAgInNjcm9sbFgiOiAiMTAwJSINCgkgKiAgICAgIH0gKTsNCiAgICAgICAgICogICAgICBuZXcgJC5mbi5kYXRhVGFibGUuZml4ZWRDb2x1bW5zKCB0YWJsZSwgew0KCSAqICAgICAgICAgICJkcmF3Q2FsbGJhY2siOiBmdW5jdGlvbiAoKSB7DQoJICoJICAgICAgICAgICAgYWxlcnQoICJGaXhlZENvbHVtbnMgcmVkcmF3IiApOw0KCSAqCSAgICAgICAgfQ0KCSAqICAgICAgfSApOw0KICAgICAgICAgKi8NCiAgICAgICAgImZuRHJhd0NhbGxiYWNrIjogbnVsbCwNCg0KICAgICAgICAvKioNCiAgICAgICAgICogSGVpZ2h0IG1hdGNoaW5nIGFsZ29ydGhpbSB0byB1c2UuIFRoaXMgY2FuIGJlICJub25lIiB3aGljaCB3aWxsIHJlc3VsdCBpbiBubyBoZWlnaHQNCiAgICAgICAgICogbWF0Y2hpbmcgYmVpbmcgYXBwbGllZCBieSBGaXhlZENvbHVtbnMgKGhlaWdodCBtYXRjaGluZyBjb3VsZCBiZSBmb3JjZWQgYnkgQ1NTIGluIHRoaXMNCiAgICAgICAgICogY2FzZSksICJzZW1pYXV0byIgd2hlcmVieSB0aGUgaGVpZ2h0IGNhbGN1bGF0aW9uIHdpbGwgYmUgcGVyZm9ybWVkIG9uY2UsIGFuZCB0aGUgcmVzdWx0DQogICAgICAgICAqIGNhY2hlZCB0byBiZSB1c2VkIGFnYWluIChmblJlY2FsY3VsYXRlSGVpZ2h0IGNhbiBiZSB1c2VkIHRvIGZvcmNlIHJlY2FsY3VsYXRpb24pLCBvcg0KICAgICAgICAgKiAiYXV0byIgd2hlbiBoZWlnaHQgbWF0Y2hpbmcgaXMgcGVyZm9ybWVkIG9uIGV2ZXJ5IGRyYXcgKHNsb3dlc3QgYnV0IG11c3QgYWNjdXJhdGUpDQogICAgICAgICAqICBAdHlwZSAgICAgc3RyaW5nDQogICAgICAgICAqICBAZGVmYXVsdCAgc2VtaWF1dG8NCiAgICAgICAgICogIEBzdGF0aWMNCiAgICAgICAgICogIEBleGFtcGxlDQogICAgICAgICAqICAgICAgdmFyIHRhYmxlID0gJCgnI2V4YW1wbGUnKS5kYXRhVGFibGUoIHsNCgkgKiAgICAgICAgICAic2Nyb2xsWCI6ICIxMDAlIg0KCSAqICAgICAgfSApOw0KICAgICAgICAgKiAgICAgIG5ldyAkLmZuLmRhdGFUYWJsZS5maXhlZENvbHVtbnMoIHRhYmxlLCB7DQoJICogICAgICAgICAgImhlaWdodE1hdGNoIjogImF1dG8iDQoJICogICAgICB9ICk7DQogICAgICAgICAqLw0KICAgICAgICAic0hlaWdodE1hdGNoIjogInNlbWlhdXRvIg0KICAgIH07DQoNCg0KDQoNCiAgICAvKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICoNCiAgICAgKiBDb25zdGFudHMNCiAgICAgKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICovDQoNCiAgICAvKioNCiAgICAgKiBGaXhlZENvbHVtbnMgdmVyc2lvbg0KICAgICAqICBAbmFtZSAgICAgIEZpeGVkQ29sdW1ucy52ZXJzaW9uDQogICAgICogIEB0eXBlICAgICAgU3RyaW5nDQogICAgICogIEBkZWZhdWx0ICAgU2VlIGNvZGUNCiAgICAgKiAgQHN0YXRpYw0KICAgICAqLw0KICAgIEZpeGVkQ29sdW1ucy52ZXJzaW9uID0gIjMuMi4zLWRldiI7DQoNCg0KDQogICAgLyogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqDQogICAgICogRGF0YVRhYmxlcyBBUEkgaW50ZWdyYXRpb24NCiAgICAgKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICovDQoNCiAgICBEYXRhVGFibGUuQXBpLnJlZ2lzdGVyKCAnZml4ZWRDb2x1bW5zKCknLCBmdW5jdGlvbiAoKSB7DQogICAgICAgIHJldHVybiB0aGlzOw0KICAgIH0gKTsNCg0KICAgIERhdGFUYWJsZS5BcGkucmVnaXN0ZXIoICdmaXhlZENvbHVtbnMoKS51cGRhdGUoKScsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgcmV0dXJuIHRoaXMuaXRlcmF0b3IoICd0YWJsZScsIGZ1bmN0aW9uICggY3R4ICkgew0KICAgICAgICAgICAgaWYgKCBjdHguX29GaXhlZENvbHVtbnMgKSB7DQogICAgICAgICAgICAgICAgY3R4Ll9vRml4ZWRDb2x1bW5zLmZuVXBkYXRlKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0gKTsNCiAgICB9ICk7DQoNCiAgICBEYXRhVGFibGUuQXBpLnJlZ2lzdGVyKCAnZml4ZWRDb2x1bW5zKCkucmVsYXlvdXQoKScsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgcmV0dXJuIHRoaXMuaXRlcmF0b3IoICd0YWJsZScsIGZ1bmN0aW9uICggY3R4ICkgew0KICAgICAgICAgICAgaWYgKCBjdHguX29GaXhlZENvbHVtbnMgKSB7DQogICAgICAgICAgICAgICAgY3R4Ll9vRml4ZWRDb2x1bW5zLmZuUmVkcmF3TGF5b3V0KCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0gKTsNCiAgICB9ICk7DQoNCiAgICBEYXRhVGFibGUuQXBpLnJlZ2lzdGVyKCAncm93cygpLnJlY2FsY0hlaWdodCgpJywgZnVuY3Rpb24gKCkgew0KICAgICAgICByZXR1cm4gdGhpcy5pdGVyYXRvciggJ3JvdycsIGZ1bmN0aW9uICggY3R4LCBpZHggKSB7DQogICAgICAgICAgICBpZiAoIGN0eC5fb0ZpeGVkQ29sdW1ucyApIHsNCiAgICAgICAgICAgICAgICBjdHguX29GaXhlZENvbHVtbnMuZm5SZWNhbGN1bGF0ZUhlaWdodCggdGhpcy5yb3coaWR4KS5ub2RlKCkgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSApOw0KICAgIH0gKTsNCg0KICAgIERhdGFUYWJsZS5BcGkucmVnaXN0ZXIoICdmaXhlZENvbHVtbnMoKS5yb3dJbmRleCgpJywgZnVuY3Rpb24gKCByb3cgKSB7DQogICAgICAgIHJvdyA9ICQocm93KTsNCg0KICAgICAgICByZXR1cm4gcm93LnBhcmVudHMoJy5EVEZDX0Nsb25lZCcpLmxlbmd0aCA/DQogICAgICAgICAgICB0aGlzLnJvd3MoIHsgcGFnZTogJ2N1cnJlbnQnIH0gKS5pbmRleGVzKClbIHJvdy5pbmRleCgpIF0gOg0KICAgICAgICAgICAgdGhpcy5yb3coIHJvdyApLmluZGV4KCk7DQogICAgfSApOw0KDQogICAgRGF0YVRhYmxlLkFwaS5yZWdpc3RlciggJ2ZpeGVkQ29sdW1ucygpLmNlbGxJbmRleCgpJywgZnVuY3Rpb24gKCBjZWxsICkgew0KICAgICAgICBjZWxsID0gJChjZWxsKTsNCg0KICAgICAgICBpZiAoIGNlbGwucGFyZW50cygnLkRURkNfQ2xvbmVkJykubGVuZ3RoICkgew0KICAgICAgICAgICAgdmFyIHJvd0Nsb25lZElkeCA9IGNlbGwucGFyZW50KCkuaW5kZXgoKTsNCiAgICAgICAgICAgIHZhciByb3dJZHggPSB0aGlzLnJvd3MoIHsgcGFnZTogJ2N1cnJlbnQnIH0gKS5pbmRleGVzKClbIHJvd0Nsb25lZElkeCBdOw0KICAgICAgICAgICAgdmFyIGNvbHVtbklkeDsNCg0KICAgICAgICAgICAgaWYgKCBjZWxsLnBhcmVudHMoJy5EVEZDX0xlZnRXcmFwcGVyJykubGVuZ3RoICkgew0KICAgICAgICAgICAgICAgIGNvbHVtbklkeCA9IGNlbGwuaW5kZXgoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgICAgIHZhciBjb2x1bW5zID0gdGhpcy5jb2x1bW5zKCkuZmxhdHRlbigpLmxlbmd0aDsNCiAgICAgICAgICAgICAgICBjb2x1bW5JZHggPSBjb2x1bW5zIC0gdGhpcy5jb250ZXh0WzBdLl9vRml4ZWRDb2x1bW5zLnMuaVJpZ2h0Q29sdW1ucyArIGNlbGwuaW5kZXgoKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICByb3c6IHJvd0lkeCwNCiAgICAgICAgICAgICAgICBjb2x1bW46IHRoaXMuY29sdW1uLmluZGV4KCAndG9EYXRhJywgY29sdW1uSWR4ICksDQogICAgICAgICAgICAgICAgY29sdW1uVmlzaWJsZTogY29sdW1uSWR4DQogICAgICAgICAgICB9Ow0KICAgICAgICB9DQogICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2VsbCggY2VsbCApLmluZGV4KCk7DQogICAgICAgIH0NCiAgICB9ICk7DQoNCg0KDQoNCiAgICAvKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICoNCiAgICAgKiBJbml0aWFsaXNhdGlvbg0KICAgICAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKi8NCg0KLy8gQXR0YWNoIGEgbGlzdGVuZXIgdG8gdGhlIGRvY3VtZW50IHdoaWNoIGxpc3RlbnMgZm9yIERhdGFUYWJsZXMgaW5pdGlhbGlzYXRpb24NCi8vIGV2ZW50cyBzbyB3ZSBjYW4gYXV0b21hdGljYWxseSBpbml0aWFsaXNlDQogICAgJChkb2N1bWVudCkub24oICdpbml0LmR0LmZpeGVkQ29sdW1ucycsIGZ1bmN0aW9uIChlLCBzZXR0aW5ncykgew0KICAgICAgICBpZiAoIGUubmFtZXNwYWNlICE9PSAnZHQnICkgew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICAgICAgdmFyIGluaXQgPSBzZXR0aW5ncy5vSW5pdC5maXhlZENvbHVtbnM7DQogICAgICAgIHZhciBkZWZhdWx0cyA9IERhdGFUYWJsZS5kZWZhdWx0cy5maXhlZENvbHVtbnM7DQoNCiAgICAgICAgaWYgKCBpbml0IHx8IGRlZmF1bHRzICkgew0KICAgICAgICAgICAgdmFyIG9wdHMgPSAkLmV4dGVuZCgge30sIGluaXQsIGRlZmF1bHRzICk7DQoNCiAgICAgICAgICAgIGlmICggaW5pdCAhPT0gZmFsc2UgKSB7DQogICAgICAgICAgICAgICAgbmV3IEZpeGVkQ29sdW1ucyggc2V0dGluZ3MsIG9wdHMgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0gKTsNCg0KDQoNCi8vIE1ha2UgRml4ZWRDb2x1bW5zIGFjY2Vzc2libGUgZnJvbSB0aGUgRGF0YVRhYmxlcyBpbnN0YW5jZQ0KICAgICQuZm4uZGF0YVRhYmxlLkZpeGVkQ29sdW1ucyA9IEZpeGVkQ29sdW1uczsNCiAgICAkLmZuLkRhdGFUYWJsZS5GaXhlZENvbHVtbnMgPSBGaXhlZENvbHVtbnM7DQoNCiAgICByZXR1cm4gRml4ZWRDb2x1bW5zOw0KfSkpOwovKiENCiBEYXRhVGFibGVzIEJvb3RzdHJhcCAzIGludGVncmF0aW9uDQogwqkyMDExLTIwMTUgU3ByeU1lZGlhIEx0ZCAtIGRhdGF0YWJsZXMubmV0L2xpY2Vuc2UNCiovDQooZnVuY3Rpb24oYil7ImZ1bmN0aW9uIj09PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFsianF1ZXJ5IiwiZGF0YXRhYmxlcy5uZXQiXSxmdW5jdGlvbihhKXtyZXR1cm4gYihhLHdpbmRvdyxkb2N1bWVudCl9KToib2JqZWN0Ij09PXR5cGVvZiBleHBvcnRzP21vZHVsZS5leHBvcnRzPWZ1bmN0aW9uKGEsZCl7YXx8KGE9d2luZG93KTtpZighZHx8IWQuZm4uZGF0YVRhYmxlKWQ9cmVxdWlyZSgiZGF0YXRhYmxlcy5uZXQiKShhLGQpLiQ7cmV0dXJuIGIoZCxhLGEuZG9jdW1lbnQpfTpiKGpRdWVyeSx3aW5kb3csZG9jdW1lbnQpfSkoZnVuY3Rpb24oYixhLGQsbSl7dmFyIGY9Yi5mbi5kYXRhVGFibGU7Yi5leHRlbmQoITAsZi5kZWZhdWx0cyx7ZG9tOiI8J3Jvdyc8J2NvbC1zbS02J2w+PCdjb2wtc20tNidmPj48J3Jvdyc8J2NvbC1zbS0xMid0cj4+PCdyb3cnPCdjb2wtc20tNSdpPjwnY29sLXNtLTcncD4+IixyZW5kZXJlcjoiYm9vdHN0cmFwIn0pO2IuZXh0ZW5kKGYuZXh0LmNsYXNzZXMsDQp7c1dyYXBwZXI6ImRhdGFUYWJsZXNfd3JhcHBlciBmb3JtLWlubGluZSBkdC1ib290c3RyYXAiLHNGaWx0ZXJJbnB1dDoiZm9ybS1jb250cm9sIGlucHV0LXNtIixzTGVuZ3RoU2VsZWN0OiJmb3JtLWNvbnRyb2wgaW5wdXQtc20iLHNQcm9jZXNzaW5nOiJkYXRhVGFibGVzX3Byb2Nlc3NpbmcgcGFuZWwgcGFuZWwtZGVmYXVsdCJ9KTtmLmV4dC5yZW5kZXJlci5wYWdlQnV0dG9uLmJvb3RzdHJhcD1mdW5jdGlvbihhLGgscixzLGosbil7dmFyIG89bmV3IGYuQXBpKGEpLHQ9YS5vQ2xhc3NlcyxrPWEub0xhbmd1YWdlLm9QYWdpbmF0ZSx1PWEub0xhbmd1YWdlLm9BcmlhLnBhZ2luYXRlfHx7fSxlLGcscD0wLHE9ZnVuY3Rpb24oZCxmKXt2YXIgbCxoLGksYyxtPWZ1bmN0aW9uKGEpe2EucHJldmVudERlZmF1bHQoKTshYihhLmN1cnJlbnRUYXJnZXQpLmhhc0NsYXNzKCJkaXNhYmxlZCIpJiZvLnBhZ2UoKSE9YS5kYXRhLmFjdGlvbiYmby5wYWdlKGEuZGF0YS5hY3Rpb24pLmRyYXcoInBhZ2UiKX07DQpsPTA7Zm9yKGg9Zi5sZW5ndGg7bDxoO2wrKylpZihjPWZbbF0sYi5pc0FycmF5KGMpKXEoZCxjKTtlbHNle2c9ZT0iIjtzd2l0Y2goYyl7Y2FzZSAiZWxsaXBzaXMiOmU9IiYjeDIwMjY7IjtnPSJkaXNhYmxlZCI7YnJlYWs7Y2FzZSAiZmlyc3QiOmU9ay5zRmlyc3Q7Zz1jKygwPGo/IiI6IiBkaXNhYmxlZCIpO2JyZWFrO2Nhc2UgInByZXZpb3VzIjplPWsuc1ByZXZpb3VzO2c9YysoMDxqPyIiOiIgZGlzYWJsZWQiKTticmVhaztjYXNlICJuZXh0IjplPWsuc05leHQ7Zz1jKyhqPG4tMT8iIjoiIGRpc2FibGVkIik7YnJlYWs7Y2FzZSAibGFzdCI6ZT1rLnNMYXN0O2c9YysoajxuLTE/IiI6IiBkaXNhYmxlZCIpO2JyZWFrO2RlZmF1bHQ6ZT1jKzEsZz1qPT09Yz8iYWN0aXZlIjoiIn1lJiYoaT1iKCI8bGk+Iix7ImNsYXNzIjp0LnNQYWdlQnV0dG9uKyIgIitnLGlkOjA9PT1yJiYic3RyaW5nIj09PXR5cGVvZiBjP2Euc1RhYmxlSWQrIl8iK2M6bnVsbH0pLmFwcGVuZChiKCI8YT4iLHtocmVmOiIjIiwNCiJhcmlhLWNvbnRyb2xzIjphLnNUYWJsZUlkLCJhcmlhLWxhYmVsIjp1W2NdLCJkYXRhLWR0LWlkeCI6cCx0YWJpbmRleDphLmlUYWJJbmRleH0pLmh0bWwoZSkpLmFwcGVuZFRvKGQpLGEub0FwaS5fZm5CaW5kQWN0aW9uKGkse2FjdGlvbjpjfSxtKSxwKyspfX0saTt0cnl7aT1iKGgpLmZpbmQoZC5hY3RpdmVFbGVtZW50KS5kYXRhKCJkdC1pZHgiKX1jYXRjaCh2KXt9cShiKGgpLmVtcHR5KCkuaHRtbCgnPHVsIGNsYXNzPSJwYWdpbmF0aW9uIi8+JykuY2hpbGRyZW4oInVsIikscyk7aSE9PW0mJmIoaCkuZmluZCgiW2RhdGEtZHQtaWR4PSIraSsiXSIpLmZvY3VzKCl9O3JldHVybiBmfSk7DQoKKGZ1bmN0aW9uKGIpeyJmdW5jdGlvbiI9PT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShbImpxdWVyeSIsIm1vbWVudCIsImRhdGF0YWJsZXMiXSxiKTpiKGpRdWVyeSxtb21lbnQpfSkoZnVuY3Rpb24oYixkKXtiLmZuLmRhdGFUYWJsZS5tb21lbnQ9ZnVuY3Rpb24oYyxlKXt2YXIgZj1iLmZuLmRhdGFUYWJsZS5leHQudHlwZTtmLmRldGVjdC51bnNoaWZ0KGZ1bmN0aW9uKGEpe2EmJmEucmVwbGFjZSYmKGE9YS5yZXBsYWNlKC88Lio/Pi9nLCIiKSk7cmV0dXJuIiI9PT1hfHxudWxsPT09YT8ibW9tZW50LSIrYzpkKGEsYyxlLCEwKS5pc1ZhbGlkKCk/Im1vbWVudC0iK2M6bnVsbH0pO2Yub3JkZXJbIm1vbWVudC0iK2MrIi1wcmUiXT1mdW5jdGlvbihhKXthJiZhLnJlcGxhY2UmJihhPWEucmVwbGFjZSgvPC4qPz4vZywiIikpO3JldHVybiIiPT09YXx8bnVsbD09PWE/LUluZmluaXR5OnBhcnNlSW50KGQoYSxjLGUsITApLmZvcm1hdCgieCIpLDEwKX19fSk7Ci8vPSByZXF1aXJlX3NlbGYNCi8vPSByZXF1aXJlIF9ncmlkLXV0aWxzDQovLz0gcmVxdWlyZSBfZ3JpZC11aQ0KDQovLyB2YXIgcHZ1aSA9IHB2dWkgfHwge307DQoKdmFyIHB2dWkgPSBwdnVpIHx8IHt9Ow0KcHZ1aS5ncmlkID0gcHZ1aS5ncmlkIHx8IHt9Ow0KDQpwdnVpLmdyaWQudXRpbHM9IGZ1bmN0aW9uICgpIHsNCiAgICB2YXIgd3JhcHBlckNvbnRhaW5lciA9ICQoIiN3cmFwcGVyIik7DQogICAgdmFyIGhhc011bHRpcGxlTGlzdCA9ICQoIiNjb21tb25MaXN0RGF0YUVsZW1lbnRzIikuZGF0YSgiaGFzLW11bHRpcGxlLWxpc3QiKTsNCg0KICAgIHZhciBhcHBlbmREcm9wZG93bk91dHNpZGVDb250YWluZXIgPSBmdW5jdGlvbiAoY29udGFpbmVyLCBkcm9wZG93bkNscykgew0KICAgICAgICB2YXIgYWN0aW9uRHJvcGRvd25NZW51Ow0KICAgICAgICAkKGNvbnRhaW5lcikub24oJ3Nob3cuYnMuZHJvcGRvd24nLGRyb3Bkb3duQ2xzLCBmdW5jdGlvbihlKSB7DQogICAgICAgICAgICBhY3Rpb25Ecm9wZG93bk1lbnUgPSAkKGUuY3VycmVudFRhcmdldCkuZmluZCgnLmRyb3Bkb3duLW1lbnUnKTsNCiAgICAgICAgICAgICQoJ2JvZHknKS5hcHBlbmQoYWN0aW9uRHJvcGRvd25NZW51LmRldGFjaCgpKTsNCiAgICAgICAgICAgIHZhciBjdXJyVGFyZ2V0ID0gJChlLmN1cnJlbnRUYXJnZXQpLA0KICAgICAgICAgICAgICAgIGVPZmZzZXQgPSBjdXJyVGFyZ2V0Lm9mZnNldCgpLA0KICAgICAgICAgICAgICAgIHJ0T2Zmc2V0ID0gKCQod2luZG93KS53aWR0aCgpIC0gKGVPZmZzZXQubGVmdCArIGN1cnJUYXJnZXQub3V0ZXJXaWR0aCgpKSksDQogICAgICAgICAgICAgICAgZHJvcGRvd25IZWlnaHQgPSBwYXJzZUludChhY3Rpb25Ecm9wZG93bk1lbnUub3V0ZXJIZWlnaHQoKSksDQogICAgICAgICAgICAgICAgZU9mZnNldFRvcCA9IGVPZmZzZXQudG9wLA0KICAgICAgICAgICAgICAgIHRhcmdldE91dGVySGVpZ2h0ID0gcGFyc2VJbnQoY3VyclRhcmdldC5vdXRlckhlaWdodCgpKTsNCiAgICAgICAgICAgIGFjdGlvbkRyb3Bkb3duTWVudS5jc3Moew0KICAgICAgICAgICAgICAgICdkaXNwbGF5JzogJ2Jsb2NrJywNCiAgICAgICAgICAgICAgICAndG9wJzogc2V0RHJvcGRvd25Qb3NpdGlvblRvcChjdXJyVGFyZ2V0LGRyb3Bkb3duSGVpZ2h0LHRhcmdldE91dGVySGVpZ2h0LCBlT2Zmc2V0VG9wKT8gZU9mZnNldFRvcCAtIGRyb3Bkb3duSGVpZ2h0IDogZU9mZnNldFRvcCArIHRhcmdldE91dGVySGVpZ2h0LA0KICAgICAgICAgICAgICAgICdyaWdodCc6IHJ0T2Zmc2V0DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSk7DQoNCiAgICAgICAgJChjb250YWluZXIpLm9uKCdoaWRkZW4uYnMuZHJvcGRvd24nLGRyb3Bkb3duQ2xzLCBmdW5jdGlvbiAoZSkgew0KICAgICAgICAgICAgJChlLmN1cnJlbnRUYXJnZXQpLmFwcGVuZChhY3Rpb25Ecm9wZG93bk1lbnUuZGV0YWNoKCkpOw0KICAgICAgICAgICAgYWN0aW9uRHJvcGRvd25NZW51LmhpZGUoKTsNCiAgICAgICAgfSk7DQoNCiAgICAgICAgdmFyIHNldERyb3Bkb3duUG9zaXRpb25Ub3AgPSBmdW5jdGlvbiAodGFyZ2V0LCBkcm9wZG93bkhlaWdodCwgdGFyZ2V0T3V0ZXJIZWlnaHQsIHRvcE9mZnNldCkgew0KICAgICAgICAgICAgdmFyIHNjcmVlbkhlaWdodCA9ICQod2luZG93KS5oZWlnaHQoKSwNCiAgICAgICAgICAgICAgICBjdXJyZW50VGFyZ2V0SGVpZ2h0ID0gdGFyZ2V0T3V0ZXJIZWlnaHQrIGRyb3Bkb3duSGVpZ2h0LA0KICAgICAgICAgICAgICAgIHRvdGFsSGVpZ2h0ID0gcGFyc2VJbnQoY3VycmVudFRhcmdldEhlaWdodCArIHRvcE9mZnNldCk7DQogICAgICAgICAgICByZXR1cm4gKHNjcmVlbkhlaWdodCA8IHRvdGFsSGVpZ2h0KTsNCiAgICAgICAgfQ0KICAgIH07DQoNCiAgICB2YXIgaHRtbE92ZXJmbG93WUhpZGRlbiA9IGZ1bmN0aW9uKCl7DQogICAgICAgIGlmICghaGFzTXVsdGlwbGVMaXN0KSB7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaHRtbCcpWzBdLmNsYXNzTGlzdC5hZGQoJ292ZXJmbG93LXktaGlkZGVuJyk7IC8vICcwJyB0byBhc3NpZ24gdGhlIGZpcnN0IChhbmQgb25seSBgSFRNTGAgdGFnKQ0KICAgICAgICB9DQogICAgfTsNCg0KICAgIHZhciBncmlkV2lkZ2V0VGFibGVIZWlnaHQgPSBmdW5jdGlvbiAoY29udGFpbmVyKSB7DQogICAgICAgIHJldHVybiBjb250YWluZXIuZmluZCgiLmRhdGFUYWJsZXNfc2Nyb2xsQm9keSB0YWJsZSIpLm91dGVySGVpZ2h0KCk7DQogICAgfTsNCg0KICAgIHZhciB1cGRhdGVGaXhlZENvbEhlaWdodCA9IGZ1bmN0aW9uIChjb250YWluZXIpIHsNCiAgICAgICAgdmFyIGRhdGFTY3JvbGxhYmxlQm9keSA9IGNvbnRhaW5lci5maW5kKCJkaXYuZGF0YVRhYmxlc19zY3JvbGxCb2R5IiksDQogICAgICAgICAgICBkYXRhU2Nyb2xsRml4ZWRDb2wgPSBjb250YWluZXIuZmluZCgiZGl2LkRURkNfTGVmdEJvZHlXcmFwcGVyLCBkaXYuRFRGQ19MZWZ0Qm9keUxpbmVyIik7DQogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgJChkYXRhU2Nyb2xsRml4ZWRDb2wpLmhlaWdodChnZXRHcmlkSGVpZ2h0KGNvbnRhaW5lcikpOw0KICAgICAgICB9LCAxMCk7DQogICAgICAgIHB2dWkuZ3JpZC5tYW5hZ2VVSVdyYXBwZXIudXBkYXRlUGVyZmVjdFNjcm9sbGJhcihjb250YWluZXIpOw0KICAgIH07DQoNCiAgICB2YXIgZ2V0R3JpZEhlaWdodCA9IGZ1bmN0aW9uIChjb250YWluZXIpIHsNCiAgICAgICAgaWYgKCFoYXNNdWx0aXBsZUxpc3QpIHsNCiAgICAgICAgICAgIHZhciBjb250YWluZXJUb3BTZWFyY2ggPSBjb250YWluZXIuZmluZCgiLnB2LXRvcHNyYy1jb250YWluZXIiKSwNCiAgICAgICAgICAgICAgICBpc1RvcFNyY1Zpc2libGUgPSBjb250YWluZXJUb3BTZWFyY2guaXMoIjp2aXNpYmxlIiksDQogICAgICAgICAgICAgICAgY29udGFpbmVyVG9wU2VhcmNoSGVpZ2h0ID0gJChjb250YWluZXJUb3BTZWFyY2gpLm91dGVySGVpZ2h0KCksDQogICAgICAgICAgICAgICAgcGFnZUNvbnRhaW5lckhlaWdodCA9ICQod2luZG93KS5oZWlnaHQoKS0yNjU7IC8vIDI2NSBpcyBoZWlnaHQgb2YgdG9waGVhZGVyICsgYm90dG9tIGZpeGVkIHNlY3Rpb24NCiAgICAgICAgICAgIHJldHVybiBpc1RvcFNyY1Zpc2libGU/IHBhZ2VDb250YWluZXJIZWlnaHQtY29udGFpbmVyVG9wU2VhcmNoSGVpZ2h0OiBwYWdlQ29udGFpbmVySGVpZ2h0Ow0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgcmV0dXJuIGdyaWRXaWRnZXRUYWJsZUhlaWdodChjb250YWluZXIpOy8vIEZpeGVkIFdpZGdldCBIZWlnaHQNCiAgICAgICAgfQ0KICAgIH07DQoNCiAgICB2YXIgc2V0R3JpZEhlaWdodCA9IGZ1bmN0aW9uIChjb250YWluZXIpIHsNCiAgICAgICAgaWYgKCFoYXNNdWx0aXBsZUxpc3QpIHsNCiAgICAgICAgICAgIHZhciBkYXRhU2Nyb2xsYWJsZUJvZHkgPSBjb250YWluZXIuZmluZCgiZGl2LmRhdGFUYWJsZXNfc2Nyb2xsQm9keSIpOw0KICAgICAgICAgICAgJChkYXRhU2Nyb2xsYWJsZUJvZHkpLmNzcyh7ImhlaWdodCI6Z2V0R3JpZEhlaWdodChjb250YWluZXIpLCAibWF4LWhlaWdodCI6Z2V0R3JpZEhlaWdodChjb250YWluZXIpfSk7DQogICAgICAgIH0NCiAgICAgICAgdXBkYXRlRml4ZWRDb2xIZWlnaHQoY29udGFpbmVyKTsvLyBGaXhlZCBXaWRnZXQgSGVpZ2h0DQogICAgfTsNCg0KICAgIHZhciB1cGRhdGVHcmlkT25SZXNpemUgPSBmdW5jdGlvbiAoY29udGFpbmVyKSB7DQogICAgICAgICQod2luZG93KS5yZXNpemUoZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgc2V0R3JpZEhlaWdodChjb250YWluZXIpOw0KICAgICAgICB9KTsNCiAgICB9Ow0KDQogICAgdmFyIG1hbmFnZUxpc3RpbmdVSSA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgdmFyIGhpZGVTZXR0aW5nUGFuZWwgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB3cmFwcGVyQ29udGFpbmVyLnJlbW92ZUNsYXNzKCdyaWdodC1iYXItZW5hYmxlZCcpOw0KICAgICAgICAgICAgJCgiLnJpZ2h0cGFuZWwtYmFja2Ryb3AiKS5yZW1vdmUoKTsNCiAgICAgICAgfTsNCiAgICAgICAgdmFyIHNob3dTZXR0aW5nUGFuZWwgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB3cmFwcGVyQ29udGFpbmVyLmFkZENsYXNzKCdyaWdodC1iYXItZW5hYmxlZCcpOw0KICAgICAgICB9Ow0KICAgICAgICByZXR1cm57DQogICAgICAgICAgICBoaWRlU2V0dGluZ1BhbmVsOmhpZGVTZXR0aW5nUGFuZWwsDQogICAgICAgICAgICBzaG93U2V0dGluZ1BhbmVsOiBzaG93U2V0dGluZ1BhbmVsDQogICAgICAgIH0NCiAgICB9KCk7DQogICAgcmV0dXJuew0KICAgICAgICBhcHBlbmREcm9wZG93bk91dHNpZGVDb250YWluZXI6YXBwZW5kRHJvcGRvd25PdXRzaWRlQ29udGFpbmVyLA0KICAgICAgICBodG1sT3ZlcmZsb3dZSGlkZGVuOmh0bWxPdmVyZmxvd1lIaWRkZW4sDQogICAgICAgIGdldEdyaWRIZWlnaHQ6Z2V0R3JpZEhlaWdodCwNCiAgICAgICAgc2V0R3JpZEhlaWdodDpzZXRHcmlkSGVpZ2h0LA0KICAgICAgICB1cGRhdGVHcmlkT25SZXNpemU6dXBkYXRlR3JpZE9uUmVzaXplLA0KICAgICAgICBtYW5hZ2VMaXN0aW5nVUk6bWFuYWdlTGlzdGluZ1VJDQogICAgfQ0KfSgpOwp2YXIgcHZ1aSA9IHB2dWkgfHwge307DQpwdnVpLmdyaWQgPSBwdnVpLmdyaWQgfHwge307DQp2YXIgaXRlbURyYWdnZWQgPSBmYWxzZTsNCnB2dWkuZ3JpZC5tYW5hZ2VVSVdyYXBwZXIgPSBmdW5jdGlvbiAoKSB7DQogICAgdmFyIHBzR3JpZDsNCiAgICB2YXIgcHJldmVudFNjcm9sbGluZ0VtcHR5R3JpZCA9IGZ1bmN0aW9uIChjb250YWluZXIsIHNjcm9sbGFibGVTZWN0aW9uKSB7DQogICAgICAgIGlmKGNvbnRhaW5lci5maW5kKCIuZGF0YVRhYmxlc19lbXB0eSIpLmxlbmd0aCl7DQogICAgICAgICAgICBzY3JvbGxhYmxlU2VjdGlvbi5jc3MoeyJvdmVyZmxvdy15IjoiaGlkZGVuIn0pOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgc2Nyb2xsYWJsZVNlY3Rpb24uY3NzKHsib3ZlcmZsb3cteSI6ImF1dG8ifSk7DQogICAgICAgIH0NCiAgICB9LA0KICAgIGRpc2FibGVUYWJsZVNjcm9sbGluZyA9IGZ1bmN0aW9uIChzY3JvbGxhYmxlU2VjdGlvbiwgc2Nyb2xsYWJsZUZpeGVkQ29sKSB7DQogICAgICAgIHNjcm9sbGFibGVTZWN0aW9uLmNzcyh7Im92ZXJmbG93IjoiaGlkZGVuIn0pOw0KICAgICAgICBzY3JvbGxhYmxlRml4ZWRDb2wuY3NzKHsib3ZlcmZsb3cteSI6ImhpZGRlbiJ9KTsNCiAgICB9LA0KICAgIGVuYWJsZVRhYmxlU2Nyb2xsaW5nID0gZnVuY3Rpb24gKHNjcm9sbGFibGVTZWN0aW9uLCBzY3JvbGxhYmxlRml4ZWRDb2wpIHsNCiAgICAgICAgc2Nyb2xsYWJsZVNlY3Rpb24uY3NzKHsib3ZlcmZsb3ciOiJhdXRvIn0pOw0KICAgICAgICBzY3JvbGxhYmxlRml4ZWRDb2wuY3NzKHsib3ZlcmZsb3cteSI6InNjcm9sbCJ9KTsNCiAgICB9LA0KICAgIGlzU2Vjb25kYXJ5VmlldyA9IGZ1bmN0aW9uIChjb250YWluZXIsIGdyaWRSb3cpIHsNCiAgICAgICAgdmFyIGlkeCA9ICQoZ3JpZFJvdykuaW5kZXgoKTsNCiAgICAgICAgcmV0dXJuIGNvbnRhaW5lci5maW5kKCIuZGF0YVRhYmxlc19zY3JvbGxCb2R5PnRhYmxlPnRib2R5PnRyOm50aC1jaGlsZCgiK2lkeCsiKSIpLmhhc0NsYXNzKCJkZXRhaWxzIik7DQogICAgfSwNCiAgICBhbGxUYXJnZXRlZFJvd3MgPSBmdW5jdGlvbiAoY29udGFpbmVyLCBncmlkUm93KSB7DQogICAgICAgIHZhciBpZHggPSAkKGdyaWRSb3cpLmluZGV4KCkgKyAxLA0KICAgICAgICAgICAgYWxsUm93cywNCiAgICAgICAgICAgIHRhYmxlU2Nyb2xsQm9keSA9ICIuZGF0YVRhYmxlc19zY3JvbGxCb2R5PnRhYmxlPnRib2R5IiwNCiAgICAgICAgICAgIHRhYmxlRml4ZWRMZWZ0ID0gIi5EVEZDX0xlZnRCb2R5TGluZXI+dGFibGU+dGJvZHkiLA0KICAgICAgICAgICAgaGFzU2Vjb25kYXJ5QW5kVmlzaWJsZSA9IGNvbnRhaW5lci5maW5kKHRhYmxlU2Nyb2xsQm9keSsiPnRyOm50aC1jaGlsZCgiK2lkeCsiKSIpLmhhc0NsYXNzKCJkZXRhaWxzIiksDQogICAgICAgICAgICBpc1RoaXNTZWNvbmRhcnlWaWV3ID0gaXNTZWNvbmRhcnlWaWV3KGNvbnRhaW5lciwgZ3JpZFJvdyk7DQogICAgICAgIGlmKGlzVGhpc1NlY29uZGFyeVZpZXcpIHsNCiAgICAgICAgICAgIHZhciBpZHhQcmltYXJ5PSAkKGdyaWRSb3cpLmluZGV4KCk7DQogICAgICAgICAgICBhbGxSb3dzID0gdGFibGVTY3JvbGxCb2R5KyI+dHI6bnRoLWNoaWxkKCIraWR4KyIpLCIrDQogICAgICAgICAgICAgICAgdGFibGVGaXhlZExlZnQrIj50cjpudGgtY2hpbGQoIitpZHggKyAiKSwiKw0KICAgICAgICAgICAgICAgIHRhYmxlU2Nyb2xsQm9keSsiPnRyOm50aC1jaGlsZCgiK2lkeFByaW1hcnkgKyIpLCIrDQogICAgICAgICAgICAgICAgdGFibGVGaXhlZExlZnQrIj50cjpudGgtY2hpbGQoIitpZHhQcmltYXJ5KyIpIjsNCiAgICAgICAgICAgIHJldHVybiBhbGxSb3dzOw0KICAgICAgICB9ICBlbHNlIGlmKGhhc1NlY29uZGFyeUFuZFZpc2libGUpIHsNCiAgICAgICAgICAgIHZhciBpZHhTZWNvbmRhcnk9ICQoZ3JpZFJvdykuaW5kZXgoKSsyOw0KICAgICAgICAgICAgYWxsUm93cyA9IHRhYmxlU2Nyb2xsQm9keSsiPnRyOm50aC1jaGlsZCgiK2lkeCsiKSwiKw0KICAgICAgICAgICAgICAgIHRhYmxlRml4ZWRMZWZ0KyI+dHI6bnRoLWNoaWxkKCIraWR4ICsgIiksIisNCiAgICAgICAgICAgICAgICB0YWJsZVNjcm9sbEJvZHkrIj50cjpudGgtY2hpbGQoIitpZHhTZWNvbmRhcnkrIiksIisNCiAgICAgICAgICAgICAgICB0YWJsZUZpeGVkTGVmdCsiPnRyOm50aC1jaGlsZCgiK2lkeFNlY29uZGFyeSsiKSI7DQogICAgICAgICAgICByZXR1cm4gYWxsUm93czsNCiAgICAgICAgfSBlbHNlew0KICAgICAgICAgICAgYWxsUm93cz0gdGFibGVTY3JvbGxCb2R5KyI+dHI6bnRoLWNoaWxkKCIraWR4KyIpLCIrDQogICAgICAgICAgICAgICAgdGFibGVGaXhlZExlZnQrIj50cjpudGgtY2hpbGQoIitpZHggKyAiKSI7DQogICAgICAgICAgICByZXR1cm4gYWxsUm93czsNCiAgICAgICAgfQ0KICAgIH0sDQogICAgY2hlY2tSb3dBbmRDZWxsID0gZnVuY3Rpb24gKGNvbnRhaW5lciwgZ3JpZFJvdykgew0KICAgICAgICB2YXIgaWR4ID0gJChncmlkUm93KS5pbmRleCgpICsgMSwNCiAgICAgICAgICAgIGN1cnJBY3Rpb25CdG5Sb3cgPSBjb250YWluZXIuZmluZCgiLmRhdGFUYWJsZXNfc2Nyb2xsQm9keT50YWJsZT50Ym9keT50cjpudGgtY2hpbGQoIisgaWR4ICsiKSIpLA0KICAgICAgICAgICAgYWN0aW9uQ29sID0gY3VyckFjdGlvbkJ0blJvdy5maW5kKCIucHYtdGFibGUtYWN0aW9uIiksDQogICAgICAgICAgICBhY3Rpb25DZWxsID0gY3VyckFjdGlvbkJ0blJvdy5maW5kKCIucHYtdGFibGUtYWN0aW9uPi50ZC1ib3giKSwNCiAgICAgICAgICAgIGFsbEZpeGVkQ3VyclJvdyA9IGFsbFRhcmdldGVkUm93cyhjb250YWluZXIsIGdyaWRSb3cpLA0KICAgICAgICAgICAgY3VyclJvdyA9IGNvbnRhaW5lci5maW5kKGFsbEZpeGVkQ3VyclJvdyk7DQogICAgICAgIHJldHVybiB7cm93OmN1cnJSb3csY2VsbDphY3Rpb25DZWxsLGNvbDphY3Rpb25Db2x9Ow0KICAgIH0sDQogICAgc2V0R3JpZEFjdGlvbkJ1dHRvblBvc2l0aW9uID0gZnVuY3Rpb24gKHJvdykgew0KICAgICAgICB2YXIgY3VyclBhcmVudENvbnRhaW5lciA9ICQocm93KS5jbG9zZXN0KCIuRFRGQ19TY3JvbGxXcmFwcGVyIikuZmluZCgiLmRhdGFUYWJsZXNfc2Nyb2xsQm9keSIpLA0KICAgICAgICAgICAgZ3JpZENvbnRhaW5lcldpZHRoID0gY3VyclBhcmVudENvbnRhaW5lci5vdXRlcldpZHRoKCksDQogICAgICAgICAgICBncmlkU2Nyb2xsZWQgPSBjdXJyUGFyZW50Q29udGFpbmVyLnNjcm9sbExlZnQoKSwNCiAgICAgICAgICAgIGxlZnRPZmZzZXQgPSBncmlkQ29udGFpbmVyV2lkdGgrZ3JpZFNjcm9sbGVkOw0KICAgICAgICByZXR1cm4gbGVmdE9mZnNldDsNCiAgICB9LA0KICAgIGhhbmRsZVJvd01vdXNlT3ZlckV2ZW50ID0gZnVuY3Rpb24gKGNvbnRhaW5lcikgew0KICAgICAgICB2YXIgZ3JpZFJvdyA9ICIuZGF0YVRhYmxlc19zY3JvbGxCb2R5PnRhYmxlPnRib2R5PnRyLCAuRFRGQ19MZWZ0Qm9keUxpbmVyPnRhYmxlPnRib2R5PnRyIiwNCiAgICAgICAgICAgIGNvbnRhaW5lckdyaWQgPSBjb250YWluZXIuZmluZCgiLmRhdGFUYWJsZXNfc2Nyb2xsQm9keSIpLA0KICAgICAgICAgICAgY29udGFpbmVyU2l6ZSA9IGNvbnRhaW5lckdyaWQub3V0ZXJXaWR0aCgpLA0KICAgICAgICAgICAgY29udGFpbmVyU2Nyb2xsYWJsZVdpZHRoID0gY29udGFpbmVyR3JpZC5nZXQoMCkuc2Nyb2xsV2lkdGgsDQogICAgICAgICAgICBjbG9uZWRDVEE7DQogICAgICAgIGNvbnRhaW5lci5vZmYoIm1vdXNlZW50ZXIgbW91c2VsZWF2ZSIpLm9uKCJtb3VzZWVudGVyIiwgZ3JpZFJvdywgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdmFyIHRhcmdldCA9IGNoZWNrUm93QW5kQ2VsbChjb250YWluZXIsICQodGhpcykpOw0KICAgICAgICAgICAgaWYoY29udGFpbmVyU2l6ZSA8IGNvbnRhaW5lclNjcm9sbGFibGVXaWR0aCl7DQogICAgICAgICAgICAgICAgdmFyIHBvc2l0aW9uQ1RBID0gc2V0R3JpZEFjdGlvbkJ1dHRvblBvc2l0aW9uKCQodGhpcykpIC0gdGFyZ2V0LmNlbGwub3V0ZXJXaWR0aCgpOw0KICAgICAgICAgICAgICAgIGNsb25lZENUQSA9IHRhcmdldC5jZWxsLmRldGFjaCgpOw0KICAgICAgICAgICAgICAgIGNsb25lZENUQS5hZGRDbGFzcygicHYtbGlzdC1hY3Rpb24tY3RhIikuY3NzKHtsZWZ0OnBvc2l0aW9uQ1RBKyJweCJ9KTsNCiAgICAgICAgICAgICAgICB0YXJnZXQuY29sLmFmdGVyKGNsb25lZENUQSk7DQogICAgICAgICAgICAgICAgdGFyZ2V0LnJvdy5hZGRDbGFzcygiY3Vyci1yZWNvcmQiKTsNCiAgICAgICAgICAgIH0gZWxzZXsNCiAgICAgICAgICAgICAgICB0YXJnZXQucm93LmFkZENsYXNzKCJjdXJyLXJlY29yZCIpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KS5vbigibW91c2VsZWF2ZSIsIGdyaWRSb3csIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciB0YXJnZXQgPSBjaGVja1Jvd0FuZENlbGwoY29udGFpbmVyLCAkKHRoaXMpKTsNCiAgICAgICAgICAgIGlmKGNvbnRhaW5lclNpemUgPCBjb250YWluZXJTY3JvbGxhYmxlV2lkdGgpew0KICAgICAgICAgICAgICAgIGNsb25lZENUQS5yZW1vdmVDbGFzcygicHYtbGlzdC1hY3Rpb24tY3RhIik7DQogICAgICAgICAgICAgICAgY2xvbmVkQ1RBLmF0dHIoInN0eWxlIiwgIiIpOw0KICAgICAgICAgICAgICAgIHRhcmdldC5jb2wuYXBwZW5kKGNsb25lZENUQSk7DQogICAgICAgICAgICAgICAgdGFyZ2V0LnJvdy5yZW1vdmVDbGFzcygiY3Vyci1yZWNvcmQiKTsNCiAgICAgICAgICAgIH0gZWxzZXsNCiAgICAgICAgICAgICAgICB0YXJnZXQucm93LnJlbW92ZUNsYXNzKCJjdXJyLXJlY29yZCIpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9LA0KICAgIGhhbmRsZURyYWdEcm9wRXZlbnQgPSBmdW5jdGlvbiAoY29udGFpbmVyKSB7DQogICAgICAgIGl0ZW1EcmFnZ2VkID0gZmFsc2U7DQogICAgICAgIGNvbnRhaW5lci5maW5kKCIudWktc29ydGFibGUiKS5zb3J0YWJsZSh7DQogICAgICAgICAgICB1cGRhdGU6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICBpdGVtRHJhZ2dlZCA9IHRydWU7DQogICAgICAgICAgICAgICAgcHNHcmlkLnVwZGF0ZSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9LA0KICAgIGhhbmRsZUdyaWRIb3Jpem9udGFsU2Nyb2xsID0gZnVuY3Rpb24gKGNvbnRhaW5lcikgew0KICAgICAgICAgICAgY29udGFpbmVyLmZpbmQoIi5kYXRhVGFibGVzX3Njcm9sbEJvZHkiKS5vbigic2Nyb2xsLCB0b3VjaG1vdmUiLGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICB2YXIgdGhhdCA9ICQodGhpcyk7DQogICAgICAgICAgICAgICAgdmFyIGlzR3JpZFNjcm9sbGFibGUgPSB0aGF0Lm91dGVyV2lkdGgoKSA8IHRoYXQuZ2V0KDApLnNjcm9sbFdpZHRoOw0KICAgICAgICAgICAgICAgIHZhciBzZWNvZGFyeVZpZXdSb3cgPSB0aGF0LmZpbmQoIi5mb290YWJsZS1yb3ctZGV0YWlsLWlubmVyIik7DQogICAgICAgICAgICAgICAgdmFyIHNjcm9sbGVkTGVmdCA9IHRoYXQuZ2V0KDApLnNjcm9sbExlZnQ7DQogICAgICAgICAgICAgICAgaWYoaXNHcmlkU2Nyb2xsYWJsZSAmJiBzY3JvbGxlZExlZnQgPiAwKXsNCiAgICAgICAgICAgICAgICAgICAgc2Vjb2RhcnlWaWV3Um93LmNzcygibWFyZ2luLWxlZnQiLHNjcm9sbGVkTGVmdCsicHgiKTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGN0YSA9IGNvbnRhaW5lci5maW5kKCIuZGF0YVRhYmxlc19zY3JvbGxCb2R5IC5wdi1saXN0LWFjdGlvbi1jdGEiKTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGN0YUNsb3NlVEQgPSBjdGEucHJldigpOw0KICAgICAgICAgICAgICAgICAgICBjdGEuZGV0YWNoKCkucmVtb3ZlQ2xhc3MoInB2LWxpc3QtYWN0aW9uLWN0YSIpLmFwcGVuZFRvKGN0YUNsb3NlVEQpOw0KICAgICAgICAgICAgICAgIH0gZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgc2Vjb2RhcnlWaWV3Um93LmNzcygibWFyZ2luLWxlZnQiLCIwcHgiKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSwNCiAgICBiaW5kSWNvbkhvdmVyRXZlbnRzID0gZnVuY3Rpb24gKGNvbnRhaW5lcikgew0KICAgICAgICBjb250YWluZXIuZmluZCgiLnJlcG9ydFN0YXRlTWVzc2FnZSIpLndlYnVpUG9wb3Zlcih7DQogICAgICAgICAgICB0cmlnZ2VyOiJob3ZlciIsDQogICAgICAgICAgICB3aWR0aDo0MDAsDQogICAgICAgICAgICBjb250ZW50OiQodGhpcykuZGF0YSgiY29udGVudCIpDQogICAgICAgIH0pOw0KICAgIH0sDQogICAgc2V0UGVyZmVjdFNjcm9sbGJhciA9IGZ1bmN0aW9uIChjb250YWluZXIpIHsNCiAgICAgICAgcHNHcmlkID0gbmV3IFBlcmZlY3RTY3JvbGxiYXIoY29udGFpbmVyLmZpbmQoJy5kYXRhVGFibGVzX3Njcm9sbEJvZHknKVswXSk7DQogICAgICAgIHZhciBwc1NldHRpbmdQYW5lbCA9IG5ldyBQZXJmZWN0U2Nyb2xsYmFyKCIuc2lkZS1iYXIucmlnaHQtYmFyIik7DQogICAgfSwNCiAgICB1cGRhdGVQZXJmZWN0U2Nyb2xsYmFyID0gZnVuY3Rpb24gKGNvbnRhaW5lcikgew0KICAgICAgICB2YXIgc2Nyb2xsQ29udGFpbmVyID0gY29udGFpbmVyLmZpbmQoJy5kYXRhVGFibGVzX3Njcm9sbEJvZHknKVswXTsNCiAgICAgICAgaWYocHNHcmlkKXsNCiAgICAgICAgICAgIHBzR3JpZC51cGRhdGUoKTsNCiAgICAgICAgfQ0KICAgICAgICAkKHNjcm9sbENvbnRhaW5lcikuc2Nyb2xsKCk7DQogICAgfSwNCiAgICBzZXRNb3JlT3B0aW9uID0gZnVuY3Rpb24gKGNvbnRhaW5lcikgew0KICAgICAgICBjb250YWluZXIuZmluZCgnLnB2anNfb3V0ZXItbW9yZS1ib3gnKS5lYWNoKCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAvLyBjb25zb2xlLmxvZygkKHRoaXMpKTsNCiAgICAgICAgICAgIHZhciBlbGUgPSAkKHRoaXMpDQogICAgICAgICAgICB2YXIgaW5uZXJDb250YWluZXIgPSBlbGUuZmluZCgiLnB2anNfaW5uZXItbW9yZS1ib3giKTsNCiAgICAgICAgICAgIHZhciBtb3JlRGF0YSA9IGVsZS5hdHRyKCJkYXRhLW1vcmUiKTsNCiAgICAgICAgICAgIHZhciBkYXRhTmFtZSA9IGVsZS5hdHRyKCJkYXRhLW5hbWUiKTsNCiAgICAgICAgICAgIHZhciBtb3JlT3B0aW9uID0gJzxhIHR5cGU9ImxpbmsiIGNsYXNzPSJjbC1pYy1tb3JlIj48aSBjbGFzcz0iZmEgZmEtZWxsaXBzaXMtaCBtb3JlLW9wdGlvbiIgIGRhdGEtbW9yZWRhdGE9IicgKyBtb3JlRGF0YSArICciIGRhdGEtaXRlbT0iJyArIGRhdGFOYW1lICsgJyI+IDwvaT4gPC9hPic7DQogICAgICAgICAgICBpZihpbm5lckNvbnRhaW5lci5pbm5lckhlaWdodCgpID4gZWxlLmlubmVySGVpZ2h0KCkpew0KICAgICAgICAgICAgICAgIGlubmVyQ29udGFpbmVyLmFwcGVuZChtb3JlT3B0aW9uKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfSwNCiAgICBzY3JvbGxUb3BHcmlkID0gZnVuY3Rpb24gKGNvbnRhaW5lcikgew0KICAgICAgICB2YXIgc2Nyb2xsQ29udGFpbmVyID0gY29udGFpbmVyLmZpbmQoJy5kYXRhVGFibGVzX3Njcm9sbEJvZHknKTsNCiAgICAgICAgc2Nyb2xsQ29udGFpbmVyLnNjcm9sbFRvcCgwKTsNCiAgICB9LA0KICAgIGluaXRpYWxpemVQb3BvdmVyID0gZnVuY3Rpb24gKGNvbnRhaW5lcikgew0KICAgICAgICBfLmVhY2goY29udGFpbmVyLmZpbmQoJy5tb3JlLW9wdGlvbicpLCBmdW5jdGlvbiAoZWxlKSB7DQogICAgICAgICAgICB2YXIgbW9yZURhdGEgPSBwdmkudXRpbC5yZW1vdmVIVE1MVGFncygkKGVsZSkuZGF0YSgnbW9yZWRhdGEnKSk7DQogICAgICAgICAgICAkKGVsZSkud2VidWlQb3BvdmVyKHsNCiAgICAgICAgICAgICAgICBodG1sOiB0cnVlLA0KICAgICAgICAgICAgICAgIHRyaWdnZXI6ICdob3ZlcicsDQogICAgICAgICAgICAgICAgY29udGVudDogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICBpZihfLmlzRW1wdHkobW9yZURhdGEpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBtb3JlRGF0YSA9ICIiOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHZhciB0aGVEYXRhID0gXy5maWx0ZXIobW9yZURhdGEuc3BsaXQoJywnKSwgZnVuY3Rpb24gKGl0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIV8uaXNFbXB0eShpdC50cmltKCkpOw0KICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHYgPSAiIjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHRoZURhdGFMZW5ndGggPSB0aGVEYXRhLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGVEYXRhTGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGVEYXRhW2ldKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHYgPSB2ICsgIjxhPiIgKyB0aGVEYXRhW2ldICsgIjwvYT4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPCB0aGVEYXRhTGVuZ3RoIC0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHYgPSB2ICsgIiw8YnI+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSk7DQogICAgfSwNCiAgICBzZXRNb3JlRGF0YU9wdGlvbiA9IGZ1bmN0aW9uIChjb250YWluZXJJZCkgew0KICAgICAgICBfLmVhY2goJCgiIyIrY29udGFpbmVySWQpLmZpbmQoIi5wdmpzX291dGVyLW1vcmUtYm94IiksIGZ1bmN0aW9uIChlbGUpIHsNCiAgICAgICAgICAgIHZhciBpbm5lckNvbnRhaW5lciA9ICQoZWxlKS5maW5kKCIucHZqc19pbm5lci1tb3JlLWJveCIpOw0KICAgICAgICAgICAgdmFyIG1vcmVEYXRhID0gaW5uZXJDb250YWluZXIuaHRtbCgpOw0KICAgICAgICAgICAgdmFyIG1vcmVPcHRpb24gPSAnPGEgdHlwZT0ibGluayIgY2xhc3M9ImNsLWljLW1vcmUiIHRpdGxlPSJTZWUgQWxsIj48aSBjbGFzcz0iZmEgZmEtZWxsaXBzaXMtaCBtb3JlLW9wdGlvbiI+IDwvaT48c3BhbiBjbGFzcz0iaGlkZSI+Jyttb3JlRGF0YSsnPC9zcGFuPiA8L2E+JzsNCiAgICAgICAgICAgIGlmKGlubmVyQ29udGFpbmVyLmlubmVySGVpZ2h0KCkgPiAkKGVsZSkuaW5uZXJIZWlnaHQoKSl7DQogICAgICAgICAgICAgICAgaW5uZXJDb250YWluZXIuYXBwZW5kKG1vcmVPcHRpb24pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9LA0KDQogICAgYmluZE1vcmVDb250ZW50UG9wb3ZlciA9IGZ1bmN0aW9uIChjb250YWluZXJJZCkgew0KICAgICAgICBfLmVhY2goJCgiIyIrY29udGFpbmVySWQpLmZpbmQoJy5tb3JlLW9wdGlvbicpLCBmdW5jdGlvbiAoZWxlKSB7DQogICAgICAgICAgICAkKGVsZSkud2VidWlQb3BvdmVyKCdkZXN0cm95Jykud2VidWlQb3BvdmVyKHsNCiAgICAgICAgICAgICAgICB0cmlnZ2VyOiAnaG92ZXInLA0KICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICQoZWxlKS5uZXh0KCdzcGFuJykuaHRtbCgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9KTsNCiAgICB9LA0KICAgIGNsb3NlU2V0dGluZ1BhbmVsID0gZnVuY3Rpb24gKGNhbGxiYWNrLCB0YXJnZXQpIHsNCiAgICAgICAgdmFyIGNoZWNrQW5kSGlkZSA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIGlmIChpdGVtRHJhZ2dlZCkgew0KICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7DQogICAgICAgICAgICB9IGVsc2V7DQogICAgICAgICAgICAgICAgcHZ1aS5ncmlkLnV0aWxzLm1hbmFnZUxpc3RpbmdVSS5oaWRlU2V0dGluZ1BhbmVsKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH07DQogICAgICAgIGlmKHRhcmdldCkgew0KICAgICAgICAgICAgdGFyZ2V0LmNsaWNrKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICBjaGVja0FuZEhpZGUoKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJChkb2N1bWVudCkub24oImNsaWNrIiwgIi5yaWdodHBhbmVsLWJhY2tkcm9wIiwgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgIGNoZWNrQW5kSGlkZSgpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCg0KICAgIH0sDQogICAgdG9nZ2xlR3JpZEZpbHRlciA9IGZ1bmN0aW9uIChjb250YWluZXIsb3B0aW9ucykgew0KICAgICAgICBpZihjb250YWluZXIuZmluZCgnLmxpc3QtZmlsdGVyJykuaXMoJzp2aXNpYmxlJykpIHsNCiAgICAgICAgICAgIGNvbnRhaW5lci5maW5kKCcubGlzdC1maWx0ZXInKS5oaWRlKCk7DQogICAgICAgICAgICBjb250YWluZXIuZmluZCgnLmZpbHRlci1oZWFkJykuZmluZCgnLnNlbGVjdDItY29udGFpbmVyJykuaGlkZSgpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgY29udGFpbmVyLmZpbmQoJy5saXN0LWZpbHRlcicpLnNob3coKTsNCiAgICAgICAgICAgIGNvbnRhaW5lci5maW5kKCcuc2VsZWN0Mi1jb250YWluZXInKS5zaG93KCk7DQogICAgICAgICAgICBjb250YWluZXIuZmluZCgnLmRhdGUtdGltZS1maWx0ZXInKS5hdHRyKCJwbGFjZWhvbGRlciIsIG9wdGlvbnM/b3B0aW9ucy5kYXRlRm9ybWF0OicnKTsNCiAgICAgICAgfQ0KICAgIH07DQoNCiAgICByZXR1cm4gew0KICAgICAgICBwcmV2ZW50U2Nyb2xsaW5nRW1wdHlHcmlkOnByZXZlbnRTY3JvbGxpbmdFbXB0eUdyaWQsDQogICAgICAgIGRpc2FibGVUYWJsZVNjcm9sbGluZzogZGlzYWJsZVRhYmxlU2Nyb2xsaW5nLA0KICAgICAgICBlbmFibGVUYWJsZVNjcm9sbGluZzogZW5hYmxlVGFibGVTY3JvbGxpbmcsDQogICAgICAgIGhhbmRsZVJvd01vdXNlT3ZlckV2ZW50OiBoYW5kbGVSb3dNb3VzZU92ZXJFdmVudCwNCiAgICAgICAgaGFuZGxlR3JpZEhvcml6b250YWxTY3JvbGw6IGhhbmRsZUdyaWRIb3Jpem9udGFsU2Nyb2xsLA0KICAgICAgICBiaW5kSWNvbkhvdmVyRXZlbnRzOiBiaW5kSWNvbkhvdmVyRXZlbnRzLA0KICAgICAgICBzZXRQZXJmZWN0U2Nyb2xsYmFyOnNldFBlcmZlY3RTY3JvbGxiYXIsDQogICAgICAgIHVwZGF0ZVBlcmZlY3RTY3JvbGxiYXI6dXBkYXRlUGVyZmVjdFNjcm9sbGJhciwNCiAgICAgICAgc2V0R3JpZEFjdGlvbkJ1dHRvblBvc2l0aW9uOiBzZXRHcmlkQWN0aW9uQnV0dG9uUG9zaXRpb24sDQogICAgICAgIHNldE1vcmVPcHRpb246IHNldE1vcmVPcHRpb24sDQogICAgICAgIGhhbmRsZURyYWdEcm9wRXZlbnQ6IGhhbmRsZURyYWdEcm9wRXZlbnQsDQogICAgICAgIHNjcm9sbFRvcEdyaWQ6c2Nyb2xsVG9wR3JpZCwNCiAgICAgICAgaW5pdGlhbGl6ZVBvcG92ZXI6IGluaXRpYWxpemVQb3BvdmVyLA0KICAgICAgICBzZXRNb3JlRGF0YU9wdGlvbjpzZXRNb3JlRGF0YU9wdGlvbiwNCiAgICAgICAgYmluZE1vcmVDb250ZW50UG9wb3ZlcjpiaW5kTW9yZUNvbnRlbnRQb3BvdmVyLA0KICAgICAgICBjbG9zZVNldHRpbmdQYW5lbDpjbG9zZVNldHRpbmdQYW5lbCwNCiAgICAgICAgdG9nZ2xlR3JpZEZpbHRlcjogdG9nZ2xlR3JpZEZpbHRlcg0KICAgIH0NCn0oKTsKLy89IHJlcXVpcmUgdmVuZG9yVWkvZGF0YXRhYmxlcy9qcXVlcnkuZGF0YVRhYmxlcy5taW4NCi8vPSByZXF1aXJlIHZlbmRvclVpL2RhdGF0YWJsZXMvZGF0YVRhYmxlcy5maXhlZENvbHVtbnMubWluDQovLz0gcmVxdWlyZSB2ZW5kb3JVaS9kYXRhdGFibGVzL2RhdGFUYWJsZXMuYm9vdHN0cmFwLm1pbg0KLy89IHJlcXVpcmUgdmVuZG9yVWkvZGF0YXRhYmxlcy9kYXRldGltZS1tb21lbnQNCi8vPSByZXF1aXJlIGNvbXBvbmVudC9ncmlkL3B2dWktZ3JpZA0KLy89IHJlcXVpcmVfc2VsZgovKiEgQ29sUmVvcmRlciAxLjMuMw0KICogwqkyMDEwLTIwMTUgU3ByeU1lZGlhIEx0ZCAtIGRhdGF0YWJsZXMubmV0L2xpY2Vuc2UNCiAqLw0KDQovKioNCiAqIEBzdW1tYXJ5ICAgICBDb2xSZW9yZGVyDQogKiBAZGVzY3JpcHRpb24gUHJvdmlkZSB0aGUgYWJpbGl0eSB0byByZW9yZGVyIGNvbHVtbnMgaW4gYSBEYXRhVGFibGUNCiAqIEB2ZXJzaW9uICAgICAxLjMuMw0KICogQGZpbGUgICAgICAgIGRhdGFUYWJsZXMuY29sUmVvcmRlci5qcw0KICogQGF1dGhvciAgICAgIFNwcnlNZWRpYSBMdGQgKHd3dy5zcHJ5bWVkaWEuY28udWspDQogKiBAY29udGFjdCAgICAgd3d3LnNwcnltZWRpYS5jby51ay9jb250YWN0DQogKiBAY29weXJpZ2h0ICAgQ29weXJpZ2h0IDIwMTAtMjAxNCBTcHJ5TWVkaWEgTHRkLg0KICoNCiAqIFRoaXMgc291cmNlIGZpbGUgaXMgZnJlZSBzb2Z0d2FyZSwgYXZhaWxhYmxlIHVuZGVyIHRoZSBmb2xsb3dpbmcgbGljZW5zZToNCiAqICAgTUlUIGxpY2Vuc2UgLSBodHRwOi8vZGF0YXRhYmxlcy5uZXQvbGljZW5zZS9taXQNCiAqDQogKiBUaGlzIHNvdXJjZSBmaWxlIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsIGJ1dA0KICogV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZiBNRVJDSEFOVEFCSUxJVFkNCiAqIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiBTZWUgdGhlIGxpY2Vuc2UgZmlsZXMgZm9yIGRldGFpbHMuDQogKg0KICogRm9yIGRldGFpbHMgcGxlYXNlIHJlZmVyIHRvOiBodHRwOi8vd3d3LmRhdGF0YWJsZXMubmV0DQogKi8NCihmdW5jdGlvbiggZmFjdG9yeSApew0KICAgIGlmICggdHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kICkgew0KICAgICAgICAvLyBBTUQNCiAgICAgICAgZGVmaW5lKCBbJ2pxdWVyeScsICdkYXRhdGFibGVzLm5ldCddLCBmdW5jdGlvbiAoICQgKSB7DQogICAgICAgICAgICByZXR1cm4gZmFjdG9yeSggJCwgd2luZG93LCBkb2N1bWVudCApOw0KICAgICAgICB9ICk7DQogICAgfQ0KICAgIGVsc2UgaWYgKCB0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgKSB7DQogICAgICAgIC8vIENvbW1vbkpTDQogICAgICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKHJvb3QsICQpIHsNCiAgICAgICAgICAgIGlmICggISByb290ICkgew0KICAgICAgICAgICAgICAgIHJvb3QgPSB3aW5kb3c7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggISAkIHx8ICEgJC5mbi5kYXRhVGFibGUgKSB7DQogICAgICAgICAgICAgICAgJCA9IHJlcXVpcmUoJ2RhdGF0YWJsZXMubmV0Jykocm9vdCwgJCkuJDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIGZhY3RvcnkoICQsIHJvb3QsIHJvb3QuZG9jdW1lbnQgKTsNCiAgICAgICAgfTsNCiAgICB9DQogICAgZWxzZSB7DQogICAgICAgIC8vIEJyb3dzZXINCiAgICAgICAgZmFjdG9yeSggalF1ZXJ5LCB3aW5kb3csIGRvY3VtZW50ICk7DQogICAgfQ0KfShmdW5jdGlvbiggJCwgd2luZG93LCBkb2N1bWVudCwgdW5kZWZpbmVkICkgew0KICAgICd1c2Ugc3RyaWN0JzsNCiAgICB2YXIgRGF0YVRhYmxlID0gJC5mbi5kYXRhVGFibGU7DQoNCg0KICAgIC8qKg0KICAgICAqIFN3aXRjaCB0aGUga2V5IHZhbHVlIHBhaXJpbmcgb2YgYW4gaW5kZXggYXJyYXkgdG8gYmUgdmFsdWUga2V5IChpLmUuIHRoZSBvbGQgdmFsdWUgaXMgbm93IHRoZQ0KICAgICAqIGtleSkuIEZvciBleGFtcGxlIGNvbnNpZGVyIFsgMiwgMCwgMSBdIHRoaXMgd291bGQgYmUgcmV0dXJuZWQgYXMgWyAxLCAyLCAwIF0uDQogICAgICogIEBtZXRob2QgIGZuSW52ZXJ0S2V5VmFsdWVzDQogICAgICogIEBwYXJhbSAgIGFycmF5IGFJbiBBcnJheSB0byBzd2l0Y2ggYXJvdW5kDQogICAgICogIEByZXR1cm5zIGFycmF5DQogICAgICovDQogICAgZnVuY3Rpb24gZm5JbnZlcnRLZXlWYWx1ZXMoIGFJbiApDQogICAgew0KICAgICAgICB2YXIgYVJldD1bXTsNCiAgICAgICAgZm9yICggdmFyIGk9MCwgaUxlbj1hSW4ubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkNCiAgICAgICAgew0KICAgICAgICAgICAgYVJldFsgYUluW2ldIF0gPSBpOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiBhUmV0Ow0KICAgIH0NCg0KDQogICAgLyoqDQogICAgICogTW9kaWZ5IGFuIGFycmF5IGJ5IHN3aXRjaGluZyB0aGUgcG9zaXRpb24gb2YgdHdvIGVsZW1lbnRzDQogICAgICogIEBtZXRob2QgIGZuQXJyYXlTd2l0Y2gNCiAgICAgKiAgQHBhcmFtICAgYXJyYXkgYUFycmF5IEFycmF5IHRvIGNvbnNpZGVyLCB3aWxsIGJlIG1vZGlmaWVkIGJ5IHJlZmVyZW5jZSAoaS5lLiBubyByZXR1cm4pDQogICAgICogIEBwYXJhbSAgIGludCBpRnJvbSBGcm9tIHBvaW50DQogICAgICogIEBwYXJhbSAgIGludCBpVG8gSW5zZXJ0IHBvaW50DQogICAgICogIEByZXR1cm5zIHZvaWQNCiAgICAgKi8NCiAgICBmdW5jdGlvbiBmbkFycmF5U3dpdGNoKCBhQXJyYXksIGlGcm9tLCBpVG8gKQ0KICAgIHsNCiAgICAgICAgdmFyIG1TdG9yZSA9IGFBcnJheS5zcGxpY2UoIGlGcm9tLCAxIClbMF07DQogICAgICAgIGFBcnJheS5zcGxpY2UoIGlUbywgMCwgbVN0b3JlICk7DQogICAgfQ0KDQoNCiAgICAvKioNCiAgICAgKiBTd2l0Y2ggdGhlIHBvc2l0aW9ucyBvZiBub2RlcyBpbiBhIHBhcmVudCBub2RlIChub3RlIHRoaXMgaXMgc3BlY2lmaWNhbGx5IGRlc2lnbmVkIGZvcg0KICAgICAqIHRhYmxlIHJvd3MpLiBOb3RlIHRoaXMgZnVuY3Rpb24gY29uc2lkZXJzIGFsbCBlbGVtZW50IG5vZGVzIHVuZGVyIHRoZSBwYXJlbnQhDQogICAgICogIEBtZXRob2QgIGZuRG9tU3dpdGNoDQogICAgICogIEBwYXJhbSAgIHN0cmluZyBzVGFnIFRhZyB0byBjb25zaWRlcg0KICAgICAqICBAcGFyYW0gICBpbnQgaUZyb20gRWxlbWVudCB0byBtb3ZlDQogICAgICogIEBwYXJhbSAgIGludCBQb2ludCB0byBlbGVtZW50IHRoZSBlbGVtZW50IHRvIChiZWZvcmUgdGhpcyBwb2ludCksIGNhbiBiZSBudWxsIGZvciBhcHBlbmQNCiAgICAgKiAgQHJldHVybnMgdm9pZA0KICAgICAqLw0KICAgIGZ1bmN0aW9uIGZuRG9tU3dpdGNoKCBuUGFyZW50LCBpRnJvbSwgaVRvICkNCiAgICB7DQogICAgICAgIHZhciBhblRhZ3MgPSBbXTsNCiAgICAgICAgZm9yICggdmFyIGk9MCwgaUxlbj1uUGFyZW50LmNoaWxkTm9kZXMubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkNCiAgICAgICAgew0KICAgICAgICAgICAgaWYgKCBuUGFyZW50LmNoaWxkTm9kZXNbaV0ubm9kZVR5cGUgPT0gMSApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgYW5UYWdzLnB1c2goIG5QYXJlbnQuY2hpbGROb2Rlc1tpXSApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHZhciBuU3RvcmUgPSBhblRhZ3NbIGlGcm9tIF07DQoNCiAgICAgICAgaWYgKCBpVG8gIT09IG51bGwgKQ0KICAgICAgICB7DQogICAgICAgICAgICBuUGFyZW50Lmluc2VydEJlZm9yZSggblN0b3JlLCBhblRhZ3NbaVRvXSApOw0KICAgICAgICB9DQogICAgICAgIGVsc2UNCiAgICAgICAgew0KICAgICAgICAgICAgblBhcmVudC5hcHBlbmRDaGlsZCggblN0b3JlICk7DQogICAgICAgIH0NCiAgICB9DQoNCg0KICAgIC8qKg0KICAgICAqIFBsdWctaW4gZm9yIERhdGFUYWJsZXMgd2hpY2ggd2lsbCByZW9yZGVyIHRoZSBpbnRlcm5hbCBjb2x1bW4gc3RydWN0dXJlIGJ5IHRha2luZyB0aGUgY29sdW1uDQogICAgICogZnJvbSBvbmUgcG9zaXRpb24gKGlGcm9tKSBhbmQgaW5zZXJ0IGl0IGludG8gYSBnaXZlbiBwb2ludCAoaVRvKS4NCiAgICAgKiAgQG1ldGhvZCAgJC5mbi5kYXRhVGFibGVFeHQub0FwaS5mbkNvbFJlb3JkZXINCiAgICAgKiAgQHBhcmFtICAgb2JqZWN0IG9TZXR0aW5ncyBEYXRhVGFibGVzIHNldHRpbmdzIG9iamVjdCAtIGF1dG9tYXRpY2FsbHkgYWRkZWQgYnkgRGF0YVRhYmxlcyENCiAgICAgKiAgQHBhcmFtICAgaW50IGlGcm9tIFRha2UgdGhlIGNvbHVtbiB0byBiZSByZXBvc2l0aW9uZWQgZnJvbSB0aGlzIHBvaW50DQogICAgICogIEBwYXJhbSAgIGludCBpVG8gYW5kIGluc2VydCBpdCBpbnRvIHRoaXMgcG9pbnQNCiAgICAgKiAgQHBhcmFtICAgYm9vbCBkcm9wIEluZGljYXRlIGlmIHRoZSByZW9yZGVyIGlzIHRoZSBmaW5hbCBvbmUgKGkuZS4gYSBkcm9wKQ0KICAgICAqICAgIG5vdCBhIGxpdmUgcmVvcmRlcg0KICAgICAqICBAcGFyYW0gICBib29sIGludmFsaWRhdGVSb3dzIHNwZWVkcyB1cCBwcm9jZXNzaW5nIGlmIGZhbHNlIHBhc3NlZA0KICAgICAqICBAcmV0dXJucyB2b2lkDQogICAgICovDQogICAgJC5mbi5kYXRhVGFibGVFeHQub0FwaS5mbkNvbFJlb3JkZXIgPSBmdW5jdGlvbiAoIG9TZXR0aW5ncywgaUZyb20sIGlUbywgZHJvcCwgaW52YWxpZGF0ZVJvd3MgKQ0KICAgIHsNCiAgICAgICAgdmFyIGksIGlMZW4sIGosIGpMZW4sIGplbiwgaUNvbHM9b1NldHRpbmdzLmFvQ29sdW1ucy5sZW5ndGgsIG5UcnMsIG9Db2w7DQogICAgICAgIHZhciBhdHRyTWFwID0gZnVuY3Rpb24gKCBvYmosIHByb3AsIG1hcHBpbmcgKSB7DQogICAgICAgICAgICBpZiAoICEgb2JqWyBwcm9wIF0gfHwgdHlwZW9mIG9ialsgcHJvcCBdID09PSAnZnVuY3Rpb24nICkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdmFyIGEgPSBvYmpbIHByb3AgXS5zcGxpdCgnLicpOw0KICAgICAgICAgICAgdmFyIG51bSA9IGEuc2hpZnQoKTsNCg0KICAgICAgICAgICAgaWYgKCBpc05hTiggbnVtKjEgKSApIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIG9ialsgcHJvcCBdID0gbWFwcGluZ1sgbnVtKjEgXSsnLicrYS5qb2luKCcuJyk7DQogICAgICAgIH07DQoNCiAgICAgICAgLyogU2FuaXR5IGNoZWNrIGluIHRoZSBpbnB1dCAqLw0KICAgICAgICBpZiAoIGlGcm9tID09IGlUbyApDQogICAgICAgIHsNCiAgICAgICAgICAgIC8qIFBvaW50bGVzcyByZW9yZGVyICovDQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoIGlGcm9tIDwgMCB8fCBpRnJvbSA+PSBpQ29scyApDQogICAgICAgIHsNCiAgICAgICAgICAgIHRoaXMub0FwaS5fZm5Mb2coIG9TZXR0aW5ncywgMSwgIkNvbFJlb3JkZXIgJ2Zyb20nIGluZGV4IGlzIG91dCBvZiBib3VuZHM6ICIraUZyb20gKTsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICggaVRvIDwgMCB8fCBpVG8gPj0gaUNvbHMgKQ0KICAgICAgICB7DQogICAgICAgICAgICB0aGlzLm9BcGkuX2ZuTG9nKCBvU2V0dGluZ3MsIDEsICJDb2xSZW9yZGVyICd0bycgaW5kZXggaXMgb3V0IG9mIGJvdW5kczogIitpVG8gKTsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KDQogICAgICAgIC8qDQogICAgICAgICAqIENhbGN1bGF0ZSB0aGUgbmV3IGNvbHVtbiBhcnJheSBpbmRleCwgc28gd2UgaGF2ZSBhIG1hcHBpbmcgYmV0d2VlbiB0aGUgb2xkIGFuZCBuZXcNCiAgICAgICAgICovDQogICAgICAgIHZhciBhaU1hcHBpbmcgPSBbXTsNCiAgICAgICAgZm9yICggaT0wLCBpTGVuPWlDb2xzIDsgaTxpTGVuIDsgaSsrICkNCiAgICAgICAgew0KICAgICAgICAgICAgYWlNYXBwaW5nW2ldID0gaTsNCiAgICAgICAgfQ0KICAgICAgICBmbkFycmF5U3dpdGNoKCBhaU1hcHBpbmcsIGlGcm9tLCBpVG8gKTsNCiAgICAgICAgdmFyIGFpSW52ZXJ0TWFwcGluZyA9IGZuSW52ZXJ0S2V5VmFsdWVzKCBhaU1hcHBpbmcgKTsNCg0KDQogICAgICAgIC8qDQogICAgICAgICAqIENvbnZlcnQgYWxsIGludGVybmFsIGluZGV4aW5nIHRvIHRoZSBuZXcgY29sdW1uIG9yZGVyIGluZGV4ZXMNCiAgICAgICAgICovDQogICAgICAgIC8qIFNvcnRpbmcgKi8NCiAgICAgICAgZm9yICggaT0wLCBpTGVuPW9TZXR0aW5ncy5hYVNvcnRpbmcubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkNCiAgICAgICAgew0KICAgICAgICAgICAgb1NldHRpbmdzLmFhU29ydGluZ1tpXVswXSA9IGFpSW52ZXJ0TWFwcGluZ1sgb1NldHRpbmdzLmFhU29ydGluZ1tpXVswXSBdOw0KICAgICAgICB9DQoNCiAgICAgICAgLyogRml4ZWQgc29ydGluZyAqLw0KICAgICAgICBpZiAoIG9TZXR0aW5ncy5hYVNvcnRpbmdGaXhlZCAhPT0gbnVsbCApDQogICAgICAgIHsNCiAgICAgICAgICAgIGZvciAoIGk9MCwgaUxlbj1vU2V0dGluZ3MuYWFTb3J0aW5nRml4ZWQubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBvU2V0dGluZ3MuYWFTb3J0aW5nRml4ZWRbaV1bMF0gPSBhaUludmVydE1hcHBpbmdbIG9TZXR0aW5ncy5hYVNvcnRpbmdGaXhlZFtpXVswXSBdOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgLyogRGF0YSBjb2x1bW4gc29ydGluZyAodGhlIGNvbHVtbiB3aGljaCB0aGUgc29ydCBmb3IgYSBnaXZlbiBjb2x1bW4gc2hvdWxkIHRha2UgcGxhY2Ugb24pICovDQogICAgICAgIGZvciAoIGk9MCwgaUxlbj1pQ29scyA7IGk8aUxlbiA7IGkrKyApDQogICAgICAgIHsNCiAgICAgICAgICAgIG9Db2wgPSBvU2V0dGluZ3MuYW9Db2x1bW5zW2ldOw0KICAgICAgICAgICAgZm9yICggaj0wLCBqTGVuPW9Db2wuYURhdGFTb3J0Lmxlbmd0aCA7IGo8akxlbiA7IGorKyApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgb0NvbC5hRGF0YVNvcnRbal0gPSBhaUludmVydE1hcHBpbmdbIG9Db2wuYURhdGFTb3J0W2pdIF07DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgY29sdW1uIGluZGV4ZXMNCiAgICAgICAgICAgIG9Db2wuaWR4ID0gYWlJbnZlcnRNYXBwaW5nWyBvQ29sLmlkeCBdOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gVXBkYXRlIDEuMTAgb3B0aW1pc2VkIHNvcnQgY2xhc3MgcmVtb3ZhbCB2YXJpYWJsZQ0KICAgICAgICAkLmVhY2goIG9TZXR0aW5ncy5hTGFzdFNvcnQsIGZ1bmN0aW9uIChpLCB2YWwpIHsNCiAgICAgICAgICAgIG9TZXR0aW5ncy5hTGFzdFNvcnRbaV0uc3JjID0gYWlJbnZlcnRNYXBwaW5nWyB2YWwuc3JjIF07DQogICAgICAgIH0gKTsNCg0KICAgICAgICAvKiBVcGRhdGUgdGhlIEdldCBhbmQgU2V0IGZ1bmN0aW9ucyBmb3IgZWFjaCBjb2x1bW4gKi8NCiAgICAgICAgZm9yICggaT0wLCBpTGVuPWlDb2xzIDsgaTxpTGVuIDsgaSsrICkNCiAgICAgICAgew0KICAgICAgICAgICAgb0NvbCA9IG9TZXR0aW5ncy5hb0NvbHVtbnNbaV07DQoNCiAgICAgICAgICAgIGlmICggdHlwZW9mIG9Db2wubURhdGEgPT0gJ251bWJlcicgKSB7DQogICAgICAgICAgICAgICAgb0NvbC5tRGF0YSA9IGFpSW52ZXJ0TWFwcGluZ1sgb0NvbC5tRGF0YSBdOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSBpZiAoICQuaXNQbGFpbk9iamVjdCggb0NvbC5tRGF0YSApICkgew0KICAgICAgICAgICAgICAgIC8vIEhUTUw1IGRhdGEgc291cmNlZA0KICAgICAgICAgICAgICAgIGF0dHJNYXAoIG9Db2wubURhdGEsICdfJywgICAgICBhaUludmVydE1hcHBpbmcgKTsNCiAgICAgICAgICAgICAgICBhdHRyTWFwKCBvQ29sLm1EYXRhLCAnZmlsdGVyJywgYWlJbnZlcnRNYXBwaW5nICk7DQogICAgICAgICAgICAgICAgYXR0ck1hcCggb0NvbC5tRGF0YSwgJ3NvcnQnLCAgIGFpSW52ZXJ0TWFwcGluZyApOw0KICAgICAgICAgICAgICAgIGF0dHJNYXAoIG9Db2wubURhdGEsICd0eXBlJywgICBhaUludmVydE1hcHBpbmcgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIC8qDQogICAgICAgICAqIE1vdmUgdGhlIERPTSBlbGVtZW50cw0KICAgICAgICAgKi8NCiAgICAgICAgaWYgKCBvU2V0dGluZ3MuYW9Db2x1bW5zW2lGcm9tXS5iVmlzaWJsZSApDQogICAgICAgIHsNCiAgICAgICAgICAgIC8qIENhbGN1bGF0ZSB0aGUgY3VycmVudCB2aXNpYmxlIGluZGV4IGFuZCB0aGUgcG9pbnQgdG8gaW5zZXJ0IHRoZSBub2RlIGJlZm9yZS4gVGhlIGluc2VydA0KICAgICAgICAgICAgICogYmVmb3JlIG5lZWRzIHRvIHRha2UgaW50byBhY2NvdW50IHRoYXQgdGhlcmUgbWlnaHQgbm90IGJlIGFuIGVsZW1lbnQgdG8gaW5zZXJ0IGJlZm9yZSwNCiAgICAgICAgICAgICAqIGluIHdoaWNoIGNhc2UgaXQgd2lsbCBiZSBudWxsLCBhbmQgYW4gYXBwZW5kQ2hpbGQgc2hvdWxkIGJlIHVzZWQNCiAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgdmFyIGlWaXNpYmxlSW5kZXggPSB0aGlzLm9BcGkuX2ZuQ29sdW1uSW5kZXhUb1Zpc2libGUoIG9TZXR0aW5ncywgaUZyb20gKTsNCiAgICAgICAgICAgIHZhciBpSW5zZXJ0QmVmb3JlSW5kZXggPSBudWxsOw0KDQogICAgICAgICAgICBpID0gaVRvIDwgaUZyb20gPyBpVG8gOiBpVG8gKyAxOw0KICAgICAgICAgICAgd2hpbGUgKCBpSW5zZXJ0QmVmb3JlSW5kZXggPT09IG51bGwgJiYgaSA8IGlDb2xzICkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpSW5zZXJ0QmVmb3JlSW5kZXggPSB0aGlzLm9BcGkuX2ZuQ29sdW1uSW5kZXhUb1Zpc2libGUoIG9TZXR0aW5ncywgaSApOw0KICAgICAgICAgICAgICAgIGkrKzsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLyogSGVhZGVyICovDQogICAgICAgICAgICBuVHJzID0gb1NldHRpbmdzLm5USGVhZC5nZXRFbGVtZW50c0J5VGFnTmFtZSgndHInKTsNCiAgICAgICAgICAgIGZvciAoIGk9MCwgaUxlbj1uVHJzLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgZm5Eb21Td2l0Y2goIG5UcnNbaV0sIGlWaXNpYmxlSW5kZXgsIGlJbnNlcnRCZWZvcmVJbmRleCApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvKiBGb290ZXIgKi8NCiAgICAgICAgICAgIGlmICggb1NldHRpbmdzLm5URm9vdCAhPT0gbnVsbCApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgblRycyA9IG9TZXR0aW5ncy5uVEZvb3QuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RyJyk7DQogICAgICAgICAgICAgICAgZm9yICggaT0wLCBpTGVuPW5UcnMubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGZuRG9tU3dpdGNoKCBuVHJzW2ldLCBpVmlzaWJsZUluZGV4LCBpSW5zZXJ0QmVmb3JlSW5kZXggKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8qIEJvZHkgKi8NCiAgICAgICAgICAgIGZvciAoIGk9MCwgaUxlbj1vU2V0dGluZ3MuYW9EYXRhLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWYgKCBvU2V0dGluZ3MuYW9EYXRhW2ldLm5UciAhPT0gbnVsbCApDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBmbkRvbVN3aXRjaCggb1NldHRpbmdzLmFvRGF0YVtpXS5uVHIsIGlWaXNpYmxlSW5kZXgsIGlJbnNlcnRCZWZvcmVJbmRleCApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIC8qDQogICAgICAgICAqIE1vdmUgdGhlIGludGVybmFsIGFycmF5IGVsZW1lbnRzDQogICAgICAgICAqLw0KICAgICAgICAvKiBDb2x1bW5zICovDQogICAgICAgIGZuQXJyYXlTd2l0Y2goIG9TZXR0aW5ncy5hb0NvbHVtbnMsIGlGcm9tLCBpVG8gKTsNCg0KICAgICAgICAvLyByZWdlbmVyYXRlIHRoZSBnZXQgLyBzZXQgZnVuY3Rpb25zDQogICAgICAgIGZvciAoIGk9MCwgaUxlbj1pQ29scyA7IGk8aUxlbiA7IGkrKyApIHsNCiAgICAgICAgICAgIG9TZXR0aW5ncy5vQXBpLl9mbkNvbHVtbk9wdGlvbnMoIG9TZXR0aW5ncywgaSwge30gKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8qIFNlYXJjaCBjb2x1bW5zICovDQogICAgICAgIGZuQXJyYXlTd2l0Y2goIG9TZXR0aW5ncy5hb1ByZVNlYXJjaENvbHMsIGlGcm9tLCBpVG8gKTsNCg0KICAgICAgICAvKiBBcnJheSBhcnJheSAtIGludGVybmFsIGRhdGEgYW5vZGVzIGNhY2hlICovDQogICAgICAgIGZvciAoIGk9MCwgaUxlbj1vU2V0dGluZ3MuYW9EYXRhLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApDQogICAgICAgIHsNCiAgICAgICAgICAgIHZhciBkYXRhID0gb1NldHRpbmdzLmFvRGF0YVtpXTsNCiAgICAgICAgICAgIHZhciBjZWxscyA9IGRhdGEuYW5DZWxsczsNCg0KICAgICAgICAgICAgaWYgKCBjZWxscyApIHsNCiAgICAgICAgICAgICAgICBmbkFycmF5U3dpdGNoKCBjZWxscywgaUZyb20sIGlUbyApOw0KDQogICAgICAgICAgICAgICAgLy8gTG9uZ2VyIHRlcm0sIHNob3VsZCB0aGlzIGJlIG1vdmVkIGludG8gdGhlIERhdGFUYWJsZXMnIGludmFsaWRhdGUNCiAgICAgICAgICAgICAgICAvLyBtZXRob2RzPw0KICAgICAgICAgICAgICAgIGZvciAoIGo9MCwgamVuPWNlbGxzLmxlbmd0aCA7IGo8amVuIDsgaisrICkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIGNlbGxzW2pdICYmIGNlbGxzW2pdLl9EVF9DZWxsSW5kZXggKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjZWxsc1tqXS5fRFRfQ2VsbEluZGV4LmNvbHVtbiA9IGo7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIEZvciBET00gc291cmNlZCBkYXRhLCB0aGUgaW52YWxpZGF0ZSB3aWxsIHJlcmVhZCB0aGUgY2VsbCBpbnRvDQogICAgICAgICAgICAvLyB0aGUgZGF0YSBhcnJheSwgYnV0IGZvciBkYXRhIHNvdXJjZXMgYXMgYW4gYXJyYXksIHRoZXkgbmVlZCB0bw0KICAgICAgICAgICAgLy8gYmUgZmxpcHBlZA0KICAgICAgICAgICAgaWYgKCBkYXRhLnNyYyAhPT0gJ2RvbScgJiYgJC5pc0FycmF5KCBkYXRhLl9hRGF0YSApICkgew0KICAgICAgICAgICAgICAgIGZuQXJyYXlTd2l0Y2goIGRhdGEuX2FEYXRhLCBpRnJvbSwgaVRvICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvKiBSZXBvc2l0aW9uIHRoZSBoZWFkZXIgZWxlbWVudHMgaW4gdGhlIGhlYWRlciBsYXlvdXQgYXJyYXkgKi8NCiAgICAgICAgZm9yICggaT0wLCBpTGVuPW9TZXR0aW5ncy5hb0hlYWRlci5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQ0KICAgICAgICB7DQogICAgICAgICAgICBmbkFycmF5U3dpdGNoKCBvU2V0dGluZ3MuYW9IZWFkZXJbaV0sIGlGcm9tLCBpVG8gKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICggb1NldHRpbmdzLmFvRm9vdGVyICE9PSBudWxsICkNCiAgICAgICAgew0KICAgICAgICAgICAgZm9yICggaT0wLCBpTGVuPW9TZXR0aW5ncy5hb0Zvb3Rlci5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGZuQXJyYXlTd2l0Y2goIG9TZXR0aW5ncy5hb0Zvb3RlcltpXSwgaUZyb20sIGlUbyApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCBpbnZhbGlkYXRlUm93cyB8fCBpbnZhbGlkYXRlUm93cyA9PT0gdW5kZWZpbmVkICkNCiAgICAgICAgew0KICAgICAgICAgICAgJC5mbi5kYXRhVGFibGUuQXBpKCBvU2V0dGluZ3MgKS5yb3dzKCkuaW52YWxpZGF0ZSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgLyoNCiAgICAgICAgICogVXBkYXRlIERhdGFUYWJsZXMnIGV2ZW50IGhhbmRsZXJzDQogICAgICAgICAqLw0KDQogICAgICAgIC8qIFNvcnQgbGlzdGVuZXIgKi8NCiAgICAgICAgZm9yICggaT0wLCBpTGVuPWlDb2xzIDsgaTxpTGVuIDsgaSsrICkNCiAgICAgICAgew0KICAgICAgICAgICAgJChvU2V0dGluZ3MuYW9Db2x1bW5zW2ldLm5UaCkub2ZmKCdjbGljay5EVCcpOw0KICAgICAgICAgICAgdGhpcy5vQXBpLl9mblNvcnRBdHRhY2hMaXN0ZW5lciggb1NldHRpbmdzLCBvU2V0dGluZ3MuYW9Db2x1bW5zW2ldLm5UaCwgaSApOw0KICAgICAgICB9DQoNCg0KICAgICAgICAvKiBGaXJlIGFuIGV2ZW50IHNvIG90aGVyIHBsdWctaW5zIGNhbiB1cGRhdGUgKi8NCiAgICAgICAgJChvU2V0dGluZ3Mub0luc3RhbmNlKS50cmlnZ2VyKCAnY29sdW1uLXJlb3JkZXIuZHQnLCBbIG9TZXR0aW5ncywgew0KICAgICAgICAgICAgZnJvbTogaUZyb20sDQogICAgICAgICAgICB0bzogaVRvLA0KICAgICAgICAgICAgbWFwcGluZzogYWlJbnZlcnRNYXBwaW5nLA0KICAgICAgICAgICAgZHJvcDogZHJvcCwNCg0KICAgICAgICAgICAgLy8gT2xkIHN0eWxlIHBhcmFtZXRlcnMgZm9yIGNvbXBhdGliaWxpdHkNCiAgICAgICAgICAgIGlGcm9tOiBpRnJvbSwNCiAgICAgICAgICAgIGlUbzogaVRvLA0KICAgICAgICAgICAgYWlJbnZlcnRNYXBwaW5nOiBhaUludmVydE1hcHBpbmcNCiAgICAgICAgfSBdICk7DQogICAgfTsNCg0KICAgIC8qKg0KICAgICAqIENvbFJlb3JkZXIgcHJvdmlkZXMgY29sdW1uIHZpc2liaWxpdHkgY29udHJvbCBmb3IgRGF0YVRhYmxlcw0KICAgICAqIEBjbGFzcyBDb2xSZW9yZGVyDQogICAgICogQGNvbnN0cnVjdG9yDQogICAgICogQHBhcmFtIHtvYmplY3R9IGR0IERhdGFUYWJsZXMgc2V0dGluZ3Mgb2JqZWN0DQogICAgICogQHBhcmFtIHtvYmplY3R9IG9wdHMgQ29sUmVvcmRlciBvcHRpb25zDQogICAgICovDQogICAgdmFyIENvbFJlb3JkZXIgPSBmdW5jdGlvbiggZHQsIG9wdHMgKQ0KICAgIHsNCiAgICAgICAgdmFyIHNldHRpbmdzID0gbmV3ICQuZm4uZGF0YVRhYmxlLkFwaSggZHQgKS5zZXR0aW5ncygpWzBdOw0KDQogICAgICAgIC8vIEVuc3VyZSB0aGF0IHdlIGNhbid0IGluaXRpYWxpc2Ugb24gdGhlIHNhbWUgdGFibGUgdHdpY2UNCiAgICAgICAgaWYgKCBzZXR0aW5ncy5fY29sUmVvcmRlciApIHsNCiAgICAgICAgICAgIHJldHVybiBzZXR0aW5ncy5fY29sUmVvcmRlcjsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIEFsbG93IHRoZSBvcHRpb25zIHRvIGJlIGEgYm9vbGVhbiBmb3IgZGVmYXVsdHMNCiAgICAgICAgaWYgKCBvcHRzID09PSB0cnVlICkgew0KICAgICAgICAgICAgb3B0cyA9IHt9Ow0KICAgICAgICB9DQoNCiAgICAgICAgLy8gQ29udmVydCBmcm9tIGNhbWVsQ2FzZSB0byBIdW5nYXJpYW4sIGp1c3QgYXMgRGF0YVRhYmxlcyBkb2VzDQogICAgICAgIHZhciBjYW1lbFRvSHVuZ2FyaWFuID0gJC5mbi5kYXRhVGFibGUuY2FtZWxUb0h1bmdhcmlhbjsNCiAgICAgICAgaWYgKCBjYW1lbFRvSHVuZ2FyaWFuICkgew0KICAgICAgICAgICAgY2FtZWxUb0h1bmdhcmlhbiggQ29sUmVvcmRlci5kZWZhdWx0cywgQ29sUmVvcmRlci5kZWZhdWx0cywgdHJ1ZSApOw0KICAgICAgICAgICAgY2FtZWxUb0h1bmdhcmlhbiggQ29sUmVvcmRlci5kZWZhdWx0cywgb3B0cyB8fCB7fSApOw0KICAgICAgICB9DQoNCg0KICAgICAgICAvKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqDQogICAgICAgICAqIFB1YmxpYyBjbGFzcyB2YXJpYWJsZXMNCiAgICAgICAgICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKi8NCg0KICAgICAgICAvKioNCiAgICAgICAgICogQG5hbWVzcGFjZSBTZXR0aW5ncyBvYmplY3Qgd2hpY2ggY29udGFpbnMgY3VzdG9taXNhYmxlIGluZm9ybWF0aW9uIGZvciBDb2xSZW9yZGVyIGluc3RhbmNlDQogICAgICAgICAqLw0KICAgICAgICB0aGlzLnMgPSB7DQogICAgICAgICAgICAvKioNCiAgICAgICAgICAgICAqIERhdGFUYWJsZXMgc2V0dGluZ3Mgb2JqZWN0DQogICAgICAgICAgICAgKiAgQHByb3BlcnR5IGR0DQogICAgICAgICAgICAgKiAgQHR5cGUgICAgIE9iamVjdA0KICAgICAgICAgICAgICogIEBkZWZhdWx0ICBudWxsDQogICAgICAgICAgICAgKi8NCiAgICAgICAgICAgICJkdCI6IG51bGwsDQoNCiAgICAgICAgICAgIC8qKg0KICAgICAgICAgICAgICogSW5pdGlhbGlzYXRpb24gb2JqZWN0IHVzZWQgZm9yIHRoaXMgaW5zdGFuY2UNCiAgICAgICAgICAgICAqICBAcHJvcGVydHkgaW5pdA0KICAgICAgICAgICAgICogIEB0eXBlICAgICBvYmplY3QNCiAgICAgICAgICAgICAqICBAZGVmYXVsdCAge30NCiAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgImluaXQiOiAkLmV4dGVuZCggdHJ1ZSwge30sIENvbFJlb3JkZXIuZGVmYXVsdHMsIG9wdHMgKSwNCg0KICAgICAgICAgICAgLyoqDQogICAgICAgICAgICAgKiBOdW1iZXIgb2YgY29sdW1ucyB0byBmaXggKG5vdCBhbGxvdyB0byBiZSByZW9yZGVyZWQpDQogICAgICAgICAgICAgKiAgQHByb3BlcnR5IGZpeGVkDQogICAgICAgICAgICAgKiAgQHR5cGUgICAgIGludA0KICAgICAgICAgICAgICogIEBkZWZhdWx0ICAwDQogICAgICAgICAgICAgKi8NCiAgICAgICAgICAgICJmaXhlZCI6IDAsDQoNCiAgICAgICAgICAgIC8qKg0KICAgICAgICAgICAgICogTnVtYmVyIG9mIGNvbHVtbnMgdG8gZml4IGNvdW50aW5nIGZyb20gcmlnaHQgKG5vdCBhbGxvdyB0byBiZSByZW9yZGVyZWQpDQogICAgICAgICAgICAgKiAgQHByb3BlcnR5IGZpeGVkUmlnaHQNCiAgICAgICAgICAgICAqICBAdHlwZSAgICAgaW50DQogICAgICAgICAgICAgKiAgQGRlZmF1bHQgIDANCiAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgImZpeGVkUmlnaHQiOiAwLA0KDQogICAgICAgICAgICAvKioNCiAgICAgICAgICAgICAqIENhbGxiYWNrIGZ1bmN0aW9uIGZvciBvbmNlIHRoZSByZW9yZGVyIGhhcyBiZWVuIGRvbmUNCiAgICAgICAgICAgICAqICBAcHJvcGVydHkgcmVvcmRlckNhbGxiYWNrDQogICAgICAgICAgICAgKiAgQHR5cGUgICAgIGZ1bmN0aW9uDQogICAgICAgICAgICAgKiAgQGRlZmF1bHQgIG51bGwNCiAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgInJlb3JkZXJDYWxsYmFjayI6IG51bGwsDQoNCiAgICAgICAgICAgIC8qKg0KICAgICAgICAgICAgICogQG5hbWVzcGFjZSBJbmZvcm1hdGlvbiB1c2VkIGZvciB0aGUgbW91c2UgZHJhZw0KICAgICAgICAgICAgICovDQogICAgICAgICAgICAibW91c2UiOiB7DQogICAgICAgICAgICAgICAgInN0YXJ0WCI6IC0xLA0KICAgICAgICAgICAgICAgICJzdGFydFkiOiAtMSwNCiAgICAgICAgICAgICAgICAib2Zmc2V0WCI6IC0xLA0KICAgICAgICAgICAgICAgICJvZmZzZXRZIjogLTEsDQogICAgICAgICAgICAgICAgInRhcmdldCI6IC0xLA0KICAgICAgICAgICAgICAgICJ0YXJnZXRJbmRleCI6IC0xLA0KICAgICAgICAgICAgICAgICJmcm9tSW5kZXgiOiAtMQ0KICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgLyoqDQogICAgICAgICAgICAgKiBJbmZvcm1hdGlvbiB3aGljaCBpcyB1c2VkIGZvciBwb3NpdGlvbmluZyB0aGUgaW5zZXJ0IGN1c29yIGFuZCBrbm93aW5nIHdoZXJlIHRvIGRvIHRoZQ0KICAgICAgICAgICAgICogaW5zZXJ0LiBBcnJheSBvZiBvYmplY3RzIHdpdGggdGhlIHByb3BlcnRpZXM6DQogICAgICAgICAgICAgKiAgIHg6IHgtYXhpcyBwb3NpdGlvbg0KICAgICAgICAgICAgICogICB0bzogaW5zZXJ0IHBvaW50DQogICAgICAgICAgICAgKiAgQHByb3BlcnR5IGFvVGFyZ2V0cw0KICAgICAgICAgICAgICogIEB0eXBlICAgICBhcnJheQ0KICAgICAgICAgICAgICogIEBkZWZhdWx0ICBbXQ0KICAgICAgICAgICAgICovDQogICAgICAgICAgICAiYW9UYXJnZXRzIjogW10NCiAgICAgICAgfTsNCg0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBAbmFtZXNwYWNlIENvbW1vbiBhbmQgdXNlZnVsIERPTSBlbGVtZW50cyBmb3IgdGhlIGNsYXNzIGluc3RhbmNlDQogICAgICAgICAqLw0KICAgICAgICB0aGlzLmRvbSA9IHsNCiAgICAgICAgICAgIC8qKg0KICAgICAgICAgICAgICogRHJhZ2dpbmcgZWxlbWVudCAodGhlIG9uZSB0aGUgbW91c2UgaXMgbW92aW5nKQ0KICAgICAgICAgICAgICogIEBwcm9wZXJ0eSBkcmFnDQogICAgICAgICAgICAgKiAgQHR5cGUgICAgIGVsZW1lbnQNCiAgICAgICAgICAgICAqICBAZGVmYXVsdCAgbnVsbA0KICAgICAgICAgICAgICovDQogICAgICAgICAgICAiZHJhZyI6IG51bGwsDQoNCiAgICAgICAgICAgIC8qKg0KICAgICAgICAgICAgICogVGhlIGluc2VydCBjdXJzb3INCiAgICAgICAgICAgICAqICBAcHJvcGVydHkgcG9pbnRlcg0KICAgICAgICAgICAgICogIEB0eXBlICAgICBlbGVtZW50DQogICAgICAgICAgICAgKiAgQGRlZmF1bHQgIG51bGwNCiAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgInBvaW50ZXIiOiBudWxsDQogICAgICAgIH07DQoNCg0KICAgICAgICAvKiBDb25zdHJ1Y3RvciBsb2dpYyAqLw0KICAgICAgICB0aGlzLnMuZHQgPSBzZXR0aW5nczsNCiAgICAgICAgdGhpcy5zLmR0Ll9jb2xSZW9yZGVyID0gdGhpczsNCiAgICAgICAgdGhpcy5fZm5Db25zdHJ1Y3QoKTsNCg0KICAgICAgICByZXR1cm4gdGhpczsNCiAgICB9Ow0KDQoNCg0KICAgICQuZXh0ZW5kKCBDb2xSZW9yZGVyLnByb3RvdHlwZSwgew0KICAgICAgICAvKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqDQogICAgICAgICAqIFB1YmxpYyBtZXRob2RzDQogICAgICAgICAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICovDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIFJlc2V0IHRoZSBjb2x1bW4gb3JkZXJpbmcgdG8gdGhlIG9yaWdpbmFsIG9yZGVyaW5nIHRoYXQgd2FzIGRldGVjdGVkIG9uDQogICAgICAgICAqIHN0YXJ0IHVwLg0KICAgICAgICAgKiAgQHJldHVybiB7dGhpc30gUmV0dXJucyBgdGhpc2AgZm9yIGNoYWluaW5nLg0KICAgICAgICAgKg0KICAgICAgICAgKiAgQGV4YW1wbGUNCiAgICAgICAgICogICAgLy8gRGF0YVRhYmxlcyBpbml0aWFsaXNhdGlvbiB3aXRoIENvbFJlb3JkZXINCiAgICAgICAgICogICAgdmFyIHRhYmxlID0gJCgnI2V4YW1wbGUnKS5kYXRhVGFibGUoIHsNCgkgKiAgICAgICAgInNEb20iOiAnUmxmcnRpcCcNCgkgKiAgICB9ICk7DQogICAgICAgICAqDQogICAgICAgICAqICAgIC8vIEFkZCBjbGljayBldmVudCB0byBhIGJ1dHRvbiB0byByZXNldCB0aGUgb3JkZXJpbmcNCiAgICAgICAgICogICAgJCgnI3Jlc2V0T3JkZXJpbmcnKS5jbGljayggZnVuY3Rpb24gKGUpIHsNCgkgKiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KCSAqICAgICAgICAkLmZuLmRhdGFUYWJsZS5Db2xSZW9yZGVyKCB0YWJsZSApLmZuUmVzZXQoKTsNCgkgKiAgICB9ICk7DQogICAgICAgICAqLw0KICAgICAgICAiZm5SZXNldCI6IGZ1bmN0aW9uICgpDQogICAgICAgIHsNCiAgICAgICAgICAgIHRoaXMuX2ZuT3JkZXJDb2x1bW5zKCB0aGlzLmZuT3JkZXIoKSApOw0KDQogICAgICAgICAgICByZXR1cm4gdGhpczsNCiAgICAgICAgfSwNCg0KICAgICAgICAvKioNCiAgICAgICAgICogYERlcHJlY2F0ZWRgIC0gR2V0IHRoZSBjdXJyZW50IG9yZGVyIG9mIHRoZSBjb2x1bW5zLCBhcyBhbiBhcnJheS4NCiAgICAgICAgICogIEByZXR1cm4ge2FycmF5fSBBcnJheSBvZiBjb2x1bW4gaWRlbnRpZmllcnMNCiAgICAgICAgICogIEBkZXByZWNhdGVkIGBmbk9yZGVyYCBzaG91bGQgYmUgdXNlZCBpbiBwcmVmZXJlbmNlIHRvIHRoaXMgbWV0aG9kLg0KICAgICAgICAgKiAgICAgIGBmbk9yZGVyYCBhY3RzIGFzIGEgZ2V0dGVyL3NldHRlci4NCiAgICAgICAgICovDQogICAgICAgICJmbkdldEN1cnJlbnRPcmRlciI6IGZ1bmN0aW9uICgpDQogICAgICAgIHsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLmZuT3JkZXIoKTsNCiAgICAgICAgfSwNCg0KICAgICAgICAvKioNCiAgICAgICAgICogR2V0IHRoZSBjdXJyZW50IG9yZGVyIG9mIHRoZSBjb2x1bW5zLCBhcyBhbiBhcnJheS4gTm90ZSB0aGF0IHRoZSB2YWx1ZXMNCiAgICAgICAgICogZ2l2ZW4gaW4gdGhlIGFycmF5IGFyZSB1bmlxdWUgaWRlbnRpZmllcnMgZm9yIGVhY2ggY29sdW1uLiBDdXJyZW50bHkNCiAgICAgICAgICogdGhlc2UgYXJlIHRoZSBvcmlnaW5hbCBvcmRlcmluZyBvZiB0aGUgY29sdW1ucyB0aGF0IHdhcyBkZXRlY3RlZCBvbg0KICAgICAgICAgKiBzdGFydCB1cCwgYnV0IHRoaXMgY291bGQgcG90ZW50aWFsbHkgY2hhbmdlIGluIGZ1dHVyZS4NCiAgICAgICAgICogIEByZXR1cm4ge2FycmF5fSBBcnJheSBvZiBjb2x1bW4gaWRlbnRpZmllcnMNCiAgICAgICAgICoNCiAgICAgICAgICogIEBleGFtcGxlDQogICAgICAgICAqICAgIC8vIEdldCBjb2x1bW4gb3JkZXJpbmcgZm9yIHRoZSB0YWJsZQ0KICAgICAgICAgKiAgICB2YXIgb3JkZXIgPSAkLmZuLmRhdGFUYWJsZS5Db2xSZW9yZGVyKCBkYXRhVGFibGUgKS5mbk9yZGVyKCk7DQogICAgICAgICAqLy8qKg0KICAgICAgICAgKiBTZXQgdGhlIG9yZGVyIG9mIHRoZSBjb2x1bW5zLCBmcm9tIHRoZSBwb3NpdGlvbnMgaWRlbnRpZmllZCBpbiB0aGUNCiAgICAgICAgICogb3JkZXJpbmcgYXJyYXkgZ2l2ZW4uIE5vdGUgdGhhdCBDb2xSZW9yZGVyIHRha2VzIGEgYnJ1dGUgZm9yY2UgYXBwcm9hY2gNCiAgICAgICAgICogdG8gcmVvcmRlcmluZywgc28gaXQgaXMgcG9zc2libGUgbXVsdGlwbGUgcmVvcmRlcmluZyBldmVudHMgd2lsbCBvY2N1cg0KICAgICAgICAgKiBiZWZvcmUgdGhlIGZpbmFsIG9yZGVyIGlzIHNldHRsZWQgdXBvbi4NCiAgICAgICAgICogIEBwYXJhbSB7YXJyYXl9IFtzZXRdIEFycmF5IG9mIGNvbHVtbiBpZGVudGlmaWVycyBpbiB0aGUgbmV3IG9yZGVyLiBOb3RlDQogICAgICAgICAqICAgIHRoYXQgZXZlcnkgY29sdW1uIG11c3QgYmUgaW5jbHVkZWQsIHVuaXF1ZWx5LCBpbiB0aGlzIGFycmF5Lg0KICAgICAgICAgKiAgQHJldHVybiB7dGhpc30gUmV0dXJucyBgdGhpc2AgZm9yIGNoYWluaW5nLg0KICAgICAgICAgKg0KICAgICAgICAgKiAgQGV4YW1wbGUNCiAgICAgICAgICogICAgLy8gU3dhcCB0aGUgZmlyc3QgYW5kIHNlY29uZCBjb2x1bW5zDQogICAgICAgICAqICAgICQuZm4uZGF0YVRhYmxlLkNvbFJlb3JkZXIoIGRhdGFUYWJsZSApLmZuT3JkZXIoIFsxLCAwLCAyLCAzLCA0XSApOw0KICAgICAgICAgKg0KICAgICAgICAgKiAgQGV4YW1wbGUNCiAgICAgICAgICogICAgLy8gTW92ZSB0aGUgZmlyc3QgY29sdW1uIHRvIHRoZSBlbmQgZm9yIHRoZSB0YWJsZSBgI2V4YW1wbGVgDQogICAgICAgICAqICAgIHZhciBjdXJyID0gJC5mbi5kYXRhVGFibGUuQ29sUmVvcmRlciggJyNleGFtcGxlJyApLmZuT3JkZXIoKTsNCiAgICAgICAgICogICAgdmFyIGZpcnN0ID0gY3Vyci5zaGlmdCgpOw0KICAgICAgICAgKiAgICBjdXJyLnB1c2goIGZpcnN0ICk7DQogICAgICAgICAqICAgICQuZm4uZGF0YVRhYmxlLkNvbFJlb3JkZXIoICcjZXhhbXBsZScgKS5mbk9yZGVyKCBjdXJyICk7DQogICAgICAgICAqDQogICAgICAgICAqICBAZXhhbXBsZQ0KICAgICAgICAgKiAgICAvLyBSZXZlcnNlIHRoZSB0YWJsZSdzIG9yZGVyDQogICAgICAgICAqICAgICQuZm4uZGF0YVRhYmxlLkNvbFJlb3JkZXIoICcjZXhhbXBsZScgKS5mbk9yZGVyKA0KICAgICAgICAgKiAgICAgICQuZm4uZGF0YVRhYmxlLkNvbFJlb3JkZXIoICcjZXhhbXBsZScgKS5mbk9yZGVyKCkucmV2ZXJzZSgpDQogICAgICAgICAqICAgICk7DQogICAgICAgICAqLw0KICAgICAgICAiZm5PcmRlciI6IGZ1bmN0aW9uICggc2V0LCBvcmlnaW5hbCApDQogICAgICAgIHsNCiAgICAgICAgICAgIHZhciBhID0gW10sIGksIGllbiwgaiwgamVuOw0KICAgICAgICAgICAgdmFyIGNvbHVtbnMgPSB0aGlzLnMuZHQuYW9Db2x1bW5zOw0KDQogICAgICAgICAgICBpZiAoIHNldCA9PT0gdW5kZWZpbmVkICl7DQogICAgICAgICAgICAgICAgZm9yICggaT0wLCBpZW49Y29sdW1ucy5sZW5ndGggOyBpPGllbiA7IGkrKyApIHsNCiAgICAgICAgICAgICAgICAgICAgYS5wdXNoKCBjb2x1bW5zW2ldLl9Db2xSZW9yZGVyX2lPcmlnQ29sICk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgcmV0dXJuIGE7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIFRoZSBvcmRlciBnaXZlbiBpcyBiYXNlZCBvbiB0aGUgb3JpZ2luYWwgaW5kZXhlcywgcmF0aGVyIHRoYW4gdGhlDQogICAgICAgICAgICAvLyBleGlzdGluZyBvbmVzLCBzbyB3ZSBuZWVkIHRvIHRyYW5zbGF0ZSBmcm9tIHRoZSBvcmlnaW5hbCB0byBjdXJyZW50DQogICAgICAgICAgICAvLyBiZWZvcmUgdGhlbiBkb2luZyB0aGUgb3JkZXINCiAgICAgICAgICAgIGlmICggb3JpZ2luYWwgKSB7DQogICAgICAgICAgICAgICAgdmFyIG9yZGVyID0gdGhpcy5mbk9yZGVyKCk7DQoNCiAgICAgICAgICAgICAgICBmb3IgKCBpPTAsIGllbj1zZXQubGVuZ3RoIDsgaTxpZW4gOyBpKysgKSB7DQogICAgICAgICAgICAgICAgICAgIGEucHVzaCggJC5pbkFycmF5KCBzZXRbaV0sIG9yZGVyICkgKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBzZXQgPSBhOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLl9mbk9yZGVyQ29sdW1ucyggZm5JbnZlcnRLZXlWYWx1ZXMoIHNldCApICk7DQoNCiAgICAgICAgICAgIHJldHVybiB0aGlzOw0KICAgICAgICB9LA0KDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIENvbnZlcnQgZnJvbSB0aGUgb3JpZ2luYWwgY29sdW1uIGluZGV4LCB0byB0aGUgb3JpZ2luYWwNCiAgICAgICAgICoNCiAgICAgICAgICogQHBhcmFtICB7aW50fGFycmF5fSBpZHggSW5kZXgoZXMpIHRvIGNvbnZlcnQNCiAgICAgICAgICogQHBhcmFtICB7c3RyaW5nfSBkaXIgVHJhbnNwb3NlIGRpcmVjdGlvbiAtIGBmcm9tT3JpZ2luYWxgIC8gYHRvQ3VycmVudGANCiAgICAgICAgICogICBvciBgJ3RvT3JpZ2luYWxgIC8gYGZyb21DdXJyZW50YA0KICAgICAgICAgKiBAcmV0dXJuIHtpbnR8YXJyYXl9ICAgICBDb252ZXJ0ZWQgdmFsdWVzDQogICAgICAgICAqLw0KICAgICAgICBmblRyYW5zcG9zZTogZnVuY3Rpb24gKCBpZHgsIGRpciApDQogICAgICAgIHsNCiAgICAgICAgICAgIGlmICggISBkaXIgKSB7DQogICAgICAgICAgICAgICAgZGlyID0gJ3RvQ3VycmVudCc7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHZhciBvcmRlciA9IHRoaXMuZm5PcmRlcigpOw0KICAgICAgICAgICAgdmFyIGNvbHVtbnMgPSB0aGlzLnMuZHQuYW9Db2x1bW5zOw0KDQogICAgICAgICAgICBpZiAoIGRpciA9PT0gJ3RvQ3VycmVudCcgKSB7DQogICAgICAgICAgICAgICAgLy8gR2l2ZW4gYW4gb3JpZ2luYWwgaW5kZXgsIHdhbnQgdGhlIGN1cnJlbnQNCiAgICAgICAgICAgICAgICByZXR1cm4gISAkLmlzQXJyYXkoIGlkeCApID8NCiAgICAgICAgICAgICAgICAgICAgJC5pbkFycmF5KCBpZHgsIG9yZGVyICkgOg0KICAgICAgICAgICAgICAgICAgICAkLm1hcCggaWR4LCBmdW5jdGlvbiAoIGluZGV4ICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICQuaW5BcnJheSggaW5kZXgsIG9yZGVyICk7DQogICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgICAgIC8vIEdpdmVuIGEgY3VycmVudCBpbmRleCwgd2FudCB0aGUgb3JpZ2luYWwNCiAgICAgICAgICAgICAgICByZXR1cm4gISAkLmlzQXJyYXkoIGlkeCApID8NCiAgICAgICAgICAgICAgICAgICAgY29sdW1uc1tpZHhdLl9Db2xSZW9yZGVyX2lPcmlnQ29sIDoNCiAgICAgICAgICAgICAgICAgICAgJC5tYXAoIGlkeCwgZnVuY3Rpb24gKCBpbmRleCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb2x1bW5zW2luZGV4XS5fQ29sUmVvcmRlcl9pT3JpZ0NvbDsNCiAgICAgICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQoNCiAgICAgICAgLyogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKg0KICAgICAgICAgKiBQcml2YXRlIG1ldGhvZHMgKHRoZXkgYXJlIG9mIGNvdXJzZSBwdWJsaWMgaW4gSlMsIGJ1dCByZWNvbW1lbmRlZCBhcyBwcml2YXRlKQ0KICAgICAgICAgKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqLw0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBDb25zdHJ1Y3RvciBsb2dpYw0KICAgICAgICAgKiAgQG1ldGhvZCAgX2ZuQ29uc3RydWN0DQogICAgICAgICAqICBAcmV0dXJucyB2b2lkDQogICAgICAgICAqICBAcHJpdmF0ZQ0KICAgICAgICAgKi8NCiAgICAgICAgIl9mbkNvbnN0cnVjdCI6IGZ1bmN0aW9uICgpDQogICAgICAgIHsNCiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpczsNCiAgICAgICAgICAgIHZhciBpTGVuID0gdGhpcy5zLmR0LmFvQ29sdW1ucy5sZW5ndGg7DQogICAgICAgICAgICB2YXIgdGFibGUgPSB0aGlzLnMuZHQublRhYmxlOw0KICAgICAgICAgICAgdmFyIGk7DQoNCiAgICAgICAgICAgIC8qIENvbHVtbnMgZGlzY291bnRlZCBmcm9tIHJlb3JkZXJpbmcgLSBjb3VudGluZyBsZWZ0IHRvIHJpZ2h0ICovDQogICAgICAgICAgICBpZiAoIHRoaXMucy5pbml0LmlGaXhlZENvbHVtbnMgKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHRoaXMucy5maXhlZCA9IHRoaXMucy5pbml0LmlGaXhlZENvbHVtbnM7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICggdGhpcy5zLmluaXQuaUZpeGVkQ29sdW1uc0xlZnQgKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHRoaXMucy5maXhlZCA9IHRoaXMucy5pbml0LmlGaXhlZENvbHVtbnNMZWZ0Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvKiBDb2x1bW5zIGRpc2NvdW50ZWQgZnJvbSByZW9yZGVyaW5nIC0gY291bnRpbmcgcmlnaHQgdG8gbGVmdCAqLw0KICAgICAgICAgICAgdGhpcy5zLmZpeGVkUmlnaHQgPSB0aGlzLnMuaW5pdC5pRml4ZWRDb2x1bW5zUmlnaHQgPw0KICAgICAgICAgICAgICAgIHRoaXMucy5pbml0LmlGaXhlZENvbHVtbnNSaWdodCA6DQogICAgICAgICAgICAgICAgMDsNCg0KICAgICAgICAgICAgLyogRHJvcCBjYWxsYmFjayBpbml0aWFsaXNhdGlvbiBvcHRpb24gKi8NCiAgICAgICAgICAgIGlmICggdGhpcy5zLmluaXQuZm5SZW9yZGVyQ2FsbGJhY2sgKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHRoaXMucy5yZW9yZGVyQ2FsbGJhY2sgPSB0aGlzLnMuaW5pdC5mblJlb3JkZXJDYWxsYmFjazsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLyogQWRkIGV2ZW50IGhhbmRsZXJzIGZvciB0aGUgZHJhZyBhbmQgZHJvcCwgYW5kIGFsc28gbWFyayB0aGUgb3JpZ2luYWwgY29sdW1uIG9yZGVyICovDQogICAgICAgICAgICBmb3IgKCBpID0gMDsgaSA8IGlMZW47IGkrKyApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWYgKCBpID4gdGhpcy5zLmZpeGVkLTEgJiYgaSA8IGlMZW4gLSB0aGlzLnMuZml4ZWRSaWdodCApDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLl9mbk1vdXNlTGlzdGVuZXIoIGksIHRoaXMucy5kdC5hb0NvbHVtbnNbaV0ublRoICk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgLyogTWFyayB0aGUgb3JpZ2luYWwgY29sdW1uIG9yZGVyIGZvciBsYXRlciByZWZlcmVuY2UgKi8NCiAgICAgICAgICAgICAgICB0aGlzLnMuZHQuYW9Db2x1bW5zW2ldLl9Db2xSZW9yZGVyX2lPcmlnQ29sID0gaTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLyogU3RhdGUgc2F2aW5nICovDQogICAgICAgICAgICB0aGlzLnMuZHQub0FwaS5fZm5DYWxsYmFja1JlZyggdGhpcy5zLmR0LCAnYW9TdGF0ZVNhdmVQYXJhbXMnLCBmdW5jdGlvbiAob1MsIG9EYXRhKSB7DQogICAgICAgICAgICAgICAgdGhhdC5fZm5TdGF0ZVNhdmUuY2FsbCggdGhhdCwgb0RhdGEgKTsNCiAgICAgICAgICAgIH0sICJDb2xSZW9yZGVyX1N0YXRlIiApOw0KDQogICAgICAgICAgICAvKiBBbiBpbml0aWFsIGNvbHVtbiBvcmRlciBoYXMgYmVlbiBzcGVjaWZpZWQgKi8NCiAgICAgICAgICAgIHZhciBhaU9yZGVyID0gbnVsbDsNCiAgICAgICAgICAgIGlmICggdGhpcy5zLmluaXQuYWlPcmRlciApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgYWlPcmRlciA9IHRoaXMucy5pbml0LmFpT3JkZXIuc2xpY2UoKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLyogU3RhdGUgbG9hZGluZywgb3ZlcnJpZGVzIHRoZSBjb2x1bW4gb3JkZXIgZ2l2ZW4gKi8NCiAgICAgICAgICAgIGlmICggdGhpcy5zLmR0Lm9Mb2FkZWRTdGF0ZSAmJiB0eXBlb2YgdGhpcy5zLmR0Lm9Mb2FkZWRTdGF0ZS5Db2xSZW9yZGVyICE9ICd1bmRlZmluZWQnICYmDQogICAgICAgICAgICAgICAgdGhpcy5zLmR0Lm9Mb2FkZWRTdGF0ZS5Db2xSZW9yZGVyLmxlbmd0aCA9PSB0aGlzLnMuZHQuYW9Db2x1bW5zLmxlbmd0aCApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgYWlPcmRlciA9IHRoaXMucy5kdC5vTG9hZGVkU3RhdGUuQ29sUmVvcmRlcjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLyogSWYgd2UgaGF2ZSBhbiBvcmRlciB0byBhcHBseSAtIGRvIHNvICovDQogICAgICAgICAgICBpZiAoIGFpT3JkZXIgKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIC8qIFdlIG1pZ2h0IGJlIGNhbGxlZCBkdXJpbmcgb3IgYWZ0ZXIgdGhlIERhdGFUYWJsZXMgaW5pdGlhbGlzYXRpb24uIElmIGJlZm9yZSwgdGhlbiB3ZSBuZWVkDQogICAgICAgICAgICAgICAgICogdG8gd2FpdCB1bnRpbCB0aGUgZHJhdyBpcyBkb25lLCBpZiBhZnRlciwgdGhlbiBkbyB3aGF0IHdlIG5lZWQgdG8gZG8gcmlnaHQgYXdheQ0KICAgICAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgICAgIGlmICggIXRoYXQucy5kdC5fYkluaXRDb21wbGV0ZSApDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYkRvbmUgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgJCh0YWJsZSkub24oICdkcmF3LmR0LmNvbFJlb3JkZXInLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoICF0aGF0LnMuZHQuX2JJbml0Q29tcGxldGUgJiYgIWJEb25lICkNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiRG9uZSA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc29ydCA9IGZuSW52ZXJ0S2V5VmFsdWVzKCBhaU9yZGVyICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5fZm5PcmRlckNvbHVtbnMuY2FsbCggdGhhdCwgcmVzb3J0ICk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc29ydCA9IGZuSW52ZXJ0S2V5VmFsdWVzKCBhaU9yZGVyICk7DQogICAgICAgICAgICAgICAgICAgIHRoYXQuX2ZuT3JkZXJDb2x1bW5zLmNhbGwoIHRoYXQsIHJlc29ydCApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgICAgIHRoaXMuX2ZuU2V0Q29sdW1uSW5kZXhlcygpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBEZXN0cm95IGNsZWFuIHVwDQogICAgICAgICAgICAkKHRhYmxlKS5vbiggJ2Rlc3Ryb3kuZHQuY29sUmVvcmRlcicsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAkKHRhYmxlKS5vZmYoICdkZXN0cm95LmR0LmNvbFJlb3JkZXIgZHJhdy5kdC5jb2xSZW9yZGVyJyApOw0KICAgICAgICAgICAgICAgICQodGhhdC5zLmR0Lm5USGVhZCkuZmluZCggJyonICkub2ZmKCAnLkNvbFJlb3JkZXInICk7DQoNCiAgICAgICAgICAgICAgICAkLmVhY2goIHRoYXQucy5kdC5hb0NvbHVtbnMsIGZ1bmN0aW9uIChpLCBjb2x1bW4pIHsNCiAgICAgICAgICAgICAgICAgICAgJChjb2x1bW4ublRoKS5yZW1vdmVBdHRyKCdkYXRhLWNvbHVtbi1pbmRleCcpOw0KICAgICAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgICAgIHRoYXQucy5kdC5fY29sUmVvcmRlciA9IG51bGw7DQogICAgICAgICAgICAgICAgdGhhdC5zID0gbnVsbDsNCiAgICAgICAgICAgIH0gKTsNCiAgICAgICAgfSwNCg0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBTZXQgdGhlIGNvbHVtbiBvcmRlciBmcm9tIGFuIGFycmF5DQogICAgICAgICAqICBAbWV0aG9kICBfZm5PcmRlckNvbHVtbnMNCiAgICAgICAgICogIEBwYXJhbSAgIGFycmF5IGEgQW4gYXJyYXkgb2YgaW50ZWdlcnMgd2hpY2ggZGljdGF0ZSB0aGUgY29sdW1uIG9yZGVyIHRoYXQgc2hvdWxkIGJlIGFwcGxpZWQNCiAgICAgICAgICogIEByZXR1cm5zIHZvaWQNCiAgICAgICAgICogIEBwcml2YXRlDQogICAgICAgICAqLw0KICAgICAgICAiX2ZuT3JkZXJDb2x1bW5zIjogZnVuY3Rpb24gKCBhICkNCiAgICAgICAgew0KICAgICAgICAgICAgdmFyIGNoYW5nZWQgPSBmYWxzZTsNCg0KICAgICAgICAgICAgaWYgKCBhLmxlbmd0aCAhPSB0aGlzLnMuZHQuYW9Db2x1bW5zLmxlbmd0aCApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgdGhpcy5zLmR0Lm9JbnN0YW5jZS5vQXBpLl9mbkxvZyggdGhpcy5zLmR0LCAxLCAiQ29sUmVvcmRlciAtIGFycmF5IHJlb3JkZXIgZG9lcyBub3QgIisNCiAgICAgICAgICAgICAgICAgICAgIm1hdGNoIGtub3duIG51bWJlciBvZiBjb2x1bW5zLiBTa2lwcGluZy4iICk7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBmb3IgKCB2YXIgaT0wLCBpTGVuPWEubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICB2YXIgY3VyckluZGV4ID0gJC5pbkFycmF5KCBpLCBhICk7DQogICAgICAgICAgICAgICAgaWYgKCBpICE9IGN1cnJJbmRleCApDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAvKiBSZW9yZGVyIG91ciBzd2l0Y2hpbmcgYXJyYXkgKi8NCiAgICAgICAgICAgICAgICAgICAgZm5BcnJheVN3aXRjaCggYSwgY3VyckluZGV4LCBpICk7DQoNCiAgICAgICAgICAgICAgICAgICAgLyogRG8gdGhlIGNvbHVtbiByZW9yZGVyIGluIHRoZSB0YWJsZSAqLw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnMuZHQub0luc3RhbmNlLmZuQ29sUmVvcmRlciggY3VyckluZGV4LCBpLCB0cnVlLCBmYWxzZSApOw0KDQogICAgICAgICAgICAgICAgICAgIGNoYW5nZWQgPSB0cnVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgJC5mbi5kYXRhVGFibGUuQXBpKCB0aGlzLnMuZHQgKS5yb3dzKCkuaW52YWxpZGF0ZSgpOw0KDQogICAgICAgICAgICB0aGlzLl9mblNldENvbHVtbkluZGV4ZXMoKTsNCg0KICAgICAgICAgICAgLy8gSGFzIGFueXRoaW5nIGFjdHVhbGx5IGNoYW5nZWQ/IElmIG5vdCwgdGhlbiBub3RoaW5nIGVsc2UgdG8gZG8NCiAgICAgICAgICAgIGlmICggISBjaGFuZ2VkICkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLyogV2hlbiBzY3JvbGxpbmcgd2UgbmVlZCB0byByZWNhbGN1bGF0ZSB0aGUgY29sdW1uIHNpemVzIHRvIGFsbG93IGZvciB0aGUgc2hpZnQgKi8NCiAgICAgICAgICAgIGlmICggdGhpcy5zLmR0Lm9TY3JvbGwuc1ggIT09ICIiIHx8IHRoaXMucy5kdC5vU2Nyb2xsLnNZICE9PSAiIiApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgdGhpcy5zLmR0Lm9JbnN0YW5jZS5mbkFkanVzdENvbHVtblNpemluZyggZmFsc2UgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLyogU2F2ZSB0aGUgc3RhdGUgKi8NCiAgICAgICAgICAgIHRoaXMucy5kdC5vSW5zdGFuY2Uub0FwaS5fZm5TYXZlU3RhdGUoIHRoaXMucy5kdCApOw0KDQogICAgICAgICAgICBpZiAoIHRoaXMucy5yZW9yZGVyQ2FsbGJhY2sgIT09IG51bGwgKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHRoaXMucy5yZW9yZGVyQ2FsbGJhY2suY2FsbCggdGhpcyApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIEJlY2F1c2Ugd2UgY2hhbmdlIHRoZSBpbmRleGVzIG9mIGNvbHVtbnMgaW4gdGhlIHRhYmxlLCByZWxhdGl2ZSB0byB0aGVpciBzdGFydGluZyBwb2ludA0KICAgICAgICAgKiB3ZSBuZWVkIHRvIHJlb3JkZXIgdGhlIHN0YXRlIGNvbHVtbnMgdG8gd2hhdCB0aGV5IGFyZSBhdCB0aGUgc3RhcnRpbmcgcG9pbnQgc28gd2UgY2FuDQogICAgICAgICAqIHRoZW4gcmVhcnJhbmdlIHRoZW0gYWdhaW4gb24gc3RhdGUgbG9hZCENCiAgICAgICAgICogIEBtZXRob2QgIF9mblN0YXRlU2F2ZQ0KICAgICAgICAgKiAgQHBhcmFtICAgb2JqZWN0IG9TdGF0ZSBEYXRhVGFibGVzIHN0YXRlDQogICAgICAgICAqICBAcmV0dXJucyBzdHJpbmcgSlNPTiBlbmNvZGVkIGNvb2tpZSBzdHJpbmcgZm9yIERhdGFUYWJsZXMNCiAgICAgICAgICogIEBwcml2YXRlDQogICAgICAgICAqLw0KICAgICAgICAiX2ZuU3RhdGVTYXZlIjogZnVuY3Rpb24gKCBvU3RhdGUgKQ0KICAgICAgICB7DQogICAgICAgICAgICB2YXIgaSwgaUxlbiwgYUNvcHksIGlPcmlnQ29sdW1uOw0KICAgICAgICAgICAgdmFyIG9TZXR0aW5ncyA9IHRoaXMucy5kdDsNCiAgICAgICAgICAgIHZhciBjb2x1bW5zID0gb1NldHRpbmdzLmFvQ29sdW1uczsNCg0KICAgICAgICAgICAgb1N0YXRlLkNvbFJlb3JkZXIgPSBbXTsNCg0KICAgICAgICAgICAgLyogU29ydGluZyAqLw0KICAgICAgICAgICAgaWYgKCBvU3RhdGUuYWFTb3J0aW5nICkgew0KICAgICAgICAgICAgICAgIC8vIDEuMTAuMC0NCiAgICAgICAgICAgICAgICBmb3IgKCBpPTAgOyBpPG9TdGF0ZS5hYVNvcnRpbmcubGVuZ3RoIDsgaSsrICkgew0KICAgICAgICAgICAgICAgICAgICBvU3RhdGUuYWFTb3J0aW5nW2ldWzBdID0gY29sdW1uc1sgb1N0YXRlLmFhU29ydGluZ1tpXVswXSBdLl9Db2xSZW9yZGVyX2lPcmlnQ29sOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHZhciBhU2VhcmNoQ29weSA9ICQuZXh0ZW5kKCB0cnVlLCBbXSwgb1N0YXRlLmFvU2VhcmNoQ29scyApOw0KDQogICAgICAgICAgICAgICAgZm9yICggaT0wLCBpTGVuPWNvbHVtbnMubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGlPcmlnQ29sdW1uID0gY29sdW1uc1tpXS5fQ29sUmVvcmRlcl9pT3JpZ0NvbDsNCg0KICAgICAgICAgICAgICAgICAgICAvKiBDb2x1bW4gZmlsdGVyICovDQogICAgICAgICAgICAgICAgICAgIG9TdGF0ZS5hb1NlYXJjaENvbHNbIGlPcmlnQ29sdW1uIF0gPSBhU2VhcmNoQ29weVtpXTsNCg0KICAgICAgICAgICAgICAgICAgICAvKiBWaXNpYmlsaXR5ICovDQogICAgICAgICAgICAgICAgICAgIG9TdGF0ZS5hYlZpc0NvbHNbIGlPcmlnQ29sdW1uIF0gPSBjb2x1bW5zW2ldLmJWaXNpYmxlOw0KDQogICAgICAgICAgICAgICAgICAgIC8qIENvbHVtbiByZW9yZGVyaW5nICovDQogICAgICAgICAgICAgICAgICAgIG9TdGF0ZS5Db2xSZW9yZGVyLnB1c2goIGlPcmlnQ29sdW1uICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSBpZiAoIG9TdGF0ZS5vcmRlciApIHsNCiAgICAgICAgICAgICAgICAvLyAxLjEwLjErDQogICAgICAgICAgICAgICAgZm9yICggaT0wIDsgaTxvU3RhdGUub3JkZXIubGVuZ3RoIDsgaSsrICkgew0KICAgICAgICAgICAgICAgICAgICBvU3RhdGUub3JkZXJbaV1bMF0gPSBjb2x1bW5zWyBvU3RhdGUub3JkZXJbaV1bMF0gXS5fQ29sUmVvcmRlcl9pT3JpZ0NvbDsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB2YXIgc3RhdGVDb2x1bW5zQ29weSA9ICQuZXh0ZW5kKCB0cnVlLCBbXSwgb1N0YXRlLmNvbHVtbnMgKTsNCg0KICAgICAgICAgICAgICAgIGZvciAoIGk9MCwgaUxlbj1jb2x1bW5zLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBpT3JpZ0NvbHVtbiA9IGNvbHVtbnNbaV0uX0NvbFJlb3JkZXJfaU9yaWdDb2w7DQoNCiAgICAgICAgICAgICAgICAgICAgLyogQ29sdW1ucyAqLw0KICAgICAgICAgICAgICAgICAgICBvU3RhdGUuY29sdW1uc1sgaU9yaWdDb2x1bW4gXSA9IHN0YXRlQ29sdW1uc0NvcHlbaV07DQoNCiAgICAgICAgICAgICAgICAgICAgLyogQ29sdW1uIHJlb3JkZXJpbmcgKi8NCiAgICAgICAgICAgICAgICAgICAgb1N0YXRlLkNvbFJlb3JkZXIucHVzaCggaU9yaWdDb2x1bW4gKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCg0KICAgICAgICAvKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqDQogICAgICAgICAqIE1vdXNlIGRyb3AgYW5kIGRyYWcNCiAgICAgICAgICovDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIEFkZCBhIG1vdXNlIGRvd24gbGlzdGVuZXIgdG8gYSBwYXJ0aWNsdWFyIFRIIGVsZW1lbnQNCiAgICAgICAgICogIEBtZXRob2QgIF9mbk1vdXNlTGlzdGVuZXINCiAgICAgICAgICogIEBwYXJhbSAgIGludCBpIENvbHVtbiBpbmRleA0KICAgICAgICAgKiAgQHBhcmFtICAgZWxlbWVudCBuVGggVEggZWxlbWVudCBjbGlja2VkIG9uDQogICAgICAgICAqICBAcmV0dXJucyB2b2lkDQogICAgICAgICAqICBAcHJpdmF0ZQ0KICAgICAgICAgKi8NCiAgICAgICAgIl9mbk1vdXNlTGlzdGVuZXIiOiBmdW5jdGlvbiAoIGksIG5UaCApDQogICAgICAgIHsNCiAgICAgICAgICAgIC8qDQogICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7DQogICAgICAgICAgICAkKG5UaCkNCiAgICAgICAgICAgICAgICAub24oICdtb3VzZWRvd24uQ29sUmVvcmRlcicsIGZ1bmN0aW9uIChlKSB7DQogICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhhdC5fZm5Nb3VzZURvd24uY2FsbCggdGhhdCwgZSwgblRoICk7DQogICAgICAgICAgICAgICAgfSApDQogICAgICAgICAgICAgICAgLm9uKCAndG91Y2hzdGFydC5Db2xSZW9yZGVyJywgZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhhdC5fZm5Nb3VzZURvd24uY2FsbCggdGhhdCwgZSwgblRoICk7DQogICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgICAgICovDQogICAgICAgIH0sDQoNCg0KICAgICAgICAvKioNCiAgICAgICAgICogTW91c2UgZG93biBvbiBhIFRIIGVsZW1lbnQgaW4gdGhlIHRhYmxlIGhlYWRlcg0KICAgICAgICAgKiAgQG1ldGhvZCAgX2ZuTW91c2VEb3duDQogICAgICAgICAqICBAcGFyYW0gICBldmVudCBlIE1vdXNlIGV2ZW50DQogICAgICAgICAqICBAcGFyYW0gICBlbGVtZW50IG5UaCBUSCBlbGVtZW50IHRvIGJlIGRyYWdnZWQNCiAgICAgICAgICogIEByZXR1cm5zIHZvaWQNCiAgICAgICAgICogIEBwcml2YXRlDQogICAgICAgICAqLw0KICAgICAgICAiX2ZuTW91c2VEb3duIjogZnVuY3Rpb24gKCBlLCBuVGggKQ0KICAgICAgICB7DQogICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7DQoNCiAgICAgICAgICAgIC8qIFN0b3JlIGluZm9ybWF0aW9uIGFib3V0IHRoZSBtb3VzZSBwb3NpdGlvbiAqLw0KICAgICAgICAgICAgdmFyIHRhcmdldCA9ICQoZS50YXJnZXQpLmNsb3Nlc3QoJ3RoLCB0ZCcpOw0KICAgICAgICAgICAgdmFyIG9mZnNldCA9IHRhcmdldC5vZmZzZXQoKTsNCiAgICAgICAgICAgIHZhciBpZHggPSBwYXJzZUludCggJChuVGgpLmF0dHIoJ2RhdGEtY29sdW1uLWluZGV4JyksIDEwICk7DQoNCiAgICAgICAgICAgIGlmICggaWR4ID09PSB1bmRlZmluZWQgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLnMubW91c2Uuc3RhcnRYID0gdGhpcy5fZm5DdXJzb3JQb3NpdGlvbiggZSwgJ3BhZ2VYJyApOw0KICAgICAgICAgICAgdGhpcy5zLm1vdXNlLnN0YXJ0WSA9IHRoaXMuX2ZuQ3Vyc29yUG9zaXRpb24oIGUsICdwYWdlWScgKTsNCiAgICAgICAgICAgIHRoaXMucy5tb3VzZS5vZmZzZXRYID0gdGhpcy5fZm5DdXJzb3JQb3NpdGlvbiggZSwgJ3BhZ2VYJyApIC0gb2Zmc2V0LmxlZnQ7DQogICAgICAgICAgICB0aGlzLnMubW91c2Uub2Zmc2V0WSA9IHRoaXMuX2ZuQ3Vyc29yUG9zaXRpb24oIGUsICdwYWdlWScgKSAtIG9mZnNldC50b3A7DQogICAgICAgICAgICB0aGlzLnMubW91c2UudGFyZ2V0ID0gdGhpcy5zLmR0LmFvQ29sdW1uc1sgaWR4IF0ublRoOy8vdGFyZ2V0WzBdOw0KICAgICAgICAgICAgdGhpcy5zLm1vdXNlLnRhcmdldEluZGV4ID0gaWR4Ow0KICAgICAgICAgICAgdGhpcy5zLm1vdXNlLmZyb21JbmRleCA9IGlkeDsNCg0KICAgICAgICAgICAgdGhpcy5fZm5SZWdpb25zKCk7DQoNCiAgICAgICAgICAgIC8qIEFkZCBldmVudCBoYW5kbGVycyB0byB0aGUgZG9jdW1lbnQgKi8NCiAgICAgICAgICAgICQoZG9jdW1lbnQpDQogICAgICAgICAgICAgICAgLm9uKCAnbW91c2Vtb3ZlLkNvbFJlb3JkZXIgdG91Y2htb3ZlLkNvbFJlb3JkZXInLCBmdW5jdGlvbiAoZSkgew0KICAgICAgICAgICAgICAgICAgICB0aGF0Ll9mbk1vdXNlTW92ZS5jYWxsKCB0aGF0LCBlICk7DQogICAgICAgICAgICAgICAgfSApDQogICAgICAgICAgICAgICAgLm9uKCAnbW91c2V1cC5Db2xSZW9yZGVyIHRvdWNoZW5kLkNvbFJlb3JkZXInLCBmdW5jdGlvbiAoZSkgew0KICAgICAgICAgICAgICAgICAgICB0aGF0Ll9mbk1vdXNlVXAuY2FsbCggdGhhdCwgZSApOw0KICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgfSwNCg0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBEZWFsIHdpdGggYSBtb3VzZSBtb3ZlIGV2ZW50IHdoaWxlIGRyYWdnaW5nIGEgbm9kZQ0KICAgICAgICAgKiAgQG1ldGhvZCAgX2ZuTW91c2VNb3ZlDQogICAgICAgICAqICBAcGFyYW0gICBldmVudCBlIE1vdXNlIGV2ZW50DQogICAgICAgICAqICBAcmV0dXJucyB2b2lkDQogICAgICAgICAqICBAcHJpdmF0ZQ0KICAgICAgICAgKi8NCiAgICAgICAgIl9mbk1vdXNlTW92ZSI6IGZ1bmN0aW9uICggZSApDQogICAgICAgIHsNCiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpczsNCg0KICAgICAgICAgICAgaWYgKCB0aGlzLmRvbS5kcmFnID09PSBudWxsICkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAvKiBPbmx5IGNyZWF0ZSB0aGUgZHJhZyBlbGVtZW50IGlmIHRoZSBtb3VzZSBoYXMgbW92ZWQgYSBzcGVjaWZpYyBkaXN0YW5jZSBmcm9tIHRoZSBzdGFydA0KICAgICAgICAgICAgICAgICAqIHBvaW50IC0gdGhpcyBhbGxvd3MgdGhlIHVzZXIgdG8gbWFrZSBzbWFsbCBtb3VzZSBtb3ZlbWVudHMgd2hlbiBzb3J0aW5nIGFuZCBub3QgaGF2ZSBhDQogICAgICAgICAgICAgICAgICogcG9zc2libHkgY29uZnVzaW5nIGRyYWcgZWxlbWVudCBzaG93aW5nIHVwDQogICAgICAgICAgICAgICAgICovDQogICAgICAgICAgICAgICAgaWYgKCBNYXRoLnBvdygNCiAgICAgICAgICAgICAgICAgICAgICAgIE1hdGgucG93KHRoaXMuX2ZuQ3Vyc29yUG9zaXRpb24oIGUsICdwYWdlWCcpIC0gdGhpcy5zLm1vdXNlLnN0YXJ0WCwgMikgKw0KICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5wb3codGhpcy5fZm5DdXJzb3JQb3NpdGlvbiggZSwgJ3BhZ2VZJykgLSB0aGlzLnMubW91c2Uuc3RhcnRZLCAyKSwgMC41ICkgPCA1ICkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdGhpcy5fZm5DcmVhdGVEcmFnTm9kZSgpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvKiBQb3NpdGlvbiB0aGUgZWxlbWVudCAtIHdlIHJlc3BlY3Qgd2hlcmUgaW4gdGhlIGVsZW1lbnQgdGhlIGNsaWNrIG9jY3VyZWQgKi8NCiAgICAgICAgICAgIHRoaXMuZG9tLmRyYWcuY3NzKCB7DQogICAgICAgICAgICAgICAgbGVmdDogdGhpcy5fZm5DdXJzb3JQb3NpdGlvbiggZSwgJ3BhZ2VYJyApIC0gdGhpcy5zLm1vdXNlLm9mZnNldFgsDQogICAgICAgICAgICAgICAgdG9wOiB0aGlzLl9mbkN1cnNvclBvc2l0aW9uKCBlLCAncGFnZVknICkgLSB0aGlzLnMubW91c2Uub2Zmc2V0WQ0KICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICAvKiBCYXNlZCBvbiB0aGUgY3VycmVudCBtb3VzZSBwb3NpdGlvbiwgY2FsY3VsYXRlIHdoZXJlIHRoZSBpbnNlcnQgc2hvdWxkIGdvICovDQogICAgICAgICAgICB2YXIgYlNldCA9IGZhbHNlOw0KICAgICAgICAgICAgdmFyIGxhc3RUb0luZGV4ID0gdGhpcy5zLm1vdXNlLnRvSW5kZXg7DQoNCiAgICAgICAgICAgIGZvciAoIHZhciBpPTEsIGlMZW49dGhpcy5zLmFvVGFyZ2V0cy5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlmICggdGhpcy5fZm5DdXJzb3JQb3NpdGlvbihlLCAncGFnZVgnKSA8IHRoaXMucy5hb1RhcmdldHNbaS0xXS54ICsgKCh0aGlzLnMuYW9UYXJnZXRzW2ldLngtdGhpcy5zLmFvVGFyZ2V0c1tpLTFdLngpLzIpICkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZG9tLnBvaW50ZXIuY3NzKCAnbGVmdCcsIHRoaXMucy5hb1RhcmdldHNbaS0xXS54ICk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucy5tb3VzZS50b0luZGV4ID0gdGhpcy5zLmFvVGFyZ2V0c1tpLTFdLnRvOw0KICAgICAgICAgICAgICAgICAgICBiU2V0ID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBUaGUgaW5zZXJ0IGVsZW1lbnQgd2Fzbid0IHBvc2l0aW9uZWQgaW4gdGhlIGFycmF5IChsZXNzIHRoYW4NCiAgICAgICAgICAgIC8vIG9wZXJhdG9yKSwgc28gd2UgcHV0IGl0IGF0IHRoZSBlbmQNCiAgICAgICAgICAgIGlmICggIWJTZXQgKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHRoaXMuZG9tLnBvaW50ZXIuY3NzKCAnbGVmdCcsIHRoaXMucy5hb1RhcmdldHNbdGhpcy5zLmFvVGFyZ2V0cy5sZW5ndGgtMV0ueCApOw0KICAgICAgICAgICAgICAgIHRoaXMucy5tb3VzZS50b0luZGV4ID0gdGhpcy5zLmFvVGFyZ2V0c1t0aGlzLnMuYW9UYXJnZXRzLmxlbmd0aC0xXS50bzsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gUGVyZm9ybSByZW9yZGVyaW5nIGlmIHJlYWx0aW1lIHVwZGF0aW5nIGlzIG9uIGFuZCB0aGUgY29sdW1uIGhhcyBtb3ZlZA0KICAgICAgICAgICAgaWYgKCB0aGlzLnMuaW5pdC5iUmVhbHRpbWUgJiYgbGFzdFRvSW5kZXggIT09IHRoaXMucy5tb3VzZS50b0luZGV4ICkgew0KICAgICAgICAgICAgICAgIHRoaXMucy5kdC5vSW5zdGFuY2UuZm5Db2xSZW9yZGVyKCB0aGlzLnMubW91c2UuZnJvbUluZGV4LCB0aGlzLnMubW91c2UudG9JbmRleCwgZmFsc2UgKTsNCiAgICAgICAgICAgICAgICB0aGlzLnMubW91c2UuZnJvbUluZGV4ID0gdGhpcy5zLm1vdXNlLnRvSW5kZXg7DQogICAgICAgICAgICAgICAgdGhpcy5fZm5SZWdpb25zKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCg0KICAgICAgICAvKioNCiAgICAgICAgICogRmluaXNoIG9mZiB0aGUgbW91c2UgZHJhZyBhbmQgaW5zZXJ0IHRoZSBjb2x1bW4gd2hlcmUgbmVlZGVkDQogICAgICAgICAqICBAbWV0aG9kICBfZm5Nb3VzZVVwDQogICAgICAgICAqICBAcGFyYW0gICBldmVudCBlIE1vdXNlIGV2ZW50DQogICAgICAgICAqICBAcmV0dXJucyB2b2lkDQogICAgICAgICAqICBAcHJpdmF0ZQ0KICAgICAgICAgKi8NCiAgICAgICAgIl9mbk1vdXNlVXAiOiBmdW5jdGlvbiAoIGUgKQ0KICAgICAgICB7DQogICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7DQoNCiAgICAgICAgICAgICQoZG9jdW1lbnQpLm9mZiggJy5Db2xSZW9yZGVyJyApOw0KDQogICAgICAgICAgICBpZiAoIHRoaXMuZG9tLmRyYWcgIT09IG51bGwgKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIC8qIFJlbW92ZSB0aGUgZ3VpZGUgZWxlbWVudHMgKi8NCiAgICAgICAgICAgICAgICB0aGlzLmRvbS5kcmFnLnJlbW92ZSgpOw0KICAgICAgICAgICAgICAgIHRoaXMuZG9tLnBvaW50ZXIucmVtb3ZlKCk7DQogICAgICAgICAgICAgICAgdGhpcy5kb20uZHJhZyA9IG51bGw7DQogICAgICAgICAgICAgICAgdGhpcy5kb20ucG9pbnRlciA9IG51bGw7DQoNCiAgICAgICAgICAgICAgICAvKiBBY3R1YWxseSBkbyB0aGUgcmVvcmRlciAqLw0KICAgICAgICAgICAgICAgIHRoaXMucy5kdC5vSW5zdGFuY2UuZm5Db2xSZW9yZGVyKCB0aGlzLnMubW91c2UuZnJvbUluZGV4LCB0aGlzLnMubW91c2UudG9JbmRleCwgdHJ1ZSApOw0KICAgICAgICAgICAgICAgIHRoaXMuX2ZuU2V0Q29sdW1uSW5kZXhlcygpOw0KDQogICAgICAgICAgICAgICAgLyogV2hlbiBzY3JvbGxpbmcgd2UgbmVlZCB0byByZWNhbGN1bGF0ZSB0aGUgY29sdW1uIHNpemVzIHRvIGFsbG93IGZvciB0aGUgc2hpZnQgKi8NCiAgICAgICAgICAgICAgICBpZiAoIHRoaXMucy5kdC5vU2Nyb2xsLnNYICE9PSAiIiB8fCB0aGlzLnMuZHQub1Njcm9sbC5zWSAhPT0gIiIgKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zLmR0Lm9JbnN0YW5jZS5mbkFkanVzdENvbHVtblNpemluZyggZmFsc2UgKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAvKiBTYXZlIHRoZSBzdGF0ZSAqLw0KICAgICAgICAgICAgICAgIHRoaXMucy5kdC5vSW5zdGFuY2Uub0FwaS5fZm5TYXZlU3RhdGUoIHRoaXMucy5kdCApOw0KDQogICAgICAgICAgICAgICAgaWYgKCB0aGlzLnMucmVvcmRlckNhbGxiYWNrICE9PSBudWxsICkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucy5yZW9yZGVyQ2FsbGJhY2suY2FsbCggdGhpcyApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBDYWxjdWxhdGUgYSBjYWNoZWQgYXJyYXkgd2l0aCB0aGUgcG9pbnRzIG9mIHRoZSBjb2x1bW4gaW5zZXJ0cywgYW5kIHRoZQ0KICAgICAgICAgKiAndG8nIHBvaW50cw0KICAgICAgICAgKiAgQG1ldGhvZCAgX2ZuUmVnaW9ucw0KICAgICAgICAgKiAgQHJldHVybnMgdm9pZA0KICAgICAgICAgKiAgQHByaXZhdGUNCiAgICAgICAgICovDQogICAgICAgICJfZm5SZWdpb25zIjogZnVuY3Rpb24gKCkNCiAgICAgICAgew0KICAgICAgICAgICAgdmFyIGFvQ29sdW1ucyA9IHRoaXMucy5kdC5hb0NvbHVtbnM7DQoNCiAgICAgICAgICAgIHRoaXMucy5hb1RhcmdldHMuc3BsaWNlKCAwLCB0aGlzLnMuYW9UYXJnZXRzLmxlbmd0aCApOw0KDQogICAgICAgICAgICB0aGlzLnMuYW9UYXJnZXRzLnB1c2goIHsNCiAgICAgICAgICAgICAgICAieCI6ICAkKHRoaXMucy5kdC5uVGFibGUpLm9mZnNldCgpLmxlZnQsDQogICAgICAgICAgICAgICAgInRvIjogMA0KICAgICAgICAgICAgfSApOw0KDQogICAgICAgICAgICB2YXIgaVRvUG9pbnQgPSAwOw0KICAgICAgICAgICAgdmFyIHRvdGFsID0gdGhpcy5zLmFvVGFyZ2V0c1swXS54Ow0KDQogICAgICAgICAgICBmb3IgKCB2YXIgaT0wLCBpTGVuPWFvQ29sdW1ucy5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIC8qIEZvciB0aGUgY29sdW1uIC8gaGVhZGVyIGluIHF1ZXN0aW9uLCB3ZSB3YW50IGl0J3MgcG9zaXRpb24gdG8gcmVtYWluIHRoZSBzYW1lIGlmIHRoZQ0KICAgICAgICAgICAgICAgICAqIHBvc2l0aW9uIGlzIGp1c3QgdG8gaXQncyBpbW1lZGlhdGUgbGVmdCBvciByaWdodCwgc28gd2Ugb25seSBpbmNyZW1lbnQgdGhlIGNvdW50ZXIgZm9yDQogICAgICAgICAgICAgICAgICogb3RoZXIgY29sdW1ucw0KICAgICAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgICAgIGlmICggaSAhPSB0aGlzLnMubW91c2UuZnJvbUluZGV4ICkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGlUb1BvaW50Kys7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgaWYgKCBhb0NvbHVtbnNbaV0uYlZpc2libGUgJiYgYW9Db2x1bW5zW2ldLm5UaC5zdHlsZS5kaXNwbGF5ICE9PSdub25lJyApDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICB0b3RhbCArPSAkKGFvQ29sdW1uc1tpXS5uVGgpLm91dGVyV2lkdGgoKTsNCg0KICAgICAgICAgICAgICAgICAgICB0aGlzLnMuYW9UYXJnZXRzLnB1c2goIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJ4IjogIHRvdGFsLA0KICAgICAgICAgICAgICAgICAgICAgICAgInRvIjogaVRvUG9pbnQNCiAgICAgICAgICAgICAgICAgICAgfSApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLyogRGlzYWxsb3cgY29sdW1ucyBmb3IgYmVpbmcgcmVvcmRlcmVkIGJ5IGRyYWcgYW5kIGRyb3AsIGNvdW50aW5nIHJpZ2h0IHRvIGxlZnQgKi8NCiAgICAgICAgICAgIGlmICggdGhpcy5zLmZpeGVkUmlnaHQgIT09IDAgKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHRoaXMucy5hb1RhcmdldHMuc3BsaWNlKCB0aGlzLnMuYW9UYXJnZXRzLmxlbmd0aCAtIHRoaXMucy5maXhlZFJpZ2h0ICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8qIERpc2FsbG93IGNvbHVtbnMgZm9yIGJlaW5nIHJlb3JkZXJlZCBieSBkcmFnIGFuZCBkcm9wLCBjb3VudGluZyBsZWZ0IHRvIHJpZ2h0ICovDQogICAgICAgICAgICBpZiAoIHRoaXMucy5maXhlZCAhPT0gMCApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgdGhpcy5zLmFvVGFyZ2V0cy5zcGxpY2UoIDAsIHRoaXMucy5maXhlZCApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIENvcHkgdGhlIFRIIGVsZW1lbnQgdGhhdCBpcyBiZWluZyBkcmFncyBzbyB0aGUgdXNlciBoYXMgdGhlIGlkZWEgdGhhdCB0aGV5IGFyZSBhY3R1YWxseQ0KICAgICAgICAgKiBtb3ZpbmcgaXQgYXJvdW5kIHRoZSBwYWdlLg0KICAgICAgICAgKiAgQG1ldGhvZCAgX2ZuQ3JlYXRlRHJhZ05vZGUNCiAgICAgICAgICogIEByZXR1cm5zIHZvaWQNCiAgICAgICAgICogIEBwcml2YXRlDQogICAgICAgICAqLw0KICAgICAgICAiX2ZuQ3JlYXRlRHJhZ05vZGUiOiBmdW5jdGlvbiAoKQ0KICAgICAgICB7DQogICAgICAgICAgICB2YXIgc2Nyb2xsaW5nID0gdGhpcy5zLmR0Lm9TY3JvbGwuc1ggIT09ICIiIHx8IHRoaXMucy5kdC5vU2Nyb2xsLnNZICE9PSAiIjsNCg0KICAgICAgICAgICAgdmFyIG9yaWdDZWxsID0gdGhpcy5zLmR0LmFvQ29sdW1uc1sgdGhpcy5zLm1vdXNlLnRhcmdldEluZGV4IF0ublRoOw0KICAgICAgICAgICAgdmFyIG9yaWdUciA9IG9yaWdDZWxsLnBhcmVudE5vZGU7DQogICAgICAgICAgICB2YXIgb3JpZ1RoZWFkID0gb3JpZ1RyLnBhcmVudE5vZGU7DQogICAgICAgICAgICB2YXIgb3JpZ1RhYmxlID0gb3JpZ1RoZWFkLnBhcmVudE5vZGU7DQogICAgICAgICAgICB2YXIgY2xvbmVDZWxsID0gJChvcmlnQ2VsbCkuY2xvbmUoKTsNCg0KICAgICAgICAgICAgLy8gVGhpcyBpcyBhIHNsaWdodGx5IG9kZCBjb21iaW5hdGlvbiBvZiBqUXVlcnkgYW5kIERPTSwgYnV0IGl0IGlzIHRoZQ0KICAgICAgICAgICAgLy8gZmFzdGVzdCBhbmQgbGVhc3QgcmVzb3VyY2UgaW50ZW5zaXZlIHdheSBJIGNvdWxkIHRoaW5rIG9mIGNsb25pbmcNCiAgICAgICAgICAgIC8vIHRoZSB0YWJsZSB3aXRoIGp1c3QgYSBzaW5nbGUgaGVhZGVyIGNlbGwgaW4gaXQuDQogICAgICAgICAgICB0aGlzLmRvbS5kcmFnID0gJChvcmlnVGFibGUuY2xvbmVOb2RlKGZhbHNlKSkNCiAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoICdEVENSX2Nsb25lZFRhYmxlJyApDQogICAgICAgICAgICAgICAgLmFwcGVuZCgNCiAgICAgICAgICAgICAgICAgICAgJChvcmlnVGhlYWQuY2xvbmVOb2RlKGZhbHNlKSkuYXBwZW5kKA0KICAgICAgICAgICAgICAgICAgICAgICAgJChvcmlnVHIuY2xvbmVOb2RlKGZhbHNlKSkuYXBwZW5kKA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb25lQ2VsbFswXQ0KICAgICAgICAgICAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgICAgICAgICApDQogICAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgICAgIC5jc3MoIHsNCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsDQogICAgICAgICAgICAgICAgICAgIHRvcDogMCwNCiAgICAgICAgICAgICAgICAgICAgbGVmdDogMCwNCiAgICAgICAgICAgICAgICAgICAgd2lkdGg6ICQob3JpZ0NlbGwpLm91dGVyV2lkdGgoKSwNCiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAkKG9yaWdDZWxsKS5vdXRlckhlaWdodCgpDQogICAgICAgICAgICAgICAgfSApDQogICAgICAgICAgICAgICAgLmFwcGVuZFRvKCAnYm9keScgKTsNCg0KICAgICAgICAgICAgdGhpcy5kb20ucG9pbnRlciA9ICQoJzxkaXY+PC9kaXY+JykNCiAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoICdEVENSX3BvaW50ZXInICkNCiAgICAgICAgICAgICAgICAuY3NzKCB7DQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLA0KICAgICAgICAgICAgICAgICAgICB0b3A6IHNjcm9sbGluZyA/DQogICAgICAgICAgICAgICAgICAgICAgICAkKCdkaXYuZGF0YVRhYmxlc19zY3JvbGwnLCB0aGlzLnMuZHQublRhYmxlV3JhcHBlcikub2Zmc2V0KCkudG9wIDoNCiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcy5zLmR0Lm5UYWJsZSkub2Zmc2V0KCkudG9wLA0KICAgICAgICAgICAgICAgICAgICBoZWlnaHQgOiBzY3JvbGxpbmcgPw0KICAgICAgICAgICAgICAgICAgICAgICAgJCgnZGl2LmRhdGFUYWJsZXNfc2Nyb2xsJywgdGhpcy5zLmR0Lm5UYWJsZVdyYXBwZXIpLmhlaWdodCgpIDoNCiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcy5zLmR0Lm5UYWJsZSkuaGVpZ2h0KCkNCiAgICAgICAgICAgICAgICB9ICkNCiAgICAgICAgICAgICAgICAuYXBwZW5kVG8oICdib2R5JyApOw0KICAgICAgICB9LA0KDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIEFkZCBhIGRhdGEgYXR0cmlidXRlIHRvIHRoZSBjb2x1bW4gaGVhZGVycywgc28gd2Uga25vdyB0aGUgaW5kZXggb2YNCiAgICAgICAgICogdGhlIHJvdyB0byBiZSByZW9yZGVyZWQuIFRoaXMgYWxsb3dzIGZhc3QgZGV0ZWN0aW9uIG9mIHRoZSBpbmRleCwgYW5kDQogICAgICAgICAqIGZvciB0aGlzIHBsdWctaW4gdG8gd29yayB3aXRoIEZpeGVkSGVhZGVyIHdoaWNoIGNsb25lcyB0aGUgbm9kZXMuDQogICAgICAgICAqICBAcHJpdmF0ZQ0KICAgICAgICAgKi8NCiAgICAgICAgIl9mblNldENvbHVtbkluZGV4ZXMiOiBmdW5jdGlvbiAoKQ0KICAgICAgICB7DQogICAgICAgICAgICAkLmVhY2goIHRoaXMucy5kdC5hb0NvbHVtbnMsIGZ1bmN0aW9uIChpLCBjb2x1bW4pIHsNCiAgICAgICAgICAgICAgICAkKGNvbHVtbi5uVGgpLmF0dHIoJ2RhdGEtY29sdW1uLWluZGV4JywgaSk7DQogICAgICAgICAgICB9ICk7DQogICAgICAgIH0sDQoNCg0KICAgICAgICAvKioNCiAgICAgICAgICogR2V0IGN1cnNvciBwb3NpdGlvbiByZWdhcmRsZXNzIG9mIG1vdXNlIG9yIHRvdWNoIGlucHV0DQogICAgICAgICAqIEBwYXJhbSAge0V2ZW50fSAgZSAgICBqUXVlcnkgRXZlbnQNCiAgICAgICAgICogQHBhcmFtICB7c3RyaW5nfSBwcm9wIFByb3BlcnR5IHRvIGdldA0KICAgICAgICAgKiBAcmV0dXJuIHtudW1iZXJ9ICAgICAgVmFsdWUNCiAgICAgICAgICovDQogICAgICAgIF9mbkN1cnNvclBvc2l0aW9uOiBmdW5jdGlvbiAoIGUsIHByb3AgKSB7DQogICAgICAgICAgICBpZiAoIGUudHlwZS5pbmRleE9mKCd0b3VjaCcpICE9PSAtMSApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gZS5vcmlnaW5hbEV2ZW50LnRvdWNoZXNbMF1bIHByb3AgXTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBlWyBwcm9wIF07DQogICAgICAgIH0NCiAgICB9ICk7DQoNCg0KDQoNCg0KICAgIC8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKg0KICAgICAqIFN0YXRpYyBwYXJhbWV0ZXJzDQogICAgICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqLw0KDQoNCiAgICAvKioNCiAgICAgKiBDb2xSZW9yZGVyIGRlZmF1bHQgc2V0dGluZ3MgZm9yIGluaXRpYWxpc2F0aW9uDQogICAgICogIEBuYW1lc3BhY2UNCiAgICAgKiAgQHN0YXRpYw0KICAgICAqLw0KICAgIENvbFJlb3JkZXIuZGVmYXVsdHMgPSB7DQogICAgICAgIC8qKg0KICAgICAgICAgKiBQcmVkZWZpbmVkIG9yZGVyaW5nIGZvciB0aGUgY29sdW1ucyB0aGF0IHdpbGwgYmUgYXBwbGllZCBhdXRvbWF0aWNhbGx5DQogICAgICAgICAqIG9uIGluaXRpYWxpc2F0aW9uLiBJZiBub3Qgc3BlY2lmaWVkIHRoZW4gdGhlIG9yZGVyIHRoYXQgdGhlIGNvbHVtbnMgYXJlDQogICAgICAgICAqIGZvdW5kIHRvIGJlIGluIHRoZSBIVE1MIGlzIHRoZSBvcmRlciB1c2VkLg0KICAgICAgICAgKiAgQHR5cGUgYXJyYXkNCiAgICAgICAgICogIEBkZWZhdWx0IG51bGwNCiAgICAgICAgICogIEBzdGF0aWMNCiAgICAgICAgICovDQogICAgICAgIGFpT3JkZXI6IG51bGwsDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIFJlZHJhdyB0aGUgdGFibGUncyBjb2x1bW4gb3JkZXJpbmcgYXMgdGhlIGVuZCB1c2VyIGRyYXdzIHRoZSBjb2x1bW4NCiAgICAgICAgICogKGB0cnVlYCkgb3Igd2FpdCB1bnRpbCB0aGUgbW91c2UgaXMgcmVsZWFzZWQgKGBmYWxzZWAgLSBkZWZhdWx0KS4gTm90ZQ0KICAgICAgICAgKiB0aGF0IHRoaXMgd2lsbCBwZXJmb3JtIGEgcmVkcmF3IG9uIGVhY2ggcmVvcmRlcmluZywgd2hpY2ggaW52b2x2ZXMgYW4NCiAgICAgICAgICogQWpheCByZXF1ZXN0IGVhY2ggdGltZSBpZiB5b3UgYXJlIHVzaW5nIHNlcnZlci1zaWRlIHByb2Nlc3NpbmcgaW4NCiAgICAgICAgICogRGF0YVRhYmxlcy4NCiAgICAgICAgICogIEB0eXBlIGJvb2xlYW4NCiAgICAgICAgICogIEBkZWZhdWx0IGZhbHNlDQogICAgICAgICAqICBAc3RhdGljDQogICAgICAgICAqLw0KICAgICAgICBiUmVhbHRpbWU6IHRydWUsDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIEluZGljYXRlIGhvdyBtYW55IGNvbHVtbnMgc2hvdWxkIGJlIGZpeGVkIGluIHBvc2l0aW9uIChjb3VudGluZyBmcm9tIHRoZQ0KICAgICAgICAgKiBsZWZ0KS4gVGhpcyB3aWxsIHR5cGljYWxseSBiZSAxIGlmIHVzZWQsIGJ1dCBjYW4gYmUgYXMgaGlnaCBhcyB5b3UgbGlrZS4NCiAgICAgICAgICogIEB0eXBlIGludA0KICAgICAgICAgKiAgQGRlZmF1bHQgMA0KICAgICAgICAgKiAgQHN0YXRpYw0KICAgICAgICAgKi8NCiAgICAgICAgaUZpeGVkQ29sdW1uc0xlZnQ6IDAsDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIEFzIGBpRml4ZWRDb2x1bW5zUmlnaHRgIGJ1dCBjb3VudGluZyBmcm9tIHRoZSByaWdodC4NCiAgICAgICAgICogIEB0eXBlIGludA0KICAgICAgICAgKiAgQGRlZmF1bHQgMA0KICAgICAgICAgKiAgQHN0YXRpYw0KICAgICAgICAgKi8NCiAgICAgICAgaUZpeGVkQ29sdW1uc1JpZ2h0OiAwLA0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBDYWxsYmFjayBmdW5jdGlvbiB0aGF0IGlzIGZpcmVkIHdoZW4gY29sdW1ucyBhcmUgcmVvcmRlcmVkLiBUaGUgYGNvbHVtbi0NCiAgICAgICAgICogcmVvcmRlcmAgZXZlbnQgaXMgcHJlZmVycmVkIG92ZXIgdGhpcyBjYWxsYmFjaw0KICAgICAgICAgKiAgQHR5cGUgZnVuY3Rpb24oKTp2b2lkDQogICAgICAgICAqICBAZGVmYXVsdCBudWxsDQogICAgICAgICAqICBAc3RhdGljDQogICAgICAgICAqLw0KICAgICAgICBmblJlb3JkZXJDYWxsYmFjazogbnVsbA0KICAgIH07DQoNCg0KDQogICAgLyogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqDQogICAgICogQ29uc3RhbnRzDQogICAgICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqLw0KDQogICAgLyoqDQogICAgICogQ29sUmVvcmRlciB2ZXJzaW9uDQogICAgICogIEBjb25zdGFudCAgdmVyc2lvbg0KICAgICAqICBAdHlwZSAgICAgIFN0cmluZw0KICAgICAqICBAZGVmYXVsdCAgIEFzIGNvZGUNCiAgICAgKi8NCiAgICBDb2xSZW9yZGVyLnZlcnNpb24gPSAiMS4zLjMiOw0KDQoNCg0KICAgIC8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKg0KICAgICAqIERhdGFUYWJsZXMgaW50ZXJmYWNlcw0KICAgICAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKi8NCg0KLy8gRXhwb3NlDQogICAgJC5mbi5kYXRhVGFibGUuQ29sUmVvcmRlciA9IENvbFJlb3JkZXI7DQogICAgJC5mbi5EYXRhVGFibGUuQ29sUmVvcmRlciA9IENvbFJlb3JkZXI7DQoNCg0KLy8gUmVnaXN0ZXIgYSBuZXcgZmVhdHVyZSB3aXRoIERhdGFUYWJsZXMNCiAgICBpZiAoIHR5cGVvZiAkLmZuLmRhdGFUYWJsZSA9PSAiZnVuY3Rpb24iICYmDQogICAgICAgIHR5cGVvZiAkLmZuLmRhdGFUYWJsZUV4dC5mblZlcnNpb25DaGVjayA9PSAiZnVuY3Rpb24iICYmDQogICAgICAgICQuZm4uZGF0YVRhYmxlRXh0LmZuVmVyc2lvbkNoZWNrKCcxLjEwLjgnKSApDQogICAgew0KICAgICAgICAkLmZuLmRhdGFUYWJsZUV4dC5hb0ZlYXR1cmVzLnB1c2goIHsNCiAgICAgICAgICAgICJmbkluaXQiOiBmdW5jdGlvbiggc2V0dGluZ3MgKSB7DQogICAgICAgICAgICAgICAgdmFyIHRhYmxlID0gc2V0dGluZ3Mub0luc3RhbmNlOw0KDQogICAgICAgICAgICAgICAgaWYgKCAhIHNldHRpbmdzLl9jb2xSZW9yZGVyICkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgZHRJbml0ID0gc2V0dGluZ3Mub0luaXQ7DQogICAgICAgICAgICAgICAgICAgIHZhciBvcHRzID0gZHRJbml0LmNvbFJlb3JkZXIgfHwgZHRJbml0Lm9Db2xSZW9yZGVyIHx8IHt9Ow0KDQogICAgICAgICAgICAgICAgICAgIG5ldyBDb2xSZW9yZGVyKCBzZXR0aW5ncywgb3B0cyApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgdGFibGUub0FwaS5fZm5Mb2coIHNldHRpbmdzLCAxLCAiQ29sUmVvcmRlciBhdHRlbXB0ZWQgdG8gaW5pdGlhbGlzZSB0d2ljZS4gSWdub3Jpbmcgc2Vjb25kIiApOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHJldHVybiBudWxsOyAvKiBObyBub2RlIGZvciBEYXRhVGFibGVzIHRvIGluc2VydCAqLw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJjRmVhdHVyZSI6ICJSIiwNCiAgICAgICAgICAgICJzRmVhdHVyZSI6ICJDb2xSZW9yZGVyIg0KICAgICAgICB9ICk7DQogICAgfQ0KICAgIGVsc2Ugew0KICAgICAgICBhbGVydCggIldhcm5pbmc6IENvbFJlb3JkZXIgcmVxdWlyZXMgRGF0YVRhYmxlcyAxLjEwLjggb3IgZ3JlYXRlciAtIHd3dy5kYXRhdGFibGVzLm5ldC9kb3dubG9hZCIpOw0KICAgIH0NCg0KDQovLyBBdHRhY2ggYSBsaXN0ZW5lciB0byB0aGUgZG9jdW1lbnQgd2hpY2ggbGlzdGVucyBmb3IgRGF0YVRhYmxlcyBpbml0aWFsaXNhdGlvbg0KLy8gZXZlbnRzIHNvIHdlIGNhbiBhdXRvbWF0aWNhbGx5IGluaXRpYWxpc2UNCiAgICAkKGRvY3VtZW50KS5vbiggJ3ByZUluaXQuZHQuY29sUmVvcmRlcicsIGZ1bmN0aW9uIChlLCBzZXR0aW5ncykgew0KICAgICAgICBpZiAoIGUubmFtZXNwYWNlICE9PSAnZHQnICkgew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICAgICAgdmFyIGluaXQgPSBzZXR0aW5ncy5vSW5pdC5jb2xSZW9yZGVyOw0KICAgICAgICB2YXIgZGVmYXVsdHMgPSBEYXRhVGFibGUuZGVmYXVsdHMuY29sUmVvcmRlcjsNCg0KICAgICAgICBpZiAoIGluaXQgfHwgZGVmYXVsdHMgKSB7DQogICAgICAgICAgICB2YXIgb3B0cyA9ICQuZXh0ZW5kKCB7fSwgaW5pdCwgZGVmYXVsdHMgKTsNCg0KICAgICAgICAgICAgaWYgKCBpbml0ICE9PSBmYWxzZSApIHsNCiAgICAgICAgICAgICAgICBuZXcgQ29sUmVvcmRlciggc2V0dGluZ3MsIG9wdHMgICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9ICk7DQoNCg0KLy8gQVBJIGF1Z21lbnRhdGlvbg0KICAgICQuZm4uZGF0YVRhYmxlLkFwaS5yZWdpc3RlciggJ2NvbFJlb3JkZXIucmVzZXQoKScsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgcmV0dXJuIHRoaXMuaXRlcmF0b3IoICd0YWJsZScsIGZ1bmN0aW9uICggY3R4ICkgew0KICAgICAgICAgICAgY3R4Ll9jb2xSZW9yZGVyLmZuUmVzZXQoKTsNCiAgICAgICAgfSApOw0KICAgIH0gKTsNCg0KICAgICQuZm4uZGF0YVRhYmxlLkFwaS5yZWdpc3RlciggJ2NvbFJlb3JkZXIub3JkZXIoKScsIGZ1bmN0aW9uICggc2V0LCBvcmlnaW5hbCApIHsNCiAgICAgICAgaWYgKCBzZXQgKSB7DQogICAgICAgICAgICByZXR1cm4gdGhpcy5pdGVyYXRvciggJ3RhYmxlJywgZnVuY3Rpb24gKCBjdHggKSB7DQogICAgICAgICAgICAgICAgY3R4Ll9jb2xSZW9yZGVyLmZuT3JkZXIoIHNldCwgb3JpZ2luYWwgKTsNCiAgICAgICAgICAgIH0gKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQubGVuZ3RoID8NCiAgICAgICAgICAgIHRoaXMuY29udGV4dFswXS5fY29sUmVvcmRlci5mbk9yZGVyKCkgOg0KICAgICAgICAgICAgbnVsbDsNCiAgICB9ICk7DQoNCiAgICAkLmZuLmRhdGFUYWJsZS5BcGkucmVnaXN0ZXIoICdjb2xSZW9yZGVyLnRyYW5zcG9zZSgpJywgZnVuY3Rpb24gKCBpZHgsIGRpciApIHsNCiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dC5sZW5ndGggJiYgdGhpcy5jb250ZXh0WzBdLl9jb2xSZW9yZGVyID8NCiAgICAgICAgICAgIHRoaXMuY29udGV4dFswXS5fY29sUmVvcmRlci5mblRyYW5zcG9zZSggaWR4LCBkaXIgKSA6DQogICAgICAgICAgICBpZHg7DQogICAgfSApOw0KDQoNCiAgICByZXR1cm4gQ29sUmVvcmRlcjsNCn0pKTsKLyohDQogICBDb3B5cmlnaHQgMjAxNy0yMDE5IFNwcnlNZWRpYSBMdGQuDQoNCiBUaGlzIHNvdXJjZSBmaWxlIGlzIGZyZWUgc29mdHdhcmUsIGF2YWlsYWJsZSB1bmRlciB0aGUgZm9sbG93aW5nIGxpY2Vuc2U6DQogICBNSVQgbGljZW5zZSAtIGh0dHA6Ly9kYXRhdGFibGVzLm5ldC9saWNlbnNlL21pdA0KDQogVGhpcyBzb3VyY2UgZmlsZSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLCBidXQNCiBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mIE1FUkNIQU5UQUJJTElUWQ0KIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiBTZWUgdGhlIGxpY2Vuc2UgZmlsZXMgZm9yIGRldGFpbHMuDQoNCiBGb3IgZGV0YWlscyBwbGVhc2UgcmVmZXIgdG86IGh0dHA6Ly93d3cuZGF0YXRhYmxlcy5uZXQNCiBSb3dHcm91cCAxLjEuMQ0KIMKpMjAxNy0yMDE5IFNwcnlNZWRpYSBMdGQgLSBkYXRhdGFibGVzLm5ldC9saWNlbnNlDQoqLw0KdmFyICRqc2NvbXA9JGpzY29tcHx8e307JGpzY29tcC5zY29wZT17fTskanNjb21wLmZpbmRJbnRlcm5hbD1mdW5jdGlvbihhLGQsYyl7YSBpbnN0YW5jZW9mIFN0cmluZyYmKGE9U3RyaW5nKGEpKTtmb3IodmFyIGU9YS5sZW5ndGgsZj0wO2Y8ZTtmKyspe3ZhciBoPWFbZl07aWYoZC5jYWxsKGMsaCxmLGEpKXJldHVybntpOmYsdjpofX1yZXR1cm57aTotMSx2OnZvaWQgMH19OyRqc2NvbXAuQVNTVU1FX0VTNT0hMTskanNjb21wLkFTU1VNRV9OT19OQVRJVkVfTUFQPSExOyRqc2NvbXAuQVNTVU1FX05PX05BVElWRV9TRVQ9ITE7JGpzY29tcC5TSU1QTEVfRlJPVU5EX1BPTFlGSUxMPSExOw0KJGpzY29tcC5kZWZpbmVQcm9wZXJ0eT0kanNjb21wLkFTU1VNRV9FUzV8fCJmdW5jdGlvbiI9PXR5cGVvZiBPYmplY3QuZGVmaW5lUHJvcGVydGllcz9PYmplY3QuZGVmaW5lUHJvcGVydHk6ZnVuY3Rpb24oYSxkLGMpe2EhPUFycmF5LnByb3RvdHlwZSYmYSE9T2JqZWN0LnByb3RvdHlwZSYmKGFbZF09Yy52YWx1ZSl9OyRqc2NvbXAuZ2V0R2xvYmFsPWZ1bmN0aW9uKGEpe3JldHVybiJ1bmRlZmluZWQiIT10eXBlb2Ygd2luZG93JiZ3aW5kb3c9PT1hP2E6InVuZGVmaW5lZCIhPXR5cGVvZiBnbG9iYWwmJm51bGwhPWdsb2JhbD9nbG9iYWw6YX07JGpzY29tcC5nbG9iYWw9JGpzY29tcC5nZXRHbG9iYWwodGhpcyk7DQokanNjb21wLnBvbHlmaWxsPWZ1bmN0aW9uKGEsZCxjLGUpe2lmKGQpe2M9JGpzY29tcC5nbG9iYWw7YT1hLnNwbGl0KCIuIik7Zm9yKGU9MDtlPGEubGVuZ3RoLTE7ZSsrKXt2YXIgZj1hW2VdO2YgaW4gY3x8KGNbZl09e30pO2M9Y1tmXX1hPWFbYS5sZW5ndGgtMV07ZT1jW2FdO2Q9ZChlKTtkIT1lJiZudWxsIT1kJiYkanNjb21wLmRlZmluZVByb3BlcnR5KGMsYSx7Y29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwLHZhbHVlOmR9KX19OyRqc2NvbXAucG9seWZpbGwoIkFycmF5LnByb3RvdHlwZS5maW5kIixmdW5jdGlvbihhKXtyZXR1cm4gYT9hOmZ1bmN0aW9uKGEsYyl7cmV0dXJuICRqc2NvbXAuZmluZEludGVybmFsKHRoaXMsYSxjKS52fX0sImVzNiIsImVzMyIpOw0KKGZ1bmN0aW9uKGEpeyJmdW5jdGlvbiI9PT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShbImpxdWVyeSIsImRhdGF0YWJsZXMubmV0Il0sZnVuY3Rpb24oZCl7cmV0dXJuIGEoZCx3aW5kb3csZG9jdW1lbnQpfSk6Im9iamVjdCI9PT10eXBlb2YgZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1mdW5jdGlvbihkLGMpe2R8fChkPXdpbmRvdyk7YyYmYy5mbi5kYXRhVGFibGV8fChjPXJlcXVpcmUoImRhdGF0YWJsZXMubmV0IikoZCxjKS4kKTtyZXR1cm4gYShjLGQsZC5kb2N1bWVudCl9OmEoalF1ZXJ5LHdpbmRvdyxkb2N1bWVudCl9KShmdW5jdGlvbihhLGQsYyxlKXt2YXIgZj1hLmZuLmRhdGFUYWJsZSxoPWZ1bmN0aW9uKGIsZyl7aWYoIWYudmVyc2lvbkNoZWNrfHwhZi52ZXJzaW9uQ2hlY2soIjEuMTAuOCIpKXRocm93IlJvd0dyb3VwIHJlcXVpcmVzIERhdGFUYWJsZXMgMS4xMC44IG9yIG5ld2VyIjt0aGlzLmM9YS5leHRlbmQoITAse30sZi5kZWZhdWx0cy5yb3dHcm91cCwNCmguZGVmYXVsdHMsZyk7dGhpcy5zPXtkdDpuZXcgZi5BcGkoYil9O3RoaXMuZG9tPXt9O2I9dGhpcy5zLmR0LnNldHRpbmdzKClbMF07aWYoZz1iLnJvd0dyb3VwKXJldHVybiBnO2Iucm93R3JvdXA9dGhpczt0aGlzLl9jb25zdHJ1Y3RvcigpfTthLmV4dGVuZChoLnByb3RvdHlwZSx7ZGF0YVNyYzpmdW5jdGlvbihiKXtpZihiPT09ZSlyZXR1cm4gdGhpcy5jLmRhdGFTcmM7dmFyIGc9dGhpcy5zLmR0O3RoaXMuYy5kYXRhU3JjPWI7YShnLnRhYmxlKCkubm9kZSgpKS50cmlnZ2VySGFuZGxlcigicm93Z3JvdXAtZGF0YXNyYy5kdCIsW2csYl0pO3JldHVybiB0aGlzfSxkaXNhYmxlOmZ1bmN0aW9uKCl7dGhpcy5jLmVuYWJsZT0hMTtyZXR1cm4gdGhpc30sZW5hYmxlOmZ1bmN0aW9uKGIpe2lmKCExPT09YilyZXR1cm4gdGhpcy5kaXNhYmxlKCk7dGhpcy5jLmVuYWJsZT0hMDtyZXR1cm4gdGhpc30sX2NvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7dmFyIGI9dGhpcyxhPXRoaXMucy5kdDthLm9uKCJkcmF3LmR0cmciLA0KZnVuY3Rpb24oKXtiLmMuZW5hYmxlJiZiLl9kcmF3KCl9KTthLm9uKCJjb2x1bW4tdmlzaWJpbGl0eS5kdC5kdHJnIHJlc3BvbnNpdmUtcmVzaXplLmR0LmR0cmciLGZ1bmN0aW9uKCl7Yi5fYWRqdXN0Q29sc3BhbigpfSk7YS5vbigiZGVzdHJveSIsZnVuY3Rpb24oKXthLm9mZigiLmR0cmciKX0pO2Eub24oInJlc3BvbnNpdmUtcmVzaXplLmR0IixmdW5jdGlvbigpe2IuX2FkanVzdENvbHNwYW4oKX0pfSxfYWRqdXN0Q29sc3BhbjpmdW5jdGlvbigpe2EoInRyLiIrdGhpcy5jLmNsYXNzTmFtZSx0aGlzLnMuZHQudGFibGUoKS5ib2R5KCkpLmZpbmQoInRkIikuYXR0cigiY29sc3BhbiIsdGhpcy5fY29sc3BhbigpKX0sX2NvbHNwYW46ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zLmR0LmNvbHVtbnMoKS52aXNpYmxlKCkucmVkdWNlKGZ1bmN0aW9uKGIsYSl7cmV0dXJuIGIrYX0sMCl9LF9kcmF3OmZ1bmN0aW9uKCl7dmFyIGI9dGhpcy5fZ3JvdXAoMCx0aGlzLnMuZHQucm93cyh7cGFnZToiY3VycmVudCJ9KS5pbmRleGVzKCkpOw0KdGhpcy5fZ3JvdXBEaXNwbGF5KDAsYil9LF9ncm91cDpmdW5jdGlvbihiLGcpe2Zvcih2YXIgYz1hLmlzQXJyYXkodGhpcy5jLmRhdGFTcmMpP3RoaXMuYy5kYXRhU3JjOlt0aGlzLmMuZGF0YVNyY10sZD1mLmV4dC5vQXBpLl9mbkdldE9iamVjdERhdGFGbihjW2JdKSxoPXRoaXMucy5kdCxsLG4sbT1bXSxrPTAscD1nLmxlbmd0aDtrPHA7aysrKXt2YXIgcT1nW2tdO2w9aC5yb3cocSkuZGF0YSgpO2w9ZChsKTtpZihudWxsPT09bHx8bD09PWUpbD10aGlzLmMuZW1wdHlEYXRhR3JvdXA7aWYobj09PWV8fGwhPT1uKW0ucHVzaCh7ZGF0YVBvaW50Omwscm93czpbXX0pLG49bDttW20ubGVuZ3RoLTFdLnJvd3MucHVzaChxKX1pZihjW2IrMV0hPT1lKWZvcihrPTAscD1tLmxlbmd0aDtrPHA7aysrKW1ba10uY2hpbGRyZW49dGhpcy5fZ3JvdXAoYisxLG1ba10ucm93cyk7cmV0dXJuIG19LF9ncm91cERpc3BsYXk6ZnVuY3Rpb24oYixhKXtmb3IodmFyIGM9dGhpcy5zLmR0LGcsZD0wLGY9DQphLmxlbmd0aDtkPGY7ZCsrKXt2YXIgZT1hW2RdLGg9ZS5kYXRhUG9pbnQsaz1lLnJvd3M7dGhpcy5jLnN0YXJ0UmVuZGVyJiYoZz10aGlzLmMuc3RhcnRSZW5kZXIuY2FsbCh0aGlzLGMucm93cyhrKSxoLGIpLChnPXRoaXMuX3Jvd1dyYXAoZyx0aGlzLmMuc3RhcnRDbGFzc05hbWUsYikpJiZnLmluc2VydEJlZm9yZShjLnJvdyhrWzBdKS5ub2RlKCkpKTt0aGlzLmMuZW5kUmVuZGVyJiYoZz10aGlzLmMuZW5kUmVuZGVyLmNhbGwodGhpcyxjLnJvd3MoayksaCxiKSwoZz10aGlzLl9yb3dXcmFwKGcsdGhpcy5jLmVuZENsYXNzTmFtZSxiKSkmJmcuaW5zZXJ0QWZ0ZXIoYy5yb3coa1trLmxlbmd0aC0xXSkubm9kZSgpKSk7ZS5jaGlsZHJlbiYmdGhpcy5fZ3JvdXBEaXNwbGF5KGIrMSxlLmNoaWxkcmVuKX19LF9yb3dXcmFwOmZ1bmN0aW9uKGIsZyxjKXtpZihudWxsPT09Ynx8IiI9PT1iKWI9dGhpcy5jLmVtcHR5RGF0YUdyb3VwO3JldHVybiBiPT09ZXx8bnVsbD09PWI/bnVsbDooIm9iamVjdCI9PT0NCnR5cGVvZiBiJiZiLm5vZGVOYW1lJiYidHIiPT09Yi5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpP2EoYik6YiBpbnN0YW5jZW9mIGEmJmIubGVuZ3RoJiYidHIiPT09YlswXS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpP2I6YSgiPHRyLz4iKS5hcHBlbmQoYSgiPHRkLz4iKS5hdHRyKCJjb2xzcGFuIix0aGlzLl9jb2xzcGFuKCkpLmFwcGVuZChiKSkpLmFkZENsYXNzKHRoaXMuYy5jbGFzc05hbWUpLmFkZENsYXNzKGcpLmFkZENsYXNzKCJkdHJnLWxldmVsLSIrYyl9fSk7aC5kZWZhdWx0cz17Y2xhc3NOYW1lOiJkdHJnLWdyb3VwIixkYXRhU3JjOjAsZW1wdHlEYXRhR3JvdXA6Ik5vIGdyb3VwIixlbmFibGU6ITAsZW5kQ2xhc3NOYW1lOiJkdHJnLWVuZCIsZW5kUmVuZGVyOm51bGwsc3RhcnRDbGFzc05hbWU6ImR0cmctc3RhcnQiLHN0YXJ0UmVuZGVyOmZ1bmN0aW9uKGIsYSl7cmV0dXJuIGF9fTtoLnZlcnNpb249IjEuMS4xIjthLmZuLmRhdGFUYWJsZS5Sb3dHcm91cD1oO2EuZm4uRGF0YVRhYmxlLlJvd0dyb3VwPQ0KaDtmLkFwaS5yZWdpc3Rlcigicm93R3JvdXAoKSIsZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30pO2YuQXBpLnJlZ2lzdGVyKCJyb3dHcm91cCgpLmRpc2FibGUoKSIsZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pdGVyYXRvcigidGFibGUiLGZ1bmN0aW9uKGEpe2Eucm93R3JvdXAmJmEucm93R3JvdXAuZW5hYmxlKCExKX0pfSk7Zi5BcGkucmVnaXN0ZXIoInJvd0dyb3VwKCkuZW5hYmxlKCkiLGZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLml0ZXJhdG9yKCJ0YWJsZSIsZnVuY3Rpb24oYil7Yi5yb3dHcm91cCYmYi5yb3dHcm91cC5lbmFibGUoYT09PWU/ITA6YSl9KX0pO2YuQXBpLnJlZ2lzdGVyKCJyb3dHcm91cCgpLmRhdGFTcmMoKSIsZnVuY3Rpb24oYSl7cmV0dXJuIGE9PT1lP3RoaXMuY29udGV4dFswXS5yb3dHcm91cC5kYXRhU3JjKCk6dGhpcy5pdGVyYXRvcigidGFibGUiLGZ1bmN0aW9uKGIpe2Iucm93R3JvdXAmJmIucm93R3JvdXAuZGF0YVNyYyhhKX0pfSk7YShjKS5vbigicHJlSW5pdC5kdC5kdHJnIiwNCmZ1bmN0aW9uKGIsYyxkKXsiZHQiPT09Yi5uYW1lc3BhY2UmJihiPWMub0luaXQucm93R3JvdXAsZD1mLmRlZmF1bHRzLnJvd0dyb3VwLGJ8fGQpJiYoZD1hLmV4dGVuZCh7fSxkLGIpLCExIT09YiYmbmV3IGgoYyxkKSl9KTtyZXR1cm4gaH0pOw0KCnZhciBGb3JtU3RhdGUgPSBmdW5jdGlvbiAoZm9ybU9iaiwga2V5KSB7CiAgICB2YXIgaW5wdXRzID0gJ2lucHV0LCB0ZXh0YXJlYSwgc2VsZWN0JzsKICAgIHZhciBleGNsdWRlZCA9ICdpbnB1dFt0eXBlPSJmaWxlIl0sIGlucHV0W3R5cGU9ImhpZGRlbiJdLCBpbnB1dFt0eXBlPSJzdWJtaXQiXSwgaW5wdXRbdHlwZT0icmVzZXQiXSc7CiAgICB2YXIgcGVyc2lzdGluZ0tleSA9ICcucGVyc2lzdGluZyc7CiAgICB2YXIgZm9ybUVsZW1lbnQ7CiAgICB2YXIgc3RvcmFnZUtleTsKICAgIHZhciBzb3J0RWxlbWVudHNCYXNlZE9uRXZlbnRzID0gZnVuY3Rpb24gKGVsMSwgZWwyKSB7CiAgICAgICAgdmFyICRldmVudHNBID0gJC5fZGF0YShlbDEsICJldmVudHMiKTsKICAgICAgICB2YXIgJGV2ZW50c0IgPSAkLl9kYXRhKGVsMiwgImV2ZW50cyIpOwogICAgICAgIHZhciBldmVudHNBQ291bnQgPSAodHlwZW9mICRldmVudHNBICE9PSAidW5kZWZpbmVkIikgPyBPYmplY3Qua2V5cygkZXZlbnRzQSkubGVuZ3RoIDogMDsKICAgICAgICB2YXIgZXZlbnRzQkNvdW50ID0gKHR5cGVvZiAkZXZlbnRzQiAhPT0gInVuZGVmaW5lZCIpID8gT2JqZWN0LmtleXMoJGV2ZW50c0IpLmxlbmd0aCA6IDA7CiAgICAgICAgaWYgKGV2ZW50c0FDb3VudCA9PT0gZXZlbnRzQkNvdW50KSByZXR1cm4gMDsKICAgICAgICByZXR1cm4gZXZlbnRzQUNvdW50ID4gZXZlbnRzQkNvdW50ID8gMSA6IC0xOwogICAgfTsKCiAgICB0aGlzLmdldFN0YXRlID0gZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBpdGVtcyA9IHt9OwogICAgICAgICQoZm9ybUVsZW1lbnQpLmZpbmQoaW5wdXRzKS5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIGVsZW0gPSAkKHRoaXMpOwogICAgICAgICAgICBpZiAoZWxlbS5pcyhleGNsdWRlZCkgfHwgaXNGaWVsZEhpZGRlbihlbGVtLCBmb3JtRWxlbWVudCkpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIgcGF0aCA9IGdldFBhdGgoZWxlbSk7CiAgICAgICAgICAgIGl0ZW1zW3BhdGhdID0gZ2V0VmFsKGVsZW0pOwogICAgICAgIH0pOwogICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShpdGVtcyk7CiAgICB9OwoKICAgIHZhciBmaW5kRmllbGRQYXJlbnQgPSBmdW5jdGlvbihmaWVsZCwgZm9ybSkgewogICAgICAgIHZhciBpZCA9IGZpZWxkLnBhcmVudCgpLmF0dHIoJ2RhdGEtaWQnKTsKICAgICAgICBpZiAoIV8uaXNVbmRlZmluZWQoaWQpKSB7CiAgICAgICAgICAgIHJldHVybiBmb3JtLmZpbmQoJyMnICsgaWQpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbnVsbDsKICAgIH07CgogICAgdmFyIGlzRmllbGRIaWRkZW4gPSBmdW5jdGlvbihmaWVsZCwgZm9ybSkgewogICAgICAgIHZhciBwYXJlbnQgPSBmaW5kRmllbGRQYXJlbnQoZmllbGQsIGZvcm0pOwogICAgICAgIGlmIChwYXJlbnQpIHsKICAgICAgICAgICAgcmV0dXJuIHBhcmVudC5oYXNDbGFzcygnaGlkZScpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9OwoKICAgIHRoaXMubG9hZFZpc2liaWxpdHlTdGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICAgIHZhciBkYXRhID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShzdG9yYWdlS2V5KTsKICAgICAgICBpZiAoZGF0YSkgewogICAgICAgICAgICB2YXIgaXRlbXMgPSBKU09OLnBhcnNlKGRhdGEpOwogICAgICAgICAgICAkKGZvcm1FbGVtZW50KS5maW5kKGlucHV0cykuZWFjaChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGVsZW0gPSAkKHRoaXMpOwogICAgICAgICAgICAgICAgICAgIGlmIChlbGVtLmlzKGV4Y2x1ZGVkKSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHZhciBwYXRoID0gZ2V0UGF0aChlbGVtKTsKICAgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gZmluZEZpZWxkUGFyZW50KGVsZW0sIGZvcm1FbGVtZW50KTsKICAgICAgICAgICAgICAgICAgICBpZiAocGF0aCAmJiBwYXJlbnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpdGVtcy5oYXNPd25Qcm9wZXJ0eShwYXRoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwYXJlbnQuaGFzQ2xhc3MoJ2hpZGUnKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1FbGVtZW50LmZpbmQoIi4iICsgcGFyZW50LmF0dHIoJ2lkJykpLmFkZENsYXNzKCdoaWRlJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50Lmhhc0NsYXNzKCdoaWRlJykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtRWxlbWVudC5maW5kKCIuIiArIHBhcmVudC5hdHRyKCdpZCcpKS5yZW1vdmVDbGFzcygnaGlkZScpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIkVycm9yIHdoaWxlIGxvYWRpbmcgZm9ybSBzdGF0ZSIsIGVycik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH07CgogICAgdGhpcy5zYXZlU3RhdGUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbShzdG9yYWdlS2V5LCB0aGlzLmdldFN0YXRlKCkpOwogICAgfTsKCiAgICB0aGlzLmNsZWFyU3RhdGUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbShzdG9yYWdlS2V5KTsKICAgIH07CgogICAgdGhpcy5jbGVhclNlbGVjdGl2ZWx5ID0gZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBzdG9yZWRWYWx1ZSA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oc3RvcmFnZUtleSk7CiAgICAgICAgaWYgKHN0b3JlZFZhbHVlKSB7CiAgICAgICAgICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZShzdG9yZWRWYWx1ZSk7CiAgICAgICAgICAgICQuZWFjaChkYXRhLCBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHsKICAgICAgICAgICAgICAgIGlmIChuYW1lLmluZGV4T2YocGVyc2lzdGluZ0tleSkgPT09IC0xKSB7CiAgICAgICAgICAgICAgICAgICAgZGF0YVtuYW1lXSA9ICcnOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbShzdG9yYWdlS2V5LCBKU09OLnN0cmluZ2lmeShkYXRhKSk7CiAgICAgICAgfQogICAgfTsKCiAgICB0aGlzLmxvYWRTdGF0ZSA9IGZ1bmN0aW9uIChwYWdlVHlwZSkgewogICAgICAgIHZhciBkYXRhID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShzdG9yYWdlS2V5KTsKICAgICAgICB0aGlzLmxvYWRTdGF0ZUZyb20oZGF0YSxwYWdlVHlwZSk7CiAgICB9OwoKICAgIHRoaXMubG9hZFN0YXRlRnJvbSA9IGZ1bmN0aW9uIChkYXRhICxwYWdlVHlwZSkgewogICAgICAgIGlmICgndW5kZWZpbmVkJyA9PT0gdHlwZW9mIGRhdGEgfHwgIWRhdGEpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICB2YXIgaXRlbXMgPSBKU09OLnBhcnNlKGRhdGEpOwogICAgICAgICQoZm9ybUVsZW1lbnQpLmZpbmQoaW5wdXRzKS5zb3J0KHNvcnRFbGVtZW50c0Jhc2VkT25FdmVudHMpLmVhY2goZnVuY3Rpb24gKCkgewogICAgICAgICAgICBpZiAoJCh0aGlzKS5pcyhleGNsdWRlZCkpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBzZXRWYWwoJCh0aGlzKSwgaXRlbXMsIHBhZ2VUeXBlKQogICAgICAgIH0pOwogICAgfTsKCiAgICB0aGlzLmNvbnN0cnVjdCA9IGZ1bmN0aW9uIChmb3JtT2JqLCBrZXkpIHsKICAgICAgICBmb3JtRWxlbWVudCA9IGZvcm1PYmo7CiAgICAgICAgc3RvcmFnZUtleSA9IGtleTsKICAgICAgICByZXR1cm4gdGhpczsKICAgIH07CgogICAgdmFyIGdldFBhdGggPSBmdW5jdGlvbiAoZWxlbSkgewogICAgICAgIGlmICgndW5kZWZpbmVkJyA9PT0gdHlwZW9mIGVsZW0pIHsKICAgICAgICAgICAgcmV0dXJuIGVsZW07CiAgICAgICAgfQogICAgICAgIGlmIChlbGVtLmxlbmd0aCAhPT0gMSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIHZhciBwYXRoID0gJycKICAgICAgICAgICAgLCBmdWxsUGF0aCA9IGVsZW0uaXMoJ2lucHV0W3R5cGU9Y2hlY2tib3hdJykKICAgICAgICAgICAgLCBub2RlID0gZWxlbQogICAgICAgICAgICAsIHBlcm1hbmVudCA9ICEhZWxlbS5kYXRhKCdpcy1wZXJtYW5lbnQnKTsKCiAgICAgICAgd2hpbGUgKG5vZGUubGVuZ3RoKSB7CiAgICAgICAgICAgIHZhciByZWFsTm9kZSA9IG5vZGVbMF0KICAgICAgICAgICAgICAgICwgbmFtZSA9IHJlYWxOb2RlLm5vZGVOYW1lOwoKICAgICAgICAgICAgaWYgKCFuYW1lKSB7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKTsKCiAgICAgICAgICAgIHZhciBwYXJlbnQgPSBub2RlLnBhcmVudCgpCiAgICAgICAgICAgICAgICAsIHNpYmxpbmdzID0gcGFyZW50LmNoaWxkcmVuKG5hbWUpOwoKICAgICAgICAgICAgLy8gZG9uJ3QgbmVlZCB0byBwb2xsdXRlIHBhdGggd2l0aCBzZWxlY3QsIGZpZWxkc2V0cywgZGl2cyBhbmQgb3RoZXIgbm9pc3kgZWxlbWVudHMsCiAgICAgICAgICAgIC8vIGV4ZXB0IGZvciBjaGVja2JveGVzIHRoYXQgbmVlZCBleGFjdCBwYXRoLCBjdXogaGF2ZSBzYW1lIG5hbWUgYW5kIHNvbWV0aW1lcyBzYW1lIGVxKCkhCiAgICAgICAgICAgIGlmICghJChyZWFsTm9kZSkuaXMoJ2Zvcm0sIGlucHV0LCBzZWxlY3QsIHRleHRhcmVhJykgJiYgIWZ1bGxQYXRoKSB7CiAgICAgICAgICAgICAgICBub2RlID0gcGFyZW50OwogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIHNldCBpbnB1dCB0eXBlIGFzIG5hbWUgKyBuYW1lIGF0dHIgaWYgZXhpc3RzCiAgICAgICAgICAgIG5hbWUgKz0gJChyZWFsTm9kZSkuYXR0cignbmFtZScpID8gJy4nICsgJChyZWFsTm9kZSkuYXR0cignbmFtZScpIDogJyc7CgogICAgICAgICAgICAvLyBpZiBoYXMgc2liaWxpbmdzLCBnZXQgZXEoKSwgZXhlcHQgZm9yIHJhZGlvIGJ1dHRvbnMKICAgICAgICAgICAgaWYgKHNpYmxpbmdzLmxlbmd0aCA+IDEgJiYgISQocmVhbE5vZGUpLmlzKCdpbnB1dFt0eXBlPXJhZGlvXScpKSB7CiAgICAgICAgICAgICAgICBuYW1lICs9ICc6ZXEoJyArIHNpYmxpbmdzLmluZGV4KHJlYWxOb2RlKSArICcpJzsKICAgICAgICAgICAgfQogICAgICAgICAgICBwYXRoID0gbmFtZSArICggcGF0aCA/ICc+JyArIHBhdGggOiAnJyApOwogICAgICAgICAgICAvLyBicmVhayBvbmNlIHdlIGNhbWUgdXAgdG8gZm9ybTplcSh4KSwgbm8gbmVlZCB0byBnbyBmdXJ0aGVyCiAgICAgICAgICAgIGlmICgnZm9ybScgPT09IHJlYWxOb2RlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkpIHsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIG5vZGUgPSBwYXJlbnQ7CiAgICAgICAgfQogICAgICAgIGlmIChwZXJtYW5lbnQpIHsKICAgICAgICAgICAgcGF0aCA9IHBhdGggKyBwZXJzaXN0aW5nS2V5CiAgICAgICAgfQogICAgICAgIHJldHVybiBwYXRoOwogICAgfTsKCiAgICB2YXIgZ2V0VmFsID0gZnVuY3Rpb24gKGVsZW0pIHsKICAgICAgICByZXR1cm4gIWVsZW0uaXMoJ2lucHV0W3R5cGU9Y2hlY2tib3hdJykgPyBlbGVtLnZhbCgpIDogKCBlbGVtLnByb3AoJ2NoZWNrZWQnKSA/ICdjaGVja2VkJyA6ICd1bmNoZWNrZWQnICk7CiAgICB9OwoKICAgIHZhciBzZXRWYWwgPSBmdW5jdGlvbiAoZWxlbSwgaXRlbXMsIHBhZ2VUeXBlKSB7CiAgICAgICAgaWYgKCFpdGVtcykgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHZhciBwYXRoID0gZ2V0UGF0aChlbGVtKTsKICAgICAgICB2YXIgc3RvcmVkVmFsdWUgPSBpdGVtc1twYXRoXTsKCiAgICAgICAgaWYgKCd1bmRlZmluZWQnICE9PSB0eXBlb2Ygc3RvcmVkVmFsdWUpIHsKICAgICAgICAgICAgaWYgKHR5cGVvZiBzdG9yZWRWYWx1ZSA9PSAnYm9vbGVhbicgJiYgc3RvcmVkVmFsdWUgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gaW5wdXRbdHlwZT1jaGVja2JveF0gYW5kIGlucHV0W3R5cGU9cmFkaW9dIGhhdmUgYSBzcGVjaWFsIGNoZWNrZWQgLyB1bmNoZWNrZWQgYmVoYXZpb3IKICAgICAgICAgICAgaWYgKGVsZW0uaXMoJ2lucHV0W3R5cGU9cmFkaW9dLCBpbnB1dFt0eXBlPWNoZWNrYm94XScpKSB7CgogICAgICAgICAgICAgICAgLy8gZm9yIGNoZWNrYm94ZXMgYW5kIHJhZGlvcwogICAgICAgICAgICAgICAgaWYgKCdjaGVja2VkJyA9PT0gc3RvcmVkVmFsdWUgfHwgZWxlbS52YWwoKSA9PT0gc3RvcmVkVmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZWxlbS5wcm9wKCdjaGVja2VkJywgdHJ1ZSk7CgogICAgICAgICAgICAgICAgICAgIC8vIG9ubHkgbmVlZGVkIGZvciBjaGVja2JveGVzCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCd1bmNoZWNrZWQnID09PSBzdG9yZWRWYWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGVsZW0ucHJvcCgnY2hlY2tlZCcsIGZhbHNlKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9IGVsZW0udmFsKCk7CiAgICAgICAgICAgIGlmIChjdXJyZW50VmFsdWUgPT09IHN0b3JlZFZhbHVlKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gZm9yIGlucHV0W3R5cGU9dGV4dF0sIHNlbGVjdCBhbmQgdGV4dGFyZWEsIGp1c3Qgc2V0IHZhbCgpCiAgICAgICAgICAgIGlmIChwYWdlVHlwZSA9PT0gcHZpX2Zvcm1zLmR1cGxpY2F0ZV9zZWFyY2gpIHsKICAgICAgICAgICAgICAgIGlmIChwYXRoLmluY2x1ZGVzKHBlcnNpc3RpbmdLZXkpKSB7CiAgICAgICAgICAgICAgICAgICAgZWxlbS52YWwoc3RvcmVkVmFsdWUpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBlbGVtLnZhbChzdG9yZWRWYWx1ZSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIHRyaWdnZXIgYW4gaW5wdXQgZXZlbnQgZ2l2ZW4gdGhlIHZhbHVlIGhhcyBiZWVuIGNoYW5nZWQKICAgICAgICAgICAgaWYgKGVsZW0uaXMoJ2lucHV0JykpIHsKICAgICAgICAgICAgICAgIGVsZW0udHJpZ2dlcignaW5wdXQnKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChlbGVtLmlzKCdzZWxlY3QnKSkgewogICAgICAgICAgICAgICAgZWxlbS50cmlnZ2VyKCdjaGFuZ2UnKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyB0cmlnZ2VyIGN1c3RvbSB1c2VyIGZ1bmN0aW9uIHdoZW4gZGF0YSBpcyByZXRyaWV2ZWQKICAgICAgICB9CiAgICB9OwogICAgcmV0dXJuIHRoaXMuY29uc3RydWN0KGZvcm1PYmosIGtleSk7Cn07CnZhciBwdmkgPSBwdmkgfHwge307CgpwdmkucmRsID0gcHZpLnJkbCB8fCB7fTsKCnB2aS5yZGwubWFuYWdlUmVwb3J0RGlzdHJpYnV0aW9uID0gZnVuY3Rpb24oKSB7CiAgICB2YXIgcmRNb2RhbCA9ICQoIiNyZXBvcnREZXN0aW5hdGlvbk1vZGFsIik7CiAgICB2YXIgcmRUYWJsZSA9ICQoJyNyZXBvcnREaXN0VGFibGUnKTsKICAgIHZhciByZXBvcnRMb2dUYWJsZSA9IG51bGw7CiAgICB2YXIgcmRUYWJsZUJvZHkgPSByZFRhYmxlLmZpbmQoJ3Rib2R5Jyk7CiAgICB2YXIgZTJiRGV0YWlsRGl2ID0gcmRNb2RhbC5maW5kKCIuZTJiWE1MRGV0YWlsIik7CiAgICB2YXIgYmFja1JkTG9nREJ0biA9IHJkTW9kYWwuZmluZCgiLmJhY2stdG8tcmQtbGlzdGluZyIpOwogICAgdmFyIGxpc3RDbG9zZUJ0biA9IHJkTW9kYWwuZmluZCgiLnJkLWxpc3RpbmctY2xvc2UtYnRuIik7CiAgICB2YXIgcmRMb2dIZWFkZXIgPSByZE1vZGFsLmZpbmQoJ2g0LnJkTG9nJyk7CiAgICB2YXIgcmVzcFJETFhtbCA9IFtdOwoKICAgIHZhciBzaG93RTJCQWNrWE1MRGV0YWlsID0gZnVuY3Rpb24gKHhtbERhdGEsIGZpbGVOYW1lLCBzaG93RTJCKSB7CiAgICAgICAgaWYgKHNob3dFMkIpIHsKICAgICAgICAgICAgcmRNb2RhbC5maW5kKCdoNC5lMmJYbWwnKS5yZW1vdmVDbGFzcygnaGlkZScpLmZpbmQoJy5lMmJGaWxlTmFtZScpLnRleHQoIiAoIiArIGZpbGVOYW1lICsgIikiKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZE1vZGFsLmZpbmQoJ2g0LmFja1htbCcpLnJlbW92ZUNsYXNzKCdoaWRlJykuZmluZCgnLmFja0ZpbGVOYW1lJykudGV4dCgiICgiICsgZmlsZU5hbWUgKyAiKSIpOwogICAgICAgIH0KICAgICAgICByZFRhYmxlLmFkZChyZExvZ0hlYWRlcikuYWRkKGxpc3RDbG9zZUJ0bikuYWRkQ2xhc3MoImhpZGUiKTsKICAgICAgICBiYWNrUmRMb2dEQnRuLmFkZChlMmJEZXRhaWxEaXYpLnJlbW92ZUNsYXNzKCJoaWRlIik7CiAgICAgICAgZTJiRGV0YWlsRGl2LmZpbmQoJy54bWxDb250ZW50JykudGV4dCh2a2JlYXV0aWZ5LnhtbCh4bWxEYXRhKSk7CiAgICB9OwoKICAgIHZhciBoaWRlRTJCQWNrWE1MRGV0YWlsID0gZnVuY3Rpb24gKCkgewogICAgICAgICQoJy5lMmJYbWwsLmFja1htbCcpLmFkZChiYWNrUmRMb2dEQnRuKS5hZGQoZTJiRGV0YWlsRGl2KS5hZGRDbGFzcygnaGlkZScpOwogICAgICAgIHJkTG9nSGVhZGVyLmFkZChyZFRhYmxlKS5hZGQobGlzdENsb3NlQnRuKS5yZW1vdmVDbGFzcygiaGlkZSIpOwogICAgICAgIGUyYkRldGFpbERpdi5maW5kKCcueG1sQ29udGVudCcpLnRleHQoJycpOwogICAgfTsKCiAgICB2YXIgcG9wdWxhdGVEYXRhSW5UYWJsZSA9IGZ1bmN0aW9uKGRhdGEpIHsKICAgICAgICBkYXRhID0gXy5pc1VuZGVmaW5lZChkYXRhKSA/IFtdIDogZGF0YTsKICAgICAgICByZXNwUkRMWG1sID0gZGF0YTsKICAgICAgICB2YXIgY3Vyckdyb3VwID0gMDsKICAgICAgICB2YXIgZ3JvdXAxVmFsdWUgPSBudWxsOwoKICAgICAgICByZXBvcnRMb2dUYWJsZSA9ICQocmRUYWJsZSkuRGF0YVRhYmxlKHsKICAgICAgICAgICAgZGVzdHJveTogdHJ1ZSwKICAgICAgICAgICAgcGFnaW5nOiBmYWxzZSwKICAgICAgICAgICAgc2VhcmNoaW5nOiBmYWxzZSwKICAgICAgICAgICAgaW5mbzogZmFsc2UsCiAgICAgICAgICAgIGRhdGE6IGRhdGEsCiAgICAgICAgICAgIG9yZGVyOiBbCiAgICAgICAgICAgICAgICBbMSwgJ2FzYyddLAogICAgICAgICAgICAgICAgWzIsICdhc2MnXQogICAgICAgICAgICBdLAogICAgICAgICAgICBvcmRlckZpeGVkOiBbCiAgICAgICAgICAgICAgICBbMSwgJ2FzYyddLAogICAgICAgICAgICAgICAgWzIsICdhc2MnXQogICAgICAgICAgICBdLAogICAgICAgICAgICBjb2x1bW5zOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgZGF0YTogJ2lkeCcsCiAgICAgICAgICAgICAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHZpLnV0aWwuZW5jb2RlVG9IVE1MKGRhdGEpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgZGF0YTogJ2Rlc3RpbmF0aW9uTmFtZScsCiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAiY29sLXJkLWRlc3RpbmF0aW9uLW5hbWUiLAogICAgICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHB2aS51dGlsLmVuY29kZVRvSFRNTChkYXRhKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGRhdGE6ICd0eXBlJywKICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtcmQtdHlwZSIsCiAgICAgICAgICAgICAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHZpLnV0aWwuZW5jb2RlVG9IVE1MKGRhdGEpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgZGF0YTogJ2Zyb21TdGF0ZScsCiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAiY29sLXJkLWZyb20tc3RhdGUiLAogICAgICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHB2aS51dGlsLmVuY29kZVRvSFRNTChkYXRhKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGRhdGE6ICd0b1N0YXRlJywKICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtcmQtdG8tc3RhdGUiLAogICAgICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHB2aS51dGlsLmVuY29kZVRvSFRNTChkYXRhKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGRhdGE6ICd0aW1lU3RhbXAnLAogICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1yZC10aW1lLXN0YW1wIiwKICAgICAgICAgICAgICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwdmkudXRpbC5lbmNvZGVUb0hUTUwoZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBkYXRhOiAnaWNzcklkJywKICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtcmQtaWNzci1pZCIsCiAgICAgICAgICAgICAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHZpLnV0aWwuZW5jb2RlVG9IVE1MKGRhdGEpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgXSwKICAgICAgICAgICAgY29sdW1uRGVmczogWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHRhcmdldHM6IFsxLCAyXSwKICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBvcmRlcmFibGU6IHRydWUKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0czogWzAsIDMsIDQsIDUsIDZdLAogICAgICAgICAgICAgICAgICAgIG9yZGVyYWJsZTogZmFsc2UKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgXSwKICAgICAgICAgICAgcm93R3JvdXA6IHsKICAgICAgICAgICAgICAgIGRhdGFTcmM6IFsnZGVzdGluYXRpb25OYW1lJywgJ3R5cGUnXSwKICAgICAgICAgICAgICAgIHN0YXJ0UmVuZGVyOiBmdW5jdGlvbihyb3dzLCBncm91cCkgewogICAgICAgICAgICAgICAgICAgIGlmIChjdXJyR3JvdXAgPT09IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXAxVmFsdWUgPSBncm91cDsKICAgICAgICAgICAgICAgICAgICAgICAgY3Vyckdyb3VwKys7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgY3Vyckdyb3VwID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICc8aDU+PGI+JyArIGdyb3VwMVZhbHVlICsgJzwvYj48L2g1PicKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGNyZWF0ZWRSb3c6IGZ1bmN0aW9uKHRyLCByb3csIGluZGV4KSB7CiAgICAgICAgICAgICAgICB2YXIgc2hvd0F0dGFjaG1lbnRzID0gZmFsc2U7CiAgICAgICAgICAgICAgICB2YXIgc2hvd0UyQk9yQWNrID0gJyc7CiAgICAgICAgICAgICAgICB2YXIgcm93RGF0YSA9ICcnOwogICAgICAgICAgICAgICAgaWYgKHJvdy50b1N0YXRlSWQgPT09IHB2aV9pY3NyX3N0YXRlLkdFTkVSQVRFRCkgewogICAgICAgICAgICAgICAgICAgIGlmIChyb3cudHlwZSA9PT0gcHZpX2ljc3JfdHlwZS5QREYpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0UyQk9yQWNrID0gZ2V0TWVzc2FnZSgiaWNzcl90eXBlX3BkZiIpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocm93LnR5cGUgPT09IHB2aV9pY3NyX3R5cGUuRTJCX0VYVCkgewogICAgICAgICAgICAgICAgICAgICAgICBzaG93RTJCT3JBY2sgPSBnZXRNZXNzYWdlKCJpY3NyX3R5cGVfZTJiIik7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0UyQk9yQWNrID0gZ2V0TWVzc2FnZSgiaWNzcl90eXBlX2UyYl9yMyIpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAvLyBzaG93RTJCT3JBY2sgPSAocm93LnR5cGUgPT09IHB2aV9pY3NyX3R5cGUuUERGID8gZ2V0TWVzc2FnZSgiaWNzcl90eXBlX3BkZiIpIDogZ2V0TWVzc2FnZSgiaWNzcl90eXBlX2UyYiIpKTsKICAgICAgICAgICAgICAgICAgICBzaG93QXR0YWNobWVudHMgPSAocm93LnR5cGUgPT09IHB2aV9pY3NyX3R5cGUuUERGKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXy5jb250YWlucyhbcHZpX2ljc3Jfc3RhdGUuUE9TSVRJVkVfQUNLLCBwdmlfaWNzcl9zdGF0ZS5ORUdBVElWRV9BQ0tdLCByb3cudG9TdGF0ZUlkKSkgewogICAgICAgICAgICAgICAgICAgIHNob3dFMkJPckFjayA9ICJBY2siOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyb3cudG9TdGF0ZUlkID09PSBwdmlfaWNzcl9zdGF0ZS5UUkFOU01JVFRFRCAmJiByb3cudHlwZSA9PT0gcHZpX2ljc3JfdHlwZS5FMkJfUjNfRVhUKSB7CiAgICAgICAgICAgICAgICAgICAgc2hvd0UyQk9yQWNrID0gIkhMNyI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB2YXIgc2hvd09ySGlkZU1zZ0ljb24gPSAoIV8uaXNFbXB0eShyb3cucmVwb3J0TWVzc2FnZSkgJiYgXy5jb250YWlucyhbcHZpX2ljc3Jfc3RhdGUuUE9TSVRJVkVfQUNLLCBwdmlfaWNzcl9zdGF0ZS5ORUdBVElWRV9BQ0tdLCByb3cudG9TdGF0ZUlkKSkgPyAnJyA6ICdoaWRlJzsKICAgICAgICAgICAgICAgIGlmIChzaG93QXR0YWNobWVudHMpIHsKICAgICAgICAgICAgICAgICAgICByb3dEYXRhICs9IGNyZWF0ZVBkZkF0dGFjaG1lbnRzKHJvdy5pY3NySWQsIHJvdy5maWxlcywgc2hvd0UyQk9yQWNrKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgcm93RGF0YSArPSAnPGJ1dHRvbiB0eXBlPSJidXR0b24iIGRhdGEtaW5kZXg9IicraW5kZXgrJyIgY2xhc3M9InNob3dBY2tYTUwgYnRuIGJ0bi14cyBidG4taW52ZXJzZSB3YXZlcy1saWdodCBkcm9wZG93bi10b2dnbGUgbm9BY3Rpb25BbGxvd2VkIG5vdC1jbGlja2FibGUgJyArIHNob3dFMkJPckFjayArICciPicgKyBzaG93RTJCT3JBY2sgKyAnPC9idXR0b24+JzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICQoJ3RkOmVxKDApJywgdHIpLmFkZENsYXNzKCdzbnVtJyk7CiAgICAgICAgICAgICAgICAkKCd0ZDplcSgyKScsIHRyKS5odG1sKHJvdy50b1N0YXRlICsgJzxhIGhyZWY9IiMiIGNsYXNzPSJwdi1pYy12aWV3cXVlcnkgcmRsLWljLXNob3dtc2cgJyArIHNob3dPckhpZGVNc2dJY29uICsgJyI+XG48c3BhbiBjbGFzcz0iZmEgZmEtaW5mby1jaXJjbGUgbS1sLTUiPjwvc3Bhbj5cbjwvYT4nKTsKICAgICAgICAgICAgICAgICQoJ3RkOmVxKDQpJywgdHIpLmh0bWwocm93RGF0YSk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICBoaWRlRTJCQWNrWE1MRGV0YWlsKCk7CiAgICAgICAgcmRNb2RhbC5tb2RhbCgic2hvdyIpOwogICAgfTsKCiAgICB2YXIgY3JlYXRlUGRmQXR0YWNobWVudHMgPSBmdW5jdGlvbiAoaWNzcklkLCBmaWxlcywgbGFiZWwpIHsKICAgICAgICB2YXIgc2luZ2xlX2J1dHRvbiA9ICc8YSBjbGFzcz0iYnRuIGJ0bi14cyBidG4taW52ZXJzZSB3YXZlcy1saWdodCIgaHJlZj0iJyArIHB2aV91cmxzLmljc3JQZGZEb3dubG9hZCArICc/aWQ9JyArIGljc3JJZCArICcmdHlwZT1pY3NyIj4nICsgbGFiZWwgKyAnPC9hPic7CiAgICAgICAgaWYgKGZpbGVzLmxlbmd0aCA9PT0gMCl7CiAgICAgICAgICAgIHJldHVybiBzaW5nbGVfYnV0dG9uOwogICAgICAgIH0KICAgICAgICB2YXIgYnV0dG9uID0gJzxkaXYgY2xhc3M9ImRyb3Bkb3duIj4nICsKICAgICAgICAgICAgJyA8ZGl2IGNsYXNzPSJidG4tZ3JvdXAiIHJvbGU9Imdyb3VwIj4nICsKICAgICAgICAgICAgc2luZ2xlX2J1dHRvbiArCiAgICAgICAgICAgICc8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXhzIGJ0bi1pbnZlcnNlIHdhdmVzLWxpZ2h0IGRyb3Bkb3duLXRvZ2dsZSIgaWQ9ImRyb3Bkb3duQXR0YWNobWVudHMiIHR5cGU9ImJ1dHRvbiIgZGF0YS10b2dnbGU9ImRyb3Bkb3duIiBhcmlhLWhhc3BvcHVwPSJ0cnVlIiA+PHNwYW4gY2xhc3M9Im1kIG1kLW1lbnUtZG93biI+PC9zcGFuPjwvYnV0dG9uPicgKwogICAgICAgICAgICAnPHVsIGNsYXNzPSJkcm9wZG93bi1tZW51IGRyb3Bkb3duLW1lbnUtcmlnaHQiIGFyaWEtbGFiZWxsZWRieT0iZHJvcGRvd25BdHRhY2htZW50cyIgPic7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmaWxlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBidXR0b24gKz0gJzxsaT48YSBocmVmPSInICsgcHZpX3VybHMuaWNzclBkZkRvd25sb2FkICsgJz9pZD0nICsgZmlsZXNbaV0uaWQgKyAnJnR5cGU9YXR0YWNobWVudCI+JyArIGZpbGVzW2ldLm5hbWUgKyAnPC9hPjwvbGk+JwogICAgICAgIH0KICAgICAgICBidXR0b24gKz0gJzwvdWw+PC9kaXY+JzsKICAgICAgICByZXR1cm4gYnV0dG9uOwogICAgfTsKCiAgICB2YXIgYmluZFJlcG9ydERpc3RyaWJ1dGlvbkV2ZW50cyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAvL21vZGFsIG9uIGNsaWNrIGV2ZW50CiAgICAgICAgJChkb2N1bWVudCkub2ZmKCdjbGljaycsJ2EucmVwb3J0U3RhdGUnKS5vbignY2xpY2snLCdhLnJlcG9ydFN0YXRlJywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICB2YXIgaWQgPSAkKHRoaXMpLmF0dHIoJ2RhdGEtaWQnKTsKICAgICAgICAgICAgdmFyIHVybCA9IHB2aV91cmxzLnJlcG9ydF9kaXN0cmlidXRpb25fbG9nX3VybCArIGlkOwogICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgdHlwZTogJ0dFVCcsCiAgICAgICAgICAgICAgICB1cmw6IHVybCwKICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgcG9wdWxhdGVEYXRhSW5UYWJsZShKU09OLnBhcnNlKGRhdGEpLmRhdGEpOwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICByZFRhYmxlQm9keS50ZXh0KGVycm9yLm1lc3NhZ2UpOwogICAgICAgICAgICAgICAgICAgIHJkTW9kYWwubW9kYWwoInNob3ciKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CgogICAgICAgIC8vZXJyb3IgbWVzc2FnZSBldmVudCBiaW5kaW5nCiAgICAgICAgJChkb2N1bWVudCkub2ZmKCJjbGljayIsICJhLnJkbC1pYy1zaG93bXNnIikub24oImNsaWNrIiwgImEucmRsLWljLXNob3dtc2ciLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgIHZhciB0ciA9ICQodGhpcykuY2xvc2VzdCgndHInKTsKICAgICAgICAgICAgdmFyIHJvdyA9IHJlcG9ydExvZ1RhYmxlLnJvdyh0cik7CiAgICAgICAgICAgIGlmIChyb3cuY2hpbGQuaXNTaG93bigpKSB7CiAgICAgICAgICAgICAgICByb3cuY2hpbGQuaGlkZSgpOwogICAgICAgICAgICAgICAgdHIucmVtb3ZlQ2xhc3MoJ3Nob3duJyk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByb3cuY2hpbGQoICc8cD4nICsgcm93LmRhdGEoKS5yZXBvcnRNZXNzYWdlICsgJzwvcD4nKS5zaG93KCk7CiAgICAgICAgICAgICAgICB0ci5hZGRDbGFzcygnc2hvd24nKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICAvL3Nob3cgRTJCIEFDSyB4bWwgZGV0YWlscyBldmVudCBiaW5kaW5nCiAgICAgICAgJChkb2N1bWVudCkub2ZmKCJjbGljayIsICIuc2hvd0Fja1hNTCIpLm9uKCJjbGljayIsICIuc2hvd0Fja1hNTCIsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSAkKHRoaXMpOwogICAgICAgICAgICB2YXIgaW5kZXggPSBlbGVtZW50LmF0dHIoJ2RhdGEtaW5kZXgnKTsKICAgICAgICAgICAgaWYgKGVsZW1lbnQuaGFzQ2xhc3MocHZpX2ljc3JfdHlwZS5FMkJfRVhUKSB8fCBlbGVtZW50Lmhhc0NsYXNzKHB2aV9pY3NyX3R5cGUuRTJCX1IzX0VYVCkpIHsKICAgICAgICAgICAgICAgIHNob3dFMkJBY2tYTUxEZXRhaWwocmVzcFJETFhtbFtpbmRleF0uaWNzclhtbCwgcmVzcFJETFhtbFtpbmRleF0uaWNzckZpbGVOYW1lLCB0cnVlKTsKICAgICAgICAgICAgfSBlbHNlIGlmKGVsZW1lbnQuaGFzQ2xhc3MocHZpX2ljc3JfdHlwZS5ITDdfRVhUKSkgewogICAgICAgICAgICAgICAgc2hvd0UyQkFja1hNTERldGFpbChyZXNwUkRMWG1sW2luZGV4XS5yM0ljc3JYbWwsIHJlc3BSRExYbWxbaW5kZXhdLmljc3JGaWxlTmFtZSwgdHJ1ZSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoZWxlbWVudC5oYXNDbGFzcyhwdmlfaWNzcl90eXBlLkUyQl9BQ0spKSB7CiAgICAgICAgICAgICAgICBzaG93RTJCQWNrWE1MRGV0YWlsKHJlc3BSRExYbWxbaW5kZXhdLmFja1htbCwgcmVzcFJETFhtbFtpbmRleF0uYWNrRmlsZU5hbWUsIGZhbHNlKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICAvL2hpZGUgRTJCIEFDSyB4bWwgZGV0YWlscyBldmVudCBiaW5kaW5nCiAgICAgICAgJChkb2N1bWVudCkub2ZmKCJjbGljayIsICIuYmFjay10by1yZC1saXN0aW5nIikub24oImNsaWNrIiwgIi5iYWNrLXRvLXJkLWxpc3RpbmciLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGhpZGVFMkJBY2tYTUxEZXRhaWwoKTsKICAgICAgICB9KTsKCiAgICAgICAgLy9tb2RhbCBjbG9zZSBldmVudAogICAgICAgIHJkTW9kYWwub2ZmKCdoaWRlLmJzLm1vZGFsJykub24oJ2hpZGUuYnMubW9kYWwnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGhpZGVFMkJBY2tYTUxEZXRhaWwoKTsKICAgICAgICB9KTsKCiAgICB9OwoKICAgIHZhciBpbml0ID0gZnVuY3Rpb24gKCkgewogICAgICAgIGJpbmRSZXBvcnREaXN0cmlidXRpb25FdmVudHMoKTsKICAgIH07CgogICAgcmV0dXJuIHsKICAgICAgICBpbml0OiBpbml0CiAgICB9Cn0oKTsKdmFyIGFsbENhc2VMaXN0VGFibGVzID0gW107Cgp2YXIgZm9sbG93VXBGcm9tTGlzdCA9IGZ1bmN0aW9uIChwYXJhbXMpIHsKICAgICQuYWpheCh7CiAgICAgICAgdXJsOiBwYXJhbXMudXJsLAogICAgICAgIHR5cGU6ICdQT1NUJywKICAgICAgICBkYXRhOiB7CiAgICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgICAgICAgIGluaXRpYWxDYXNlSWQ6IHBhcmFtcy5pbml0aWFsQ2FzZUlkLAogICAgICAgICAgICAgICAgZm9sbG93VXBDYXNlSWQ6IHBhcmFtcy5mb2xsb3dVcENhc2VJZCwKICAgICAgICAgICAgICAgIHNhZmV0eUNhc2VOdW06IHBhcmFtcy5zYWZldHlDYXNlTnVtCiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBiZWZvcmVTZW5kOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHB2dWkuY29tbW9uLnNob3dQVkxvYWRlcigpOwogICAgICAgIH0sCiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgdmFyIHJlc3AgPSAkLnBhcnNlSlNPTihkYXRhKTsKICAgICAgICAgICAgaWYgKHJlc3Auc3RhdHVzID09PSBwdmlfY29uc3RhbnRzLnN0YXR1c19mYWlsKSB7CiAgICAgICAgICAgICAgICBwdnVpLmNvbW1vbi5oaWRlUFZMb2FkZXIoKTsKICAgICAgICAgICAgICAgICQoJyNtZXNzYWdlQm94JykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTsKICAgICAgICAgICAgICAgICQoJyNlcnJvck1lc3NhZ2UnKS50ZXh0KHJlc3AubWVzc2FnZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAkKCIjcHZpTW9kYWxGb2xsb3dVcCIpLm1vZGFsKCJoaWRlIik7CiAgICAgICAgICAgICAgICBwdmkudXRpbC5nb3RvVVJMKHB2aV91cmxzLnNob3dfY2FzZV91cmwgKyByZXNwWydjYXNlLWlkJ10rcHZpX3VybHMuY2FzZV9lbnRyeV9kZWZhdWx0X3RlbXBsYXRlX3N1ZmZpeCk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGVycm9yOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICB2YXIgcmVzcCA9IEpTT04ucGFyc2UoZGF0YSk7CiAgICAgICAgICAgIHB2dWkuY29tbW9uLmhpZGVQVkxvYWRlcigpOwogICAgICAgICAgICBwdmkudXRpbC5zaG93RmxvYXRpbmdOb3RpZmljYXRpb24uZXJyb3JNZXNzYWdlKHJlc3AubWVzc2FnZSk7CiAgICAgICAgfQogICAgfSk7Cn07Cgp2YXIgcHZpID0gcHZpIHx8IHt9OwpwdmkubGlzdCA9IHB2aS5saXN0IHx8IHt9OwoKcHZpLmxpc3QuY29tbW9uRnVuY3Rpb25zID0gZnVuY3Rpb24gKCkgewoKICAgIHZhciBzZXRDb2x1bW5WaXNpYmlsaXR5ID0gZnVuY3Rpb24oY29sdW1uQ29uZmlncywgZGF0YVRhYmxlKXsKICAgICAgICBfLmVhY2goY29sdW1uQ29uZmlncywgZnVuY3Rpb24gKGNvbmZpZ09iaikgewogICAgICAgICAgICB2YXIgbmFtZSA9IGNvbmZpZ09iai5uYW1lOwogICAgICAgICAgICB2YXIgY29sID0gZGF0YVRhYmxlLmNvbHVtbnMobmFtZSArICI6bmFtZSIpOwogICAgICAgICAgICB2YXIgaXNWaXNpYmxlID0gKGNvbmZpZ09iai5jb250YWluZXJWaWV3ID09PSAxKTsKICAgICAgICAgICAgY29sLnZpc2libGUoaXNWaXNpYmxlLCBmYWxzZSk7CiAgICAgICAgfSk7CiAgICB9OwoKICAgIHZhciBwb3B1bGF0ZUVycm9ySW5FcnJvckNvbnRhaW5lciA9IGZ1bmN0aW9uIChtZXNzYWdlTGlzdCwgdGFyZ2V0Q29udGFpbmVyKSB7CiAgICAgICAgJCgiI21lc3NhZ2VBbGVydENvbnRhaW5lciIpLnJlbW92ZSgpOwogICAgICAgIHZhciBlcnJvck1lc3NhZ2VMaXN0ID0gIiI7CiAgICAgICAgdmFyIG1lc3NhZ2VMaXN0TGVuZ3RoID0gbWVzc2FnZUxpc3QubGVuZ3RoOwogICAgICAgIGZvciAodmFyIGNudCA9IDA7IGNudCA8IG1lc3NhZ2VMaXN0TGVuZ3RoOyBjbnQrKykgewogICAgICAgICAgICBlcnJvck1lc3NhZ2VMaXN0ICs9ICI8bGk+IiArIG1lc3NhZ2VMaXN0W2NudF0gKyAiPC9saT4iOwogICAgICAgIH0KICAgICAgICB2YXIgZXJyb3JEaXYgPSAnPGRpdiBjbGFzcz0iYWxlcnQgYWxlcnQtZGlzbWlzc2libGUgZm9yY2VMaW5lV3JhcCBhbGVydC1kYW5nZXIiIHJvbGU9ImFsZXJ0IiBpZD0ibWVzc2FnZUFsZXJ0Q29udGFpbmVyIj48L2Rpdj4nOwogICAgICAgICQoIiMiICsgdGFyZ2V0Q29udGFpbmVyKS5maW5kKCIuZGF0YVRhYmxlTGlzdCIpLmJlZm9yZShlcnJvckRpdik7CiAgICAgICAgJCgiI21lc3NhZ2VBbGVydENvbnRhaW5lciIpLmh0bWwoIjx1bCBpZD0nZXJyb3JMaXN0Jz4iK2Vycm9yTWVzc2FnZUxpc3QrIjwvdWw+Iik7CiAgICB9OwoKICAgIHJldHVybiB7CiAgICAgICAgc2V0Q29sdW1uVmlzaWJpbGl0eTogc2V0Q29sdW1uVmlzaWJpbGl0eSwKICAgICAgICBwb3B1bGF0ZUVycm9ySW5FcnJvckNvbnRhaW5lcjogcG9wdWxhdGVFcnJvckluRXJyb3JDb250YWluZXIKICAgIH07Cgp9KCk7CgpwdmkubGlzdC5kYXRhR3JpZCA9IGZ1bmN0aW9uIChjb250YWluZXJJZCwgdGFibGVJZCwgY29sdW1uc0JhcklkLCBzZWFyY2hGb3JtTmFtZSwgb3B0aW9ucykgewogICAgdmFyIGNvbnRhaW5lciA9ICQoIiMiICsgY29udGFpbmVySWQpOwogICAgdmFyIGRhdGFUYWJsZSA9IGNvbnRhaW5lci5maW5kKCIjIiArIHRhYmxlSWQpOwogICAgdmFyIGRhdGFUYWJsZU9wdGlvbnMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIG9wdGlvbnMgPyBvcHRpb25zIDoge307CiAgICB9KCk7CiAgICB2YXIgaW5pdGlhbGl6ZWQgPSBmYWxzZTsKICAgIHZhciBwYWdlU3RhcnQgPSAwOwogICAgdmFyIGNhc2VMaXN0VGFibGU7CiAgICB2YXIgY2FzZUxpc3RUYWJsZVJlZiA9IHtjYXNlTGlzdFRhYmxlOiB7fX07CiAgICB2YXIgaW5pdE9yZGVyID0gZmFsc2U7CiAgICB2YXIgcGFnZVR5cGVJZCA9IGNvbnRhaW5lci5maW5kKCJpbnB1dFtuYW1lPSdwYWdlVHlwZUlkJ10iKS52YWwoKTsKICAgIHZhciBpc09uRHVwbGljYXRlU2VhcmNoUGFnZSA9ICh0eXBlb2YgZHVwbGljYXRlU2VhcmNoUGFnZUlkICE9PSAndW5kZWZpbmVkJykgJiYgKHBhZ2VUeXBlSWQgPT09IGR1cGxpY2F0ZVNlYXJjaFBhZ2VJZC50b1N0cmluZygpKTsKICAgIHZhciBhY3Rpb25WaXNpYmxlID0gY29udGFpbmVyLmZpbmQoImlucHV0W25hbWU9J2FjdGlvblZpc2libGUnXSIpLnZhbCgpOwogICAgdmFyIGlzTG9hZGVkVmlhQmFjayA9IHB2aS51dGlsLmlzRnJvbUJhY2tCdXR0b25QYWdlKCk7CiAgICBkYXRhVGFibGVPcHRpb25zLmxvYWREYXRhID0gISFjb250YWluZXIuZmluZCgiaW5wdXRbbmFtZT0nbG9hZERhdGEnXSIpLmRhdGEoJ3ZhbHVlJykgfHwgaXNMb2FkZWRWaWFCYWNrOwogICAgdmFyIGRhdGFFbGVtZW50cyA9IGNvbnRhaW5lci5maW5kKCIjbGlzdC1kYXRhLWVsZW1lbnRzIik7CiAgICB2YXIgcGFnZUxlbmd0aCA9IGRhdGFFbGVtZW50cy5kYXRhKCdwYWdlLWxlbmd0aCcpOwogICAgdmFyIGNvbHVtbnNCYXIgPSBjb250YWluZXIuZmluZCgnIycgKyBjb2x1bW5zQmFySWQpOwogICAgdmFyIGNvbHVtblNpemU7CiAgICB2YXIgZm9jdXNPbkZpeGVkQ29sID0gZmFsc2U7CiAgICB2YXIgZml4ZWRGaWx0ZXJDb2xOYW1lID0gImludGFrZUNhc2VOdW1iZXIiOwogICAgdmFyIGlzRGFzaGJvYXJkUGFnZSA9ICQoJyNpc0Rhc2hib2FyZFBhZ2UnKS5sZW5ndGggPiAwOwogICAgdmFyIHNjcm9sbGFibGVTZWN0aW9uID0gY29udGFpbmVyLmZpbmQoIi5kYXRhVGFibGVzX3Njcm9sbEJvZHkiKTsKICAgIHZhciBzY3JvbGxhYmxlRml4ZWRDb2wgPSBjb250YWluZXIuZmluZCgiLkRURkNfTGVmdEJvZHlMaW5lciIpOwogICAgdmFyIGNvbHVtbkNvbmZpZ3MgPSBbXTsKCiAgICB2YXIgZ2V0U3RvcmFnZUtleSA9IGZ1bmN0aW9uIChwcmltYXJ5S2V5KSB7CiAgICAgICAgcmV0dXJuIHNlYXJjaEZvcm1OYW1lICsgJzonICsgcHJpbWFyeUtleTsKICAgIH07CgogICAgdmFyIHNlYXJjaEZvcm1TdGF0ZSA9IG5ldyBGb3JtU3RhdGUoJCgnZm9ybVtuYW1lPSInICsgc2VhcmNoRm9ybU5hbWUgKyAnIl0nKSwgYnJvd3NlclN0b3JhZ2UudXRpbHMuYXBwVXNlclN0b3JhZ2VLZXkgKyBnZXRTdG9yYWdlS2V5KCdGT1JNX1NUQVRFJykpOwoKICAgIHZhciBidWlsZEluY2x1ZGVFeGNsdWRlVmFsdWVzID0gZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBzdGF0ZXNMaXN0ID0gXy5yZWR1Y2UoY29udGFpbmVyLmZpbmQoJ2lucHV0W2Nhc2VTdGF0ZV0nKSwgZnVuY3Rpb24gKG1lbW8sIGNoZWNrYm94KSB7CiAgICAgICAgICAgIHZhciBjaGVja2VkID0gY2hlY2tib3guY2hlY2tlZDsKICAgICAgICAgICAgaWYgKGNoZWNrZWQpIHsKICAgICAgICAgICAgICAgIG1lbW8ucHVzaChjb250YWluZXIuZmluZChjaGVja2JveCkuYXR0cigndmFsdWUnKS50b0xvd2VyQ2FzZSgpKQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBtZW1vOwogICAgICAgIH0sIFtdKTsKICAgICAgICBpZiAoc3RhdGVzTGlzdCAmJiBzdGF0ZXNMaXN0Lmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgcmV0dXJuIHN0YXRlc0xpc3Quam9pbigpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmIChjb250YWluZXIuZmluZCgnZGl2LnJlcG9ydC1kaXN0cmlidXRpb24gaW5wdXQnKS5pcygiOmNoZWNrZWQiKSkgewogICAgICAgICAgICAgICAgcmV0dXJuICIiCiAgICAgICAgICAgIH0gZWxzZQogICAgICAgICAgICAgICAgcmV0dXJuICJ4eHh4eC1jcmF6eSI7IC8vUmV0dXJuIHNvbWV0aGluZyBjcmF6eQogICAgICAgIH0KICAgIH07CgogICAgLy8gSGFuZGxlIHNvdXJjZSBkYXRhYmFzZQogICAgdmFyIGdldFNvdXJjZURhdGFiYXNlcyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgc291cmNlcyA9IFtdOwogICAgICAgIGNvbnRhaW5lci5maW5kKCcucHYtc291cmNlLWRhdGFiYXNlJykuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGlmICgkKHRoaXMpLmlzKCI6Y2hlY2tlZCIpKSB7CiAgICAgICAgICAgICAgICBzb3VyY2VzLnB1c2goJCh0aGlzKS52YWwoKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICByZXR1cm4gc291cmNlczsKICAgIH07CgogICAgLyoqCiAgICAgKiBGb3IgRlUvRFMsIG1ldGhvZCBzaG91bGQgdXNlIHRoZSB1c2VyIHNlbGVjdGlvbiwgZm9yIGludGFrZSBjYXNlIG9yIGNhc2UgbGlzdCwgbWV0aG9kIHdpbGwgcmV0dXJuIGRlZmF1bHQgaW50YWtlIGRiCiAgICAgKiBAcmV0dXJucyB7QXJyYXl9CiAgICAgKi8KICAgIHZhciBnZXRTb3VyY2VEYXRhYmFzZXNPckRlZmF1bHQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIERFRkFVTFRfU09VUkNFX0RCID0gMTsKICAgICAgICB2YXIgc291cmNlcyA9IGdldFNvdXJjZURhdGFiYXNlcygpOwogICAgICAgIGlmIChzb3VyY2VzLmxlbmd0aCA8IDEpIHNvdXJjZXMucHVzaChERUZBVUxUX1NPVVJDRV9EQik7CiAgICAgICAgcmV0dXJuIHNvdXJjZXM7CiAgICB9OwoKICAgIHZhciBkYXRlUmFuZ2VRdWVyeT0gZnVuY3Rpb24oc3RhcnREYXRlLCBlbmREYXRlKXsKICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoeyJndGUiIDogc3RhcnREYXRlICwgImx0ZSIgOiAgZW5kRGF0ZSB9KTsKICAgIH07CgogICAgdmFyIGJ1aWxkTGFzdFhTZWFyY2hDb25kaXRpb24gPSBmdW5jdGlvbiAoeF9mYWN0b3IsIHVuaXQpIHsKICAgICAgICB2YXIgcmFuZ2UgPSBidWlsZExhc3RYU2VhcmNoQ29uZGl0aW9uSnNvbih4X2ZhY3RvciwgdW5pdCk7CiAgICAgICAgcmV0dXJuICBkYXRlUmFuZ2VRdWVyeShyYW5nZS5zdGFydFRpbWUsIHJhbmdlLmVuZFRpbWUpOwogICAgfTsKCiAgICBmdW5jdGlvbiBidWlsZExhc3RYRGF0ZVJhbmdlSnNvbihzdWJVbml0LCB1bml0LCB4X2ZhY3RvcikgewogICAgICAgIHZhciB0b2RheSA9IG1vbWVudCgpLnR6KGNvcnBvcmF0ZVRpbWV6b25lKTsKICAgICAgICB2YXIgbGFzdFggPSB0b2RheS5zdWJ0cmFjdChzdWJVbml0LCB1bml0KTsKICAgICAgICB2YXIgeE1vbnRoQWdhbyA9IGxhc3RYLmNsb25lKCkuc3VidHJhY3QoeF9mYWN0b3IgLSAxLCB1bml0KTsKICAgICAgICB2YXIgc3RhcnRUaW1lID0geE1vbnRoQWdhby5jbG9uZSgpLnN0YXJ0T2YodW5pdCkudXRjKCkuZm9ybWF0KCk7CiAgICAgICAgdmFyIGVuZFRpbWUgPSBsYXN0WC5jbG9uZSgpLmVuZE9mKHVuaXQpLnV0YygpLmZvcm1hdCgpOwoKICAgICAgICByZXR1cm4gZGF0ZVJhbmdlUXVlcnkoc3RhcnRUaW1lLCBlbmRUaW1lKTsKICAgIH0KCiAgICB2YXIgYnVpbGRMYXN0WFNlYXJjaENvbmRpdGlvbkpzb24gPSBmdW5jdGlvbiAoeF9mYWN0b3IsIHVuaXQpIHsKICAgICAgICB2YXIgc3ViVW5pdCA9IDE7CiAgICAgICAgaWYgKGlzSW5jbHVkZVRvZGF5SW5TZWFyY2hDcml0ZXJpYSA9PT0gInRydWUiIHx8IGlzSW5jbHVkZVRvZGF5SW5TZWFyY2hDcml0ZXJpYSA9PT0gdHJ1ZSkgewogICAgICAgICAgICBzdWJVbml0ID0gMDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGJ1aWxkTGFzdFhEYXRlUmFuZ2VKc29uKHN1YlVuaXQsIHVuaXQsIHhfZmFjdG9yKTsKICAgIH07CgogICAgdmFyIGdldERlZmF1bHREYXRlUmFuZ2UgPSBmdW5jdGlvbigpewogICAgICAgIHZhciBjcml0ZXJpYSA9IGJ1aWxkTGFzdFhTZWFyY2hDb25kaXRpb25Kc29uKGRlZmF1bHREYXRlUmFuZ2VWYWx1ZSwgJ2RheScpOwogICAgICAgIGNyaXRlcmlhLnJhbmdlID0gJ0xBU1RfWF9EQVlTJzsKICAgICAgICBjcml0ZXJpYS54ID0gZGVmYXVsdERhdGVSYW5nZVZhbHVlOwogICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShjcml0ZXJpYSk7CiAgICB9OwoKICAgIHZhciBjcmVhdGVEYXRlUmFuZ2VWYWx1ZSA9IGZ1bmN0aW9uIChyYW5nZSwgeF9mYWN0b3IpIHsKICAgICAgICB2YXIgdmFsdWUgPSBudWxsOwogICAgICAgIHN3aXRjaCAocmFuZ2UpIHsKICAgICAgICAgICAgY2FzZSAnVE9EQVknOgogICAgICAgICAgICAgICAgdmFyIGZpbHRlckRhdGVDbG9uZSA9IG1vbWVudCgpLnR6KGNvcnBvcmF0ZVRpbWV6b25lKS5jbG9uZSgpOwogICAgICAgICAgICAgICAgdmFyIHN0YXJ0T2ZUb2RheSA9IGZpbHRlckRhdGVDbG9uZS5zdGFydE9mKCdkYXknKS51dGMoKS5mb3JtYXQoKTsKICAgICAgICAgICAgICAgIHZhciBlbmRPZlRvZGF5ID0gZmlsdGVyRGF0ZUNsb25lLmVuZE9mKCdkYXknKS51dGMoKS5mb3JtYXQoKTsKICAgICAgICAgICAgICAgIHZhbHVlID0gZGF0ZVJhbmdlUXVlcnkoc3RhcnRPZlRvZGF5LCBlbmRPZlRvZGF5KTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlICdZRVNURVJEQVknOgogICAgICAgICAgICAgICAgdmFsdWUgPSBidWlsZExhc3RYRGF0ZVJhbmdlSnNvbigxLCAnZGF5JywxKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlICdMQVNUX1dFRUsnOgogICAgICAgICAgICAgICAgdmFsdWUgPSBidWlsZExhc3RYU2VhcmNoQ29uZGl0aW9uSnNvbigxLCAnd2VlaycpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ0xBU1RfTU9OVEgnOgogICAgICAgICAgICAgICAgdmFsdWUgPSBidWlsZExhc3RYU2VhcmNoQ29uZGl0aW9uSnNvbigxLCAnbW9udGgnKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlICdMQVNUX1lFQVInOgogICAgICAgICAgICAgICAgdmFsdWUgPSBidWlsZExhc3RYU2VhcmNoQ29uZGl0aW9uSnNvbigxLCAneWVhcicpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ0xBU1RfWF9EQVlTJzoKICAgICAgICAgICAgICAgIHZhbHVlID0gaXNEaWdpdCh4X2ZhY3RvcikgPyBidWlsZExhc3RYU2VhcmNoQ29uZGl0aW9uSnNvbih4X2ZhY3RvciwgJ2RheScpIDogdmFsdWU7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnTEFTVF9YX1dFRUtTJzoKICAgICAgICAgICAgICAgIHZhbHVlID0gaXNEaWdpdCh4X2ZhY3RvcikgPyBidWlsZExhc3RYU2VhcmNoQ29uZGl0aW9uSnNvbih4X2ZhY3RvciwgJ3dlZWsnKSA6IHZhbHVlOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ0xBU1RfWF9NT05USFMnOgogICAgICAgICAgICAgICAgdmFsdWUgPSBpc0RpZ2l0KHhfZmFjdG9yKSA/IGJ1aWxkTGFzdFhTZWFyY2hDb25kaXRpb25Kc29uKHhfZmFjdG9yLCAnbW9udGgnKSA6IHZhbHVlOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ0xBU1RfWF9ZRUFSUyc6CiAgICAgICAgICAgICAgICB2YWx1ZSA9IGlzRGlnaXQoeF9mYWN0b3IpID8gYnVpbGRMYXN0WFNlYXJjaENvbmRpdGlvbkpzb24oeF9mYWN0b3IsICd5ZWFyJykgOiB2YWx1ZTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgdmFsdWUgPSBudWxsOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdmFsdWU7CiAgICB9OwoKICAgIHZhciBpc0RpZ2l0ID0gZnVuY3Rpb24gKHhfZmFjdG9yKSB7CiAgICAgICAgdmFyIHJlZyA9IC9eXGQrJC87CiAgICAgICAgcmV0dXJuIHJlZy50ZXN0KHhfZmFjdG9yKTsKICAgIH07CgogICAgdmFyIGJ1aWxkU2ltcGxlU2VhcmNoQ3JpdGVyaWEgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIHNlYXJjaENyaXRlcmlhID0ge307CiAgICAgICAgdmFyIHNpbXBsZVNlYXJjaEZpZWxkID0gY29udGFpbmVyLmZpbmQoJyNzaW1wbGVTZWFyY2hGaWVsZCcpOwogICAgICAgIHZhciBpc1NpbXBsZVNlYXJjaEZpZWxkVmlzaWJsZSA9IHNpbXBsZVNlYXJjaEZpZWxkLmhhc0NsYXNzKCd2aXNpYmxlJyk7CiAgICAgICAgaWYgKGlzU2ltcGxlU2VhcmNoRmllbGRWaXNpYmxlKSB7CiAgICAgICAgICAgIHNlYXJjaENyaXRlcmlhWydzaW1wbGVTZWFyY2gnXSA9IHNpbXBsZVNlYXJjaEZpZWxkLnZhbCgpOwogICAgICAgIH0KICAgICAgICBidWlsZFNpbXBsZVNlYXJjaE90aGVyUHJvcGVydGllcyhzZWFyY2hDcml0ZXJpYSwgIWlzU2ltcGxlU2VhcmNoRmllbGRWaXNpYmxlKTsKCiAgICAgICAgdmFyIHR5cGUgPSBjb250YWluZXIuZmluZCgnI2RhdGUtcmFuZ2UtdHlwZScpLnZhbCgpOwogICAgICAgIHZhciByYW5nZSA9IGNvbnRhaW5lci5maW5kKCcjcHZpTGlzdERhdGVSYW5nZScpLnZhbCgpOwoKICAgICAgICBpZiAoKF8uaW5kZXhPZihvbmVDbGlja1R5cGVzLCByYW5nZSkgPiAtMSkgfHwgKF8uaW5kZXhPZih0d29DbGlja1R5cGVzLCByYW5nZSkgPiAtMSkpIHsKICAgICAgICAgICAgdmFyIHhfZmFjdG9yID0gY29udGFpbmVyLmZpbmQoJyNyYW5nZS1mYWN0b3ItZmllbGQnKS52YWwoKTsKICAgICAgICAgICAgdmFyIGRhdGVSYW5nZSA9IGNyZWF0ZURhdGVSYW5nZVZhbHVlKHJhbmdlLCB4X2ZhY3Rvcik7CiAgICAgICAgICAgIGlmICghZGF0ZVJhbmdlKSB7CiAgICAgICAgICAgICAgICBzd2FsKCIiLCBnZXRNZXNzYWdlKCJjb3JyZWN0X2RhdGVfcmFuZ2UiKSk7CiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZGF0ZVJhbmdlLnJhbmdlID0gcmFuZ2U7CiAgICAgICAgICAgIGRhdGVSYW5nZS54ID0geF9mYWN0b3I7CiAgICAgICAgICAgIHNlYXJjaENyaXRlcmlhW3R5cGVdID0gZGF0ZVJhbmdlOwogICAgICAgIH0gZWxzZSBpZiAocmFuZ2UgPT09ICdDVVNUT00nKSB7CiAgICAgICAgICAgIHZhciBkYXRlUmFuZ2VTZWFyY2hWYWx1ZSA9IGdldERhdGVSYW5nZVNlYXJjaFZhbHVlKCk7CiAgICAgICAgICAgIGlmIChkYXRlUmFuZ2VTZWFyY2hWYWx1ZSkgewogICAgICAgICAgICAgICAgc2VhcmNoQ3JpdGVyaWFbdHlwZV0gPSBkYXRlUmFuZ2VTZWFyY2hWYWx1ZTsKICAgICAgICAgICAgfSBlbHNlCiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHNlYXJjaENyaXRlcmlhOwogICAgfTsKCiAgICB2YXIgYnVpbGRTaW1wbGVTZWFyY2hPdGhlclByb3BlcnRpZXMgPSBmdW5jdGlvbiAoc2VhcmNoQ3JpdGVyaWEsIGlzU2VjdGlvblZpc2libGUpIHsKCiAgICAgICAgaWYgKGlzU2VjdGlvblZpc2libGUpIHsKICAgICAgICAgICAgXy5lYWNoKGNvbnRhaW5lci5maW5kKCJpbnB1dFtkYXRhLXNlYXJjaC1maWVsZF06dmlzaWJsZSIpLCBmdW5jdGlvbiAoaW5wdXQpIHsKICAgICAgICAgICAgICAgIGlucHV0ID0gJChpbnB1dCk7CiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBpbnB1dC52YWwoKTsKICAgICAgICAgICAgICAgIGlmICghXy5pc0VtcHR5KHZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIHZhciBpbnB1dFNlYXJjaEZpZWxkRGF0YSA9IGlucHV0LmRhdGEoInNlYXJjaC1maWVsZCIpOwogICAgICAgICAgICAgICAgICAgIHNlYXJjaENyaXRlcmlhW2lucHV0U2VhcmNoRmllbGREYXRhXSA9IGlucHV0Lmhhc0NsYXNzKCdnZW5lcmF0ZURhdGVSYW5nZScpID8gcHZpLnV0aWwuZ2VuZXJhdGVEYXRlUmFuZ2UodmFsdWUpIDogdmFsdWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgXy5lYWNoKGNvbnRhaW5lci5maW5kKCJzZWxlY3RbZGF0YS1zZWFyY2gtZmllbGRdOnZpc2libGUiKSwgZnVuY3Rpb24gKGlucHV0KSB7CiAgICAgICAgICAgICAgICBpbnB1dCA9ICQoaW5wdXQpOwogICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gcHZpLnV0aWwuZ2V0U2VsZWN0ZWRWYWx1ZUZyb21TZWxlY3QyKGlucHV0KTsKICAgICAgICAgICAgICAgIGlmICghXy5pc0VtcHR5KHZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIHNlYXJjaENyaXRlcmlhW2lucHV0LmRhdGEoInNlYXJjaC1maWVsZCIpXSA9IHZhbHVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIHNlYXJjaENyaXRlcmlhWydjYXNlU3RhdGVJZCddID0gYnVpbGRJbmNsdWRlRXhjbHVkZVZhbHVlcygpOwoKICAgICAgICB2YXIgbGlzdERhdGFDb250YWluZXJEaXYgPSBjb250YWluZXIuZmluZCgiI2xpc3QtZGF0YS1lbGVtZW50cyIpOwogICAgICAgIHZhciBpc09yT3BlcmF0aW9uID0gbGlzdERhdGFDb250YWluZXJEaXYuZGF0YSgiaXMtb3Itb3BlcmF0aW9uIik7CiAgICAgICAgdmFyIHNvcnRXaGlsZVNlYXJjaCA9IGxpc3REYXRhQ29udGFpbmVyRGl2LmRhdGEoInNvcnQtd2hpbGUtc2VhcmNoIik7CiAgICAgICAgdmFyIGNvdW50U2VhcmNoQ3JpdGVyaWEgPSBsaXN0RGF0YUNvbnRhaW5lckRpdi5kYXRhKCJjb3VudC1zZWFyY2gtY3JpdGVyaWEiKTsKICAgICAgICBzZWFyY2hDcml0ZXJpYVsnY29uZmlnJ10gPSAneyJpc09yT3BlcmF0aW9uIjogIicgKyBpc09yT3BlcmF0aW9uICsgJyIsICJzb3J0V2hpbGVTZWFyY2giOiAiJyArIHNvcnRXaGlsZVNlYXJjaCArICciLCAiY291bnRTZWFyY2hDcml0ZXJpYSI6ICInICsgY291bnRTZWFyY2hDcml0ZXJpYSArICcifSc7CgogICAgICAgIGlmIChsaXN0RGF0YUNvbnRhaW5lckRpdi5kYXRhKCJvbmx5LWxhdGVzdC12YWxpZC12ZXJzaW9uIikgPT09IHRydWUpIHsKICAgICAgICAgICAgc2VhcmNoQ3JpdGVyaWFbJ2lzTGF0ZXN0VmFsaWRWZXJzaW9uJ10gPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKGNvbnRhaW5lci5maW5kKCdkaXYucmVwb3J0LWRpc3RyaWJ1dGlvbiBpbnB1dCcpLmlzKCI6Y2hlY2tlZCIpKSB7CiAgICAgICAgICAgIHNlYXJjaENyaXRlcmlhWydyZXBvcnREaXN0cmlidXRpb25UaHJlc2hvbGQnXSA9IHRydWU7CiAgICAgICAgfQogICAgICAgIC8vIEhhbmRsZSBzb3VyY2UgZGF0YWJhc2UKICAgICAgICBzZWFyY2hDcml0ZXJpYVsnc291cmNlRGJJZCddID0gZ2V0U291cmNlRGF0YWJhc2VzT3JEZWZhdWx0KCkuam9pbigiLCIpOwogICAgfTsKCiAgICB2YXIgZ2V0RGF0ZVJhbmdlU2VhcmNoVmFsdWUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIHJhbmdlU3RhcnQgPSBjb250YWluZXIuZmluZCgnI2RhdGVwaWNrZXItcmFuZ2VTdGFydERhdGUnKS52YWwoKTsKICAgICAgICB2YXIgcmFuZ2VFbmQgPSBjb250YWluZXIuZmluZCgnI2RhdGVwaWNrZXItcmFuZ2VFbmREYXRlJykudmFsKCk7CgogICAgICAgIGlmICghKHJhbmdlU3RhcnQgfHwgcmFuZ2VFbmQpKSB7CiAgICAgICAgICAgIHB2aS51dGlsLnNob3dJbmZvKGdldE1lc3NhZ2UoImVudGVyX3N0YXJ0X2VuZF9kYXRlIikpOwogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CgogICAgICAgIGlmICghcmFuZ2VTdGFydCkgewogICAgICAgICAgICBzd2FsKCIiLCBnZXRNZXNzYWdlKCJlbnRlcl9zdGFydF9kYXRlIikpOwogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CgogICAgICAgIGlmICghcmFuZ2VFbmQpIHsKICAgICAgICAgICAgc3dhbCgiIiwgZ2V0TWVzc2FnZSgiZW50ZXJfZW5kX2RhdGUiKSk7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFwdmkudXRpbC5pc1ZhbGlkRGF0ZShyYW5nZVN0YXJ0KSkgewogICAgICAgICAgICBzd2FsKCIiLCBnZXRNZXNzYWdlKCJjb3JyZWN0X3N0YXJ0X2RhdGUiKSk7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFwdmkudXRpbC5pc1ZhbGlkRGF0ZShyYW5nZUVuZCkpIHsKICAgICAgICAgICAgc3dhbCgiIiwgZ2V0TWVzc2FnZSgiY29ycmVjdF9lbmRfZGF0ZSIpKTsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICAgIHZhciBzdXBwb3J0ZWREYXRlVGltZUZvcm1hdCA9IHB2aS51dGlsLnN1cHBvcnRlZERhdGVUaW1lRm9ybWF0OwoKICAgICAgICB2YXIgc2VhcmNoX3N0YXJ0ID0gbW9tZW50KHJhbmdlU3RhcnQsIHN1cHBvcnRlZERhdGVUaW1lRm9ybWF0KS50eihjb3Jwb3JhdGVUaW1lem9uZSwgdHJ1ZSkuc3RhcnRPZignZGF5JykudXRjKCk7CiAgICAgICAgdmFyIHNlYXJjaF9lbmQgPSBtb21lbnQocmFuZ2VFbmQsIHN1cHBvcnRlZERhdGVUaW1lRm9ybWF0KS50eihjb3Jwb3JhdGVUaW1lem9uZSwgdHJ1ZSkuZW5kT2YoJ2RheScpLnV0YygpOwogICAgICAgIHZhciB2YWx1ZSA9IG51bGw7CiAgICAgICAgaWYgKChyYW5nZVN0YXJ0ICYmIHJhbmdlRW5kKSAmJiAoc2VhcmNoX2VuZC5pc0FmdGVyKHNlYXJjaF9zdGFydCkpKSB7CiAgICAgICAgICAgIHZhbHVlID0gZGF0ZVJhbmdlUXVlcnkoc2VhcmNoX3N0YXJ0LmZvcm1hdCgpLCBzZWFyY2hfZW5kLmZvcm1hdCgpKTsKCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYgKCEocmFuZ2VTdGFydCAmJiByYW5nZUVuZCkpIHsKICAgICAgICAgICAgICAgIHN3YWwoIiIsIGdldE1lc3NhZ2UoImVudGVyX3N0YXJ0X2VuZF9kYXRlIikpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgc3dhbCgiIiwgZ2V0TWVzc2FnZSgic3RhcnRfZW5kX2NvbnN0cmFpbnQiKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgfTsKCiAgICB2YXIgb25lQ2xpY2tUeXBlcyA9IFsnVE9EQVknLCAnWUVTVEVSREFZJywgJ0xBU1RfV0VFSycsICdMQVNUX01PTlRIJywgJ0xBU1RfWUVBUiddOwogICAgdmFyIHR3b0NsaWNrVHlwZXMgPSBbJ0xBU1RfWF9EQVlTJywgJ0xBU1RfWF9XRUVLUycsICdMQVNUX1hfTU9OVEhTJywgJ0xBU1RfWF9ZRUFSUyddOwoKICAgIHZhciBzaG93V2FybmluZyA9IGZ1bmN0aW9uICh0aXRsZSwgdGV4dCwgY2FuY2VsQnRuVGV4dCwgY29uZmlybUJ0blRleHQsIGNhbGxCYWNrKSB7CiAgICAgICAgdmFyIG9wdGlvbnMgPSB7CiAgICAgICAgICAgIHRpdGxlOiB0aXRsZSwKICAgICAgICAgICAgdGV4dDogdGV4dCwKICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICBjb25maXJtQnV0dG9uQ29sb3I6ICIjREQ2QjU1IiwKICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6IGNvbmZpcm1CdG5UZXh0LAogICAgICAgICAgICBjbG9zZU9uQ29uZmlybTogdHJ1ZQogICAgICAgIH07CiAgICAgICAgaWYoY2FuY2VsQnRuVGV4dCl7CiAgICAgICAgICAgIG9wdGlvbnMuc2hvd0NhbmNlbEJ1dHRvbiA9IHRydWU7CiAgICAgICAgICAgIG9wdGlvbnMuY2FuY2VsQnV0dG9uVGV4dCA9IGNhbmNlbEJ0blRleHQ7CiAgICAgICAgfQogICAgICAgIHN3YWwob3B0aW9ucywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgY2FsbEJhY2soKTsKICAgICAgICAgICAgfSk7CiAgICB9OwoKICAgIHZhciBhc3NpZ25lZFRvVXNlck9wdGlvbnM7CgogICAgdmFyIGJpbmREcm9wZG93bkZpbHRlcnMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgYXNzaWduZWRUb1VzZXJPcHRpb25zID0gZ2V0VXNlckxpc3QoKTsKICAgICAgICBhc3NpZ25lZFRvVXNlck9wdGlvbnMuc3BsaWNlKDAsMCx7aWQ6Jy0xJyx0ZXh0OiBnZXRNZXNzYWdlKCJzZWxlY3RfYmxhbmtfb3B0aW9uIil9KTsKICAgICAgICBjb250YWluZXIuZmluZCgnI2Fzc2lnbmVlLWZpbHRlcicpLnNlbGVjdDIoewogICAgICAgICAgICBkYXRhOiBhc3NpZ25lZFRvVXNlck9wdGlvbnMsCiAgICAgICAgICAgIHBsYWNlaG9sZGVyOiBnZXRNZXNzYWdlKCJzZWxlY3RfZGVmYXVsdF90ZXh0IiksCiAgICAgICAgICAgIGFsbG93Q2xlYXI6IHRydWUKICAgICAgICB9KTsKICAgICAgICB2YXIgYXNzaWduZWRVc2VybmFtZSA9IGNhc2VMaXN0VGFibGVSZWYuY2FzZUxpc3RUYWJsZS5jb2x1bW4oJ2Fzc2lnbmVkVG9Vc2VybmFtZTpuYW1lJykuc2VhcmNoKCk7CiAgICAgICAgaWYgKGFzc2lnbmVkVXNlcm5hbWUgPT09IHVuZGVmaW5lZCB8fCBhc3NpZ25lZFVzZXJuYW1lID09PSBsb2dpblVzZXIpewogICAgICAgICAgICBjb250YWluZXIuZmluZCgnI2Fzc2lnbmVlLWZpbHRlcicpLnZhbChsb2dpblVzZXIpLnRyaWdnZXIoImNoYW5nZS5zZWxlY3QyIik7CiAgICAgICAgfQogICAgfTsKCiAgICB2YXIgZ2V0VXNlckxpc3QgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIHVzZXJMaXN0ID0gcHZpLnV0aWwuZmV0Y2hVc2Vyc1JlZmVyZW5jZURhdGEoKTsKICAgICAgICBfLmVhY2godXNlckxpc3QgLGZ1bmN0aW9uIChvYmopIHsKICAgICAgICAgICAgb2JqLmlkID0gb2JqLnRleHQ7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHVzZXJMaXN0OwogICAgfTsKCiAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHsKCiAgICAgICAgdmFyIG5vQWN0aW9uQWxsb3dlZEJ1dHRvbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgY29udGFpbmVyLmZpbmQoJy5wdi1saXN0LXRhYmxlJykub24oJ2NsaWNrJywgJ2J1dHRvbi5ub0FjdGlvbkFsbG93ZWQnLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgc3dhbCgiIiwgZ2V0TWVzc2FnZSgnbm9fYWN0aW9uX3N0YXRlJykgKyBjb250YWluZXIuZmluZCh0aGlzKS5hdHRyKCJkYXRhLWNhc2Utc3RhdGUiKSArICIgU3RhdGUiLCAiIik7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0pOwogICAgICAgIH07CgogICAgICAgIHZhciBub0J1bGtBY3Rpb25BbGxvd2VkQnV0dG9uID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICBjb250YWluZXIuZmluZCgnLmdyaWQtdG9wLWhlYWQnKS5vbignY2xpY2snLCAnYnV0dG9uLm5vQnVsa0FjdGlvbkFsbG93ZWQnLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgc3dhbCgiIiwgZ2V0TWVzc2FnZSgnbm9fYnVsa19hY3Rpb25fc3RhdGUnKSwgIiIpOwogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9KTsKICAgICAgICB9OwoKICAgICAgICB2YXIgYnVsa0FjdGlvbkNhbGxiYWNrID0gZnVuY3Rpb24gKHBhcmFtcyx0YXJnZXRDb250YWluZXIpIHsKICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICAgIHVybDogcHZpX3VybHMuYnVsa19jaGFuZ2VfY2FzZV9zdGF0ZSwKICAgICAgICAgICAgICAgIHR5cGU6ICdQT1NUJywKICAgICAgICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgICAgICAgICBkYXRhOiBKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgICAgICAgICAgICAgICAgIGlkczogcGFyYW1zLmlkcywKICAgICAgICAgICAgICAgICAgICAgICAgdG9TdGF0ZUlkOiBwYXJhbXMudG9TdGF0ZUlkLAogICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25QZXJmb3JtZWQ6IHBhcmFtcy5hY3Rpb24KICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGJlZm9yZVNlbmQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBwdnVpLmNvbW1vbi5zaG93UFZMb2FkZXIoKTsKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHZhciByZXNwID1KU09OLnBhcnNlKGRhdGEpOwogICAgICAgICAgICAgICAgICAgIGlmIChwYXJzZUludChyZXNwLnN0YXR1cykgPT09IDQyMil7CiAgICAgICAgICAgICAgICAgICAgICAgIHB2aS5saXN0LmNvbW1vbkZ1bmN0aW9ucy5wb3B1bGF0ZUVycm9ySW5FcnJvckNvbnRhaW5lcihyZXNwLnRleHQuZXJyb3JzLHRhcmdldENvbnRhaW5lcik7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2VMaXN0VGFibGUuYWpheC5yZWxvYWQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgcHZ1aS5jb21tb24uaGlkZVBWTG9hZGVyKCk7CiAgICAgICAgICAgICAgICAgICAgfWVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2VMaXN0VGFibGUuYWpheC5yZWxvYWQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB2dWkuY29tbW9uLmhpZGVQVkxvYWRlcigpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHZpLnV0aWwuc2hvd0Zsb2F0aW5nTm90aWZpY2F0aW9uLnN1Y2Nlc3NNZXNzYWdlKHJlc3AubWVzc2FnZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEwMDApOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcCA9IEpTT04ucGFyc2UoZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgcHZ1aS5jb21tb24uaGlkZVBWTG9hZGVyKCk7CiAgICAgICAgICAgICAgICAgICAgcHZpLnV0aWwuc2hvd0Zsb2F0aW5nTm90aWZpY2F0aW9uLmVycm9yTWVzc2FnZShyZXNwLm1lc3NhZ2UpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9OwoKICAgICAgICB2YXIgYnVsa0FjdGlvbkNhbGxiYWNrV2l0aEp1c3RpZmljYXRpb24gPSBmdW5jdGlvbiAocGFyYW1zLCBjb250ZW50KSB7CgogICAgICAgICAgICB2YXIgcGFzc3dvcmQgPSAkKCIjanVzdGlmaWNhdGlvblBhc3N3b3JkIikudmFsKCk7CgogICAgICAgICAgICBwdmkudXRpbC5zaG93U3BpbkRsZyhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgICAgIHVybDogcHZpX3VybHMuYnVsa19jaGFuZ2VfY2FzZV9zdGF0ZSwKICAgICAgICAgICAgICAgICAgICBhc3luYzogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLAogICAgICAgICAgICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRzOiBwYXJhbXMuaWRzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9TdGF0ZUlkOiBwYXJhbXMudG9TdGF0ZUlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tbWVudHM6IGNvbnRlbnQuY29tbWVudHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25QZXJmb3JtZWQ6IHBhcmFtcy5hY3Rpb25QZXJmb3JtZWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IGNvbnRlbnQudGltZXN0YW1wLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lVG9TYXZlUHJlZmVyZW5jZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZAogICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcHZ1aS5jb21tb24uaGlkZVBWTG9hZGVyKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNwID0gSlNPTi5wYXJzZShkYXRhKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoXy5oYXMocmVzcCwgImNhc2VTdGF0ZUNoYW5nZWQiKSAmJiAhcmVzcC5jYXNlU3RhdGVDaGFuZ2VkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdmkudXRpbC5oYW5kbGVDYXNlU3RhdGVDaGFuZ2VSZWplY3Rpb24ocmVzcCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCIjcHYtanVzdGlmaWNhdGlvbi1tb2RhbCIpLm1vZGFsKCJoaWRlIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZUxpc3RUYWJsZS5hamF4LnJlbG9hZCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB2aS51dGlsLnNob3dGbG9hdGluZ05vdGlmaWNhdGlvbi5zdWNjZXNzTWVzc2FnZShyZXNwLm1lc3NhZ2UpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgMTAwMCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcCA9IEpTT04ucGFyc2UoZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHB2dWkuY29tbW9uLmhpZGVQVkxvYWRlcigpOwogICAgICAgICAgICAgICAgICAgICAgICBwdmkudXRpbC5zaG93RmxvYXRpbmdOb3RpZmljYXRpb24uZXJyb3JNZXNzYWdlKHJlc3AubWVzc2FnZSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH07CgogICAgICAgIHZhciBpbml0aWFsaXplQnVsa0FjdGlvbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgY29udGFpbmVyLmZpbmQoJy5ncmlkLXRvcC1oZWFkJykub24oJ2NsaWNrJywgJ3VsLmJ1bGstYWN0aW9uLWxpc3Q+bGkuYnVsay1hY3Rpb24nLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgdmFyIGlkcyA9IF8uY29sbGVjdChfLmZpbHRlcihjb250YWluZXIuZmluZCgnLmxpc3Qtcm93LWNoZWNrYm94OmNoZWNrZWQnKSksIGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICQoaXRlbSkuYXR0cignZGF0YS1pZCcpOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgdmFyIHZlbmRvcklkcyA9IFtdOwogICAgICAgICAgICAgICAgdmFyIHByb2R1Y3RJZHMgPSBbXTsKICAgICAgICAgICAgICAgIHZhciBjb3VudHJ5SWRzID0gW107CiAgICAgICAgICAgICAgICB2YXIgc3R1ZHlJZHMgPSBbXTsKICAgICAgICAgICAgICAgIHZhciBhc3NpZ25Ub0lkcyA9IFtdOwogICAgICAgICAgICAgICAgdmFyIGlzQ2xpbmljYWxUcmlhbCA9IFtdOwogICAgICAgICAgICAgICAgXy5lYWNoKGNvbnRhaW5lci5maW5kKCcubGlzdC1yb3ctY2hlY2tib3g6Y2hlY2tlZCcpLCBmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgICAgICAgIHZhciByb3dEYXRhID0gJChpdGVtKS5kYXRhKCk7CiAgICAgICAgICAgICAgICAgICAgaWYocm93RGF0YS52ZW5kb3JJZCkKICAgICAgICAgICAgICAgICAgICAgICAgdmVuZG9ySWRzLnB1c2gocm93RGF0YS52ZW5kb3JJZCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJvd0RhdGEucHJvZHVjdGlkcykgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNOYU4ocm93RGF0YS5wcm9kdWN0aWRzKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgXy5lYWNoKHJvd0RhdGEucHJvZHVjdGlkcy5zcGxpdCgiLCIpLCBmdW5jdGlvbiAodmFsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFfLmlzVW5kZWZpbmVkKHZhbCkgJiYgdmFsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJZHMucHVzaChwYXJzZUludCh2YWwpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJZHMucHVzaChyb3dEYXRhLnByb2R1Y3RpZHMpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmKHJvd0RhdGEuY291bnRyeWlkKQogICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJ5SWRzLnB1c2gocm93RGF0YS5jb3VudHJ5aWQpOwogICAgICAgICAgICAgICAgICAgIGlmKHJvd0RhdGEuc3R1ZHlpZCkKICAgICAgICAgICAgICAgICAgICAgICAgc3R1ZHlJZHMucHVzaChyb3dEYXRhLnN0dWR5aWQpOwogICAgICAgICAgICAgICAgICAgIGlmIChyb3dEYXRhLmFzc2lnbnRvaWQpCiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnblRvSWRzLnB1c2gocm93RGF0YS5hc3NpZ250b2lkKTsKICAgICAgICAgICAgICAgICAgICBpc0NsaW5pY2FsVHJpYWwucHVzaChyb3dEYXRhLmlzY2xpbmljYWx0cmlhbCk7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uVGFyZ2V0ID0gJCh0aGlzKS5maW5kKCJhIik7CiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0gYWN0aW9uVGFyZ2V0LmRhdGEoImFjdGlvbiIpOwogICAgICAgICAgICAgICAgdmFyIHRhcmdldENvbnRhaW5lciA9IGFjdGlvblRhcmdldC5kYXRhKCJjb250YWluZXIiKTsKICAgICAgICAgICAgICAgIHN3aXRjaCAoYWN0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBhY3RpdmVTdGF0ZUlkOgogICAgICAgICAgICAgICAgICAgICAgICBidWxrQWN0aW9uQ2FsbGJhY2soe3RvU3RhdGVJZDogYWN0aXZlU3RhdGVJZCwgYWN0aW9uOiBhY3Rpb24sIGlkczogaWRzfSx0YXJnZXRDb250YWluZXIpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIHJlamVjdGVkU3RhdGVJZDoKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHthY3Rpb25QZXJmb3JtZWQ6IGFjdGlvbiwgdG9TdGF0ZUlkOiByZWplY3RlZFN0YXRlSWQsIGlkczogaWRzfTsKICAgICAgICAgICAgICAgICAgICAgICAgcHZpLnV0aWwuanVzdGlmaWNhdGlvbk1vZHVsZSgpLnNob3dKdXN0aWZpY2F0aW9uTW9kYWwoIm1hcmtfcmVqZWN0IiwgcGFyYW1zLCBidWxrQWN0aW9uQ2FsbGJhY2tXaXRoSnVzdGlmaWNhdGlvbik7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgZmluYWxTdGF0ZUlkOgogICAgICAgICAgICAgICAgICAgICAgICBzaG93V2FybmluZygiIiwgZ2V0TWVzc2FnZSgnc3VibWl0X2J0bicpLCBwdmlfY29uc3RhbnRzLmNhbmNlbF9idG5fbGFiZWwsIHB2aV9jb25zdGFudHMuc3VjY2Vzc19idG5fbGFiZWwsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1bGtBY3Rpb25DYWxsYmFjayh7dG9TdGF0ZUlkOiBmaW5hbFN0YXRlSWQsIGFjdGlvbjogYWN0aW9uLCBpZHM6IGlkc30sdGFyZ2V0Q29udGFpbmVyKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYoYWN0aW9uVGFyZ2V0LnBhcmVudCgpLmhhc0NsYXNzKCdhc3NpZ25BbGwnKSkgewogICAgICAgICAgICAgICAgICAgIHZhciBkYXRhTWFwID0ge307CiAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbmVlTGlzdCA9ICAkKCIjYXNzaWduZWVVc2VyTGlzdCIpOwogICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlTGlzdC5zZWxlY3QyKHtkcm9wZG93blBhcmVudDogcHZpLnV0aWwuY2FzZUp1c3RpZmljYXRpb24uanVzdGlmaWNhdGlvbk1vZGFsfSk7CiAgICAgICAgICAgICAgICAgICAgZGF0YU1hcC5jb3VudHJ5SWRzID0gXy51bmlxdWUoY291bnRyeUlkcyk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHByb2R1Y3RJZHMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgICBkYXRhTWFwLnByb2R1Y3RJZHMgPSBfLnVuaXF1ZShwcm9kdWN0SWRzKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKCFfLmlzVW5kZWZpbmVkKHN0dWR5SWRzKSAmJiBzdHVkeUlkcykgewogICAgICAgICAgICAgICAgICAgICAgICBkYXRhTWFwLnN0dWR5SWRzID0gXy51bmlxdWUoc3R1ZHlJZHMpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkYXRhTWFwLmlzQ2xpbmljYWxUcmlhbCA9IF8udW5pcXVlKGlzQ2xpbmljYWxUcmlhbCk7CgogICAgICAgICAgICAgICAgICAgIGlmKHZlbmRvcklkcykgewogICAgICAgICAgICAgICAgICAgICAgICBkYXRhTWFwLnZlbmRvcklkcyA9IF8udW5pcXVlKHZlbmRvcklkcyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChhc3NpZ25Ub0lkcykgewogICAgICAgICAgICAgICAgICAgICAgICBkYXRhTWFwLmFzc2lnblRvSWRzID0gXy51bmlxdWUoYXNzaWduVG9JZHMpOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBwdmlfdXJscy5jYXNlX2Fzc2lnbmVlX3VzZXJfbGlzdF91cmwsCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtkYXRhOkpTT04uc3RyaW5naWZ5KGRhdGFNYXApfSwKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLAogICAgICAgICAgICAgICAgICAgICAgICBhc3luYzogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZUxpc3QuaHRtbCgnJykuYXBwZW5kKG5ldyBPcHRpb24oZ2V0TWVzc2FnZSgic2VsZWN0X2RlZmF1bHRfdGV4dCIpLCAwLCB0cnVlLCB0cnVlKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBKU09OLnBhcnNlKGRhdGEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICBfLmVhY2goZGF0YSwgZnVuY3Rpb24ob2JqKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlTGlzdC5hcHBlbmQobmV3IE9wdGlvbihvYmoudXNlcm5hbWUsIG9iai5pZCwgZmFsc2UsIGZhbHNlKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgcHZpLnV0aWwubWFuYWdlVXNlckFzc2lnbi51c2VyQ2FzZUFzc2lnbm1lbnRMb2dpYyhlLCBhc3NpZ25lZUxpc3QsIGFzc2lnbmVlTGlzdCwgYWN0aW9uVGFyZ2V0LCBudWxsLCBpZHMsICQoIiNhc3NpZ25lZVVzZXJMaXN0IDpzZWxlY3RlZCIpLnZhbCgpLCB0YXJnZXRDb250YWluZXIpOwogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24oZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIkxvYWRpbmcgYXNzaWduZWUgbGlzdCBmYWlsZWQuICIgKyBkYXRhKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9OwoKICAgICAgICB2YXIgaW5pdEZpbHRlckJ1dHRvbiA9IGZ1bmN0aW9uICgpIHsKCiAgICAgICAgICAgIGNvbnRhaW5lci5maW5kKCcjZmlsdGVyLWJ1dHRvbicpLmNsaWNrKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICBpZighYXNzaWduZWRUb1VzZXJPcHRpb25zKXsKICAgICAgICAgICAgICAgICAgICBiaW5kRHJvcGRvd25GaWx0ZXJzKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBwdnVpLmdyaWQubWFuYWdlVUlXcmFwcGVyLnRvZ2dsZUdyaWRGaWx0ZXIoY29udGFpbmVyLCB7ZGF0ZUZvcm1hdDooKHB2aS51dGlsLmdldERhdGVGb3JtYXRzLmxpc3REYXRlRm9ybWF0KS50b1VwcGVyQ2FzZSgpKX0pOwogICAgICAgICAgICAgICAgY29udGFpbmVyLmZpbmQoInRoZWFkLmZpbHRlci1oZWFkIikudG9nZ2xlQ2xhc3MoInB2LWZpbHRlci1hY3RpdmUiKTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjb250YWluZXIuZmluZCgiLmJ0bi1zZWxlY3QtYWxsLWNoZWNrbGlzdCBpbnB1dCIpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIGNvbnRhaW5lci5maW5kKCIucHYtaW5jbHVkZS1jYXNlcy1saXN0IGlucHV0IikucHJvcCgnY2hlY2tlZCcsICQodGhpcykucHJvcCgiY2hlY2tlZCIpKTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjb250YWluZXIuZmluZCgiLnB2LWluY2x1ZGUtY2FzZXMtbGlzdCBpbnB1dCIpLm9uKCJjaGFuZ2UiLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBjb250YWluZXIuZmluZCgiLmJ0bi1zZWxlY3QtYWxsLWNoZWNrbGlzdCBpbnB1dCIpLnByb3AoImNoZWNrZWQiLCBjaGVja0lzU2VsZWN0ZWRBbGwoKSk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgdmFyIGNoZWNrSXNTZWxlY3RlZEFsbCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHZhciBjaGVja2VkTGVuZ3RoID0gY29udGFpbmVyLmZpbmQoIi5wdi1pbmNsdWRlLWNhc2VzLWxpc3QgaW5wdXRbY2FzZVN0YXRlXTpjaGVja2VkIikubGVuZ3RoLAogICAgICAgICAgICAgICAgICAgIHRvdGFsQ2hlY2tCb3hlcyA9IGNvbnRhaW5lci5maW5kKCIucHYtaW5jbHVkZS1jYXNlcy1saXN0IGlucHV0W2Nhc2VTdGF0ZV0iKS5sZW5ndGg7CiAgICAgICAgICAgICAgICByZXR1cm4gKGNoZWNrZWRMZW5ndGggPT09IHRvdGFsQ2hlY2tCb3hlcyk7CiAgICAgICAgICAgIH07CgogICAgICAgICAgICBjb250YWluZXIuZmluZCgiI3JhbmdlLWZhY3Rvci1maWVsZCIpLmtleWRvd24oZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgIHZhciBrZXlzQ29sbGVjdGlvbiA9IFs0NiwgOCwgOSwgMjcsIDEzLCAxMTAsIDE5MF07CiAgICAgICAgICAgICAgICAvLyBBbGxvdzogYmFja3NwYWNlLCBkZWxldGUsIHRhYiwgZXNjYXBlLCBlbnRlciBhbmQgLgogICAgICAgICAgICAgICAgaWYgKGtleXNDb2xsZWN0aW9uLmluZGV4T2YoZS5rZXlDb2RlKSAhPT0gLTEgfHwKICAgICAgICAgICAgICAgICAgICAvLyBBbGxvdzogQ3RybC9jbWQrQQogICAgICAgICAgICAgICAgICAgIChlLmtleUNvZGUgPT09IDY1ICYmIChlLmN0cmxLZXkgPT09IHRydWUgfHwgZS5tZXRhS2V5ID09PSB0cnVlKSkgfHwKICAgICAgICAgICAgICAgICAgICAvLyBBbGxvdzogQ3RybC9jbWQrQwogICAgICAgICAgICAgICAgICAgIChlLmtleUNvZGUgPT09IDY3ICYmIChlLmN0cmxLZXkgPT09IHRydWUgfHwgZS5tZXRhS2V5ID09PSB0cnVlKSkgfHwKICAgICAgICAgICAgICAgICAgICAvLyBBbGxvdzogQ3RybC9jbWQrWAogICAgICAgICAgICAgICAgICAgIChlLmtleUNvZGUgPT09IDg4ICYmIChlLmN0cmxLZXkgPT09IHRydWUgfHwgZS5tZXRhS2V5ID09PSB0cnVlKSkgfHwKICAgICAgICAgICAgICAgICAgICAvLyBBbGxvdzogaG9tZSwgZW5kLCBsZWZ0LCByaWdodAogICAgICAgICAgICAgICAgICAgIChlLmtleUNvZGUgPj0gMzUgJiYgZS5rZXlDb2RlIDw9IDM5KSkgewogICAgICAgICAgICAgICAgICAgIC8vIGxldCBpdCBoYXBwZW4sIGRvbid0IGRvIGFueXRoaW5nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gRW5zdXJlIHRoYXQgaXQgaXMgYSBudW1iZXIgYW5kIHN0b3AgdGhlIGtleXByZXNzCiAgICAgICAgICAgICAgICBpZiAoKGUuc2hpZnRLZXkgfHwgKGUua2V5Q29kZSA8IDQ4IHx8IGUua2V5Q29kZSA+IDU3KSkgJiYgKGUua2V5Q29kZSA8IDk2IHx8IGUua2V5Q29kZSA+IDEwNSkpIHsKICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY29udGFpbmVyLmZpbmQoJyNyYW5nZS1mYWN0b3ItZmllbGQnKS5rZXlwcmVzcyhmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgICAgICAgIHJldHVybiAoZXZlbnQud2hpY2ggIT09IDEzKTsgIC8vIHJldHVybmluZyBmYWxzZSB3aWxsIHByZXZlbnQgdGhlIGV2ZW50IGZyb20gYnViYmxpbmcgdXAuCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY29udGFpbmVyLmZpbmQoJyNzaW1wbGVTZWFyY2hGaWVsZCcpLmtleXVwKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09PSAxMykgewogICAgICAgICAgICAgICAgICAgIHZhciBzZWFyY2hDcml0ZXJpYSA9IGJ1aWxkU2ltcGxlU2VhcmNoQ3JpdGVyaWEoKTsKICAgICAgICAgICAgICAgICAgICBpZihzZWFyY2hDcml0ZXJpYSkKICAgICAgICAgICAgICAgICAgICAgICAgZG9TaW1wbGVTZWFyY2goSlNPTi5zdHJpbmdpZnkoc2VhcmNoQ3JpdGVyaWEpKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY29udGFpbmVyLmZpbmQoJyNwdmlMaXN0RGF0ZVJhbmdlPm9wdGlvblt2YWx1ZT0nICsgZGVmYXVsdERhdGVSYW5nZUtleSArICddJykucHJvcCgnc2VsZWN0ZWQnLCB0cnVlKTsgIC8vdGhpcyB2YWx1ZSBpcyBwaWNrZWQgdXAgZnJvbSBsaXN0LmdzcCAoZGVmYXVsdERhdGVSYW5nZUtleSkKICAgICAgICAgICAgY29udGFpbmVyLmZpbmQoJyNwdmlMaXN0RGF0ZVJhbmdlJykudHJpZ2dlcignY2hhbmdlJyk7CiAgICAgICAgICAgIGNvbnRhaW5lci5maW5kKCcjcmFuZ2UtZmFjdG9yLWZpZWxkJykudmFsKGRlZmF1bHREYXRlUmFuZ2VWYWx1ZSk7IC8vdGhpcyB2YWx1ZSBpcyBwaWNrZWQgdXAgZnJvbSBsaXN0LmdzcCAoZGVmYXVsdERhdGVSYW5nZVZhbHVlKQogICAgICAgIH07CgogICAgICAgIHZhciBkb1NpbXBsZVNlYXJjaCA9IGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgICAgICB2YXIgY29sdW1uID0gY2FzZUxpc3RUYWJsZS5jb2x1bW4oJ3NpbXBsZVNlYXJjaDpuYW1lJyk7CiAgICAgICAgICAgIGlmIChkYXRhRWxlbWVudHMuZGF0YSgic2F2ZS1mb3JtLXN0YXRlIikpIHsKICAgICAgICAgICAgICAgIGlmICh2YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIHNlYXJjaEZvcm1TdGF0ZS5zYXZlU3RhdGUoKTsKICAgICAgICAgICAgICAgICAgICBwdmkudXNlci5zdGF0ZS5zYXZlU3RhdGUoc2VhcmNoRm9ybVN0YXRlLmdldFN0YXRlKCksIHNlYXJjaEZvcm1OYW1lLCBwdmlfcGFnZV9zZWN0aW9uX25hbWUuZm9ybV9zZWN0aW9uKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgc2VhcmNoRm9ybVN0YXRlLmNsZWFyU3RhdGUoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBjb2x1bW4uc2VhcmNoKCh2YWx1ZSA/IHZhbHVlIDogbnVsbCkpOwogICAgICAgICAgICBkYXRhVGFibGVPcHRpb25zLmxvYWREYXRhID0gdHJ1ZTsKICAgICAgICAgICAgaW5pdGlhbGl6ZWQgPSB0cnVlOwogICAgICAgICAgICBkcmF3VGFibGUoKTsKICAgICAgICB9OwoKICAgICAgICB2YXIgZHJhd1RhYmxlID0gZnVuY3Rpb24ocGFnaW5nKXsKICAgICAgICAgICAgaWYoZGF0YVRhYmxlT3B0aW9ucy5sb2FkRGF0YSkgewogICAgICAgICAgICAgICAgaXNEYXNoYm9hcmRQYWdlID8gcHZ1aS5jb21tb24ucHZXaWRnZXRMb2FkZXIuaGlkZUxvYWRlcihjb250YWluZXIpIDogcHZ1aS5jb21tb24uaGlkZVBWTG9hZGVyKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoXy5pc1VuZGVmaW5lZChwYWdpbmcpKXsKICAgICAgICAgICAgICAgIGNhc2VMaXN0VGFibGUuZHJhdygpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY2FzZUxpc3RUYWJsZS5kcmF3KHBhZ2luZyk7CiAgICAgICAgICAgICAgICBpZighZGF0YVRhYmxlT3B0aW9ucy5sb2FkRGF0YSkgewogICAgICAgICAgICAgICAgICAgIHB2dWkuY29tbW9uLmhpZGVQVkxvYWRlcigpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAgICAgY29udGFpbmVyLm9uKCdsaXN0LmRhdGEudGFibGUuY2xlYXIucm93cycsZnVuY3Rpb24gKCkgewogICAgICAgICAgICBkYXRhVGFibGVPcHRpb25zLmxvYWREYXRhID0gZmFsc2U7CiAgICAgICAgICAgIGRyYXdUYWJsZSgpOwogICAgICAgICAgICBkYXRhVGFibGVPcHRpb25zLmxvYWREYXRhID0gdHJ1ZTsKICAgICAgICB9KTsKCiAgICAgICAgdmFyIGluaXREaXNwbGF5TGVuZ3RoID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICBjb250YWluZXIuZmluZCgnLmlucC1kaXNwbGF5LXJlY29yZCcpLmNoYW5nZShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB2YXIgZGlzcGxheUxlbmd0aCA9IGNvbnRhaW5lci5maW5kKCcuaW5wLWRpc3BsYXktcmVjb3JkJykudmFsKCk7CiAgICAgICAgICAgICAgICBjYXNlTGlzdFRhYmxlLnBhZ2UubGVuKGRpc3BsYXlMZW5ndGgpOwogICAgICAgICAgICAgICAgZHJhd1RhYmxlKGZhbHNlKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfTsKCiAgICAgICAgdmFyIGhhbmRsZV9pbmNsdWRlID0gZnVuY3Rpb24gKCkgewoKICAgICAgICAgICAgdmFyIHNob3dSYW5nZUZhY3RvciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIGNvbnRhaW5lci5maW5kKCcjcmFuZ2UtZmFjdG9yLWZpZWxkLWNvbnRhaW5lcicpLnJlbW92ZUNsYXNzKCdoaWRlJyk7CiAgICAgICAgICAgICAgICBoaWRlQ3VzdG9tUmFuZ2VGYWN0b3IoKTsKICAgICAgICAgICAgICAgIHJldHVybiBjb250YWluZXIuZmluZCgnI3JhbmdlLWZhY3Rvci1maWVsZCcpLnZhbCgpOwogICAgICAgICAgICB9OwoKICAgICAgICAgICAgdmFyIGhpZGVSYW5nZUZhY3RvciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIGNvbnRhaW5lci5maW5kKCcjcmFuZ2UtZmFjdG9yLWZpZWxkLWNvbnRhaW5lcicpLmFkZENsYXNzKCdoaWRlJykuZmluZCgnaW5wdXQnKS52YWwoJycpOwogICAgICAgICAgICB9OwoKICAgICAgICAgICAgdmFyIHNob3dDdXN0b21SYW5nZUZhY3RvciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIGhpZGVSYW5nZUZhY3RvcigpOwogICAgICAgICAgICAgICAgY29udGFpbmVyLmZpbmQoJyNwdmlMaXN0Q3VzdG9tRGF0ZXJhbmdlJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKS5maW5kKCJpbnB1dCIpLnZhbCgnJyk7CiAgICAgICAgICAgIH07CgogICAgICAgICAgICB2YXIgaGlkZUN1c3RvbVJhbmdlRmFjdG9yID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgY29udGFpbmVyLmZpbmQoJyNwdmlMaXN0Q3VzdG9tRGF0ZXJhbmdlJykuYWRkQ2xhc3MoJ2hpZGUnKTsKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIHZhciB0eXBlID0gY29udGFpbmVyLmZpbmQoJyNkYXRlLXJhbmdlLXR5cGUnKS52YWwoKTsKICAgICAgICAgICAgdmFyIHJhbmdlID0gY29udGFpbmVyLmZpbmQoJyNwdmlMaXN0RGF0ZVJhbmdlJykudmFsKCk7CgogICAgICAgICAgICBoaWRlUmFuZ2VGYWN0b3IoKTsKICAgICAgICAgICAgaGlkZUN1c3RvbVJhbmdlRmFjdG9yKCk7CgogICAgICAgICAgICBpZiAob25lQ2xpY2tUeXBlcy5pbmRleE9mKHJhbmdlKSA+IC0xKSB7CiAgICAgICAgICAgICAgICBoaWRlUmFuZ2VGYWN0b3IoKTsKICAgICAgICAgICAgICAgIGhpZGVDdXN0b21SYW5nZUZhY3RvcigpOwogICAgICAgICAgICB9IGVsc2UgaWYgKHR3b0NsaWNrVHlwZXMuaW5kZXhPZihyYW5nZSkgPiAtMSkgewogICAgICAgICAgICAgICAgc2hvd1JhbmdlRmFjdG9yKCk7CiAgICAgICAgICAgICAgICBoaWRlQ3VzdG9tUmFuZ2VGYWN0b3IoKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChyYW5nZSA9PT0gJ0NVU1RPTScpIHsKICAgICAgICAgICAgICAgIGhpZGVSYW5nZUZhY3RvcigpOwogICAgICAgICAgICAgICAgc2hvd0N1c3RvbVJhbmdlRmFjdG9yKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICB2YXIgaW5pdEFsbENhc2VzQnV0dG9uID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICBjb250YWluZXIuZmluZCgnLmFsbENhc2VzQnV0dG9uJykuY2xpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgdmFyIGNvbHVtbiA9IGNhc2VMaXN0VGFibGUuY29sdW1uKCdhc3NpZ25lZFRvVXNlcm5hbWU6bmFtZScpOwogICAgICAgICAgICAgICAgY29sdW1uLnNlYXJjaCgnJyk7CiAgICAgICAgICAgICAgICAkKGNvbHVtbi5oZWFkZXIoKSkuZmluZCgnI2Fzc2lnbmVlLWZpbHRlcicpLnZhbCgnJykudHJpZ2dlcignY2hhbmdlLnNlbGVjdDInKTsKICAgICAgICAgICAgICAgIGhpZ2hsaWdodFRhYigpOwogICAgICAgICAgICAgICAgZHJhd1RhYmxlKCk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH07CgogICAgICAgIGNvbnRhaW5lci5maW5kKCcjZGF0ZS1yYW5nZS10eXBlLCAjcHZpTGlzdERhdGVSYW5nZScpLm9uKCdjaGFuZ2UnLCBoYW5kbGVfaW5jbHVkZSk7CgogICAgICAgIHZhciBpc0FueUNhc2VDaGVja2VkID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gKGNvbnRhaW5lci5maW5kKCdkaXYucHYtaW5jbHVkZS1jYXNlcy1saXN0IGlucHV0OmNoZWNrYm94OmNoZWNrZWQnKS5sZW5ndGggPiAwKTsKICAgICAgICB9OwoKICAgICAgICBjb250YWluZXIuZmluZCgnLnB2LXNvdXJjZS1kYXRhYmFzZScpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICBpZiAoISQodGhpcykuaXMoIjpjaGVja2VkIikpIHsKICAgICAgICAgICAgICAgIGlmIChnZXRTb3VyY2VEYXRhYmFzZXMoKS5sZW5ndGggPCAxKSB7CiAgICAgICAgICAgICAgICAgICAgc3dhbCgiIiwgZ2V0TWVzc2FnZSgic291cmNlX2RiX3dhcm5pbmdfbXNnIikpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tlZCA9ICF0aGlzLmNoZWNrZWQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgLy8gSGFuZGxpbmcgc2VhcmNoIGhlcmUKICAgICAgICB2YXIgaGFuZGxlU2VhcmNoID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICBpZihpc0FueUNhc2VDaGVja2VkKCkpewogICAgICAgICAgICAgICAgdmFyIHNlYXJjaENyaXRlcmlhID0gYnVpbGRTaW1wbGVTZWFyY2hDcml0ZXJpYSgpOwogICAgICAgICAgICAgICAgaWYgKCFfLmlzRW1wdHkoc2VhcmNoQ3JpdGVyaWEpKSB7CiAgICAgICAgICAgICAgICAgICAgZG9TaW1wbGVTZWFyY2goSlNPTi5zdHJpbmdpZnkoc2VhcmNoQ3JpdGVyaWEpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHNob3dXYXJuaW5nKCIiLCBnZXRNZXNzYWdlKCdzZWxlY3RfYV9jYXNlJyksICIiLCBwdmlfY29uc3RhbnRzLnN1Y2Nlc3NfYnRuX2xhYmVsLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgc3dhbC5jbG9zZSgpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICB2YXIgaGFuZGxlTGlzdEV4cG9ydCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICAgIHR5cGU6ICdQT1NUJywKICAgICAgICAgICAgICAgIHVybDogcHZpX3VybHMubGlzdF9leHBvcnRfdXJsICsgcGFnZVR5cGVJZCwKICAgICAgICAgICAgICAgIGRhdGE6IGNhc2VMaXN0VGFibGUuYWpheC5wYXJhbXMoKSwKICAgICAgICAgICAgICAgIGJlZm9yZVNlbmQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBwdnVpLmNvbW1vbi5zaG93UFZMb2FkZXIoKTsKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgZXhwb3J0TGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKICAgICAgICAgICAgICAgICAgICBleHBvcnRMaW5rLmhyZWYgPSBwdmlfdXJscy5saXN0X2V4cG9ydF9yZXBvcnRfZG93bmxvYWRfdXJsICsgcmVzcG9uc2UuZmlsZW5hbWU7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChleHBvcnRMaW5rKTsKICAgICAgICAgICAgICAgICAgICBleHBvcnRMaW5rLmNsaWNrKCk7CiAgICAgICAgICAgICAgICAgICAgcHZ1aS5jb21tb24uaGlkZVBWTG9hZGVyKCk7CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgZXJyb3I6ZnVuY3Rpb24gKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93bikgewogICAgICAgICAgICAgICAgICAgIHB2dWkuY29tbW9uLmhpZGVQVkxvYWRlcigpOwogICAgICAgICAgICAgICAgICAgIHB2aS51dGlsLnNob3dGbG9hdGluZ05vdGlmaWNhdGlvbi5lcnJvck1lc3NhZ2UoZXJyb3JUaHJvd24pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9OwoKICAgICAgICBjb250YWluZXIuZmluZCgnLnNlYXJjaC1idXR0b24nKS5jbGljayhoYW5kbGVTZWFyY2gpOwogICAgICAgIGNvbnRhaW5lci5maW5kKCcjZXhwb3J0LWV4Y2VsLWJ1dHRvbicpLmNsaWNrKGhhbmRsZUxpc3RFeHBvcnQpOwoKICAgICAgICBjb250YWluZXIuZmluZCgnI3B2aUNhc2VTZWFyY2hJY29uJykuY2xpY2soZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICBjb250YWluZXIuZmluZCgnI3B2aUNhc2VTcmNTZWMnKS50b2dnbGVDbGFzcygnaGlkZScpOwogICAgICAgICAgICAkKCJib2R5IikudG9nZ2xlQ2xhc3MoInRvcC1zZWFyY2gtZW5hYmxlZCIpOwogICAgICAgICAgICBwdnVpLmdyaWQudXRpbHMuc2V0R3JpZEhlaWdodChjb250YWluZXIpOwogICAgICAgIH0pOwoKICAgICAgICB2YXIgaW5pdE15Q2FzZXNCdXR0b24gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGNvbnRhaW5lci5maW5kKCcubXlDYXNlc0J1dHRvbicpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHZhciBjb2x1bW4gPSBjYXNlTGlzdFRhYmxlLmNvbHVtbignYXNzaWduZWRUb1VzZXJuYW1lOm5hbWUnKTsKICAgICAgICAgICAgICAgIGNvbHVtbi5zZWFyY2gobG9naW5Vc2VyKTsKICAgICAgICAgICAgICAgICQoY29sdW1uLmhlYWRlcigpKS5maW5kKCcjYXNzaWduZWUtZmlsdGVyJykudmFsKGxvZ2luVXNlcikudHJpZ2dlcigiY2hhbmdlLnNlbGVjdDIiKTsKICAgICAgICAgICAgICAgIGhpZ2hsaWdodFRhYigpOwogICAgICAgICAgICAgICAgZHJhd1RhYmxlKCk7CiAgICAgICAgICAgIH0pCiAgICAgICAgfTsKCiAgICAgICAgdmFyIHNhdmVDb2x1bW5zID0gZnVuY3Rpb24gKCkgewoKICAgICAgICAgICAgdmFyIGJ1aWxkQ29sdW1uQ29uZmlnTGlzdCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHZhciBvcmRlciA9IDA7CiAgICAgICAgICAgICAgICB2YXIgc2Vjb25kT3JkZXIgPSAwOwogICAgICAgICAgICAgICAgXy5lYWNoKGNvbHVtbkNvbmZpZ3MsIGZ1bmN0aW9uIChlbGUpIHsKICAgICAgICAgICAgICAgICAgICBlbGUubGlzdE9yZGVyID0gOTk5OTsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIF8uZWFjaChsaXN0Q29sdW1ucyhwdmlfbGlzdF9jb2x1bW5zX3ZpZXcucHJpbWFyeUNvbHMpLCBmdW5jdGlvbiAoZWxlKSB7CiAgICAgICAgICAgICAgICAgICAgZWxlLmxpc3RPcmRlciA9IG9yZGVyKys7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBfLmVhY2gobGlzdENvbHVtbnMocHZpX2xpc3RfY29sdW1uc192aWV3LnNlY29uZGFyeUNvbHMpLCBmdW5jdGlvbiAoZWxlKSB7CiAgICAgICAgICAgICAgICAgICAgZWxlLmxpc3RPcmRlciA9IHNlY29uZE9yZGVyKys7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICByZXR1cm4gY29sdW1uQ29uZmlnczsKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIHZhciBjb2xMaXN0ID0gYnVpbGRDb2x1bW5Db25maWdMaXN0KCk7CiAgICAgICAgICAgIGNvbFJlb3JkZXJDYXNlTGlzdCgpOwogICAgICAgICAgICBkcmF3VGFibGUodHJ1ZSk7CiAgICAgICAgICAgIGJpbmRMaXN0RmlsdGVyRXZlbnRMaXN0ZW5lcnMoKTsKCiAgICAgICAgICAgICQuYWpheCh7CiAgICAgICAgICAgICAgICB1cmw6IGNyZWF0ZVVSTChwdmlfdXJscy5jYXNlX2xpc3RfdXBkYXRlX2NvbHVtbnNfdXJsKSwKICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLAogICAgICAgICAgICAgICAgZGF0YTogSlNPTi5zdHJpbmdpZnkoY29sTGlzdCksCiAgICAgICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nLAogICAgICAgICAgICAgICAgYmVmb3JlU2VuZDpmdW5jdGlvbigpewogICAgICAgICAgICAgICAgICAgIHB2dWkuY29tbW9uLnNob3dQVkxvYWRlcigpOwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHN1Y2Nlc3M6ZnVuY3Rpb24oKXsKICAgICAgICAgICAgICAgICAgICBwdnVpLmNvbW1vbi5oaWRlUFZMb2FkZXIoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBpdGVtRHJhZ2dlZCA9IGZhbHNlOwogICAgICAgIH07CgogICAgICAgIHZhciBpbml0RHJhZ2dhYmxlUGFuZWwgPSBmdW5jdGlvbiAoKSB7CgogICAgICAgICAgICB2YXIgYnVpbGRfY29sdW1uX2xpc3QgPSBmdW5jdGlvbiAocGFyZW50Q29tcCwgY29udGFpbmVyTnVtYmVyLCBkZWZhdWx0VmFsdWUpIHsKICAgICAgICAgICAgICAgIHZhciBsaXN0T3JkZXIgPSAwOwoKICAgICAgICAgICAgICAgIHZhciBzZXRTZXEgPSBmdW5jdGlvbiAoZWxlTmFtZSkgewogICAgICAgICAgICAgICAgICAgIHZhciBvYmogPSBfLmZpbmQoZGVmYXVsdFZhbHVlLCBmdW5jdGlvbiAobikgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbi5uYW1lID09PSBlbGVOYW1lOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBvYmouc2VxOwogICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICByZXR1cm4gXy5yZWR1Y2UocGFyZW50Q29tcC5jaGlsZHJlbigiYS5saXN0LWdyb3VwLWl0ZW0iKSwgZnVuY3Rpb24gKG1lbW8sIGVsZSkgewogICAgICAgICAgICAgICAgICAgIGVsZSA9ICQoZWxlKTsKICAgICAgICAgICAgICAgICAgICB2YXIgbGFiZWwgPSBlbGUuaHRtbCgpOwogICAgICAgICAgICAgICAgICAgIHZhciBuYW1lID0gZWxlLmF0dHIoJ2RhdGEtZmllbGQnKTsKICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0ge307CiAgICAgICAgICAgICAgICAgICAgb2JqLmxhYmVsID0gbGFiZWw7CiAgICAgICAgICAgICAgICAgICAgb2JqLm5hbWUgPSBuYW1lOwogICAgICAgICAgICAgICAgICAgIG9iai5jb250YWluZXJWaWV3ID0gY29udGFpbmVyTnVtYmVyOwogICAgICAgICAgICAgICAgICAgIG9iai5zZXEgPSBzZXRTZXEobmFtZSk7CiAgICAgICAgICAgICAgICAgICAgb2JqLmxpc3RPcmRlciA9IGxpc3RPcmRlcisrOwogICAgICAgICAgICAgICAgICAgIG1lbW8ucHVzaChvYmopOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBtZW1vOwogICAgICAgICAgICAgICAgfSwgW10pOwogICAgICAgICAgICB9OwoKICAgICAgICAgICAgY29udGFpbmVyLmZpbmQoJyNjb25maWctdmlldy1idCcpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHB2dWkuZ3JpZC51dGlscy5tYW5hZ2VMaXN0aW5nVUkuc2hvd1NldHRpbmdQYW5lbCgpOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIHZhciBoaWRlRmllbGQgPSBmdW5jdGlvbigpewogICAgICAgICAgICAgICAgY29udGFpbmVyLmZpbmQoJy5saXN0LWZpbHRlcicpLnNob3coKTsKICAgICAgICAgICAgICAgIGNvbnRhaW5lci5maW5kKCcuc2VsZWN0Mi1jb250YWluZXInKS5zaG93KCk7CiAgICAgICAgICAgICAgICBwdnVpLmdyaWQubWFuYWdlVUlXcmFwcGVyLnRvZ2dsZUdyaWRGaWx0ZXIoY29udGFpbmVyLCB7ZGF0ZUZvcm1hdDooKHB2aS51dGlsLmdldERhdGVGb3JtYXRzLmxpc3REYXRlRm9ybWF0KS50b1VwcGVyQ2FzZSgpKX0pOwogICAgICAgICAgICB9OwoKICAgICAgICAgICAgdmFyIHByb2Nlc3NMaXN0ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgaGlkZUZpZWxkKCk7CiAgICAgICAgICAgICAgICB2YXIgdG1wQ29uZmlncyA9IGJ1aWxkX2NvbHVtbl9saXN0KGNvbnRhaW5lci5maW5kKCcubGlzdC1ncm91cC1wcmltYXJ5JyksIDEsIGNvbHVtbkNvbmZpZ3MpOwogICAgICAgICAgICAgICAgdG1wQ29uZmlncyA9IHRtcENvbmZpZ3MuY29uY2F0KGJ1aWxkX2NvbHVtbl9saXN0KGNvbnRhaW5lci5maW5kKCcubGlzdC1ncm91cC1zZWNvbmRhcnknKSwgMiwgY29sdW1uQ29uZmlncykpOwogICAgICAgICAgICAgICAgdG1wQ29uZmlncyA9IHRtcENvbmZpZ3MuY29uY2F0KGJ1aWxkX2NvbHVtbl9saXN0KGNvbnRhaW5lci5maW5kKCcubGlzdC1ncm91cC1vcHRpb25hbCcpLCAzLCBjb2x1bW5Db25maWdzKSk7CiAgICAgICAgICAgICAgICBjb2x1bW5Db25maWdzID0gdG1wQ29uZmlnczsKICAgICAgICAgICAgICAgIHB2aS5saXN0LmNvbW1vbkZ1bmN0aW9ucy5zZXRDb2x1bW5WaXNpYmlsaXR5KGNvbHVtbkNvbmZpZ3MsIGNhc2VMaXN0VGFibGUpOwogICAgICAgICAgICAgICAgc2F2ZUNvbHVtbnMoKTsKICAgICAgICAgICAgICAgIHNldENhc2VHcmlkU2Vjb25kYXJ5U3R5bGUoKTsKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGNvbnRhaW5lci5maW5kKCIjYnRuU2F2ZUxpc3RDb25maWciKS51bmJpbmQoJ2NsaWNrJykub24oJ2NsaWNrJyxmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgaWYgKGl0ZW1EcmFnZ2VkKSB7CiAgICAgICAgICAgICAgICAgICAgcHZ1aS5jb21tb24uc2hvd1BWTG9hZGVyKCk7CiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc0xpc3QoKTsKICAgICAgICAgICAgICAgICAgICAgICAgcHZ1aS5ncmlkLnV0aWxzLm1hbmFnZUxpc3RpbmdVSS5oaWRlU2V0dGluZ1BhbmVsKCk7CiAgICAgICAgICAgICAgICAgICAgfSwgMCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHB2dWkuZ3JpZC51dGlscy5tYW5hZ2VMaXN0aW5nVUkuaGlkZVNldHRpbmdQYW5lbCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNvbnRhaW5lci5maW5kKCIuZGlzcGxheS1jb25maWctZmllbGQsIC5kaXNwbGF5LWNvbmZpZy1maWVsZDIsIC5kaXNwbGF5LWNvbmZpZy1maWVsZDMiKS5zb3J0YWJsZSh7CiAgICAgICAgICAgICAgICBjb25uZWN0V2l0aDogIi5zaG9ydC1maWVsZCIKICAgICAgICAgICAgfSkuZGlzYWJsZVNlbGVjdGlvbigpOwoKICAgICAgICAgICAgdmFyIGluaXRpYWwgPSBbXTsKCiAgICAgICAgICAgIGNvbnRhaW5lci5maW5kKCcuZGlzcGxheS1jb25maWctZmllbGQsIC5kaXNwbGF5LWNvbmZpZy1maWVsZDIsIC5kaXNwbGF5LWNvbmZpZy1maWVsZDMnKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgYW5jaG9yKSB7CiAgICAgICAgICAgICAgICBpbml0aWFsLnB1c2goYW5jaG9yLmlubmVySFRNTCk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgdmFyIHNob3dXYXJuaW5nT25BcnJhbmdpbmdGaWVsZHMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBzaG93V2FybmluZyhnZXRNZXNzYWdlKCJjbG9zZV9idG5fd2FybmluZ190aXRsZSIpLCBnZXRNZXNzYWdlKCJjbG9zZV9idG4iKSwgIk5vIiwgIlllcyIsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuZmluZCgnLmRpc3BsYXktY29uZmlnLWZpZWxkLCAuZGlzcGxheS1jb25maWctZmllbGQyLCAuZGlzcGxheS1jb25maWctZmllbGQzJykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGFuY2hvcikgewogICAgICAgICAgICAgICAgICAgICAgICBhbmNob3IuaW5uZXJIVE1MID0gaW5pdGlhbFtpbmRleF07CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgaXRlbURyYWdnZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICBwdnVpLmdyaWQudXRpbHMubWFuYWdlTGlzdGluZ1VJLmhpZGVTZXR0aW5nUGFuZWwoKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9OwoKICAgICAgICAgICAgY29sdW1uc0Jhci5vbigiY2xpY2siLCAoZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgcHZ1aS5ncmlkLm1hbmFnZVVJV3JhcHBlci5jbG9zZVNldHRpbmdQYW5lbChzaG93V2FybmluZ09uQXJyYW5naW5nRmllbGRzLCBjb250YWluZXIuZmluZCgiI2J0bkNsb3NlTGlzdENvbmZpZyIpKTsKICAgICAgICAgICAgcHZ1aS5ncmlkLm1hbmFnZVVJV3JhcHBlci5jbG9zZVNldHRpbmdQYW5lbChzaG93V2FybmluZ09uQXJyYW5naW5nRmllbGRzKTsKCiAgICAgICAgfTsKCiAgICAgICAgaW5pdEZpbHRlckJ1dHRvbigpOwogICAgICAgIGlmKCFpc0Rhc2hib2FyZFBhZ2UpIHsKICAgICAgICAgICAgcHZpLnV0aWwuYmluZERhdGVQaWNrZXJzKCk7CiAgICAgICAgfQogICAgICAgIHB2aS51dGlsLnNlbGVjdDJGaWVsZHMoKTsKICAgICAgICBpbml0X2Nhc2VfbGlzdCgpOwoKICAgICAgICB2YXIgYmluZExpc3RGaWx0ZXJFdmVudExpc3RlbmVycyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgY2FzZUxpc3RUYWJsZS5jb2x1bW5zKCkuZXZlcnkoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzOwogICAgICAgICAgICAgICAgdmFyIGZpbHRlckRlbGF5ID0gcGFyc2VJbnQoZ2V0Q29uZmlnKCd0eXBlQWhlYWQubGlzdEZpbHRlckRlbGF5JykpOwogICAgICAgICAgICAgICAgY29udGFpbmVyLmZpbmQoJCh0aGF0LmhlYWRlcigpKSkub24oJ2lucHV0IGNoYW5nZScsJy5saXN0LWZpbHRlcicsICQuZGVib3VuY2UoZmlsdGVyRGVsYXksIGZ1bmN0aW9uIChldnQpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0ID0gJChldnQudGFyZ2V0KTsKICAgICAgICAgICAgICAgICAgICB2YXIgZmlsdGVyTmFtZSA9IHRhcmdldC5hdHRyKCdkYXRhLWZpZWxkJyk7CiAgICAgICAgICAgICAgICAgICAgdmFyIHNlYXJjaFZhbHVlID0gdGFyZ2V0LnZhbCgpOwogICAgICAgICAgICAgICAgICAgIGlmICh0YXJnZXQuaGFzQ2xhc3MoJ2RhdGUtdGltZS1maWx0ZXInKSkgewogICAgICAgICAgICAgICAgICAgICAgICBzZWFyY2hWYWx1ZSA9IHB2aS51dGlsLmdlbmVyYXRlRGF0ZVJhbmdlKHNlYXJjaFZhbHVlLCBmaWx0ZXJOYW1lKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZGF0YVRhYmxlLkRhdGFUYWJsZSgpLmNvbHVtbihmaWx0ZXJOYW1lICsgIjpuYW1lIikuc2VhcmNoKHNlYXJjaFZhbHVlKTsKICAgICAgICAgICAgICAgICAgICBkcmF3VGFibGUoKTsKICAgICAgICAgICAgICAgICAgICBpZihmaWx0ZXJOYW1lID09PSBmaXhlZEZpbHRlckNvbE5hbWUpewogICAgICAgICAgICAgICAgICAgICAgICBmb2N1c09uRml4ZWRDb2wgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICBjb250YWluZXIuZmluZCgkKHRoYXQuaGVhZGVyKCkpKS5vbignY2xpY2snLCAnLmxpc3QtZmlsdGVyLCAuZHJvcGRvd24tbGlzdC1maWx0ZXInLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBjb250YWluZXIuZmluZCgkKHRoYXQuaGVhZGVyKCkpKS5vbigna2V5cHJlc3MnLCAnLmxpc3QtZmlsdGVyJywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgICBpZihlLmtleUNvZGUgPT09IDEzKXsKICAgICAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfTsKCiAgICAgICAgYmluZExpc3RGaWx0ZXJFdmVudExpc3RlbmVycygpOwogICAgICAgIGluaXRBbGxDYXNlc0J1dHRvbigpOwogICAgICAgIGluaXRNeUNhc2VzQnV0dG9uKCk7CiAgICAgICAgaW5pdERyYWdnYWJsZVBhbmVsKCk7CiAgICAgICAgaW5pdERpc3BsYXlMZW5ndGgoKTsKICAgICAgICBpbml0aWFsaXplQnVsa0FjdGlvbigpOwogICAgICAgIG5vQWN0aW9uQWxsb3dlZEJ1dHRvbigpOwogICAgICAgIG5vQnVsa0FjdGlvbkFsbG93ZWRCdXR0b24oKTsKICAgICAgICBjb2xSZW9yZGVyQ2FzZUxpc3QoKTsKICAgICAgICBpbml0aWFsaXplZCA9IChpc09uRHVwbGljYXRlU2VhcmNoUGFnZSAmJiAhZGF0YVRhYmxlT3B0aW9ucy5jYXNlSWRBdmFpbGFibGUpID8gZmFsc2UgOiB0cnVlOwogICAgICAgIGRyYXdUYWJsZShmYWxzZSk7CiAgICAgICAgcHZ1aS5ncmlkLnV0aWxzLmh0bWxPdmVyZmxvd1lIaWRkZW4oKTsKICAgIH07CgogICAgdmFyIHNlY29uZGFyeUNvbHVtbnNFeGlzdCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gXy5maW5kKGNvbHVtbkNvbmZpZ3MsIGZ1bmN0aW9uIChjb2wpIHsKICAgICAgICAgICAgcmV0dXJuIGNvbC5jb250YWluZXJWaWV3ID09PSAyOwogICAgICAgIH0pOwogICAgfTsKCiAgICB2YXIgc2V0Q2FzZUdyaWRTZWNvbmRhcnlTdHlsZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBpZihzZWNvbmRhcnlDb2x1bW5zRXhpc3QoKSl7CiAgICAgICAgICAgIGRhdGFUYWJsZS5yZW1vdmVDbGFzcygnbm8tc2Vjb25kYXJ5Jyk7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBkYXRhVGFibGUuYWRkQ2xhc3MoJ25vLXNlY29uZGFyeScpOwogICAgICAgIH0KICAgIH07CgogICAgdmFyIGxpc3RDb2x1bW5zID0gZnVuY3Rpb24gKGNvbnRhaW5lclZpZXdPYmosIHNvcnQpIHsKICAgICAgICB2YXIgbGlzdENvbHVtbnMgPSBfLmZpbHRlcihjb2x1bW5Db25maWdzLCBmdW5jdGlvbiAoZWxlKSB7CiAgICAgICAgICAgIHJldHVybiBlbGUuY29udGFpbmVyVmlldyA9PT0gY29udGFpbmVyVmlld09iai5jSWQ7CiAgICAgICAgfSk7CiAgICAgICAgaWYgKHNvcnQpIHsKICAgICAgICAgICAgbGlzdENvbHVtbnMgPSBsaXN0Q29sdW1ucy5zb3J0KGZ1bmN0aW9uKGEsYikgewogICAgICAgICAgICAgICAgdmFyIHZhckEgPSBhW2NvbnRhaW5lclZpZXdPYmouc29ydEJ5UHJvcF07CiAgICAgICAgICAgICAgICB2YXIgdmFyQiA9IGJbY29udGFpbmVyVmlld09iai5zb3J0QnlQcm9wXTsKICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFyQSA9PT0gJ3N0cmluZycgfHwgdmFyQSBpbnN0YW5jZW9mIFN0cmluZykgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB2YXJBLmxvY2FsZUNvbXBhcmUodmFyQiwgdW5kZWZpbmVkLCB7c2Vuc2l0aXZpdHk6ICdiYXNlJyB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhckEgPT09ICdudW1iZXInKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhckEgLSB2YXJCOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGxpc3RDb2x1bW5zOwogICAgfTsKCiAgICB2YXIgbWFuYWdlQnVsa0FjdGlvbiA9IChmdW5jdGlvbiAoKSB7CgogICAgICAgIHZhciBnZXRGaXJzdFNlbGVjdGVkU3RhdGVGb3JCdWxrT3BzID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gY29udGFpbmVyLmZpbmQoIi5saXN0LXJvdy1jaGVja2JveDpjaGVja2VkIikuZXEoMCkuZGF0YSgiY2FzZS1zdGF0ZSIpOwogICAgICAgIH07CgogICAgICAgIHZhciBpc1NhbWVTdGF0ZVNlbGVjdGVkID0gZnVuY3Rpb24gKGluaXRpYWxTdGF0ZSkgewogICAgICAgICAgICB2YXIgaXNTYW1lU3RhdGUgPSB0cnVlOwogICAgICAgICAgICBjb250YWluZXIuZmluZCgiLmxpc3Qtcm93LWNoZWNrYm94OmNoZWNrZWQiKS5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIGlmICgkKHRoaXMpLmRhdGEoImNhc2Utc3RhdGUiKSAhPT0gaW5pdGlhbFN0YXRlKSB7CiAgICAgICAgICAgICAgICAgICAgaXNTYW1lU3RhdGUgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm4gaXNTYW1lU3RhdGU7CiAgICAgICAgfTsKCiAgICAgICAgdmFyIHNob3dIaWRlQnVsa0FjdGlvbkJ1dHRvbiA9IGZ1bmN0aW9uIChzaG93KSB7CiAgICAgICAgICAgIHZhciBidWxrQWN0aW9uQnRuID0gY29udGFpbmVyLmZpbmQoIi5idG4tY2FzZWxpc3QtYWN0aW9uLWFsbCIpOwogICAgICAgICAgICBidWxrQWN0aW9uQnRuLnJlbW92ZUNsYXNzKCJub0J1bGtBY3Rpb25BbGxvd2VkIik7CiAgICAgICAgICAgIHZhciBzZWxlY3RlZFN0YXRlID0gc2hvdyA/IGdldEZpcnN0U2VsZWN0ZWRTdGF0ZUZvckJ1bGtPcHMoKTogZmFsc2U7CiAgICAgICAgICAgIHZhciBpc1NhbWVTdGF0ZSA9IHNob3cgPyBpc1NhbWVTdGF0ZVNlbGVjdGVkKHNlbGVjdGVkU3RhdGUpOiBmYWxzZTsKCiAgICAgICAgICAgIGlmKHNob3cpIHsKICAgICAgICAgICAgICAgIGJ1bGtBY3Rpb25CdG4ucmVtb3ZlQ2xhc3MoImhpZGUiKTsKICAgICAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7dG1wbE5hbWU6ICdidWxrQWN0aW9uJywgcGFnZUlkOiBwYWdlVHlwZUlkLCBkYXRhT2JqOiB7Y2FzZVN0YXRlSWQ6IHNlbGVjdGVkU3RhdGUsY29udGFpbmVySWQ6IGNvbnRhaW5lcklkfX07CiAgICAgICAgICAgICAgICB2YXIgdGVtcGxhdGVTdHJpbmcgPSBwdmkudXRpbC5tYW5hZ2VBY3Rpb25WaWV3cygpLmluaXRCdWxrKHBhcmFtcyk7CiAgICAgICAgICAgICAgICBpZiAodGVtcGxhdGVTdHJpbmcgPT09ICcnKSB7CiAgICAgICAgICAgICAgICAgICAgYnVsa0FjdGlvbkJ0bi5hZGRDbGFzcygibm9CdWxrQWN0aW9uQWxsb3dlZCIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdmFyIGJ1bGtBY3Rpb25Db250YWluZXIgPSBjb250YWluZXIuZmluZCgiI2J1bGtBY3Rpb25Db250YWluZXIiKTsKICAgICAgICAgICAgICAgIGJ1bGtBY3Rpb25Db250YWluZXIuZmluZCgidWwiKS5yZW1vdmUoKTsKICAgICAgICAgICAgICAgIGJ1bGtBY3Rpb25Db250YWluZXIuaHRtbChidWxrQWN0aW9uQ29udGFpbmVyLmh0bWwoKSArIHRlbXBsYXRlU3RyaW5nKTsKCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHNob3cgJiYgIWlzU2FtZVN0YXRlKSB7CiAgICAgICAgICAgICAgIGNvbnRhaW5lci5maW5kKCIuYnVsay1hY3Rpb24tbGlzdCIpLmZpbmQoImxpLmJ1bGstYWN0aW9uOm5vdCguYXNzaWduQWxsKSIpLmFkZENsYXNzKCJoaWRlIik7CiAgICAgICAgICAgIH1lbHNlIGlmKCFzaG93KSB7CiAgICAgICAgICAgICAgICBidWxrQWN0aW9uQnRuLmFkZENsYXNzKCJoaWRlIik7CiAgICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uIChzaG93QnRuKSB7CiAgICAgICAgICAgIHNob3dIaWRlQnVsa0FjdGlvbkJ1dHRvbihzaG93QnRuKTsKICAgICAgICB9OwoKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBpbml0OiBpbml0CiAgICAgICAgfQoKICAgIH0pKCk7CgogICAgdmFyIHVuY2hlY2tTZWxlY3RBbGxDaGVja2JveCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBjb250YWluZXIuZmluZCgnLnB2LWNhc2VsaXN0LWNoZWNrYWxsJykucHJvcCgnY2hlY2tlZCcsIGZhbHNlKTsKICAgIH07CgogICAgdmFyIHJlSW5pdEJ1dHRvbnNBZnRlclJlZHJhdyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBjb250YWluZXIub24oJ2NoYW5nZScsICcjYnVsay1zZWxlY3QtYnQnLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgIHZhciBpc011bHRpcGxlQ2hlY2tlZCA9ICQodGhpcykuaXMoJzpjaGVja2VkJyk7CiAgICAgICAgICAgIGNvbnRhaW5lci5maW5kKCcubGlzdC1yb3ctY2hlY2tib3gnKS5wcm9wKCdjaGVja2VkJywgaXNNdWx0aXBsZUNoZWNrZWQpOwogICAgICAgICAgICBtYW5hZ2VCdWxrQWN0aW9uLmluaXQoaXNNdWx0aXBsZUNoZWNrZWQpOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSk7CiAgICB9OwoKICAgIHZhciBpbml0X2Nhc2VfbGlzdCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgbGlzdERhdGFDb250YWluZXJEaXYgPSBjb250YWluZXIuZmluZCgiI2xpc3QtZGF0YS1lbGVtZW50cyIpOwogICAgICAgIHZhciBvcmRlckJ5RGVmYXVsdCA9IGxpc3REYXRhQ29udGFpbmVyRGl2LmRhdGEoIm9yZGVyLWJ5LWRlZmF1bHQiKTsKICAgICAgICB2YXIgcGFnaW5nID0gbGlzdERhdGFDb250YWluZXJEaXYuZGF0YSgicGFnaW5nIik7CiAgICAgICAgdmFyIGxlbmd0aENoYW5nZSA9IGxpc3REYXRhQ29udGFpbmVyRGl2LmRhdGEoJ2xlbmd0aC1jaGFuZ2UnKTsKICAgICAgICB2YXIgc2hvd0luZm8gPSBsaXN0RGF0YUNvbnRhaW5lckRpdi5kYXRhKCdzaG93LWluZm8nKTsKICAgICAgICB2YXIgaXNXaWRnZXQgPSBsaXN0RGF0YUNvbnRhaW5lckRpdi5kYXRhKCJpcy13aWRnZXQiKTsKICAgICAgICB2YXIgY2xlYXJDYWNoZU9uUmVmcmVzaCA9IGxpc3REYXRhQ29udGFpbmVyRGl2LmRhdGEoImNsZWFyLWNhY2hlLW9uLXJlZnJlc2giKTsKCiAgICAgICAgdmFyIHZpc2libGUgPSBmdW5jdGlvbiAobmFtZSkgewogICAgICAgICAgICB2YXIgdiA9IF8uZmluZChjb2x1bW5Db25maWdzLCBmdW5jdGlvbiAob2JqKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gKG9iai5uYW1lID09PSBuYW1lICYmIG9iai5jb250YWluZXJWaWV3ID09PSAxKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybiAhIF8uaXNFbXB0eSh2KTsKICAgICAgICB9OwoKICAgICAgICB2YXIgcmVuZGVyVmFsdWVMb29rdXAgPSBmdW5jdGlvbiAoZGF0YSwgZW5jb2RlVG9IVE1MKSB7CiAgICAgICAgICAgIHZhciByZXMgPSAiIjsKICAgICAgICAgICAgaWYgKGRhdGEgJiYgZGF0YS52YWx1ZSkgewogICAgICAgICAgICAgICAgcmVzID0gKHR5cGVvZiBlbmNvZGVUb0hUTUwgIT09ICJ1bmRlZmluZWQiICYmICFlbmNvZGVUb0hUTUwpID8gZGF0YS52YWx1ZTogcHZpLnV0aWwuZW5jb2RlVG9IVE1MKGRhdGEudmFsdWUpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiByZXM7CiAgICAgICAgfTsKCiAgICAgICAgdmFyIHJlbmRlck5hbWVMb29rdXAgPSBmdW5jdGlvbiAoZGF0YSwgZW5jb2RlVG9IVE1MKSB7CiAgICAgICAgICAgIHZhciByZXMgPSAiIjsKICAgICAgICAgICAgaWYgKGRhdGEgJiYgZGF0YS5uYW1lKSB7CiAgICAgICAgICAgICAgICByZXMgPSAodHlwZW9mIGVuY29kZVRvSFRNTCAhPT0gInVuZGVmaW5lZCIgJiYgIWVuY29kZVRvSFRNTCkgPyBkYXRhLm5hbWU6IHB2aS51dGlsLmVuY29kZVRvSFRNTChkYXRhLm5hbWUpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiByZXM7CiAgICAgICAgfTsKCiAgICAgICAgdmFyIHJlbmRlckxhYmVsV2l0aE9wdGlvbnMgPSBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICB2YXIgcmVzID0gIiI7CiAgICAgICAgICAgIGlmIChkYXRhKSB7CiAgICAgICAgICAgICAgICB2YXIgaW5mb0ljb24gPSBfLmlzRW1wdHkoZGF0YS5yZXBvcnRNZXNzYWdlKSA/ICIiIDogIiZuYnNwIDxpIGNsYXNzPSdmYSBmYS1pbmZvLWNpcmNsZSBtb3JlLW9wdGlvbiByZXBvcnRTdGF0ZU1lc3NhZ2UnIGRhdGEtY29udGVudD0nIiArICI8cD4iICsgZGVmYXVsdFJlbmRlcihkYXRhLnJlcG9ydE1lc3NhZ2UpICsgIjwvcD4iICsgIic+PC9pPiI7CiAgICAgICAgICAgICAgICByZXMgPSAiPHNwYW4gY2xhc3M9J2xibC1lbGlwc2lzIGxibC1lbGlwc2lzLWlubGluZSc+PGEgaHJlZj0namF2YXNjcmlwdDp2b2lkKDApJyBkYXRhLWlkPSIgKyBkYXRhLmlkICsgIiBjbGFzcz0ncmVwb3J0U3RhdGUnPiIgKyBkZWZhdWx0UmVuZGVyKGRhdGEudHJhbnNtaXNzaW9uU3RhdHVzKSArICI8L2E+IiArIGluZm9JY29uICsnPC9zcGFuPic7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHJlczsKICAgICAgICB9OwoKICAgICAgICB2YXIga2V5VmFsdWVQYWlyID0gewogICAgICAgICAgICAnY2xhc3MnOiAnYXR0YWNobWVudFJvdycsCiAgICAgICAgICAgICdkYXRhLWZpbGVuYW1lJzogJ25hbWUnLAogICAgICAgICAgICAnZGF0YS1zdG9yYWdlaWQnOiAnaWQnLAogICAgICAgICAgICAnZGF0YS1yZWRhY3QnOidyZWRhY3QnCiAgICAgICAgfTsKCiAgICAgICAgdmFyIGFwcGVuZExpbmsgPSBmdW5jdGlvbiAobmFtZSwgZGF0YXMsIGZpZWxkTmFtZSwgbmV3UHJvcGVydHlOYW1lKSB7CiAgICAgICAgICAgIHZhciBkYXRhTGVuZ3RoID0gZGF0YXMubGVuZ3RoOwogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGFMZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgdmFyIG5ld0RhdGEgPSBkYXRhc1tpXTsKICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGVzID0gJyc7CiAgICAgICAgICAgICAgICB2YXIgYW5jaG9yTGluayA9ICcnOwogICAgICAgICAgICAgICAgZm9yIChwcm9wIGluIGtleVZhbHVlUGFpcikgewogICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IG5ld0RhdGFba2V5VmFsdWVQYWlyW3Byb3BdXTsKICAgICAgICAgICAgICAgICAgICBpZiAoXy5jb250YWlucyhbJ2NsYXNzJ10sIHByb3ApKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0ga2V5VmFsdWVQYWlyW3Byb3BdOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZihwcm9wID09PSAnZGF0YS1yZWRhY3QnICYmIG5ld0RhdGFbJ2lzUmVkYWN0RXhpc3RzJ10gPT09IHRydWUpewogICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMgKz0gcHJvcCArICI9JyIgKyB2YWx1ZSArICInICI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZihuZXdEYXRhWydpc1Byb3RlY3RlZCddID09PSB0cnVlKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld0RhdGFbJ2lzUmVkYWN0RXhpc3RzJ10gPT09IHRydWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yTGluayA9ICI8c3BhbiBjbGFzcz0ncHYtaWMtcmVkYWN0IGljLXNtJz48aSBjbGFzcz0nbWQgbWQtYWxwaGEtci1ib3gtb3V0bGluZSc+PC9pPiA8L3NwYW4+PGEgaHJlZj0namF2YXNjcmlwdDp2b2lkKDApJyAiICsgYXR0cmlidXRlcyArICI+IiArIG5ld0RhdGFbZmllbGROYW1lXSArICI8L2E+IjsKICAgICAgICAgICAgICAgICAgICAgICAgZGF0YXNbaV1bbmV3UHJvcGVydHlOYW1lXSA9IGFuY2hvckxpbms7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yTGluayA9ICI8YSBocmVmPSdqYXZhc2NyaXB0OnZvaWQoMCknIGNsYXNzPSdwaWkgc2hvd1VuYXV0aG9yaXNlZE1lc3NhZ2UnPiIgKyBuZXdEYXRhW2ZpZWxkTmFtZV0gKyAiPC9hPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFzW2ldW25ld1Byb3BlcnR5TmFtZV0gPSBhbmNob3JMaW5rOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgIGFuY2hvckxpbmsgPSAiPGEgaHJlZj0namF2YXNjcmlwdDp2b2lkKDApJyAiICsgYXR0cmlidXRlcyArICI+IiArIG5ld0RhdGFbZmllbGROYW1lXSArICI8L2E+IjsKICAgICAgICAgICAgICAgICAgICBkYXRhc1tpXVtuZXdQcm9wZXJ0eU5hbWVdID0gYW5jaG9yTGluazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gZGF0YXM7CiAgICAgICAgfTsKCiAgICAgICAgdmFyIHJlbmRlcldpdGhNb3JlT3B0aW9uc0ZvclN0cmluZyA9IGZ1bmN0aW9uIChuYW1lLCBkYXRhcykgewogICAgICAgICAgICB2YXIgcmVzID0gIiI7CiAgICAgICAgICAgIGlmIChkYXRhcyAmJiBkYXRhcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICBkYXRhcyA9IGRhdGFzLnRyaW0oKS5yZXBsYWNlKC8sIC9nLCAnLCcpLnNwbGl0KCIsIik7CiAgICAgICAgICAgICAgICB2YXIgbW9yZURhdGEgPSBbXTsKICAgICAgICAgICAgICAgIHZhciBkYXRhTGVuZ3RoID0gZGF0YXMubGVuZ3RoOwogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhTGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YXNbaV0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgbW9yZURhdGEucHVzaCAoZGF0YXNbaV0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIG1vcmVEYXRhID0gbW9yZURhdGEuam9pbigiLCAiKTsKICAgICAgICAgICAgICAgIHZhciBodG1sRW5jb2RlZERhdGEgPSBwdmkudXRpbC5lbmNvZGVUb0hUTUwobW9yZURhdGEpOwogICAgICAgICAgICAgICAgdmFyIHF1b3Rlc0NvbnZlcnRlZERhdGEgPSBodG1sRW5jb2RlZERhdGEucmVwbGFjZSgvIi9nLCAiJyIpOwogICAgICAgICAgICAgICAgcmVzID0gJzxzcGFuIGNsYXNzPSJvbmUtcm93LWVsaXBzaXMgcHZqc19vdXRlci1tb3JlLWJveCIgZGF0YS1uYW1lPSInK25hbWUrJyIgZGF0YS1tb3JlPSInKwogICAgICAgICAgICAgICAgICAgIHF1b3Rlc0NvbnZlcnRlZERhdGErJyI+PHNwYW4gY2xhc3M9InB2anNfaW5uZXItbW9yZS1ib3giPicgKyBodG1sRW5jb2RlZERhdGEgKyAnPC9zcGFuPjwvc3Bhbj4nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiByZXM7CiAgICAgICAgfTsKCiAgICAgICAgdmFyIHJlbmRlcldpdGhNb3JlT3B0aW9ucyA9IGZ1bmN0aW9uIChuYW1lLCBkYXRhcywgZmllbGROYW1lLCBlbmNvZGVUb0hUTUwpIHsKICAgICAgICAgICAgdmFyIHJlc3VsdCA9ICIiOwogICAgICAgICAgICBpZiAoZGF0YXMgJiYgZGF0YXMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgdmFyIG1vcmVEYXRhID0gW107CiAgICAgICAgICAgICAgICB2YXIgZGF0YUxlbmd0aCA9IGRhdGFzLmxlbmd0aDsKICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YUxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgaWYoZGF0YXNbaV0pCiAgICAgICAgICAgICAgICAgICAgICAgIG1vcmVEYXRhLnB1c2ggKGRhdGFzW2ldW2ZpZWxkTmFtZV0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbW9yZURhdGEgPSBtb3JlRGF0YS5qb2luKCIsICIpOwogICAgICAgICAgICAgICAgdmFyIGh0bWxFbmNvZGVkRGF0YTsKICAgICAgICAgICAgICAgIHZhciBxdW90ZXNDb252ZXJ0ZWREYXRhOwogICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBlbmNvZGVUb0hUTUwgIT09ICJ1bmRlZmluZWQiICYmICFlbmNvZGVUb0hUTUwpIHsKICAgICAgICAgICAgICAgICAgICBodG1sRW5jb2RlZERhdGEgPSBtb3JlRGF0YTsKICAgICAgICAgICAgICAgICAgICBxdW90ZXNDb252ZXJ0ZWREYXRhID0gbW9yZURhdGE7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGh0bWxFbmNvZGVkRGF0YSA9IHB2aS51dGlsLmVuY29kZVRvSFRNTChtb3JlRGF0YSk7CiAgICAgICAgICAgICAgICAgICAgcXVvdGVzQ29udmVydGVkRGF0YSA9IHB2aS51dGlsLmNvbnZlcnRUb1NpbmdsZVF1b3RlKGh0bWxFbmNvZGVkRGF0YSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXN1bHQgPSAnPHNwYW4gY2xhc3M9Im9uZS1yb3ctZWxpcHNpcyBwdmpzX291dGVyLW1vcmUtYm94IiBkYXRhLW5hbWU9IicrIGRlZmF1bHRSZW5kZXIobmFtZSwgdHJ1ZSkgKyciIGRhdGEtbW9yZT0iJysKICAgICAgICAgICAgICAgICAgICBxdW90ZXNDb252ZXJ0ZWREYXRhICsnIj4nICsnPHNwYW4gY2xhc3M9IicrKGZpZWxkTmFtZSA9PT0gJ2xpbmsnID8gJ3B2anNfaW5uZXItbW9yZS1ib3ggZGlzYWJsZUh0bWxFbmNvZGUnIDogJ3B2anNfaW5uZXItbW9yZS1ib3gnKSsnIj4nCiAgICAgICAgICAgICAgICAgICAgKyBodG1sRW5jb2RlZERhdGEgKyAnPC9zcGFuPjwvc3Bhbj4nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgICAgfTsKCiAgICAgICAgdmFyIGRlZmF1bHRSZW5kZXIgPSBmdW5jdGlvbiAoc3RyLCBjb252ZXJ0VG9TaW5nbGVRdW90ZSkgewogICAgICAgICAgICB2YXIgcmVzID0gcHZpLnV0aWwuZW5jb2RlVG9IVE1MKHN0cik7CiAgICAgICAgICAgIGlmICh0eXBlb2YgIGNvbnZlcnRUb1NpbmdsZVF1b3RlICE9PSAidW5kZWZpbmVkIiAmJiBjb252ZXJ0VG9TaW5nbGVRdW90ZSkgewogICAgICAgICAgICAgICAgcmVzID0gcHZpLnV0aWwuY29udmVydFRvU2luZ2xlUXVvdGUocmVzKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gcmVzOwogICAgICAgIH07CgogICAgICAgIHZhciByZW5kZXJPbmx5SWZJbnRha2VDYXNlID0gZnVuY3Rpb24gKHNvdXJjZURiSWQsIGRhdGEsIGVuY29kZVRvSFRNTCkgewogICAgICAgICAgICB2YXIgcmVzID0gKHR5cGVvZiAgZW5jb2RlVG9IVE1MICE9PSAidW5kZWZpbmVkIiAmJiAhZW5jb2RlVG9IVE1MKSA/IGRhdGEgOiBkZWZhdWx0UmVuZGVyKGRhdGEpOwogICAgICAgICAgICByZXR1cm4gKHNvdXJjZURiSWQgPT09IDEpID8gKCFfLmlzRW1wdHkocmVzKSA/IHJlcyA6ICcnKSA6ICcnOwogICAgICAgIH07CgogICAgICAgIHZhciBncmlkQ29scyA9IFsKICAgICAgICAgICAgeyAvLzAKICAgICAgICAgICAgICAgIGRhdGE6ICJzZWxlY3RlZCIsCiAgICAgICAgICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgcHJvZHVjdElEcyA9IHJvdy5wcm9kdWN0cy5tYXAoZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoYS5pZCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYS5pZDsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHZhciBpbnRha2VDYXNlTnVtID0gIChyb3cuc291cmNlRGJJZCA9PT0gcHZpX2NvbnN0YW50cy5zb3VyY2VfZGJfc2FmZXR5KSA/ICcnIDogcm93LmludGFrZUNhc2VOdW1iZXIgOwogICAgICAgICAgICAgICAgICAgIHJldHVybiAnPGRpdiBjbGFzcz0idGQtYm94Ij48aW5wdXQgdHlwZT0iY2hlY2tib3giIG5hbWU9ICJsaXN0Um93Q2hlY2tib3giIGNsYXNzPSJsaXN0LXJvdy1jaGVja2JveCIgZGF0YS1pZD0nICsgZGVmYXVsdFJlbmRlcihyb3cuaWQsdHJ1ZSkgKwogICAgICAgICAgICAgICAgICAgICAgICAnIGNsYXNzPSJjb3B5LXNlbGVjdCIgZGF0YS1pbnRha2UtY2FzZS1udW09IicgKyBkZWZhdWx0UmVuZGVyKGludGFrZUNhc2VOdW0sIHRydWUpICsgJyInKwogICAgICAgICAgICAgICAgICAgICAgICAnZGF0YS1pc0NsaW5pY2FsVHJpYWw9IicgKyAocm93LnNvdXJjZVR5cGUgPyBkZWZhdWx0UmVuZGVyKHJvdy5zb3VyY2VUeXBlLmlzQ2xpbmljYWxUcmlhbCwgdHJ1ZSkgOiAoISFyb3cuc3R1ZHlJZCkpICsgJyIgJyArCiAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhLXNhZmV0eS1jYXNlLW51bT0iJyArIGRlZmF1bHRSZW5kZXIocm93LnNhZmV0eUNhc2VOdW1iZXIsIHRydWUpICsgJyInICsgJyBkYXRhLWNhc2Utc3RhdGU9IicgKyBkZWZhdWx0UmVuZGVyKHJvdy5jYXNlU3RhdGVJZCwgdHJ1ZSkgKyAnIicgKyAnIGRhdGEtaW50YWtlLWNhc2UtdmVyc2lvbj0iJyArIGRlZmF1bHRSZW5kZXIocm93LnZlcnNpb24sIHRydWUpCiAgICAgICAgICAgICAgICAgICAgICAgICsgJyInKycgZGF0YS12ZW5kb3ItaWQ9IicgKyBkZWZhdWx0UmVuZGVyKHJvdy52ZW5kb3JJZCwgdHJ1ZSkgKwogICAgICAgICAgICAgICAgICAgICAgICAnIiBkYXRhLWNvdW50cnlJZD0iJyArIChyb3cuY2FzZUNvdW50cnk/ZGVmYXVsdFJlbmRlcihyb3cuY2FzZUNvdW50cnkuaWQsIHRydWUpOiIiKSArICAnIiBkYXRhLXN0dWR5SWQ9IicgKyBkZWZhdWx0UmVuZGVyKHJvdy5zdHVkeUlkLCB0cnVlKSArICciIGRhdGEtYXNzaWduVG9JZD0iJyArIGRlZmF1bHRSZW5kZXIocm93LmFzc2lnbmVkVG8sIHRydWUpICsgJyInKyAnIiBkYXRhLXByb2R1Y3RJZHM9IicgKyBkZWZhdWx0UmVuZGVyKHByb2R1Y3RJRHMsIHRydWUpICsgJyInICsgJz48L2Rpdj4nOwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIG9yZGVyYWJsZTogZmFsc2UsCiAgICAgICAgICAgICAgICBuYW1lOiAnc2VsZWN0ZWQnLAogICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAic251bSIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgeyAvLzEKICAgICAgICAgICAgICAgIGRhdGE6ICdpbnRha2VDYXNlTnVtYmVyJywKICAgICAgICAgICAgICAgIG5hbWU6ICdpbnRha2VDYXNlTnVtYmVyJywKICAgICAgICAgICAgICAgIG9yZGVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtaW50YWtlLWNhc2UiLAogICAgICAgICAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgcm93KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICc8YSBocmVmPSIjIiBjbGFzcz0ibGluay10by1mY2UiJysnIGRhdGEtc291cmNlLWRiID0iJwogICAgICAgICAgICAgICAgICAgICAgICArIGRlZmF1bHRSZW5kZXIocm93LnNvdXJjZURiSWQsIHRydWUpICsnIicrJyBkYXRhLWlkPScKICAgICAgICAgICAgICAgICAgICAgICAgKyBkZWZhdWx0UmVuZGVyKHJvdy5pZCwgdHJ1ZSkgKyAnPicgKyAoZGF0YSA/IGRlZmF1bHRSZW5kZXIoZGF0YSkgOiAnJykgKyAnPC9hPicKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgeyAvLzIKICAgICAgICAgICAgICAgIGRhdGE6ICdjYXNlVmVyc2lvbicsCiAgICAgICAgICAgICAgICBuYW1lOiAnY2FzZVZlcnNpb24nLAogICAgICAgICAgICAgICAgdmlzaWJsZTogdmlzaWJsZSgnY2FzZVZlcnNpb24nKSwKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1jYXNlLXZlcnNpb24iLAogICAgICAgICAgICAgICAgb3JkZXJhYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWZhdWx0UmVuZGVyKGRhdGEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB7IC8vMwogICAgICAgICAgICAgICAgZGF0YTogJ2ZpcnN0UmVjZWlwdERhdGVTdHJpbmcnLAogICAgICAgICAgICAgICAgbmFtZTogJ2ZpcnN0UmVjZWlwdERhdGUnLAogICAgICAgICAgICAgICAgdmlzaWJsZTogdmlzaWJsZSgnZmlyc3RSZWNlaXB0RGF0ZScpLAogICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAiY29sLWZpcnN0LXJkYXRlIiwKICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmYXVsdFJlbmRlcihkYXRhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgeyAvLzQKICAgICAgICAgICAgICAgIGRhdGE6ICdyZXBvcnRlclF1YWxpZmljYXRpb24nLAogICAgICAgICAgICAgICAgbmFtZTogJ3JlcG9ydGVycy5xdWFsaWZpY2F0aW9uVmFsdWUnLAogICAgICAgICAgICAgICAgdmlzaWJsZTogdmlzaWJsZSgncmVwb3J0ZXJzLnF1YWxpZmljYXRpb25WYWx1ZScpLAogICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAiY29sLXJlcG9ydGVyLXR5cGUiLAogICAgICAgICAgICAgICAgb3JkZXJhYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgcm93KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChyb3cucmVwb3J0ZXJRdWFsaWZpY2F0aW9uKSA/ICBkZWZhdWx0UmVuZGVyKHJvdy5yZXBvcnRlclF1YWxpZmljYXRpb24udmFsdWUpIDogIiI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsgLy81CiAgICAgICAgICAgICAgICBkYXRhOiAnZXZlbnRzJywKICAgICAgICAgICAgICAgIG5hbWU6ICdldmVudHMuZXZlbnROYW1lJywKICAgICAgICAgICAgICAgIHZpc2libGU6IHZpc2libGUoJ2V2ZW50cy5ldmVudE5hbWUnKSwKICAgICAgICAgICAgICAgIG9yZGVyYWJsZTogZmFsc2UsCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtY2FzZS1ldmVudHMiLAogICAgICAgICAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiByZW5kZXJXaXRoTW9yZU9wdGlvbnMoJ2V2ZW50cycsIGRhdGEsICdldmVudE5hbWUnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgeyAvLzYKICAgICAgICAgICAgICAgIGRhdGE6ICdwcm9kdWN0cycsCiAgICAgICAgICAgICAgICBuYW1lOiAncHJvZHVjdHMubmFtZScsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdwcm9kdWN0cy5uYW1lJyksCiAgICAgICAgICAgICAgICBvcmRlcmFibGU6IGZhbHNlLAogICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAiY29sLWNhc2UtcHJvZHVjdHMiLAogICAgICAgICAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiByZW5kZXJXaXRoTW9yZU9wdGlvbnMoJ3Byb2R1Y3RzJywgZGF0YSwgJ25hbWUnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgeyAvLzcKICAgICAgICAgICAgICAgIGRhdGE6ICdjYXNlU2VyaW91c25lc3MnLAogICAgICAgICAgICAgICAgbmFtZTogJ2Nhc2VTZXJpb3VzbmVzcy5jYXRlZ29yeScsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdjYXNlU2VyaW91c25lc3MuY2F0ZWdvcnknKSwKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1jYXNlLXNlciIsCiAgICAgICAgICAgICAgICBvcmRlcmFibGU6IHRydWUsCiAgICAgICAgICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEgPyBkZWZhdWx0UmVuZGVyKGRhdGEpIDogIiI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsgLy84CiAgICAgICAgICAgICAgICBkYXRhOiAncHJpb3JpdHknLAogICAgICAgICAgICAgICAgbmFtZTogJ3ByaW9yaXR5LnZhbHVlJywKICAgICAgICAgICAgICAgIHZpc2libGU6IHZpc2libGUoJ3ByaW9yaXR5LnZhbHVlJyksCiAgICAgICAgICAgICAgICBzV2lkdGg6ICI0MHB4IiwKICAgICAgICAgICAgICAgIG9yZGVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1jYXNlLXByaW9yaXR5IiwKICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24oZGF0YSwgdHlwZSwgcm93KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9ICIiOwogICAgICAgICAgICAgICAgICAgIGlmKHJvdy5zb3VyY2VEYklkID09PSAxKXsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gcmVuZGVyVmFsdWVMb29rdXAoZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcmlvcml0aWVzU2VsZWN0VmlldyA9IHB2aS51dGlsLm1hbmFnZUNhc2VQcmlvcml0eS5nZXRTZWxlY3RWaWV3KHJvdy5pZCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwSnVzdGlmaWNhdGlvbkNvbW1lbnRzID0gcm93LnByaW9yaXR5SnVzdGlmaWNhdGlvbiA/IHJvdy5wcmlvcml0eUp1c3RpZmljYXRpb24gOiAiIjsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGljb25DbGFzc2VzID0gIm1vcmUtb3B0aW9uIG1kIG1kLWluZm9ybWF0aW9uIHB2LXByaW9yaXR5LWxvZyBhbGxvdy10ZXh0IiArIChwSnVzdGlmaWNhdGlvbkNvbW1lbnRzID8gIiIgOiAiIGhpZGRlbiIpOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5mb0ljb24gPSAnJm5ic3AgPGkgaWQ9InByaW9yaXR5TG9nIiBjbGFzcz0iJysgaWNvbkNsYXNzZXMgKyAnIiBkYXRhLW1vcmVkYXRhPSInICsgZGVmYXVsdFJlbmRlcihwSnVzdGlmaWNhdGlvbkNvbW1lbnRzLCB0cnVlKSArICciIGRhdGEtaWQ9IicrZGVmYXVsdFJlbmRlcihyb3cuaWQsdHJ1ZSkrJyI+PC9pPic7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gcHZpX2NvbnN0YW50cy5jYXNlX25vX3ByaW9yaXR5X3NlbGVjdDsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0aW9uQ2xhc3NlcyA9IHB2aS51dGlsLm1hbmFnZUNhc2VQcmlvcml0eS5nZXRDbGFzc2VzKHZhbHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gIjxzcGFuIGNsYXNzPSciK3NlbGVjdGlvbkNsYXNzZXMrIic+PHNwYW4gY2xhc3M9J21vcmUtb3B0aW9uIHB2LWljLXByaW9yaXR5JyBkYXRhLXByaW9yaXR5LXNlbGVjdC1pZD0nIitkZWZhdWx0UmVuZGVyKHJvdy5pZCwgdHJ1ZSkrIicgZGF0YS10YXJnZXQtZXZlbnQ9J2NsaWNrJyBkYXRhLWNvbnRlbnQ9JyIgKyBwcmlvcml0aWVzU2VsZWN0VmlldyArICInPiIrdmFsdWUrIjwvc3Bhbj4iK2luZm9JY29uKyI8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlczsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgeyAvLzkKICAgICAgICAgICAgICAgIGRhdGE6ICdhdHRhY2htZW50cycsCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdwdi1jb2wtYXR0YWNobWVudCcsCiAgICAgICAgICAgICAgICBuYW1lOiAnYXR0YWNobWVudHMubmFtZScsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdhdHRhY2htZW50cy5uYW1lJyksCiAgICAgICAgICAgICAgICBvcmRlcmFibGU6IGZhbHNlLAogICAgICAgICAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSAiIjsKICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YSAmJiAhXy5pc0VtcHR5KGRhdGFbMF0pKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXdEYXRhID0gYXBwZW5kTGluaygnYXR0YWNobWVudHMnLCBkYXRhLCAnbmFtZScsICdsaW5rJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IHJlbmRlcldpdGhNb3JlT3B0aW9ucygnYXR0YWNobWVudHMnLCBuZXdEYXRhLCAnbGluaycsIGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlczsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgeyAvLzEwCiAgICAgICAgICAgICAgICBkYXRhOiAnZHVlRGF0ZVN0cmluZycsCiAgICAgICAgICAgICAgICBuYW1lOiAnZHVlRGF0ZScsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdkdWVEYXRlJyksCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtZHVlLWRhdGUiLAogICAgICAgICAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgcm93KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9ICIiOwogICAgICAgICAgICAgICAgICAgIGlmKHJvdy5zb3VyY2VEYklkID09PSAxKXsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvcHVwID0gKHJvdy5kdWVEYXRlSnVzdGlmaWNhdGlvbiA/ICc8aSBjbGFzcz0iZmEgZmEtaW5mby1jaXJjbGUgbW9yZS1vcHRpb24gbS1sLTUgYWxsb3ctdGV4dCIgZGF0YS1tb3JlZGF0YT0iJysgZGVmYXVsdFJlbmRlcihyb3cuZHVlRGF0ZUp1c3RpZmljYXRpb24sdHJ1ZSkgKyAnIj48L2k+JyA6ICIiKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gJzxzcGFuIGNsYXNzPSJmbGV4LWJveCI+JysgJzxzcGFuIGNsYXNzPSJsYmwtZWxpcHNpcyBsYmwtZWxpcHNpcy1pbmxpbmUiPicrKHJvdy5kdWVEYXRlU3RyaW5nID8gcm93LmR1ZURhdGVTdHJpbmcgOiAiIikgKyAnPC9zcGFuPicrIHBvcHVwICsgJzwvc3Bhbj4nOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB7IC8vMTEKICAgICAgICAgICAgICAgIGRhdGE6ICdpc1JlbGF0ZWQnLAogICAgICAgICAgICAgICAgbmFtZTogJ2lzUmVsYXRlZCcsCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtaXMtcmVsYXRlZCIsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdpc1JlbGF0ZWQnKSwKICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmYXVsdFJlbmRlcihkYXRhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgeyAvLzEyCiAgICAgICAgICAgICAgICBkYXRhOiAnYXNzaWduZWRUb1VzZXJuYW1lJywKICAgICAgICAgICAgICAgIG5hbWU6ICdhc3NpZ25lZFRvVXNlcm5hbWUnLAogICAgICAgICAgICAgICAgdmlzaWJsZTogdmlzaWJsZSgnYXNzaWduZWRUb1VzZXJuYW1lJyksCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICJwdi1jb2wtZWRpdGFibGUgY29sLWFzc2lnbmVkLXRvIiwKICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSAiIjsKICAgICAgICAgICAgICAgICAgICBpZiAocm93LnNvdXJjZURiSWQgPT09IDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbmVkVXNlcm5hbWUgPSBwdmkudXRpbC5tYW5hZ2VVc2VyQXNzaWduLmFzc2lnbmVkVXNlck5hbWUoZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmZvSWNvbiA9IHJvdy5pc0Fzc2lnbm1lbnRIaXN0b3J5ID8gIiZuYnNwIDxpIGlkPSdhc3NpZ25lZFRvTG9nJyBjbGFzcz0nZmEgZmEtaW5mby1jaXJjbGUgcHYtY2FzZUFzc2lnbi1sb2cgJyBkYXRhLWlkPSciK2RlZmF1bHRSZW5kZXIocm93LmlkKSsiJz48L2k+IiA6ICIiOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAocm93LnVzZXJSb2xlcy5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IGFzc2lnbmVkVXNlcm5hbWU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJvZHVjdElEcyA9IHJvdy5wcm9kdWN0cy5tYXAoZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihhLmlkKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEuaWQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMgPSAnPHNwYW4gY2xhc3M9ImFzc2lnbi11c2VyLWJveCI+PGEgaHJlZj0iIyIgZGF0YS10eXBlPSJzZWxlY3QyIiBkYXRhLWNvdW50cnlJZD0gIicKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArIGRlZmF1bHRSZW5kZXIocm93LmNhc2VDb3VudHJ5ID8gcm93LmNhc2VDb3VudHJ5LmlkOiIiLCB0cnVlKSArICciICcgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhLXByb2R1Y3RJZHM9IicgKyBwcm9kdWN0SURzICsgJyIgJyArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhdGEtcGs9IicgKyBkZWZhdWx0UmVuZGVyKHJvdy5pZCwgdHJ1ZSkgKyAnIiAnICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YS1hc3NpbmdlZUlkPSInICsgZGVmYXVsdFJlbmRlcihyb3cuYXNzaWduZWRUbywgdHJ1ZSkgKyAnIiAnICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YS1pc0NsaW5pY2FsVHJpYWw9IicgKyAocm93LnNvdXJjZVR5cGUgPyBkZWZhdWx0UmVuZGVyKHJvdy5zb3VyY2VUeXBlLmlzQ2xpbmljYWxUcmlhbCwgdHJ1ZSkgOiAoISFyb3cuc3R1ZHlJZCkpICsgJyIgJyArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhdGEtc3R1ZHlJZD0iJyArIGRlZmF1bHRSZW5kZXIocm93LnN0dWR5SWQsIHRydWUpICsgJyIgJyArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhdGEtdmVuZG9ySWQ9IicgKyBkZWZhdWx0UmVuZGVyKHJvdy52ZW5kb3JJZCwgdHJ1ZSkgKyAnIiAnICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YS11cmw9IicgKyBwdmlfdXJscy5jYXNlX2Fzc2lnbmVlX3VzZXJfbGlzdF91cmwgKyAnIiBkYXRhLXZhbHVlPSJydSIgZGF0YS10aXRsZT0iU2VsZWN0IFVzZXIiIGNsYXNzPSJhc3NpZ25Vc2VyIG1hbmFnZUFzc2lnblVzZXIgbGJsLWVsaXBzaXMgbGJsLWVsaXBzaXMtaW5saW5lIj4nICsgZGVmYXVsdFJlbmRlcihhc3NpZ25lZFVzZXJuYW1lKSArICc8L2E+JyArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxzZWxlY3QgY2xhc3M9ImZvcm0tY29udHJvbCBzZWxlY3QyIGhpZGUgZGlzcGxheVVzZXJMaXN0IiBkaXNhYmxlZD48L3NlbGVjdD4nK2luZm9JY29uKyc8L3NwYW4+JzsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB7IC8vMTMKICAgICAgICAgICAgICAgIGRhdGE6ICdzYWZldHlDYXNlTnVtYmVyJywKICAgICAgICAgICAgICAgIG5hbWU6ICdzYWZldHlDYXNlTnVtYmVyJywKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1zYWZldHktY251bWJlciIsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdzYWZldHlDYXNlTnVtYmVyJyksCiAgICAgICAgICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgY2xhc3NlcyA9IChyb3cuc291cmNlRGJJZCA9PT0gcHZpX2NvbnN0YW50cy5zb3VyY2VfZGJfc2FmZXR5IHx8IHJvdy5zYWZldHlDYXNlRXhpc3RzKSA/ICJzYWZldHktbGluay10by1mY2UiIDogInNhZmV0eS1saW5rLXRvLWZjZSBzYWZldHktbGluay1ub3QtZXhpc3RzIiA7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICAnPGEgaHJlZj0iIyIgY2xhc3M9ICInKyBjbGFzc2VzICsnIiBkYXRhLXNvdXJjZS1kYj0iJysgZGVmYXVsdFJlbmRlcihyb3cuc291cmNlRGJJZCwgdHJ1ZSkgKyAnIiBkYXRhLWlkPScgKyBkZWZhdWx0UmVuZGVyKHJvdy5pZCwgdHJ1ZSkgKyAnPicgKyAoZGF0YSA/IGRlZmF1bHRSZW5kZXIoZGF0YSkgOiAnJykgKyAnPC9hPic7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsgLy8xNAogICAgICAgICAgICAgICAgZGF0YTogJ3JlcG9ydFR5cGUnLAogICAgICAgICAgICAgICAgbmFtZTogJ3JlcG9ydFR5cGUnLAogICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAiY29sLXJlcG9ydC10eXBlIiwKICAgICAgICAgICAgICAgIHZpc2libGU6IGZhbHNlLAogICAgICAgICAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWZhdWx0UmVuZGVyKGRhdGEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB7IC8vMTUKICAgICAgICAgICAgICAgIGRhdGE6ICdwYXRpZW50QWdlJywKICAgICAgICAgICAgICAgIG5hbWU6ICdwYXRpZW50QWdlJywKICAgICAgICAgICAgICAgIHZpc2libGU6IHZpc2libGUoJ3BhdGllbnRBZ2UnKSwKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1wYXRpZW50LWFnZSIsCiAgICAgICAgICAgICAgICBvcmRlcmFibGU6IGZhbHNlLAogICAgICAgICAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWZhdWx0UmVuZGVyKGRhdGEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB7IC8vMTYKICAgICAgICAgICAgICAgIGRhdGE6ICdnZW5kZXInLAogICAgICAgICAgICAgICAgbmFtZTogJ2dlbmRlci52YWx1ZScsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdnZW5kZXIudmFsdWUnKSwKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1saXN0LWdlbmRlciIsCiAgICAgICAgICAgICAgICBvcmRlcmFibGU6IHRydWUsCiAgICAgICAgICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlbmRlclZhbHVlTG9va3VwKGRhdGEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB7IC8vMTcKICAgICAgICAgICAgICAgIGRhdGE6ICdkZXN0aW5hdGlvbicsCiAgICAgICAgICAgICAgICBuYW1lOiAnaWNzci5kZXN0aW5hdGlvbicsCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtbGlzdC1kZXN0aW5hdGlvbiIsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdpY3NyLmRlc3RpbmF0aW9uJyksCiAgICAgICAgICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVuZGVyT25seUlmSW50YWtlQ2FzZShyb3cuc291cmNlRGJJZCwgZGF0YSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsgLy8xOAogICAgICAgICAgICAgICAgZGF0YTogJ3JlcG9ydER1ZURhdGVTdHJpbmcnLAogICAgICAgICAgICAgICAgbmFtZTogJ2ljc3IuZHVlRGF0ZScsCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtcmVwb3J0LWR1ZWRhdGUiLAogICAgICAgICAgICAgICAgdmlzaWJsZTogdmlzaWJsZSgnaWNzci5kdWVEYXRlJyksCiAgICAgICAgICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVuZGVyT25seUlmSW50YWtlQ2FzZShyb3cuc291cmNlRGJJZCwgZGF0YSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsgLy8xOQogICAgICAgICAgICAgICAgZGF0YTogJ3JlcG9ydGVyQ29tbWVudHMnLAogICAgICAgICAgICAgICAgbmFtZTogJ3JlcG9ydGVyQ29tbWVudHMnLAogICAgICAgICAgICAgICAgdmlzaWJsZTogdmlzaWJsZSgncmVwb3J0ZXJDb21tZW50cycpLAogICAgICAgICAgICAgICAgb3JkZXJhYmxlOiBmYWxzZSwKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1yZXBvcnRlci1jb21tZW50cyIsCiAgICAgICAgICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICc8c3BhbiBjbGFzcz0ib25lLXJvdy1lbGlwc2lzIHB2anNfb3V0ZXItbW9yZS1ib3giIGRhdGEtbW9yZT0iJyArIGRlZmF1bHRSZW5kZXIoZGF0YSwgdHJ1ZSkgKyAnIj4nCiAgICAgICAgICAgICAgICAgICAgICAgICsgJzxzcGFuIGNsYXNzPSJwdmpzX2lubmVyLW1vcmUtYm94Ij4nICsgZGVmYXVsdFJlbmRlcihkYXRhKSArICc8L3NwYW4+JzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgeyAvLzIwCiAgICAgICAgICAgICAgICBkYXRhOiAncmVwb3J0ZXJzJywKICAgICAgICAgICAgICAgIG5hbWU6ICdyZXBvcnRlcnMubmFtZScsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdyZXBvcnRlcnMubmFtZScpLAogICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAiY29sLXJlcG9ydGVyLW5hbWUiLAogICAgICAgICAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiByZW5kZXJXaXRoTW9yZU9wdGlvbnMoJ3JlcG9ydGVycycsIGRhdGEsICduYW1lJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsgLy8yMQogICAgICAgICAgICAgICAgZGF0YTogJ3NlbmRlclR5cGUnLAogICAgICAgICAgICAgICAgbmFtZTogJ3NlbmRlclR5cGUudmFsdWUnLAogICAgICAgICAgICAgICAgdmlzaWJsZTogdmlzaWJsZSgnc2VuZGVyVHlwZS52YWx1ZScpLAogICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAiY29sLXNlbmRlci10eXBlIiwKICAgICAgICAgICAgICAgIG9yZGVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgIHJldHVybiByZW5kZXJPbmx5SWZJbnRha2VDYXNlKHJvdy5zb3VyY2VEYklkLCByZW5kZXJWYWx1ZUxvb2t1cChkYXRhLCBmYWxzZSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB7IC8vMjIKICAgICAgICAgICAgICAgIGRhdGE6ICdzZW5kZXJOYW1lJywKICAgICAgICAgICAgICAgIG5hbWU6ICdzZW5kZXJOYW1lJywKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1zZW5kZXItbmFtZSIsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdzZW5kZXJOYW1lJyksCiAgICAgICAgICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVuZGVyT25seUlmSW50YWtlQ2FzZShyb3cuc291cmNlRGJJZCwgZGF0YSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsgLy8yMwogICAgICAgICAgICAgICAgZGF0YTogJ2V2ZW50Q291bnRyeScsCiAgICAgICAgICAgICAgICBuYW1lOiAnZXZlbnRDb3VudHJ5Lm5hbWUnLAogICAgICAgICAgICAgICAgdmlzaWJsZTogdmlzaWJsZSgnZXZlbnRDb3VudHJ5Lm5hbWUnKSwKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1ldmVudC1jb3VudHJ5IiwKICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVuZGVyTmFtZUxvb2t1cChkYXRhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgeyAvLzI0CiAgICAgICAgICAgICAgICBkYXRhOiAncmVwb3J0VmVyc2lvbicsCiAgICAgICAgICAgICAgICBuYW1lOiAnaWNzci5yZXBvcnRWZXJzaW9uJywKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1yZXBvcnQtdmVyc2lvbiIsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdpY3NyLnJlcG9ydFZlcnNpb24nKSwKICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgIHJldHVybiByZW5kZXJPbmx5SWZJbnRha2VDYXNlKHJvdy5zb3VyY2VEYklkLCBkYXRhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgeyAvLzI1CiAgICAgICAgICAgICAgICBkYXRhOiAnaWNzcicsCiAgICAgICAgICAgICAgICBuYW1lOiAnaWNzci50cmFuc21pc3Npb25TdGF0dXMnLAogICAgICAgICAgICAgICAgdmlzaWJsZTogdmlzaWJsZSgnaWNzci50cmFuc21pc3Npb25TdGF0dXMnKSwKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogInB2LWNvbC1lZGl0YWJsZSBjb2wtaWNzci10cmFucyIsCiAgICAgICAgICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICBpZihyb3cuc291cmNlRGJJZCA9PT0gMSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZW5kZXJMYWJlbFdpdGhPcHRpb25zKGRhdGEpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICIiCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB7IC8vMjYKICAgICAgICAgICAgICAgIGRhdGE6ICdzdGF0ZVRpbWVzdGFtcFN0cmluZycsCiAgICAgICAgICAgICAgICBuYW1lOiAnaWNzci5zdGF0ZVRpbWVzdGFtcCcsCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtc3RhdGUtdGltZXN0YW1wIiwKICAgICAgICAgICAgICAgIHZpc2libGU6IHZpc2libGUoJ2ljc3Iuc3RhdGVUaW1lc3RhbXAnKSwKICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgIHJldHVybiByZW5kZXJPbmx5SWZJbnRha2VDYXNlKHJvdy5zb3VyY2VEYklkLCBkYXRhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgeyAvLzI3CiAgICAgICAgICAgICAgICBkYXRhOiAncmVwb3J0TWVzc2FnZScsCiAgICAgICAgICAgICAgICBuYW1lOiAnaWNzci5yZXBvcnRNZXNzYWdlJywKICAgICAgICAgICAgICAgIHZpc2libGU6IHZpc2libGUoJ2ljc3IucmVwb3J0TWVzc2FnZScpLAogICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAiY29sLXJlcG9ydC1tZXNzYWdlIiwKICAgICAgICAgICAgICAgIG9yZGVyYWJsZTogZmFsc2UsCiAgICAgICAgICAgICAgICByZW5kZXI6IGZ1bmN0aW9uKGRhdGEsdHlwZSxyb3cpewogICAgICAgICAgICAgICAgICAgIGRhdGEgPSByZW5kZXJPbmx5SWZJbnRha2VDYXNlKHJvdy5zb3VyY2VEYklkLCBkYXRhKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzxzcGFuIGNsYXNzPSJvbmUtcm93LWVsaXBzaXMgcHZqc19vdXRlci1tb3JlLWJveCI+PHNwYW4gY2xhc3M9InB2anNfaW5uZXItbW9yZS1ib3giIGRhdGEtdHlwZS1zdHJpbmc9InRydWUiPicgKyBkYXRhICsgJzwvc3Bhbj48L3NwYW4+JwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB7IC8vMjgKICAgICAgICAgICAgICAgIGRhdGE6ICdldmVudE5hbWUnLAogICAgICAgICAgICAgICAgbmFtZTogJ2V2ZW50TmFtZScsCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtZXZlbnQtbmFtZSIsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdldmVudE5hbWUnKSwKICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmYXVsdFJlbmRlcihkYXRhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgeyAvLzI5CiAgICAgICAgICAgICAgICBkYXRhOiAnZXZlbnRTdGFydERhdGUnLAogICAgICAgICAgICAgICAgbmFtZTogJ2V2ZW50U3RhcnREYXRlJywKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1ldmVudC1zdGFydGRhdGUiLAogICAgICAgICAgICAgICAgdmlzaWJsZTogdmlzaWJsZSgnZXZlbnRTdGFydERhdGUnKSwKICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmYXVsdFJlbmRlcihkYXRhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgeyAvLzMwCiAgICAgICAgICAgICAgICBkYXRhOiAnb3V0Y29tZScsCiAgICAgICAgICAgICAgICBuYW1lOiAnb3V0Y29tZS52YWx1ZScsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdvdXRjb21lLnZhbHVlJyksCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtbGlzdC1vdXRjb21lIiwKICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVuZGVyVmFsdWVMb29rdXAoZGF0YSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsgLy8zMQogICAgICAgICAgICAgICAgZGF0YTogJ3JlcG9ydGVyQ291bnRyeScsCiAgICAgICAgICAgICAgICBuYW1lOiAncmVwb3J0ZXJzLmNvdW50cnlOYW1lJywKICAgICAgICAgICAgICAgIHZpc2libGU6IHZpc2libGUoJ3JlcG9ydGVycy5jb3VudHJ5TmFtZScpLAogICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAiY29sLXJlcG9ydGVyLWNvdW50cnkiLAogICAgICAgICAgICAgICAgb3JkZXJhYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgcmVuZGVyIDogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAocm93LnJlcG9ydGVyQ291bnRyeSkgPyAgZGVmYXVsdFJlbmRlcihyb3cucmVwb3J0ZXJDb3VudHJ5Lm5hbWUpIDogIiI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsgLy8zMgogICAgICAgICAgICAgICAgZGF0YTogJ3JlbGF0ZWRuZXNzU3RyaW5nJywKICAgICAgICAgICAgICAgIG5hbWU6ICdyZWxhdGVkbmVzc1N0cmluZycsCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtcmVsYXRlZG5lc3Mtc3RyIiwKICAgICAgICAgICAgICAgIHZpc2libGU6IHZpc2libGUoJ3JlbGF0ZWRuZXNzU3RyaW5nJyksCiAgICAgICAgICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRSZW5kZXIoZGF0YSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsgLy8zMwogICAgICAgICAgICAgICAgZGF0YTogJ3NvdXJjZVR5cGUnLAogICAgICAgICAgICAgICAgbmFtZTogJ3NvdXJjZVR5cGUudHlwZScsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdzb3VyY2VUeXBlLnR5cGUnKSwKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1zb3VyY2UtdHlwZSIsCiAgICAgICAgICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChkYXRhICYmIGRhdGEudHlwZSkgPyBkZWZhdWx0UmVuZGVyKGRhdGEudHlwZSkgOiAiIjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgeyAvLzM0CiAgICAgICAgICAgICAgICBkYXRhOiAnY2F0ZWdvcmllcycsCiAgICAgICAgICAgICAgICBuYW1lOiAnY2F0ZWdvcmllcy52YWx1ZScsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdjYXRlZ29yaWVzLnZhbHVlJyksCiAgICAgICAgICAgICAgICBvcmRlcmFibGU6IGZhbHNlLAogICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAiY29sLWxpc3QtY2F0ZWdvcmllcyIsCiAgICAgICAgICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YSAmJiByb3cuc291cmNlRGJJZCA9PT0gMSkgewogICAgICAgICAgICAgICAgICAgICAgIF8uY29sbGVjdChkYXRhLCBmdW5jdGlvbiAoZWxlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIGVsZS52YWx1ZQogICAgICAgICAgICAgICAgICAgICAgICB9KS5qb2luKCIsICIpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVuZGVyV2l0aE1vcmVPcHRpb25zKCdjYXRlZ29yaWVzJywgZGF0YSwgJ3ZhbHVlJyk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICIiOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgeyAvLzM1CiAgICAgICAgICAgICAgICBtRGF0YTogJ21vc3RSZWNlbnRSZWNlaXB0RGF0ZVN0cmluZycsCiAgICAgICAgICAgICAgICBuYW1lOiAnbW9zdFJlY2VudFJlY2VpcHREYXRlJywKICAgICAgICAgICAgICAgIHNXaWR0aDogIjQwcHgiLAogICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAiY29sLW1vc3QtcnJkYXRlIiwKICAgICAgICAgICAgICAgIHZpc2libGU6IHZpc2libGUoJ21vc3RSZWNlbnRSZWNlaXB0RGF0ZScpLAogICAgICAgICAgICAgICAgcmVuZGVyOiBmdW5jdGlvbihkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRSZW5kZXIoZGF0YSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICB9LAogICAgICAgICAgICB7IC8vMzYKICAgICAgICAgICAgICAgIGRhdGE6ICdwcm9kdWN0TmFtZScsCiAgICAgICAgICAgICAgICBuYW1lOiAncHJvZHVjdE5hbWUnLAogICAgICAgICAgICAgICAgdmlzaWJsZTogdmlzaWJsZSgncHJvZHVjdE5hbWUnKSwKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1wcm9kdWN0LW5hbWUiLAogICAgICAgICAgICAgICAgcmVuZGVyIDogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmYXVsdFJlbmRlcihkYXRhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgeyAvLzM3CiAgICAgICAgICAgICAgICBkYXRhOiAnc3Vic3RhbmNlcycsCiAgICAgICAgICAgICAgICBuYW1lOiAnc3Vic3RhbmNlcy5uYW1lVmFsdWUnLAogICAgICAgICAgICAgICAgdmlzaWJsZTogdmlzaWJsZSgnc3Vic3RhbmNlcy5uYW1lVmFsdWUnKSwKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1saXN0LXN1YnN0YW5jZXMiLAogICAgICAgICAgICAgICAgb3JkZXJhYmxlOiBmYWxzZSwKICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVuZGVyV2l0aE1vcmVPcHRpb25zKCdzdWJzdGFuY2VzJywgZGF0YSwgJ25hbWVWYWx1ZScpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB7IC8vMzgKICAgICAgICAgICAgICAgIGRhdGE6ICdzdHVkeU51bWJlcicsCiAgICAgICAgICAgICAgICBuYW1lOiAnc3R1ZHlOdW1iZXInLAogICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAiY29sLXN0dWR5LW51bWJlciIsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdzdHVkeU51bWJlcicpLAogICAgICAgICAgICAgICAgcmVuZGVyIDogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmYXVsdFJlbmRlcihkYXRhKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsgLy8gMzkKICAgICAgICAgICAgICAgIGRhdGE6ICdjYXNlU3RhdGUnLAogICAgICAgICAgICAgICAgbmFtZTogJ2Nhc2VTdGF0ZScsCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtY2FzZS1zdGF0ZSIsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdjYXNlU3RhdGUnKSwKICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSAiIjsKICAgICAgICAgICAgICAgICAgICAgaWYocm93LnNvdXJjZURiSWQgPT09IDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb21tZW50ID0gcm93LnN0YXRlQ2hhbmdlQ29tbWVudDsKICAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1lbnQgPSBfLmlzVW5kZWZpbmVkKGNvbW1lbnQpIHx8ICFjb21tZW50ID8gJycgOiBjb21tZW50LnJlcGxhY2UoLycvZywgIiYjMzk7Iik7CiAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5mb0ljb24gPSAhY29tbWVudCA/ICIiIDogIiZuYnNwIDxpIGNsYXNzPSdmYSBmYS1pbmZvLWNpcmNsZSBtb3JlLW9wdGlvbiBhbGxvdy10ZXh0IHN0YXRlQ2hhbmdlQ29tbWVudCcgZGF0YS1jb250ZW50PSciKyBjb21tZW50ICsgIic+PC9pPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICByZXMgPSAnPGRpdj4nK2RhdGEraW5mb0ljb24rJzwvZGl2Pic7CiAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlczsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgeyAvLzQwCiAgICAgICAgICAgICAgICBkYXRhOiAndmVyc2lvblR5cGUnLAogICAgICAgICAgICAgICAgbmFtZTogJ3ZlcnNpb25UeXBlLnZhbHVlJywKICAgICAgICAgICAgICAgIHZpc2libGU6IGZhbHNlLAogICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAiY29sLXZlcnNpb24tdHlwZSIsCiAgICAgICAgICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlbmRlclZhbHVlTG9va3VwKGRhdGEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB7IC8vIDQxCiAgICAgICAgICAgICAgICBkYXRhOiAncmVjZWlwdERhdGVTdHJpbmcnLAogICAgICAgICAgICAgICAgbmFtZTogJ3JlY2VpcHREYXRlJywKICAgICAgICAgICAgICAgIHZpc2libGU6IHZpc2libGUoJ3JlY2VpcHREYXRlJyksCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtcmVjZWlwdC1kYXRlIiwKICAgICAgICAgICAgICAgIG9yZGVyYWJsZTogZmFsc2UsCiAgICAgICAgICAgICAgICByZW5kZXIgOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWZhdWx0UmVuZGVyKGRhdGEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB7IC8vIDQyCiAgICAgICAgICAgICAgICBkYXRhOiAnb25zZXREYXRlJywKICAgICAgICAgICAgICAgIG5hbWU6ICdvbnNldERhdGUnLAogICAgICAgICAgICAgICAgdmlzaWJsZTogdmlzaWJsZSgnb25zZXREYXRlJyksCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtb25zZXQtZGF0ZSIsCiAgICAgICAgICAgICAgICBvcmRlcmFibGU6IHRydWUsCiAgICAgICAgICAgICAgICByZW5kZXIgOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWZhdWx0UmVuZGVyKGRhdGEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB7Ly8gNDMKICAgICAgICAgICAgICAgIGRhdGE6ICdzdWJtaXNzaW9uRGF0ZScsCiAgICAgICAgICAgICAgICBuYW1lOiAnc3VibWlzc2lvbkRhdGUnLAogICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAiY29sLXN1Ym1pc3Npb24tZGF0ZSIsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiBmYWxzZSwKICAgICAgICAgICAgICAgIHJlbmRlciA6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRSZW5kZXIoZGF0YSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsvLyA0NAogICAgICAgICAgICAgICAgZGF0YTogJ2Rvc2FnZUZvcm0nLAogICAgICAgICAgICAgICAgbmFtZTogJ2Rvc2FnZUZvcm0udmFsdWUnLAogICAgICAgICAgICAgICAgdmlzaWJsZTogdmlzaWJsZSgnZG9zYWdlRm9ybS52YWx1ZScpLAogICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAiY29sLWRvc2FnZS1mb3JtIiwKICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVuZGVyVmFsdWVMb29rdXAoZGF0YSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsvLyA0NQogICAgICAgICAgICAgICAgZGF0YTogJ2Nhc2VWZXJzaW9uVHlwZScsCiAgICAgICAgICAgICAgICBuYW1lOiAnY2FzZVZlcnNpb25UeXBlJywKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1jYXNlLXZ0eXBlIiwKICAgICAgICAgICAgICAgIHZpc2libGU6IGZhbHNlLAogICAgICAgICAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWZhdWx0UmVuZGVyKGRhdGEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB7Ly8gNDYKICAgICAgICAgICAgICAgIGRhdGE6ICdpY3NyVHlwZScsCiAgICAgICAgICAgICAgICBuYW1lOiAnaWNzci50eXBlJywKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1pY3NyLXR5cGUiLAogICAgICAgICAgICAgICAgdmlzaWJsZTogdmlzaWJsZSgnaWNzci50eXBlJyksCiAgICAgICAgICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRSZW5kZXIoZGF0YSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsvLyA0NwogICAgICAgICAgICAgICAgZGF0YTogJ3N0dWR5VHlwZScsCiAgICAgICAgICAgICAgICBuYW1lOiAnc3R1ZHlUeXBlLnZhbHVlJywKICAgICAgICAgICAgICAgIHZpc2libGU6IHZpc2libGUoJ3N0dWR5VHlwZS52YWx1ZScpLAogICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAiY29sLXN0dWR5LXR5cGUiLAogICAgICAgICAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiByZW5kZXJWYWx1ZUxvb2t1cChkYXRhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgey8vNDgKICAgICAgICAgICAgICAgIGRhdGE6ICdwYXRpZW50TmFtZScsCiAgICAgICAgICAgICAgICBuYW1lOiAncGF0aWVudE5hbWUnLAogICAgICAgICAgICAgICAgdmlzaWJsZTogdmlzaWJsZSgncGF0aWVudE5hbWUnKSwKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1wYXRpZW50LW5hbWUiLAogICAgICAgICAgICAgICAgcmVuZGVyOmZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRSZW5kZXIoZGF0YSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsvLzQ5CiAgICAgICAgICAgICAgICBkYXRhOiAnc2VyaW91c25lc3MnLAogICAgICAgICAgICAgICAgbmFtZTogJ3NlcmlvdXNuZXNzU3RyaW5nJywKICAgICAgICAgICAgICAgIHZpc2libGU6IHZpc2libGUoJ3NlcmlvdXNuZXNzU3RyaW5nJyksCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtbGlzdC1zZXIiLAogICAgICAgICAgICAgICAgb3JkZXJhYmxlOiBmYWxzZSwKICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVuZGVyV2l0aE1vcmVPcHRpb25zKCdzZXJpb3VzbmVzcycsIGRhdGEsICdzaG9ydE5hbWUnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgey8vNTAKICAgICAgICAgICAgICAgIGRhdGE6ICdjYXNlQ291bnRyeScsCiAgICAgICAgICAgICAgICBuYW1lOiAnY2FzZUNvdW50cnkubmFtZScsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdjYXNlQ291bnRyeS5uYW1lJyksCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtY2FzZS1jb3VudHJ5IiwKICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVuZGVyTmFtZUxvb2t1cChkYXRhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgey8vNTEKICAgICAgICAgICAgICAgIGRhdGE6ICdhbGxSZWZlcmVuY2VzJywKICAgICAgICAgICAgICAgIG5hbWU6ICdhbGxSZWZlcmVuY2VzJywKICAgICAgICAgICAgICAgIHZpc2libGU6IHZpc2libGUoJ2FsbFJlZmVyZW5jZXMnKSwKICAgICAgICAgICAgICAgIG9yZGVyYWJsZTogZmFsc2UsCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtYWxsLXJlZiIsCiAgICAgICAgICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICBpZihyb3cuc291cmNlRGJJZCA9PT0gMSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmYXVsdFJlbmRlcihkYXRhKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlbmRlcldpdGhNb3JlT3B0aW9uc0ZvclN0cmluZygiYWxsUmVmZXJlbmNlcyIsZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB7Ly81MgogICAgICAgICAgICAgICAgZGF0YTogJ3BhdGllbnRJZCcsCiAgICAgICAgICAgICAgICBuYW1lOiAncGF0aWVudElkJywKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1wYXRpZW50LWlkIiwKICAgICAgICAgICAgICAgIHZpc2libGU6IHZpc2libGUoJ3BhdGllbnRJZCcpLAogICAgICAgICAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWZhdWx0UmVuZGVyKGRhdGEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB7Ly81MwogICAgICAgICAgICAgICAgZGF0YTogJ2RvYlN0cmluZycsCiAgICAgICAgICAgICAgICBuYW1lOiAnZG9iJywKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1saXN0LWRvYiIsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdkb2InKSwKICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24oZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWZhdWx0UmVuZGVyKGRhdGEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB7Ly81NAogICAgICAgICAgICAgICAgZGF0YTogJ21hdGNoU2NvcmUnLAogICAgICAgICAgICAgICAgbmFtZTogJ21hdGNoU2NvcmUnLAogICAgICAgICAgICAgICAgdmlzaWJsZTogdmlzaWJsZSgnbWF0Y2hTY29yZScpLAogICAgICAgICAgICAgICAgb3JkZXJhYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAibWF0Y2hTY29yZSBjb2wtbWF0Y2gtc2NvcmUiLAogICAgICAgICAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWZhdWx0UmVuZGVyKGRhdGEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB7Ly8gNTUKICAgICAgICAgICAgICAgIGRhdGE6ICdzaW1wbGVTZWFyY2gnLAogICAgICAgICAgICAgICAgbmFtZTogJ3NpbXBsZVNlYXJjaCcsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiBmYWxzZSwKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1zaW1wbGUtc2VhcmNoIiwKICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmYXVsdFJlbmRlcihkYXRhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgeyAvLyA1NgogICAgICAgICAgICAgICAgZGF0YTogJ2RhdGVSYW5nZVNlYXJjaCcsCiAgICAgICAgICAgICAgICBuYW1lOiAnZGF0ZVJhbmdlU2VhcmNoJywKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1kYXRlcmFuZ2Utc2VhcmNoIiwKICAgICAgICAgICAgICAgIHZpc2libGU6IGZhbHNlLAogICAgICAgICAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWZhdWx0UmVuZGVyKGRhdGEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB7Ly81NwogICAgICAgICAgICAgICAgZGF0YTogJ3NvdXJjZURiJywKICAgICAgICAgICAgICAgIG5hbWU6ICdzb3VyY2VEYicsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdzb3VyY2VEYicpLAogICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAiY29sLXNvdXJjZS1kYiIsCiAgICAgICAgICAgICAgICBvcmRlcmFibGU6IHRydWUsCiAgICAgICAgICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRSZW5kZXIoZGF0YSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsvLzU4CiAgICAgICAgICAgICAgICBkYXRhOiAnc2FmZXR5V0ZTdGF0ZScsCiAgICAgICAgICAgICAgICBuYW1lOiAnc2FmZXR5V0ZTdGF0ZScsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdzYWZldHlXRlN0YXRlJyksCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtc2FmZXR5LXdmc3RhdGUiLAogICAgICAgICAgICAgICAgb3JkZXJhYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWZhdWx0UmVuZGVyKGRhdGEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB7IC8vNTkKICAgICAgICAgICAgICAgIGRhdGE6ICdjZW50cmFsUmVjZWlwdERhdGVTdHJpbmcnLAogICAgICAgICAgICAgICAgbmFtZTogJ2NlbnRyYWxSZWNlaXB0RGF0ZScsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdjZW50cmFsUmVjZWlwdERhdGUnKSwKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1jZW50cmFsLXJlY2VpcHQtZGF0ZSIsCiAgICAgICAgICAgICAgICBvcmRlcmFibGU6IHRydWUsCiAgICAgICAgICAgICAgICByZW5kZXI6IGZ1bmN0aW9uKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmYXVsdFJlbmRlcihkYXRhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgeyAvLzYwCiAgICAgICAgICAgICAgICBkYXRhOiAnbG9jYWxTdWJtaXNzaW9uRGF0ZVN0cmluZycsCiAgICAgICAgICAgICAgICBuYW1lOiAnbG9jYWxTdWJtaXNzaW9uRGF0ZScsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdsb2NhbFN1Ym1pc3Npb25EYXRlJyksCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtbG9jYWwtc3VibWlzc2lvbi1kYXRlIiwKICAgICAgICAgICAgICAgIG9yZGVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24oZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWZhdWx0UmVuZGVyKGRhdGEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB7IC8vNjEKICAgICAgICAgICAgICAgIGRhdGE6ICdsb2NhbFN1Ym1pc3Npb25EdWVEYXRlU3RyaW5nJywKICAgICAgICAgICAgICAgIG5hbWU6ICdsb2NhbFN1Ym1pc3Npb25EdWVEYXRlJywKICAgICAgICAgICAgICAgIHZpc2libGU6IHZpc2libGUoJ2xvY2FsU3VibWlzc2lvbkR1ZURhdGUnKSwKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1sb2NhbC1zdWJtaXNzaW9uLWR1ZS1kYXRlIiwKICAgICAgICAgICAgICAgIG9yZGVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24oZGF0YSkgewogICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRSZW5kZXIoZGF0YSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsgLy82MgogICAgICAgICAgICAgICAgZGF0YTogJ2xhdGVzdEFzc2lnbm1lbnRDb21tZW50JywKICAgICAgICAgICAgICAgIG5hbWU6ICdsYXRlc3RBc3NpZ25tZW50Q29tbWVudCcsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdsYXRlc3RBc3NpZ25tZW50Q29tbWVudCcpLAogICAgICAgICAgICAgICAgb3JkZXJhYmxlOiBmYWxzZSwKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1hc3NpZ25tZW50LWNvbW1lbnRzIiwKICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbEVuY29kZWREYXRhID0gIiI7CiAgICAgICAgICAgICAgICAgICAgdmFyIHF1b3Rlc0NvbnZlcnRlZERhdGEgPSAiIjsKICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgaHRtbEVuY29kZWREYXRhID0gcHZpLnV0aWwuaHRtbEVuY29kZShkYXRhKTsKICAgICAgICAgICAgICAgICAgICAgICAgIHF1b3Rlc0NvbnZlcnRlZERhdGEgPSBwdmkudXRpbC5jb252ZXJ0VG9TaW5nbGVRdW90ZShodG1sRW5jb2RlZERhdGEpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzxzcGFuIGNsYXNzPSJvbmUtcm93LWVsaXBzaXMgcHZqc19vdXRlci1tb3JlLWJveCIgZGF0YS1tb3JlPSInICsgcXVvdGVzQ29udmVydGVkRGF0YSArICciPicgKwogICAgICAgICAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9InB2anNfaW5uZXItbW9yZS1ib3giPicgKyBodG1sRW5jb2RlZERhdGEgKyAnPC9zcGFuPjwvc3Bhbj4nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsgLy82MwogICAgICAgICAgICAgICAgZGF0YTogJ3ZlbmRvcicsCiAgICAgICAgICAgICAgICBuYW1lOiAndmVuZG9yJywKICAgICAgICAgICAgICAgIHZpc2libGU6IHZpc2libGUoJ3ZlbmRvcicpLAogICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAiY29sLWNhc2UtdmVuZG9yIiwKICAgICAgICAgICAgICAgIG9yZGVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmYXVsdFJlbmRlcihkYXRhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgeyAvLzY0CiAgICAgICAgICAgICAgICBkYXRhOiAncmVwbGFjZW1lbnRSZXF1aXJlZCcsCiAgICAgICAgICAgICAgICBuYW1lOiAncmVwbGFjZW1lbnRSZXF1aXJlZCcsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdyZXBsYWNlbWVudFJlcXVpcmVkJyksCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtcmVwbGFjZW1lbnQtcmVxdWlyZWQiLAogICAgICAgICAgICAgICAgb3JkZXJhYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWZhdWx0UmVuZGVyKGRhdGEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB7IC8vNjUKICAgICAgICAgICAgICAgIGRhdGE6ICdjYXNlQ3JlYXRlZERhdGUnLAogICAgICAgICAgICAgICAgbmFtZTogJ2Nhc2VDcmVhdGVkRGF0ZScsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdjYXNlQ3JlYXRlZERhdGUnKSwKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1jYXNlLWRhdGUtY3JlYXRlZCIsCiAgICAgICAgICAgICAgICBvcmRlcmFibGU6IHRydWUsCiAgICAgICAgICAgICAgICByZW5kZXI6IGZ1bmN0aW9uKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmYXVsdFJlbmRlcihkYXRhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgeyAvLzY2CiAgICAgICAgICAgICAgICBkYXRhOiAncmVwb3J0ZXJzJywKICAgICAgICAgICAgICAgIG5hbWU6ICdyZXBvcnRlcnMub3JnYW5pemF0aW9uJywKICAgICAgICAgICAgICAgIHZpc2libGU6IHZpc2libGUoJ3JlcG9ydGVycy5vcmdhbml6YXRpb24nKSwKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1jYXNlLXJlcG9ydGVyLW9yZ2FuaXphdGlvbiIsCiAgICAgICAgICAgICAgICBvcmRlcmFibGU6IHRydWUsCiAgICAgICAgICAgICAgICByZW5kZXIgOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiByZW5kZXJXaXRoTW9yZU9wdGlvbnMoJ3JlcG9ydGVycycsIGRhdGEsICdvcmdhbml6YXRpb24nKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgeyAvLzY3CiAgICAgICAgICAgICAgICBkYXRhOiAncmVwb3J0ZXJzJywKICAgICAgICAgICAgICAgIG5hbWU6ICdyZXBvcnRlcnMuZGVwYXJ0bWVudCcsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdyZXBvcnRlcnMuZGVwYXJ0bWVudCcpLAogICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAiY29sLWNhc2UtcmVwb3J0ZXItZGVwYXJ0bWVudCIsCiAgICAgICAgICAgICAgICBvcmRlcmFibGU6IHRydWUsCiAgICAgICAgICAgICAgICByZW5kZXIgOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiByZW5kZXJXaXRoTW9yZU9wdGlvbnMoJ3JlcG9ydGVycycsIGRhdGEsICdkZXBhcnRtZW50Jyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsgLy82OAogICAgICAgICAgICAgICAgZGF0YTogJ3JlcG9ydGVycycsCiAgICAgICAgICAgICAgICBuYW1lOiAncmVwb3J0ZXJzLmFkZHJlc3MnLAogICAgICAgICAgICAgICAgdmlzaWJsZTogdmlzaWJsZSgncmVwb3J0ZXJzLmFkZHJlc3MnKSwKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogImNvbC1jYXNlLXJlcG9ydGVyLWFkZHJlc3MiLAogICAgICAgICAgICAgICAgb3JkZXJhYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiByZW5kZXJXaXRoTW9yZU9wdGlvbnMoJ3JlcG9ydGVycycsIGRhdGEsICdhZGRyZXNzJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsgLy82OQogICAgICAgICAgICAgICAgZGF0YTogJ3JlcG9ydGVycycsCiAgICAgICAgICAgICAgICBuYW1lOiAncmVwb3J0ZXJzLnRlbGVwaG9uZScsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdyZXBvcnRlcnMudGVsZXBob25lJyksCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtY2FzZS1yZXBvcnRlci10ZWxlcGhvbmUiLAogICAgICAgICAgICAgICAgb3JkZXJhYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgcmVuZGVyIDogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVuZGVyV2l0aE1vcmVPcHRpb25zKCdyZXBvcnRlcnMnLCBkYXRhLCAndGVsZXBob25lJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsgLy83MAogICAgICAgICAgICAgICAgZGF0YTogJ3JlcG9ydGVycycsCiAgICAgICAgICAgICAgICBuYW1lOiAncmVwb3J0ZXJzLmZheE51bWJlcicsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdyZXBvcnRlcnMuZmF4TnVtYmVyJyksCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtY2FzZS1yZXBvcnRlci1mYXgiLAogICAgICAgICAgICAgICAgb3JkZXJhYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgcmVuZGVyIDogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVuZGVyV2l0aE1vcmVPcHRpb25zKCdyZXBvcnRlcnMnLCBkYXRhLCAnZmF4TnVtYmVyJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsgLy83MQogICAgICAgICAgICAgICAgZGF0YTogJ3JlcG9ydGVycycsCiAgICAgICAgICAgICAgICBuYW1lOiAncmVwb3J0ZXJzLmVtYWlsJywKICAgICAgICAgICAgICAgIHZpc2libGU6IHZpc2libGUoJ3JlcG9ydGVycy5lbWFpbCcpLAogICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAiY29sLWNhc2UtcmVwb3J0ZXItZW1haWwiLAogICAgICAgICAgICAgICAgb3JkZXJhYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgcmVuZGVyIDogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVuZGVyV2l0aE1vcmVPcHRpb25zKCdyZXBvcnRlcnMnLCBkYXRhLCAnZW1haWwnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgeyAvLzcyCiAgICAgICAgICAgICAgICBkYXRhOiAncHFjQ2FzZU51bWJlcicsCiAgICAgICAgICAgICAgICBuYW1lOiAncHFjQ2FzZU51bWJlcicsCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICJjb2wtcHFjLWNudW1iZXIiLAogICAgICAgICAgICAgICAgdmlzaWJsZTogdmlzaWJsZSgncHFjQ2FzZU51bWJlcicpLAogICAgICAgICAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWZhdWx0UmVuZGVyKGRhdGEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB7Ly83MwogICAgICAgICAgICAgICAgZGF0YTogJ3JldHVyblJlcXVpcmVkJywKICAgICAgICAgICAgICAgIG5hbWU6ICdyZXR1cm5SZXF1aXJlZCcsCiAgICAgICAgICAgICAgICB2aXNpYmxlOiB2aXNpYmxlKCdyZXR1cm5SZXF1aXJlZCcpLAogICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAiY29sLWNhc2UtcmV0dXJuUmVxdWlyZWQiLAogICAgICAgICAgICAgICAgb3JkZXJhYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWZhdWx0UmVuZGVyKGRhdGEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB7Ly83NAogICAgICAgICAgICAgICAgZGF0YTogJ3JlZnVuZFJlcXVlc3RlZCcsCiAgICAgICAgICAgICAgICBuYW1lOiAncmVmdW5kUmVxdWVzdGVkJywKICAgICAgICAgICAgICAgIHZpc2libGU6IHZpc2libGUoJ3JlZnVuZFJlcXVlc3RlZCcpLAogICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAiY29sLWNhc2UtcmVmdW5kUmVxdWVzdGVkIiwKICAgICAgICAgICAgICAgIG9yZGVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmYXVsdFJlbmRlcihkYXRhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgeyAvLzc1CiAgICAgICAgICAgICAgICBkYXRhOiAncmVwb3J0ZXJzJywKICAgICAgICAgICAgICAgIG5hbWU6ICdyZXBvcnRlcnMuY29udGFjdFR5cGVzLnZhbHVlJywKICAgICAgICAgICAgICAgIHZpc2libGU6IHZpc2libGUoJ3JlcG9ydGVycy5jb250YWN0VHlwZXMudmFsdWUnKSwKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2NvbC1jYXNlLXJlcG9ydGVyLWNvbnRhY3QtdHlwZXMnLAogICAgICAgICAgICAgICAgb3JkZXJhYmxlOiBmYWxzZSwKICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24oZGF0YSkgewogICAgICAgICAgICAgICAgICAgIGlmKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9ICBfLmNvbGxlY3QoZGF0YVswXS5jb250YWN0VHlwZXMsIGZ1bmN0aW9uIChlbGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWZhdWx0UmVuZGVyKGVsZS52YWx1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmpvaW4oIiwgIik7CiAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlbmRlcldpdGhNb3JlT3B0aW9uc0ZvclN0cmluZygnY29udGFjdFR5cGVzJywgZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsgLy8gNzYKICAgICAgICAgICAgICAgIGRhdGE6ICdhY3Rpb24nLAogICAgICAgICAgICAgICAgb3JkZXJhYmxlOiBmYWxzZSwKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogInB2LXRhYmxlLWFjdGlvbiIsCiAgICAgICAgICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICByb3dbJ2lzTGlzdCddID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICByb3dbJ2NvbnRhaW5lcklkJ10gPSBjb250YWluZXJJZDsKICAgICAgICAgICAgICAgICAgICByb3dbJ2FjdGlvblZpc2libGUnXSA9IGFjdGlvblZpc2libGU7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHB2aS51dGlsLm1hbmFnZUFjdGlvblZpZXdzKCkuaW5pdCh7CiAgICAgICAgICAgICAgICAgICAgICAgIHRtcGxOYW1lOiAndmlld0FjdGlvbicsCiAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VJZDogcGFnZVR5cGVJZCwKICAgICAgICAgICAgICAgICAgICAgICAgZGF0YU9iajogcm93CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICBdOwoKICAgICAgICB2YXIgZ3JpZFNlYXJjaENvbHMgPSBbCiAgICAgICAgICAgIG51bGwsIC8vMAogICAgICAgICAgICBudWxsLCAvLzEKICAgICAgICAgICAgbnVsbCwgLy8yCiAgICAgICAgICAgIG51bGwsIC8vMwogICAgICAgICAgICBudWxsLCAvLzQKICAgICAgICAgICAgbnVsbCwgLy81CiAgICAgICAgICAgIG51bGwsIC8vNgogICAgICAgICAgICBudWxsLCAvLzcKICAgICAgICAgICAgbnVsbCwgLy84CiAgICAgICAgICAgIG51bGwsIC8vOQogICAgICAgICAgICBudWxsLCAvLzEwCiAgICAgICAgICAgIG51bGwsIC8vMTEKICAgICAgICAgICAgeyAvLyAxMgogICAgICAgICAgICAgICAgc2VhcmNoOiBsb2dpblVzZXIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgbnVsbCwgLy8xMwogICAgICAgICAgICBudWxsLCAvLzE0CiAgICAgICAgICAgIG51bGwsIC8vMTUKICAgICAgICAgICAgbnVsbCwgLy8xNgogICAgICAgICAgICBudWxsLCAvLzE3CiAgICAgICAgICAgIG51bGwsIC8vMTgKICAgICAgICAgICAgbnVsbCwgLy8xOQogICAgICAgICAgICBudWxsLCAvLzIwCiAgICAgICAgICAgIG51bGwsIC8vMjEKICAgICAgICAgICAgbnVsbCwgLy8yMgogICAgICAgICAgICBudWxsLCAvLzIzCiAgICAgICAgICAgIG51bGwsIC8vMjQKICAgICAgICAgICAgbnVsbCwgLy8yNQogICAgICAgICAgICBudWxsLCAvLzI2CiAgICAgICAgICAgIG51bGwsIC8vMjcKICAgICAgICAgICAgbnVsbCwgLy8yOAogICAgICAgICAgICBudWxsLCAvLzI5CiAgICAgICAgICAgIG51bGwsIC8vMzAKICAgICAgICAgICAgbnVsbCwgLy8zMQogICAgICAgICAgICBudWxsLCAvLzMyCiAgICAgICAgICAgIG51bGwsIC8vMzMKICAgICAgICAgICAgbnVsbCwgLy8zNAogICAgICAgICAgICBudWxsLCAvLzM1CiAgICAgICAgICAgIG51bGwsIC8vMzYKICAgICAgICAgICAgbnVsbCwgLy8zNwogICAgICAgICAgICBudWxsLCAvLzM4CiAgICAgICAgICAgIG51bGwsIC8vMzkKICAgICAgICAgICAgbnVsbCwgLy80MAogICAgICAgICAgICBudWxsLCAvLzQxCiAgICAgICAgICAgIG51bGwsIC8vNDIKICAgICAgICAgICAgbnVsbCwgLy80MwogICAgICAgICAgICBudWxsLCAvLzQ0CiAgICAgICAgICAgIG51bGwsIC8vNDUKICAgICAgICAgICAgbnVsbCwgLy80NgogICAgICAgICAgICBudWxsLCAvLzQ3CiAgICAgICAgICAgIG51bGwsIC8vNDgKICAgICAgICAgICAgbnVsbCwgLy80OQogICAgICAgICAgICBudWxsLCAvLzUwCiAgICAgICAgICAgIG51bGwsIC8vNTEKICAgICAgICAgICAgbnVsbCwgLy81MgogICAgICAgICAgICBudWxsLCAvLzUzCiAgICAgICAgICAgIG51bGwsIC8vNTQKICAgICAgICAgICAgeyAgICAgLy81NQogICAgICAgICAgICAgICAgc2VhcmNoOiAneyAiZmlyc3RSZWNlaXB0RGF0ZSIgOiAnICsgZ2V0RGVmYXVsdERhdGVSYW5nZSgpICsgJywgImNhc2VTdGF0ZUlkIiA6ICInICsgYnVpbGRJbmNsdWRlRXhjbHVkZVZhbHVlcygpICsgJyIsICJzb3VyY2VEYklkIiA6ICInICsgZ2V0U291cmNlRGF0YWJhc2VzT3JEZWZhdWx0KCkuam9pbigiLCIpICsgJyJ9JwogICAgICAgICAgICB9LAogICAgICAgICAgICBudWxsLCAvLzU2CiAgICAgICAgICAgIG51bGwsIC8vNTcKICAgICAgICAgICAgbnVsbCwgLy81OAogICAgICAgICAgICBudWxsLCAvLzU5CiAgICAgICAgICAgIG51bGwsIC8vNjAKICAgICAgICAgICAgbnVsbCwgLy82MQogICAgICAgICAgICBudWxsLCAvLzYyCiAgICAgICAgICAgIG51bGwsIC8vNjMKICAgICAgICAgICAgbnVsbCwgLy82NAogICAgICAgICAgICBudWxsLCAvLzY1CiAgICAgICAgICAgIG51bGwsIC8vNjYKICAgICAgICAgICAgbnVsbCwgLy82NwogICAgICAgICAgICBudWxsLCAvLzY4CiAgICAgICAgICAgIG51bGwsIC8vNjkKICAgICAgICAgICAgbnVsbCwgLy83MAogICAgICAgICAgICBudWxsLCAvLzcxCiAgICAgICAgICAgIG51bGwsIC8vNzIKICAgICAgICAgICAgbnVsbCwgLy83MwogICAgICAgICAgICBudWxsLCAvLzc0CiAgICAgICAgICAgIG51bGwgLy83NSAtIEFjdGlvbi9WaWV3CiAgICAgICAgXTsKCiAgICAgICAgY29sdW1uU2l6ZSA9IGdyaWRDb2xzLmxlbmd0aDsKICAgICAgICB2YXIgZGF0YVRhYmxlU3RvcmFnZUtleSA9IGdldFN0b3JhZ2VLZXkoJ0RhdGFUYWJsZScpOwoKICAgICAgICB2YXIgc2V0U3R1ZHlBbmRQYXRpZW50VmlzaWJpbGl0eSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIGNsaW5pY2FsVHJpYWxzID0gcHZpLnJlZmVyZW5jZURhdGFVdGlsLm1hbmFnZVJlZmVyZW5jZURhdGEuZ2V0TGlzdFJlZmVyZW5jZURhdGEoImNsaW5pY2FsLXRyaWFscyIpOwogICAgICAgICAgICB2YXIgdmFsID0gJCgiI2R1cGxpY2F0ZVNlYXJjaEZvcm0gc2VsZWN0W25hbWU9J3NhZmV0eURhdGEuc291cmNlVHlwZS5pZCddIikudmFsKCk7CiAgICAgICAgICAgIHZhciBzdHVkeUZpZWxkcyA9ICQoImlucHV0W25hbWVePSdzYWZldHlEYXRhLnN0dWR5J10iKS5jbG9zZXN0KCIudGVtcGxhdGUtY29udHJvbCIpOwogICAgICAgICAgICBpZihjbGluaWNhbFRyaWFscykgewogICAgICAgICAgICAgICAgaWYgKGNsaW5pY2FsVHJpYWxzLmluZGV4T2YocGFyc2VJbnQodmFsKSkgPj0gMCkgewogICAgICAgICAgICAgICAgICAgIHN0dWR5RmllbGRzLnJlbW92ZUNsYXNzKCdoaWRlJyk7CiAgICAgICAgICAgICAgICAgICAgJCgiI3N0dWR5TmFtZSIpLmFkZENsYXNzKCdoaWRlJyk7CiAgICAgICAgICAgICAgICAgICAgJCgnI3BhdGllbnRQYXRpZW50SWQnKS5yZW1vdmVDbGFzcygnaGlkZScpLmZpbmQoJ2lucHV0JykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIHN0dWR5RmllbGRzLmFkZENsYXNzKCdoaWRlJyk7CiAgICAgICAgICAgICAgICAgICAgJCgnI3BhdGllbnRQYXRpZW50SWQnKS5hZGRDbGFzcygnaGlkZScpLmZpbmQoJ2lucHV0JykuYWRkQ2xhc3MoJ2hpZGUnKS52YWwoIiIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAgICAgdmFyIGhhbmRsZVNob3dIaWRlRmllbGRGb3JEdXBTZWFyY2ggPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIC8qdG9kbyByZWZhY3RvciBiZWxvdyBjb2RlIHRoZSByZW1vdmUgaGFyZCBkZXBlbmRlbmN5Ki8KICAgICAgICAgICAgdmFyIGRyb3Bkb3duSWRMaXN0ID0gW107CiAgICAgICAgICAgIF8uZWFjaCgkKCJkaXYucHYtaGVhZC1jb25maWciKS5maW5kKCJpbnB1dDpjaGVja2JveCIpLCBmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgICAgaWYoaXRlbS5jaGVja2VkKXsKICAgICAgICAgICAgICAgICAgICBkcm9wZG93bklkTGlzdC5wdXNoKCQoaXRlbSkuZGF0YSgnaWQnKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBfLmVhY2goJCgiI2R1cGxpY2F0ZVNlYXJjaEZvcm0iKS5maW5kKCIudGVtcGxhdGUtY29udHJvbCIpLCBmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgICAgaXRlbSA9ICQoaXRlbSk7CiAgICAgICAgICAgICAgICB2YXIgc2VjdGlvbklkID0gaXRlbS5hdHRyKCJpZCIpOwogICAgICAgICAgICAgICAgaWYoZHJvcGRvd25JZExpc3QubGVuZ3RoID4gMCAgJiYgZHJvcGRvd25JZExpc3QuaW5kZXhPZihzZWN0aW9uSWQpIDwgMCB8fCBkcm9wZG93bklkTGlzdC5sZW5ndGggPT09IDApewogICAgICAgICAgICAgICAgICAgIGl0ZW0uYWRkQ2xhc3MoImhpZGUiKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHNldFN0dWR5QW5kUGF0aWVudFZpc2liaWxpdHkoKTsKICAgICAgICB9OwoKICAgICAgICB2YXIgY2xlYXJQYWdlU3RhdGVIaXN0b3J5SWZOZWVkZWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIC8vIGxvYWRpbmcgaGVyZSB0byBzaG93L2hpZGUgZmllbGRzCiAgICAgICAgICAgIHNlYXJjaEZvcm1TdGF0ZS5sb2FkVmlzaWJpbGl0eVN0YXRlKCk7CiAgICAgICAgICAgICQoImxpLmZpZWxkLXZpc2libGUiKS5lYWNoKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdmFyIGxpID0gJCh0aGlzKTsKICAgICAgICAgICAgICAgIGlmICghbGkuaGFzQ2xhc3MoImNsaWNrLWRpc2FibGVkIikpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgY2hlY2tib3ggPSBsaS5maW5kKCI6Y2hlY2tib3giKVswXTsKICAgICAgICAgICAgICAgICAgICB2YXIgaWQgPSBsaS5kYXRhKCdpZCcpOwogICAgICAgICAgICAgICAgICAgIHZhciBpc0R1cGxpY2F0ZUZpZWxkSWQgPSAkKGNoZWNrYm94KS5kYXRhKCdjbGFzcycpLmluZGV4T2YocHZpX2NvbnN0YW50cy5kdXBsaWNhdGVGaWVsZElkQ2xhc3MpID4gLTE7CiAgICAgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnRTZWxlY3RvcjsKICAgICAgICAgICAgICAgICAgICBpZiAoaXNEdXBsaWNhdGVGaWVsZElkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRTZWxlY3RvciA9IHB2aS51dGlsLmluY2x1ZGVEdXBsaWNhdGVGaWVsZHMoaWQpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRTZWxlY3RvciA9IHB2aS51dGlsLmV4Y2x1ZGVEdXBsaWNhdGVGaWVsZChpZCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNoZWNrYm94LmNoZWNrZWQgPSAhZWxlbWVudFNlbGVjdG9yLmhhc0NsYXNzKCdoaWRlJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBpZiAoaXNPbkR1cGxpY2F0ZVNlYXJjaFBhZ2UpIHsKICAgICAgICAgICAgICAgIGhhbmRsZVNob3dIaWRlRmllbGRGb3JEdXBTZWFyY2goKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoIWlzTG9hZGVkVmlhQmFjayAmJiBjbGVhckNhY2hlT25SZWZyZXNoKSB7CiAgICAgICAgICAgICAgICAvL2NsZWFyIGNvbXBsZXRlbHkgb25seSBmb3IgZHVwIHNlYXJjaAogICAgICAgICAgICAgICAgc2VhcmNoRm9ybVN0YXRlLmNsZWFyU2VsZWN0aXZlbHkoKTsKICAgICAgICAgICAgICAgIG1hbmFnZVNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oZGF0YVRhYmxlU3RvcmFnZUtleSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc2VhcmNoRm9ybVN0YXRlLmxvYWRTdGF0ZShzZWFyY2hGb3JtTmFtZSk7CiAgICAgICAgfTsKCiAgICAgICAgdmFyIGdldERhdGVWYWx1ZUZyb21SYW5nZSA9IGZ1bmN0aW9uIChkYXRhLCBkYXRlRm9ybWF0KSB7CiAgICAgICAgICAgIGlmKCFkYXRhKXsKICAgICAgICAgICAgICAgIHJldHVybiAnJzsKICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIganNvbiA9IEpTT04ucGFyc2UoZGF0YSk7CiAgICAgICAgICAgIGlmIChqc29uICYmIGpzb24uZ3RlICYmIGRhdGVGb3JtYXQpIHsKICAgICAgICAgICAgICAgIHJldHVybiBtb21lbnQudXRjKGpzb24uZ3RlKS5mb3JtYXQoZGF0ZUZvcm1hdCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuICcnOwogICAgICAgIH07CgogICAgICAgIHZhciBoYW5kbGVGaXhDb2x1bW5Gb2N1cyA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIGlmKGZvY3VzT25GaXhlZENvbCkgewogICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBjb250YWluZXIuZmluZCgiaW5wdXRbZGF0YS1maWVsZD0nIitmaXhlZEZpbHRlckNvbE5hbWUrIiddOnZpc2libGUiKTsKICAgICAgICAgICAgICAgIGVsZW1lbnQuZm9jdXMoKTsKICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGVsZW1lbnQudmFsKCk7CiAgICAgICAgICAgICAgICBlbGVtZW50LnZhbCgiIikudmFsKHZhbHVlKTsKICAgICAgICAgICAgICAgIGZvY3VzT25GaXhlZENvbCA9IGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAgICAgdmFyIHVwZGF0ZUdyaWRVSSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcHZ1aS5ncmlkLnV0aWxzLnNldEdyaWRIZWlnaHQoY29udGFpbmVyKTsKICAgICAgICAgICAgY2FzZUxpc3RUYWJsZS5maXhlZENvbHVtbnMoKS51cGRhdGUoKTsKICAgICAgICAgICAgaGFuZGxlRml4Q29sdW1uRm9jdXMoKTsKICAgICAgICB9OwoKICAgICAgICBjb250YWluZXIub24oewogICAgICAgICAgICAnc2hvd24uYnMuY29sbGFwc2UnIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgdXBkYXRlR3JpZFVJKCk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICdoaWRkZW4uYnMuY29sbGFwc2UnIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgdXBkYXRlR3JpZFVJKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9LCcjYWNjb3JkaW9uLXNlYXJjaGNhc2UnKTsKCiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5wZGZWaWV3JywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgcGRmTGlua0hyZWYgPSAkKHRoaXMpLmZpbmQoJ2EnKS5hdHRyKCdocmVmJyk7CiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gcHZpLnV0aWwudXBkYXRlVXJsUXVlcnlTdHJpbmdQYXJhbWV0ZXIocGRmTGlua0hyZWYsICd0ZW1wbGF0ZUlkJywgIiIpOwogICAgICAgIH0pOwoKICAgICAgICB2YXIgdXBkYXRlR3JpZFNjcm9sbGJhck9uU3BsaXRWaWV3ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAkKGRvY3VtZW50KS5vbigiY2hhbmdlIiwgIiNlYXN0UGFuZWxUb2dnbGUiLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBwdnVpLmdyaWQubWFuYWdlVUlXcmFwcGVyLnVwZGF0ZVBlcmZlY3RTY3JvbGxiYXIoY29udGFpbmVyKTsKICAgICAgICAgICAgICAgIHVwZGF0ZUdyaWRVSSgpOwogICAgICAgICAgICB9KTsKICAgICAgICB9OwoKICAgICAgICBjbGVhclBhZ2VTdGF0ZUhpc3RvcnlJZk5lZWRlZCgpOwoKICAgICAgICBkYXRhVGFibGUub24oJ2RyYXcuZHQnLCBmdW5jdGlvbiAoKSB7IC8vTmVlZGVkIGJlZm9yZSB0YWJsZSBpbml0aWFsaXphdGlvbiBmb3IgZW5hYmxpbmcvZGlzYWJsaW5nIEFzc2lnbmVkVG8gQ29sdW1uRmlsdGVyLgogICAgICAgICAgICAgICAgaGlnaGxpZ2h0VGFiKCk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICB2YXIgZGVmZXJyZWREYXRhU291cmNlID0gZnVuY3Rpb24oZGF0YSkgewogICAgICAgICAgICByZXR1cm4gJC5EZWZlcnJlZChmdW5jdGlvbihkKSB7CiAgICAgICAgICAgICAgICBpZiAoIWluaXRpYWxpemVkKSB7CiAgICAgICAgICAgICAgICAgICAgZC5yZXNvbHZlKHsKICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjb3Jkc1RvdGFsOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbXlSZWNvcmRzVG90YWw6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNvcmRzRmlsdGVyZWQ6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7fQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGlmICghcGFnaW5nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFUYWJsZU9wdGlvbnMubGVuZ3RoID0gcGFnZUxlbmd0aDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZGF0YVRhYmxlT3B0aW9ucy5sb2FkRGF0YSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgXy5leHRlbmQoZGF0YSwgZGF0YVRhYmxlT3B0aW9ucyk7CiAgICAgICAgICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBjcmVhdGVVUkwocHZpX3VybHMuY2FzZV9saXN0X2RhdGFfdXJsKSwKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLAogICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhLAogICAgICAgICAgICAgICAgICAgICAgICBiZWZvcmVTZW5kOiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGlzRGFzaGJvYXJkUGFnZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB2dWkuY29tbW9uLnB2V2lkZ2V0TG9hZGVyLnNob3dMb2FkZXIoY29udGFpbmVyKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdnVpLmNvbW1vbi5zaG93UFZMb2FkZXIoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oanNvbikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5yZXNvbHZlKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBqc29uCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgY29tcGxldGU6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVRhYmxlT3B0aW9ucy5sb2FkRGF0YSA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNEYXNoYm9hcmRQYWdlID8gcHZ1aS5jb21tb24ucHZXaWRnZXRMb2FkZXIuaGlkZUxvYWRlcihjb250YWluZXIpIDogcHZ1aS5jb21tb24uaGlkZVBWTG9hZGVyKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfTsKCiAgICAgICAgY2FzZUxpc3RUYWJsZSA9IGRhdGFUYWJsZS5EYXRhVGFibGUoewogICAgICAgICAgICBvcmRlcmluZzogdHJ1ZSwKICAgICAgICAgICAgc2VhcmNoaW5nOiB0cnVlLAogICAgICAgICAgICBzdGF0ZVNhdmU6IHRydWUsCiAgICAgICAgICAgIHN0YXRlRHVyYXRpb246IC0xLAogICAgICAgICAgICBzZXJ2ZXJTaWRlOiB0cnVlLAogICAgICAgICAgICBwcm9jZXNzaW5nOiB0cnVlLAogICAgICAgICAgICBkb206ICdydGlwJywKICAgICAgICAgICAgc2Nyb2xsQ29sbGFwc2U6IHRydWUsCiAgICAgICAgICAgIHJlbmRlcmVyOiAiYm9vdHN0cmFwIiwKICAgICAgICAgICAgc2Nyb2xsWDogdHJ1ZSwKICAgICAgICAgICAgZml4ZWRDb2x1bW5zOiB7CiAgICAgICAgICAgICAgICBsZWZ0Q29sdW1uczogMgogICAgICAgICAgICB9LAogICAgICAgICAgICBzY3JvbGxZOiBwdnVpLmdyaWQudXRpbHMuZ2V0R3JpZEhlaWdodChjb250YWluZXIpLAogICAgICAgICAgICBjb2xSZW9yZGVyOiB7CiAgICAgICAgICAgICAgICByZWFsdGltZTogZmFsc2UKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb3JkZXI6IG9yZGVyQnlEZWZhdWx0LCAvL2RlZmF1bHQgc29ydGluZyBpcyBieSBGaXJzdCBSZWNlaXB0IGRhdGUgZGVzYwogICAgICAgICAgICBwYWdpbmc6IHBhZ2luZywKICAgICAgICAgICAgbGVuZ3RoQ2hhbmdlOiBsZW5ndGhDaGFuZ2UsCiAgICAgICAgICAgIHBhZ2VMZW5ndGg6IHBhZ2VMZW5ndGggPyBwYWdlTGVuZ3RoIDogMjUsCiAgICAgICAgICAgIGRpc3BsYXlTdGFydDogcGFnZVN0YXJ0LAogICAgICAgICAgICBpbmZvOiBzaG93SW5mbywKICAgICAgICAgICAgJ3BhZ2luZ1R5cGUnOiAnZnVsbF9udW1iZXJzX25vX2VsbGlwc2VzJywKICAgICAgICAgICAgZm5Jbml0Q29tcGxldGU6IHVwZGF0ZUdyaWRTY3JvbGxiYXJPblNwbGl0VmlldywKICAgICAgICAgICAgbGVuZ3RoTWVudTogWzI1LCA1MCwgMTAwLCAyNTBdLAogICAgICAgICAgICAic3RhdGVMb2FkUGFyYW1zIjogZnVuY3Rpb24gKHNldHRpbmdzLCBkYXRhKSB7CiAgICAgICAgICAgICAgICBzZWFyY2hGb3JtU3RhdGUubG9hZFN0YXRlKHNlYXJjaEZvcm1OYW1lKTsKICAgICAgICAgICAgICAgIGlmIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGlzRnJvbUJhY2tCdXR0b24gPSAoaXNMb2FkZWRWaWFCYWNrICYmICFpc1dpZGdldCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0Zyb21CYWNrQnV0dG9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuc3RhcnQgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAob3JkZXJCeURlZmF1bHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEub3JkZXIgPSBvcmRlckJ5RGVmYXVsdDsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAocGFnaW5nICYmIGRhdGEubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5maW5kKCcuaW5wLWRpc3BsYXktcmVjb3JkJykudmFsKGRhdGEubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKGlzV2lkZ2V0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEubGVuZ3RoID0gcGFnZUxlbmd0aCA/IHBhZ2VMZW5ndGggOiA1OwogICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnN0YXJ0ID0gMDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuY29sdW1ucykgewogICAgICAgICAgICAgICAgICAgICAgICBkYXRhVGFibGUuZmluZCgidGhlYWQgdGgiKS5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRoYXQgPSAkKHRoaXMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb2xJbmRleCA9IHRoYXQuZGF0YSgnaWR4Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0Zyb21CYWNrQnV0dG9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhRmllbGQgPSB0aGF0LmF0dHIoJ2RhdGEtZmllbGQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChkYXRhRmllbGQgIT09ICdzaW1wbGVTZWFyY2gnKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoZGF0YS5jb2x1bW5zW2NvbEluZGV4XS5zZWFyY2ggPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuY29sdW1uc1tjb2xJbmRleF0uc2VhcmNoID0ge307CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihkYXRhRmllbGQgPT09ICdhc3NpZ25lZFRvVXNlcm5hbWUnICYmIChkYXRhLmNvbHVtbnNbY29sSW5kZXhdLnNlYXJjaC5zZWFyY2ggPT09IGxvZ2luVXNlciB8fCBkYXRhLmNvbHVtbnNbY29sSW5kZXhdLnNlYXJjaC5zZWFyY2ggPT09IHVuZGVmaW5lZCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmNvbHVtbnNbY29sSW5kZXhdLnNlYXJjaC5zZWFyY2ggPSBsb2dpblVzZXI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuY29sdW1uc1tjb2xJbmRleF0uc2VhcmNoLnNlYXJjaCA9ICcnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNpbXBsZVNlYXJjaEpzb24gPSBKU09OLnBhcnNlKGRhdGEuY29sdW1uc1tjb2xJbmRleF0uc2VhcmNoLnNlYXJjaCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFnZVR5cGVJZCA9PSAiNCIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaW1wbGVTZWFyY2hKc29uID0gYnVpbGRTaW1wbGVTZWFyY2hDcml0ZXJpYSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8uZWFjaChbJ2ZpcnN0UmVjZWlwdERhdGUnLCAnbW9zdFJlY2VudFJlY2VpcHREYXRlJywgJ3N1Ym1pc3Npb25EYXRlJ10sIGZ1bmN0aW9uIChpdCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2ltcGxlU2VhcmNoSnNvbltpdF0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByYW5nZUpzb24gPSB0eXBlb2Ygc2ltcGxlU2VhcmNoSnNvbltpdF0gPT09ICJzdHJpbmciPyBKU09OLnBhcnNlKHNpbXBsZVNlYXJjaEpzb25baXRdKTpzaW1wbGVTZWFyY2hKc29uW2l0XTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyYW5nZUpzb24ucmFuZ2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmFuZ2UgPSBjcmVhdGVEYXRlUmFuZ2VWYWx1ZShyYW5nZUpzb24ucmFuZ2UsIHJhbmdlSnNvbi54KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZUpzb24uZ3RlID0gcmFuZ2UuZ3RlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlSnNvbi5sdGUgPSByYW5nZS5sdGU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2ltcGxlU2VhcmNoSnNvbltpdF0gPSBKU09OLnN0cmluZ2lmeShyYW5nZUpzb24pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmNvbHVtbnNbY29sSW5kZXhdLnNlYXJjaC5zZWFyY2ggPSBKU09OLnN0cmluZ2lmeShzaW1wbGVTZWFyY2hKc29uKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VhcmNoVmFsdWUgPSBkYXRhLmNvbHVtbnNbY29sSW5kZXhdLnNlYXJjaC5zZWFyY2g7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBzZWFyY2hWYWx1ZSA9PT0gJ3N0cmluZycgfHwgc2VhcmNoVmFsdWUgaW5zdGFuY2VvZiBTdHJpbmcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlucHV0RmllbGQgPSB0aGF0LmZpbmQoJ2lucHV0Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbnB1dEZpZWxkLmhhc0NsYXNzKCdkYXRlLXRpbWUtZmlsdGVyJykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0RmllbGQudmFsKGdldERhdGVWYWx1ZUZyb21SYW5nZShzZWFyY2hWYWx1ZSwgaW5wdXRGaWVsZC5hdHRyKCdkYXRhLXByZWNpc2lvbicpKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRGaWVsZC52YWwoc2VhcmNoVmFsdWUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJzdGF0ZVNhdmVDYWxsYmFjayI6IGZ1bmN0aW9uIChzZXR0aW5ncywgZGF0YSkgewogICAgICAgICAgICAgICAgaWYgKGlzV2lkZ2V0KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBKU09OLnN0cmluZ2lmeShkYXRhKTsKICAgICAgICAgICAgICAgICAgICBicm93c2VyU3RvcmFnZS51dGlscy5hZGRUb1N0b3JhZ2UoZGF0YVRhYmxlU3RvcmFnZUtleSx2YWx1ZSk7CiAgICAgICAgICAgICAgICAgICAgcHZpLnVzZXIuc3RhdGUuc2F2ZVN0YXRlKHZhbHVlLCBzZWFyY2hGb3JtTmFtZSwgcHZpX3BhZ2Vfc2VjdGlvbl9uYW1lLmRhdGF0YWJsZV9zZWN0aW9uKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgInN0YXRlTG9hZENhbGxiYWNrIjogZnVuY3Rpb24gKHNldHRpbmdzKSB7CiAgICAgICAgICAgICAgICB2YXIgc3RvcmFnZURhdGEgPSBicm93c2VyU3RvcmFnZS51dGlscy5nZXRGcm9tU3RvcmFnZShkYXRhVGFibGVTdG9yYWdlS2V5KTsKICAgICAgICAgICAgICAgIGlmKF8uaXNFbXB0eShzdG9yYWdlRGF0YSkpIHsKICAgICAgICAgICAgICAgICAgICBzdG9yYWdlRGF0YSA9IChwdmkudXNlci5zdGF0ZS5sb2FkU3RhdGUoc2VhcmNoRm9ybU5hbWUscHZpX3BhZ2Vfc2VjdGlvbl9uYW1lLmRhdGF0YWJsZV9zZWN0aW9uKSkuZGF0YS5kYXRhOwogICAgICAgICAgICAgICAgICAgIGRhdGFUYWJsZS5maW5kKCJ0aGVhZCB0aFtkYXRhLWZpZWxkPSdhc3NpZ25lZFRvVXNlcm5hbWUnXSBzZWxlY3QiKS52YWwobG9naW5Vc2VyKS50cmlnZ2VyKCJjaGFuZ2Uuc2VsZWN0MiIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIChzdG9yYWdlRGF0YSA/IEpTT04ucGFyc2Uoc3RvcmFnZURhdGEpIDogbnVsbCk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGFqYXg6IGZ1bmN0aW9uKGRhdGEsIGNhbGxiYWNrLCBzZXR0aW5ncykgewogICAgICAgICAgICAgICAgZGVmZXJyZWREYXRhU291cmNlKGRhdGEpLmRvbmUoZnVuY3Rpb24gKF9kYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGFKc29uID0gX2RhdGEuZGF0YTsKICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuZmluZCgnI215LWNhc2VzLWNvdW50JykudGV4dChkYXRhSnNvbi5teVJlY29yZHNUb3RhbCk7CiAgICAgICAgICAgICAgICAgICAgdmFyIG1hdGNoaW5nUmVjb3JkVG90YWwgPSBkYXRhSnNvbi5tYXRjaGluZ1JlY29yZHNUb3RhbCA9PT0gMCA/IGRhdGFKc29uLm15UmVjb3Jkc1RvdGFsIDogIGRhdGFKc29uLm1hdGNoaW5nUmVjb3Jkc1RvdGFsOwogICAgICAgICAgICAgICAgICAgIHZhciBtYXRjaENhc2VDb3VudFRleHQgPSBtYXRjaGluZ1JlY29yZFRvdGFsOwogICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaGluZ1JlY29yZFRvdGFsICYmIG1hdGNoaW5nUmVjb3JkVG90YWwgPiBwYWdlTGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoQ2FzZUNvdW50VGV4dCA9IGdldE1lc3NhZ2UoJ21vcmVfdGhhbl9tYXRjaGluZ19tc2cnLCB7cGFnZUxlbjogcGFnZUxlbmd0aH0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuZmluZCgnI21hdGNoaW5nLWNhc2VzLWNvdW50JykudGV4dChtYXRjaENhc2VDb3VudFRleHQpOwogICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5maW5kKCcjYWxsLWNhc2VzLWNvdW50JykudGV4dChkYXRhSnNvbi5yZWNvcmRzVG90YWwpOwogICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKGRhdGFKc29uKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9LAogICAgICAgICAgICBjb2x1bW5zOiBncmlkQ29scywKICAgICAgICAgICAgc2VhcmNoQ29sczogZ3JpZFNlYXJjaENvbHMKICAgICAgICB9KTsKCiAgICAgICAgY2FzZUxpc3RUYWJsZVJlZi5jYXNlTGlzdFRhYmxlID0gY2FzZUxpc3RUYWJsZTsKICAgICAgICBhbGxDYXNlTGlzdFRhYmxlcy5wdXNoKGNhc2VMaXN0VGFibGUpOwoKICAgICAgICB2YXIgaGlnaExpZ2h0Um93cyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgY2FzZUxpc3RUYWJsZS5yb3dzKCkuZXZlcnkoZnVuY3Rpb24gKHJvd0lkeCkgewogICAgICAgICAgICAgICAgdmFyIHJvdyA9IGNhc2VMaXN0VGFibGUucm93KHJvd0lkeCk7CiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHJvdy5kYXRhKCk7CiAgICAgICAgICAgICAgICB2YXIgbm9kZSA9IHJvdy5ub2RlKCk7CiAgICAgICAgICAgICAgICBpZiAoZGF0YS5wYXNzRHVlICYmICEoXy5jb250YWlucyhbcHZpX2Nhc2Vfc3RhdGVfbmFtZXMuU1VDQ0VTU0ZVTCwgcHZpX2Nhc2Vfc3RhdGVfbmFtZXMuUkVKRUNURURdLCBkYXRhLmNhc2VTdGF0ZSkpKSB7CiAgICAgICAgICAgICAgICAgICAgJChub2RlKS5hZGRDbGFzcygicHYtY2FzZS1vdmVyZHVlIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH07CgogICAgICAgIHZhciBtYXNrUElJRmllbGRzID0gZnVuY3Rpb24oKXsKICAgICAgICAgICAgZGF0YVRhYmxlLmZpbmQoInRkIikuZWFjaChmdW5jdGlvbigpewogICAgICAgICAgICAgICAgdmFyIGVsZSA9ICQodGhpcyk7CiAgICAgICAgICAgICAgICBpZihlbGUudGV4dCgpID09PSBQSUlNYXNrUGF0dGVybil7CiAgICAgICAgICAgICAgICAgICAgZWxlLmFkZENsYXNzKCJwdi1waWkiKS50ZXh0KFBJSU1hc2tTdHJpbmcpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9OwoKICAgICAgICB2YXIgaGFuZGxlQWN0aW9uRHJvcGRvd24gPSBmdW5jdGlvbiAoZXZ0LCBhY3Rpb24sIGNhc2VJZCwgdGVtcGxhdGVJZCwgaW50YWtlQ2FzZU51bWJlciwgY2FzZVN0YXRlLCB0YXJnZXRDb250YWluZXIsIGludGFrZUNhc2VWZXJzaW9uKSB7CiAgICAgICAgICAgIHZhciBqdXN0aWZpY2F0aW9uTW9kYWwgPSAkKCIjcHYtanVzdGlmaWNhdGlvbi1tb2RhbCIpOwoKICAgICAgICAgICAgdmFyIGNoYW5nZUNhc2VTdGF0ZVdpdGhKdXN0aWZpY2F0aW9uID0gZnVuY3Rpb24gKHRhcmdldFN0YXRlLCBwYXJhbXMpIHsKICAgICAgICAgICAgICAgIHZhciBwYXNzd29yZCA9ICQoIiNqdXN0aWZpY2F0aW9uUGFzc3dvcmQiKS52YWwoKTsKICAgICAgICAgICAgICAgIHB2aS51dGlsLnNob3dTcGluRGxnKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgICAgICAgICB1cmw6IHB2aV91cmxzLmNhc2Vfc3RhdGVfY2hhbmdlLAogICAgICAgICAgICAgICAgICAgICAgICBhc3luYzogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdQT1NUJywKICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBwYXJzZUludChjYXNlSWQpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvU3RhdGVJZDogdGFyZ2V0U3RhdGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uUGVyZm9ybWVkOiBhY3Rpb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tbWVudHM6IHBhcmFtcy5jb21tZW50cywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IHBhcmFtcy50aW1lc3RhbXAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lVG9TYXZlUHJlZmVyZW5jZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdnVpLmNvbW1vbi5oaWRlUFZMb2FkZXIoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNwID0gSlNPTi5wYXJzZShkYXRhKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfLmhhcyhyZXNwLCAiY2FzZVN0YXRlQ2hhbmdlZCIpICYmICFyZXNwLmNhc2VTdGF0ZUNoYW5nZWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdmkudXRpbC5oYW5kbGVDYXNlU3RhdGVDaGFuZ2VSZWplY3Rpb24ocmVzcCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqdXN0aWZpY2F0aW9uTW9kYWwubW9kYWwoImhpZGUiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXy5lYWNoKGFsbENhc2VMaXN0VGFibGVzLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLmFqYXgucmVsb2FkKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdmkudXRpbC5zaG93RmxvYXRpbmdOb3RpZmljYXRpb24uc3VjY2Vzc01lc3NhZ2UocmVzcC5tZXNzYWdlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcCA9IEpTT04ucGFyc2UoZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdnVpLmNvbW1vbi5oaWRlUFZMb2FkZXIoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB2aS51dGlsLnNob3dGbG9hdGluZ05vdGlmaWNhdGlvbi5lcnJvck1lc3NhZ2UocmVzcC5tZXNzYWdlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH07CgogICAgICAgICAgICB2YXIgY2hhbmdlQ2FzZVN0YXRlID0gZnVuY3Rpb24gKHRhcmdldFN0YXRlKSB7CiAgICAgICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgICAgIHVybDogcHZpX3VybHMuY2FzZV9zdGF0ZV9jaGFuZ2UsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLAogICAgICAgICAgICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHBhcnNlSW50KGNhc2VJZCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b1N0YXRlSWQ6IHRhcmdldFN0YXRlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uUGVyZm9ybWVkOiBhY3Rpb24KICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIGJlZm9yZVNlbmQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcHZ1aS5jb21tb24uc2hvd1BWTG9hZGVyKCk7CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcCA9SlNPTi5wYXJzZShkYXRhKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3Auc3RhdHVzID09IDQyMil7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdmkubGlzdC5jb21tb25GdW5jdGlvbnMucG9wdWxhdGVFcnJvckluRXJyb3JDb250YWluZXIocmVzcC50ZXh0LmVycm9ycyx0YXJnZXRDb250YWluZXIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZUxpc3RUYWJsZS5hamF4LnJlbG9hZCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHZ1aS5jb21tb24uaGlkZVBWTG9hZGVyKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgXy5lYWNoKGFsbENhc2VMaXN0VGFibGVzLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5hamF4LnJlbG9hZCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdnVpLmNvbW1vbi5oaWRlUFZMb2FkZXIoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB2aS51dGlsLnNob3dGbG9hdGluZ05vdGlmaWNhdGlvbi5zdWNjZXNzTWVzc2FnZShyZXNwLm1lc3NhZ2UpOwogICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNwID0gSlNPTi5wYXJzZShkYXRhKTsKICAgICAgICAgICAgICAgICAgICAgICAgcHZ1aS5jb21tb24uaGlkZVBWTG9hZGVyKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHB2aS51dGlsLnNob3dGbG9hdGluZ05vdGlmaWNhdGlvbi5lcnJvck1lc3NhZ2UocmVzcC5tZXNzYWdlKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIHZhciB0YXJnZXQgPSAkKGV2dC50YXJnZXQpOwogICAgICAgICAgICBpZih0YXJnZXQucGFyZW50KCdsaTpmaXJzdCcpLmhhc0NsYXNzKCd0YXNrJykpewogICAgICAgICAgICAgICAgdmFyIGNhbGxCYWNrID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIHZhciBjYXNlQ291bnRyeUlkID0gdGFyZ2V0LmRhdGEoImNhc2UtY291bnRyeS1pZCIpOwogICAgICAgICAgICAgICAgICAgIHZhciB2ZW5kb3JJZCA9IHRhcmdldC5kYXRhKCJ2ZW5kb3ItSWQiKTsKICAgICAgICAgICAgICAgICAgICB0YXNrQWN0aW9uLmNvbW1vbk1ldGhvZC5hZGRUYXNrKGNhc2VJZCwgaW50YWtlQ2FzZU51bWJlciwgaW50YWtlQ2FzZVZlcnNpb24sIG51bGwsIGNhc2VDb3VudHJ5SWQsIHZlbmRvcklkKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHB2aS51dGlsLmNoZWNrRWRpdExvY2soY2FzZUlkLCBjYWxsQmFjayk7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZih0YXJnZXQucGFyZW50KCdsaTpmaXJzdCcpLmhhc0NsYXNzKCdmb2xsb3dVcFF1ZXJ5JykpewogICAgICAgICAgICAgICAgdmFyIGNhbGxCYWNrID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIGZvbGxvd1VwUXVlcnkuY29tbW9uTWV0aG9kLmFkZEZvbGxvd1VwUXVlcnkoY2FzZUlkLCBpbnRha2VDYXNlTnVtYmVyLCBpbnRha2VDYXNlVmVyc2lvbik7CiAgICAgICAgICAgICAgICAgICAgcHZpLnV0aWwuZ2V0Q2FzZURhdGEoY2FzZUlkKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHB2aS51dGlsLmNoZWNrRWRpdExvY2soY2FzZUlkLCBjYWxsQmFjayk7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZiAodGFyZ2V0LnBhcmVudCgnbGk6Zmlyc3QnKS5oYXNDbGFzcygnZHVwbGljYXRlU2VhcmNoJykpIHsKICAgICAgICAgICAgICAgIHZhciBnb3RvRHVwU2VhcmNoID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIHB2aS51dGlsLmdvdG9VUkwocHZpX3VybHMuZHVwbGljYXRlX3NlYXJjaF91cmwgKyB0YXJnZXQuZGF0YSgnY2FzZS1pZCcpKTsKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBwdmkudXRpbC5jaGVja0VkaXRMb2NrKGNhc2VJZCwgZ290b0R1cFNlYXJjaCk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc3dpdGNoIChhY3Rpb24pIHsKICAgICAgICAgICAgICAgIGNhc2UgYWN0aXZlU3RhdGVJZDoKICAgICAgICAgICAgICAgICAgICBpZiAoJCh0YXJnZXQpLnBhcmVudCgpLmhhc0NsYXNzKCdmb2xsb3dVcCcpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhY2NlcHRGb2xsb3dVcCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IHB2aV91cmxzLmZvbGxvd191cF91cmwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9sbG93VXBDYXNlSWQ6IGNhc2VJZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB2aS51dGlsLnNob3dGb2xsb3dVcE1vZGFsLmluaXQocGFyYW1zLCBmb2xsb3dVcEZyb21MaXN0LCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgcHZpLnV0aWwuY2hlY2tFZGl0TG9jayhjYXNlSWQsIGFjY2VwdEZvbGxvd1VwKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHB2aS51dGlsLmNoZWNrRWRpdExvY2soY2FzZUlkLCBjaGFuZ2VDYXNlU3RhdGUsIGFjdGl2ZVN0YXRlSWQpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgZmluYWxTdGF0ZUlkOgogICAgICAgICAgICAgICAgICAgIHZhciBzdWJtaXRIYW5kbGVyID0gZnVuY3Rpb24gKGZpbmFsU3RhdGVJZCkgewogICAgICAgICAgICAgICAgICAgICAgICBzaG93V2FybmluZygiIiwgZ2V0TWVzc2FnZSgnc3VibWl0X2J0bicpLCBwdmlfY29uc3RhbnRzLmNhbmNlbF9idG5fbGFiZWwsIHB2aV9jb25zdGFudHMuc3VjY2Vzc19idG5fbGFiZWwsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZUNhc2VTdGF0ZShmaW5hbFN0YXRlSWQpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHB2aS51dGlsLmNoZWNrRWRpdExvY2soY2FzZUlkLCBzdWJtaXRIYW5kbGVyLGZpbmFsU3RhdGVJZCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIHJlamVjdGVkU3RhdGVJZDoKICAgICAgICAgICAgICAgICAgICB2YXIgcmVqZWN0Q2FzZSA9IGZ1bmN0aW9uKHJlamVjdGVkU3RhdGVJZCl7CiAgICAgICAgICAgICAgICAgICAgICAgIHB2aS51dGlsLmp1c3RpZmljYXRpb25Nb2R1bGUoKS5zaG93SnVzdGlmaWNhdGlvbk1vZGFsKCJtYXJrX3JlamVjdCIsIHJlamVjdGVkU3RhdGVJZCwgY2hhbmdlQ2FzZVN0YXRlV2l0aEp1c3RpZmljYXRpb24pOwogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgcHZpLnV0aWwuY2hlY2tFZGl0TG9jayhjYXNlSWQsIHJlamVjdENhc2UsIHJlamVjdGVkU3RhdGVJZCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIGNsb3NlZFN0YXRlSWQ6CiAgICAgICAgICAgICAgICAgICAgdmFyIGNsb3NlQ2FzZSA9IGZ1bmN0aW9uKGNsb3NlZFN0YXRlSWQpewogICAgICAgICAgICAgICAgICAgICAgICBwdmkudXRpbC5qdXN0aWZpY2F0aW9uTW9kdWxlKCkuc2hvd0p1c3RpZmljYXRpb25Nb2RhbCgibWFya19jbG9zZWQiLCBjbG9zZWRTdGF0ZUlkLCBjaGFuZ2VDYXNlU3RhdGVXaXRoSnVzdGlmaWNhdGlvbik7CiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBwdmkudXRpbC5jaGVja0VkaXRMb2NrKGNhc2VJZCwgY2xvc2VDYXNlLCBjbG9zZWRTdGF0ZUlkKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgJ2Z1bGxDYXNlVmlldyc6CiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBmY2VVcmwgKyAiLyIgKyBjYXNlSWQ7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlICdjYXNlRW50cnknOgogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gY2FzZUVudHJ5VXJsICsgIj90ZW1wbGF0ZUlkPSIgKyB0ZW1wbGF0ZUlkICsgIiZpZD0iICsgY2FzZUlkOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAnY2FzZSc6CiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmFtczsKICAgICAgICAgICAgICAgICAgICBpZiAodGVtcGxhdGVJZCA9PT0gcHZpX2NvbnN0YW50cy5hY2spIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zID0gZ2VuZXJhdGVQYXJhbXMocHZpX3VybHMueG1sX3JlcG9ydF91cmwsIHB2aV9jb25zdGFudHMuYWNrLCBjYXNlSWQpOwogICAgICAgICAgICAgICAgICAgICAgICBwdmkudXRpbC5nZXRYTUxSZXBvcnQocGFyYW1zKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRlbXBsYXRlSWQgPT09IHB2aV9jb25zdGFudHMuZTJiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcyA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXNbJ3htbFR5cGUnXSA9IHB2aV9jb25zdGFudHMuZTJiOwogICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMgPSBnZW5lcmF0ZVBhcmFtcyhwdmlfdXJscy54bWxfcmVwb3J0X3VybCwgcHZpX2NvbnN0YW50cy5lMmIsIGNhc2VJZCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHB2aS51dGlsLmdldFhNTFJlcG9ydChwYXJhbXMpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGVtcGxhdGVJZCA9PT0gcHZpX2NvbnN0YW50cy5mdV9kaWZmX3ZpZXcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zID0gZ2VuZXJhdGVQYXJhbXMocHZpX3VybHMudmFsaWRhdGVfZnVfZGlmZl92aWV3X3VybCwgcHZpX2NvbnN0YW50cy5mdV9kaWZmX3ZpZXcsIGNhc2VJZCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHB2aS51dGlsLnZhbGlkYXRlRnVEaWZmVmlldyhwYXJhbXMpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9OwoKICAgICAgICB2YXIgZ2VuZXJhdGVQYXJhbXMgPSBmdW5jdGlvbiAodXJsLCB4bWxUeXBlLCBjYXNlSWQpIHsKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICd1cmwnOiB1cmwsCiAgICAgICAgICAgICAgICAneG1sVHlwZSc6IHhtbFR5cGUsCiAgICAgICAgICAgICAgICAnY2FzZUlkJzogY2FzZUlkCiAgICAgICAgICAgIH07CiAgICAgICAgfTsKCiAgICAgICAgc2V0Q2FzZUdyaWRTZWNvbmRhcnlTdHlsZSgpOwoKICAgICAgICB2YXIgbWFuYWdlU2Vjb25kYXJ5VmlldyA9IChmdW5jdGlvbiAoKSB7CgogICAgICAgICAgICB2YXIgZ2V0RGF0YUtleSA9IGZ1bmN0aW9uIChuYW1lKSB7CiAgICAgICAgICAgICAgICBpZiAobmFtZSkgewogICAgICAgICAgICAgICAgICAgIGlmIChuYW1lLmluZGV4T2YoJy4nKSAhPT0gLTEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5hbWUuc3BsaXQoJy4nKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5hbWUuZW5kc1dpdGgoJ0xvdycpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbbmFtZS5zdWJzdHJpbmcoMCwgbmFtZS5pbmRleE9mKCdMb3cnKSldOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobmFtZS5lbmRzV2l0aCgnV2l0aE9yZGVyJykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtuYW1lLnN1YnN0cmluZygwLCBuYW1lLmluZGV4T2YoJ1dpdGhPcmRlcicpKV07CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbbmFtZV0gPT09IG51bGwgPyAiIiA6IFtuYW1lXTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIC8vIFRoaXMgaXMgdGhlIGZ1bmN0aW9uIHRvIGJ1aWxkIHRoZSBzZWNvbmRhcnkgdmlldwogICAgICAgICAgICB2YXIgYnVpbGRTZWNvbmRhcnlWaWV3Rm9yQ29sdW1uID0gZnVuY3Rpb24gKGNvbHVtbk5hbWUsIGxhYmVsLCBkYXRhKSB7CiAgICAgICAgICAgICAgICB2YXIgc3BlY2lhbEZpZWxkcyA9IHsic2VyaW91c25lc3NTdHJpbmciOiAic2VyaW91c25lc3Muc2hvcnROYW1lIiwiZHVlRGF0ZSIgOiAiZHVlRGF0ZVN0cmluZyIsImNhc2VTZXJpb3VzbmVzcy5jYXRlZ29yeSI6ImNhc2VTZXJpb3VzbmVzcyIsImxvY2FsU3VibWlzc2lvbkR1ZURhdGUiOiJsb2NhbFN1Ym1pc3Npb25EdWVEYXRlU3RyaW5nIiwiY2VudHJhbFJlY2VpcHREYXRlIjoiY2VudHJhbFJlY2VpcHREYXRlU3RyaW5nIiwibG9jYWxTdWJtaXNzaW9uRGF0ZSI6ImxvY2FsU3VibWlzc2lvbkRhdGVTdHJpbmciLCAiZG9iIjogImRvYlN0cmluZyIsICJyZXBvcnRlcnMucXVhbGlmaWNhdGlvblZhbHVlIjogInJlcG9ydGVyUXVhbGlmaWNhdGlvbi52YWx1ZSIsICJyZXBvcnRlcnMuY291bnRyeU5hbWUiOiJyZXBvcnRlckNvdW50cnkubmFtZSJ9OwogICAgICAgICAgICAgICAgLy9kYXRlIGZvcm1hdCBwYXR0ZXJuIHRvIGJlIGNvbXBhdGlibGUgd2l0aCBJRQogICAgICAgICAgICAgICAgdmFyIGRhdGVGb3JtYXRQYXR0ZXJuID0gLyhcZHs0fS1bMDFdXGQtWzAtM11cZFRbMC0yXVxkOlswLTVdXGQ6WzAtNV1cZFwuXGQrKFsrLV1bMC0yXVxkOlswLTVdXGR8WikpfChcZHs0fS1bMDFdXGQtWzAtM11cZFRbMC0yXVxkOlswLTVdXGQ6WzAtNV1cZChbKy1dWzAtMl1cZDpbMC01XVxkfFopKXwoXGR7NH0tWzAxXVxkLVswLTNdXGRUWzAtMl1cZDpbMC01XVxkKFsrLV1bMC0yXVxkOlswLTVdXGR8WikpLzsKICAgICAgICAgICAgICAgIGlmKHNwZWNpYWxGaWVsZHNbY29sdW1uTmFtZV0pewogICAgICAgICAgICAgICAgICAgIGNvbHVtbk5hbWUgPSBzcGVjaWFsRmllbGRzW2NvbHVtbk5hbWVdOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdmFyIGhpZGVGaWVsZERhdGFGb3JTYWZldHlDYXNlcyA9IFsiY2FzZVN0YXRlIiwgImFzc2lnbmVkVG9Vc2VybmFtZSIsICJpY3NyLnJlcG9ydFZlcnNpb24iLCAiaWNzci5yZXBvcnRNZXNzYWdlIiwgImljc3IuZGVzdGluYXRpb24iLCAiY2F0ZWdvcmllcy52YWx1ZSIsICJpY3NyLnN0YXRlVGltZXN0YW1wIiwgInNlbmRlclR5cGUudmFsdWUiLCAiaWNzci50eXBlIiwgImljc3IuZHVlRGF0ZSIsICJhdHRhY2htZW50cy5uYW1lIiwgInNlbmRlck5hbWUiLCAiZHVlRGF0ZVN0cmluZyIsICJpY3NyLnRyYW5zbWlzc2lvblN0YXR1cyJdOwogICAgICAgICAgICAgICAgaWYoZGF0YS5zb3VyY2VEYklkID09PSAyICYmIGhpZGVGaWVsZERhdGFGb3JTYWZldHlDYXNlcy5pbmRleE9mKGNvbHVtbk5hbWUpID49MCl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdmFyIGRhdGFLZXkgPSBnZXREYXRhS2V5KGNvbHVtbk5hbWUpOwogICAgICAgICAgICAgICAgdmFyIHRoZVZhbHVlID0gIiI7CiAgICAgICAgICAgICAgICAvLyBpZiB0aGlzIGlzIGEgbG9va3VwCiAgICAgICAgICAgICAgICBpZiAoZGF0YUtleS5sZW5ndGggPiAxKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGZpcnN0S2V5ID0gZGF0YUtleVswXTsKICAgICAgICAgICAgICAgICAgICB2YXIgc2Vjb25kS2V5ID0gZ2V0RGF0YUtleShkYXRhS2V5WzFdKTsKICAgICAgICAgICAgICAgICAgICB2YXIgZmlyc3RWYWx1ZSA9IGRhdGFbZmlyc3RLZXldOwogICAgICAgICAgICAgICAgICAgIGlmIChmaXJzdFZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfLmlzQXJyYXkoZmlyc3RWYWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZVZhbHVlID0gZmlyc3RWYWx1ZS5tYXAoZnVuY3Rpb24oZWxlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbCA9IGVsZVtzZWNvbmRLZXldOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfLmlzQXJyYXkodmFsKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhS2V5WzJdKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXy5jb2xsZWN0KHZhbCwgZnVuY3Rpb24gKGVsZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsZVtkYXRhS2V5WzJdXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmpvaW4oIiwgIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWwuam9pbignLCAnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmpvaW4oIiwgIik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGVWYWx1ZSA9IGZpcnN0VmFsdWVbc2Vjb25kS2V5XTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoZVZhbHVlID0gIiI7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB0aGVWYWx1ZSA9IGRhdGFbZGF0YUtleV07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoXy5pc051bGwodGhlVmFsdWUpIHx8IF8uaXNVbmRlZmluZWQodGhlVmFsdWUpIHx8IF8uaXNOYU4odGhlVmFsdWUpIHx8IHRoZVZhbHVlID09PSAiICIpewogICAgICAgICAgICAgICAgICAgIHRoZVZhbHVlID0gIiI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZihkYXRlRm9ybWF0UGF0dGVybi50ZXN0KHRoZVZhbHVlKSl7CiAgICAgICAgICAgICAgICAgICAgdGhlVmFsdWUgPSBtb21lbnQodGhlVmFsdWUpLmZvcm1hdCgocHZpLnV0aWwuZ2V0RGF0ZUZvcm1hdHMubGlzdERhdGVGb3JtYXQpLnRvVXBwZXJDYXNlKCkpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHZhciBmb290YWJsZUNvbENsYXNzID0gdGhlVmFsdWUubGVuZ3RoIDwgNTAgPyAiZm9vdGFibGUtcm93LWRldGFpbC1jb2wtbWQiIDogImZvb3RhYmxlLXJvdy1kZXRhaWwtY29sLWxnIjsKICAgICAgICAgICAgICAgIHB2dWkuZ3JpZC51dGlscy5zZXRHcmlkSGVpZ2h0KGNvbnRhaW5lcik7IC8vVG8gRml4IERhc2hib2FyZCBXaWRnZXQgRHluYW1pYyBIZWlnaHQgSXNzdWVzCiAgICAgICAgICAgICAgICAkKCIucHYtYWN0aW9uLWRyb3Bkb3duIikuaGlkZSgpOyAvL1RoaXMgaXMgdG8gZml4IGlzc3VlIGZvciBvcGVuZWQgZHJvcGRvd24gbm90IGJlaW5nIGNsb3NlZCBjbGlja2luZyBvbiByb3cKICAgICAgICAgICAgICAgIGlmICghXy5pc0VtcHR5KHRoZVZhbHVlKSAmJiB0aGVWYWx1ZSA9PT0gUElJTWFza1BhdHRlcm4pewogICAgICAgICAgICAgICAgICAgIHJldHVybiAnPGRpdiBjbGFzcz0iZm9vdGFibGUtcm93LWRldGFpbC1jb2wgJyArIGZvb3RhYmxlQ29sQ2xhc3MgKyAnIj4nICsKICAgICAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImZvb3RhYmxlLXJvdy1kZXRhaWwtbmFtZSI+JyArIGxhYmVsICsgJyA8L2Rpdj4nICsKICAgICAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImZvb3RhYmxlLXJvdy1kZXRhaWwtdmFsdWUgcHYtcGlpIj4nICsgUElJTWFza1N0cmluZyArICc8L2Rpdj48L2Rpdj4nOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmKCFfLmlzRW1wdHkodGhlVmFsdWUpKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzxkaXYgY2xhc3M9ImZvb3RhYmxlLXJvdy1kZXRhaWwtY29sICcgKyBmb290YWJsZUNvbENsYXNzICsgJyI+JyArCiAgICAgICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJmb290YWJsZS1yb3ctZGV0YWlsLW5hbWUiPicgKyBsYWJlbCArICcgPC9kaXY+JyArCiAgICAgICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJmb290YWJsZS1yb3ctZGV0YWlsLXZhbHVlIj4nICsgcHZpLnV0aWwuZW5jb2RlVG9IVE1MKHRoZVZhbHVlKSArICc8L2Rpdj48L2Rpdj4nOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJyc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CgogICAgICAgICAgICB2YXIgZ2VuZXJhdGVTZWNvbmRhcnlWaWV3SFRNTCA9IGZ1bmN0aW9uIChyb3dEYXRhKSB7CiAgICAgICAgICAgICAgICBpZiAocm93RGF0YSkgewogICAgICAgICAgICAgICAgICAgIHZhciB0YWJsZVdyYXBwZXJXaWR0aCA9IGNvbnRhaW5lci5maW5kKCIuRFRGQ19TY3JvbGxXcmFwcGVyIikud2lkdGgoKSAtIDE1OwogICAgICAgICAgICAgICAgICAgIHZhciBncmlkU2Nyb2xsZWRMZWZ0ID0gY29udGFpbmVyLmZpbmQoIi5kYXRhVGFibGVzX3Njcm9sbEJvZHkiKS5nZXQoMCkuc2Nyb2xsTGVmdDsKICAgICAgICAgICAgICAgICAgICB2YXIgaXNBbnlEYXRhQXZhaWxhYmxlID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgLy8gcm93RGF0YSBpcyB0aGUgb3JpZ2luYWwgZGF0YSBvYmplY3QgZm9yIHRoZSByb3cKICAgICAgICAgICAgICAgICAgICB2YXIgYnVpbGRTZWNvbmRhcnlWaWV3ID0gYnVpbGRTZWNvbmRhcnlWaWV3Rm9yQ29sdW1uOwogICAgICAgICAgICAgICAgICAgIHZhciBlbGUgPSAnPGRpdiBjbGFzcz0iZm9vdGFibGUtcm93LWRldGFpbC1pbm5lciIgc3R5bGU9IndpZHRoOicgKyB0YWJsZVdyYXBwZXJXaWR0aCArICdweDsgbWFyZ2luLWxlZnQ6JytncmlkU2Nyb2xsZWRMZWZ0ICsncHgiPic7CiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbERhdGEgPSBfLnJlZHVjZShsaXN0Q29sdW1ucyhwdmlfbGlzdF9jb2x1bW5zX3ZpZXcuc2Vjb25kYXJ5Q29scywgdHJ1ZSksIGZ1bmN0aW9uIChtZW1vLCBlbGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbERhdGEgPSBidWlsZFNlY29uZGFyeVZpZXcoZWxlLm5hbWUsIGVsZS5sYWJlbCwgcm93RGF0YSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb2xEYXRhLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzQW55RGF0YUF2YWlsYWJsZSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1lbW8gKyBjb2xEYXRhICsgIlxuIjsKICAgICAgICAgICAgICAgICAgICB9LCAiIik7CiAgICAgICAgICAgICAgICAgICAgY29sRGF0YSA9IGVsZSArJzxkaXYgY2xhc3M9ImZvb3RhYmxlLXJvdy1kZXRhaWwtcm93Ij4nKyBjb2xEYXRhOwogICAgICAgICAgICAgICAgICAgIGlmIChpc0FueURhdGFBdmFpbGFibGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbERhdGEgKyAnPC9kaXY+PC9kaXY+JzsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZWxlICsnPGRpdiBjbGFzcz0idGV4dC1jZW50ZXIiPicgKyBnZXRNZXNzYWdlKCdub19kYXRhX3NlY29uZGFyeV92aWV3JykgKyAnPC9kaXY+PC9kaXY+JzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAiIjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIHZhciBoaWRlU2Vjb25kYXJ5VmlldyA9IGZ1bmN0aW9uICh0ciwgcm93KSB7CiAgICAgICAgICAgICAgICB0ci5yZW1vdmVDbGFzcygnZGV0YWlscycpOwogICAgICAgICAgICAgICAgcm93LmNoaWxkLmhpZGUoKTsKICAgICAgICAgICAgICAgIHZhciBmaXhlZENvbHVtblJvdyA9IGNvbnRhaW5lci5maW5kKCcuRFRGQ19DbG9uZWQgdGJvZHkgdHJbZGF0YS1kdC1yb3c9JyArIHJvdy5pbmRleCgpICsgJ11bY2xhc3MqPSJwYWRkaW5nIl0nKTsKICAgICAgICAgICAgICAgIGZpeGVkQ29sdW1uUm93LnJlbW92ZSgpOwogICAgICAgICAgICAgICAgcHZ1aS5ncmlkLm1hbmFnZVVJV3JhcHBlci51cGRhdGVQZXJmZWN0U2Nyb2xsYmFyKGNvbnRhaW5lcik7CiAgICAgICAgICAgIH07CgogICAgICAgICAgICB2YXIgc2hvd1NlY29uZGFyeVZpZXcgPSBmdW5jdGlvbiAodHIsIHJvdykgewogICAgICAgICAgICAgICAgdmFyIGlkeCA9IHJvdy5pbmRleCgpOwogICAgICAgICAgICAgICAgdmFyIHNlY29uZGFyeVZpZXdIVE1MID0gZ2VuZXJhdGVTZWNvbmRhcnlWaWV3SFRNTChyb3cuZGF0YSgpKTsKICAgICAgICAgICAgICAgIHRyLmFkZENsYXNzKCdkZXRhaWxzJyk7CiAgICAgICAgICAgICAgICB2YXIgc2Vjb25kYXJ5UGFuZWwgPSByb3cuY2hpbGQoc2Vjb25kYXJ5Vmlld0hUTUwpOwogICAgICAgICAgICAgICAgdmFyIHAgPSBzZWNvbmRhcnlQYW5lbC5zaG93KCk7CiAgICAgICAgICAgICAgICB2YXIgdGRIZWlnaHQgPSB0ci5uZXh0KCkuYWRkQ2xhc3MoJ3B2LWNhc2VsaXN0LXNlY29kYXJ5LXZpZXcnKS5maW5kKCIuZm9vdGFibGUtcm93LWRldGFpbC1pbm5lciIpLmhlaWdodCgpOwogICAgICAgICAgICAgICAgdHIubmV4dCgpLmZpbmQoInRkIikuY3NzKHsiaGVpZ2h0IjogdGRIZWlnaHQgKyAicHgifSk7CiAgICAgICAgICAgICAgICB2YXIgcm93SGVpZ2h0ID0gJChwLmNoaWxkKCkpLmhlaWdodCgpOwogICAgICAgICAgICAgICAgdmFyIGZpeGVkQ29sdW1uUm93ID0gY29udGFpbmVyLmZpbmQoJy5EVEZDX0Nsb25lZCB0Ym9keSB0cltkYXRhLWR0LXJvdz0nICsgaWR4ICsgJ10nKTsKICAgICAgICAgICAgICAgIGZpeGVkQ29sdW1uUm93LmFmdGVyKCI8dHIgY2xhc3M9J3BhZGRpbmcnIGRhdGEtZHQtcm93PSciICsgaWR4ICsgIicgc3R5bGU9J2hlaWdodDoiICsgcm93SGVpZ2h0ICsgInB4Jz48dGQgY29sc3Bhbj0nMic+PC90ZD48L3RyPiIpOwogICAgICAgICAgICAgICAgcHZ1aS5ncmlkLm1hbmFnZVVJV3JhcHBlci51cGRhdGVQZXJmZWN0U2Nyb2xsYmFyKGNvbnRhaW5lcik7CiAgICAgICAgICAgIH07CgogICAgICAgICAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldDsKICAgICAgICAgICAgICAgIHZhciB0cklkeCA9ICQodGFyZ2V0KS5jbG9zZXN0KCJ0ciIpLmluZGV4KCkrMTsKICAgICAgICAgICAgICAgIHZhciB0ciA9IGNvbnRhaW5lci5maW5kKCIuZGF0YVRhYmxlc19zY3JvbGxCb2R5PnRhYmxlPnRib2R5PnRyOm50aC1jaGlsZCgiK3RySWR4KyIpIik7CiAgICAgICAgICAgICAgICB2YXIgcm93ID0gY2FzZUxpc3RUYWJsZS5yb3codHIpOwogICAgICAgICAgICAgICAgaWYgKHJvdy5jaGlsZC5pc1Nob3duKCkpIHsKICAgICAgICAgICAgICAgICAgICBoaWRlU2Vjb25kYXJ5Vmlldyh0ciwgcm93KTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZihzZWNvbmRhcnlDb2x1bW5zRXhpc3QoKSkgewogICAgICAgICAgICAgICAgICAgIHNob3dTZWNvbmRhcnlWaWV3KHRyLCByb3cpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwoKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIGluaXQ6IGluaXQKICAgICAgICAgICAgfTsKICAgICAgICB9KSgpOwoKICAgICAgICB2YXIgaW5pdGlhbGl6ZVBvcG92ZXIgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIF8uZWFjaChjb250YWluZXIuZmluZCgnLm1vcmUtb3B0aW9uJyksIGZ1bmN0aW9uIChlbGUpIHsKICAgICAgICAgICAgICAgIGVsZSA9ICQoZWxlKTsKICAgICAgICAgICAgICAgIHZhciBtb3JlRGF0YUNvbnRhaW5lciA9IGVsZS5jbG9zZXN0KCIucHZqc19pbm5lci1tb3JlLWJveCIpOwogICAgICAgICAgICAgICAgdmFyIG1vcmVEYXRhOwogICAgICAgICAgICAgICAgaWYgKG1vcmVEYXRhQ29udGFpbmVyLmhhc0NsYXNzKCdkaXNhYmxlSHRtbEVuY29kZScpKSB7CiAgICAgICAgICAgICAgICAgICAgbW9yZURhdGEgPSBlbGUuZGF0YSgnbW9yZWRhdGEnKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgbW9yZURhdGEgPSBwdmkudXRpbC5lbmNvZGVUb0hUTUwoZWxlLmRhdGEoJ21vcmVkYXRhJykpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdmFyIGlzSWNvblZpZXcgPSBlbGUuZGF0YSgnaWNvbnZpZXctcG9wb3ZlcicpOwogICAgICAgICAgICAgICAgdmFyIGN1cnJWYWwgPSBpc0ljb25WaWV3PyBlbGUudGV4dCgpOiAnJzsKICAgICAgICAgICAgICAgIHZhciB0YXJnZXRFdmVudCA9IGVsZS5kYXRhKCd0YXJnZXQtZXZlbnQnKTsKICAgICAgICAgICAgICAgIHZhciBiaW5kRXZlbnQgPSB0YXJnZXRFdmVudCA/IHRhcmdldEV2ZW50IDogJ2hvdmVyJzsKICAgICAgICAgICAgICAgIGVsZS53ZWJ1aVBvcG92ZXIoewogICAgICAgICAgICAgICAgICAgIGh0bWw6ICFlbGUuaGFzQ2xhc3MoJ2FsbG93LXRleHQnKSwKICAgICAgICAgICAgICAgICAgICB0cmlnZ2VyOiBiaW5kRXZlbnQsCiAgICAgICAgICAgICAgICAgICAgY29udGVudDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBpZihfLmlzRW1wdHkobW9yZURhdGEpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb3JlRGF0YSA9ICIiOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aGVEYXRhID0gXy5maWx0ZXIobW9yZURhdGEuc3BsaXQoJywnKSwgZnVuY3Rpb24gKGl0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIV8uaXNFbXB0eShpdC50cmltKCkpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHYgPSAiIjsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxpc3RDb250YWluZXIgPSAnJzsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoIShfLmlzRW1wdHkodGhlRGF0YSkpICYmICFtb3JlRGF0YUNvbnRhaW5lci5kYXRhKCJ0eXBlLXN0cmluZyIpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGlzSWNvblZpZXcpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3RDb250YWluZXIgPSAkKCI8dWwgY2xhc3M9J2ljb24tbGlzdCcvPiIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VySWQgPSAkKGVsZSkuZGF0YSgncGsnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoZURhdGEubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGl2ZUNsYXNzID0gKHRoZURhdGFbaV0gPT09IGN1cnJWYWwpID8gImFjdGl2ZSI6ICIiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ID0gJCgiPGxpPjxhIGRhdGEtcGs9JyIrdXNlcklkKyInIGNsYXNzPSciKyBhY3RpdmVDbGFzcyArIiBwb3AtaWMiKyB0aGVEYXRhW2ldICsgIic+IiArIHRoZURhdGFbaV0gKyAiPC9hPjwvbGk+Iik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHYuYXBwZW5kVG8obGlzdENvbnRhaW5lcik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXN0Q29udGFpbmVyID0gJCgiPHVsIGNsYXNzPSd0ZXh0LWxpc3QnLz4iKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoZURhdGEubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoZURhdGFbal0pewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdiA9ICQoIjxsaT4iICsgdGhlRGF0YVtqXSArICI8L2xpPiIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHYuYXBwZW5kVG8obGlzdENvbnRhaW5lcik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdENvbnRhaW5lciA9IG1vcmVEYXRhQ29udGFpbmVyLnRleHQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGlzdENvbnRhaW5lcjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfTsKCiAgICAgICAgY2FzZUxpc3RUYWJsZS5vbignY2xpY2snLCcuc2hvd1VuYXV0aG9yaXNlZE1lc3NhZ2UnLGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcHZpLnV0aWwuc2hvd0luZm8oZ2V0TWVzc2FnZSgicGlpX2F0dGFjaG1lbnRfd2FybmluZyIpKTsKICAgICAgICB9KTsKCiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy53ZWJ1aS1wb3BvdmVyLWNvbnRlbnQgLnNob3dVbmF1dGhvcmlzZWRNZXNzYWdlJywgZnVuY3Rpb24gKCkge3B2aS51dGlsLnNob3dJbmZvKGdldE1lc3NhZ2UoInBpaV9hdHRhY2htZW50X3dhcm5pbmciKSl9KTsKCiAgICAgICAgY2FzZUxpc3RUYWJsZS5vbignY2xpY2snLCAnLmxpc3Qtcm93LWNoZWNrYm94JywgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICAgIHZhciB0YXJnZXQgPSAkKGV2ZW50LnRhcmdldCk7CiAgICAgICAgICAgIHZhciBpc0NoZWNrZWQgPSB0YXJnZXQuaXMoIjpjaGVja2VkIik7CiAgICAgICAgICAgIGlmICghaXNDaGVja2VkKSB7CiAgICAgICAgICAgICAgICB1bmNoZWNrU2VsZWN0QWxsQ2hlY2tib3goKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZihpc0NoZWNrZWQgJiYgaXNPbkR1cGxpY2F0ZVNlYXJjaFBhZ2UpewogICAgICAgICAgICAgICAgJCgiaW5wdXQ6Y2hlY2tib3hbbmFtZT0nIiArIHRhcmdldC5wcm9wKCJuYW1lIikgKyAiJ10iKS5wcm9wKCJjaGVja2VkIiwgZmFsc2UpOwogICAgICAgICAgICAgICAgdGFyZ2V0LnByb3AoImNoZWNrZWQiLCB0cnVlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIgc2hvd0J1bGtBY3Rpb25CdXR0b24gPSAgKGNvbnRhaW5lci5maW5kKCIubGlzdC1yb3ctY2hlY2tib3g6Y2hlY2tlZCIpLmxlbmd0aCA+IDEpOwogICAgICAgICAgICBtYW5hZ2VCdWxrQWN0aW9uLmluaXQoc2hvd0J1bGtBY3Rpb25CdXR0b24pOwogICAgICAgIH0pOwoKICAgICAgICBjYXNlTGlzdFRhYmxlLm9uKCdjbGljaycsICcubGluay10by1mY2UnLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgdmFyIGN1cnJlbnRFbGVtZW50ID0gJCh0aGlzKTsKICAgICAgICAgICAgdmFyIHNvdXJjZURiSWQgPSBjdXJyZW50RWxlbWVudC5kYXRhKCJzb3VyY2UtZGIiKTsKICAgICAgICAgICAgaWYoc291cmNlRGJJZCA9PT0gcHZpX2NvbnN0YW50cy5zb3VyY2VfZGJfaW50YWtlKXsKICAgICAgICAgICAgICAgIHB2aS51dGlsLmdvdG9VUkwocHZpX3VybHMuc2hvd19jYXNlX3VybCArIGN1cnJlbnRFbGVtZW50LmF0dHIoJ2RhdGEtaWQnKSArIHB2aV91cmxzLm9wZW5fYWNjb3JkaW9uKTsKICAgICAgICAgICAgfSBlbHNlIGlmKHNvdXJjZURiSWQgPT09IHB2aV9jb25zdGFudHMuc291cmNlX2RiX3NhZmV0eSl7CiAgICAgICAgICAgICAgICAvL2ZpbmQgaWQgb2YgbGF0ZXN0IHZhbGlkIHZlcnNpb24gdXNpbmcgaW50YWtlIGNhc2UKICAgICAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7CiAgICAgICAgICAgICAgICAgICAgc291cmNlQ2FzZU51bTogY3VycmVudEVsZW1lbnQudGV4dCgpLAogICAgICAgICAgICAgICAgICAgIHNvdXJjZURiSWQ6IHNvdXJjZURiSWQKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBwdmkudXRpbC5mZXRjaExpbmtlZENhc2VzRGV0YWlscyhwYXJhbXMpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIGNhc2VMaXN0VGFibGUub24oJ2NsaWNrJywgJy5zYWZldHktbGluay10by1mY2UnLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgdmFyIGN1cnJlbnRFbGVtZW50ID0gJCh0aGlzKTsKICAgICAgICAgICAgdmFyIHNvdXJjZURiSWQgPSBjdXJyZW50RWxlbWVudC5kYXRhKCJzb3VyY2UtZGIiKTsKICAgICAgICAgICAgaWYgKGN1cnJlbnRFbGVtZW50Lmhhc0NsYXNzKCJzYWZldHktbGluay1ub3QtZXhpc3RzIikpIHsKICAgICAgICAgICAgICAgIHN3YWwoIldhcm5pbmciLCBnZXRNZXNzYWdlKCdzYWZldHlfY2FzZV9ub3RfbGlua2VkJykpOwogICAgICAgICAgICB9IGVsc2UgaWYoc291cmNlRGJJZCA9PT0gcHZpX2NvbnN0YW50cy5zb3VyY2VfZGJfc2FmZXR5KSB7CiAgICAgICAgICAgICAgICBwdmkudXRpbC5nb3RvVVJMKHB2aV91cmxzLnNob3dfY2FzZV91cmwgKyBjdXJyZW50RWxlbWVudC5hdHRyKCdkYXRhLWlkJykgKyBwdmlfdXJscy5vcGVuX2FjY29yZGlvbik7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoc291cmNlRGJJZCA9PT0gcHZpX2NvbnN0YW50cy5zb3VyY2VfZGJfaW50YWtlKSB7CiAgICAgICAgICAgICAgICAvL2ZpbmQgc2FmZXR5IGNhc2UgaWQgdXNpbmcgc2FmZXR5IGNhc2UgbnVtCiAgICAgICAgICAgICAgICB2YXIgcGFyYW1zID0gewogICAgICAgICAgICAgICAgICAgIHNvdXJjZUNhc2VOdW06IGN1cnJlbnRFbGVtZW50LnRleHQoKSwKICAgICAgICAgICAgICAgICAgICBzb3VyY2VEYklkOiBzb3VyY2VEYklkCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgcHZpLnV0aWwuZmV0Y2hMaW5rZWRDYXNlc0RldGFpbHMocGFyYW1zKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBjYXNlTGlzdFRhYmxlLm9uKCdjbGljaycsICcubm90LWNsaWNrYWJsZScsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICBzd2FsKCJ3YXJuaW5nIiwgZ2V0TWVzc2FnZSgnbm9fYWN0aW9uX3N0YXRlJykgKyAkKGV2ZW50LnRhcmdldCkuYXR0cignZGF0YS1jYXNlLXN0YXRlJykgKyAiIFN0YXRlIik7CiAgICAgICAgfSk7CgogICAgICAgIGNhc2VMaXN0VGFibGUub24oJ21vdXNlZW50ZXInLCAnc3Bhbi5zdGF0ZS1jb21tZW50JywgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICAgICQoZXZlbnQudGFyZ2V0KS50b29sdGlwKCk7CiAgICAgICAgfSk7CgogICAgICAgIHB2aS51dGlsLm1hbmFnZVVzZXJBc3NpZ24uaW5pdChzY3JvbGxhYmxlU2VjdGlvbiwgc2Nyb2xsYWJsZUZpeGVkQ29sKTsKICAgICAgICBwdmkudXRpbC5tYW5hZ2VDYXNlUHJpb3JpdHkuaW5pdCgpOwogICAgICAgIGNhc2VMaXN0VGFibGUub24oJ2NsaWNrJywgJ3RyIHRkJywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgdmFyIHRhcmdldEVsZW1lbnQgPSBlLnRhcmdldC50YWdOYW1lOwogICAgICAgICAgICBpZih0YXJnZXRFbGVtZW50ID09PSAiVEQiKXsKICAgICAgICAgICAgICAgIG1hbmFnZVNlY29uZGFyeVZpZXcuaW5pdChlKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICAvLyBtb3ZlZCBvdXQgYWN0aW9uIGRyb3Bkb3duIGh5cGVybGluayBjbGljayBmdW5jdGlvbgogICAgICAgICQoZG9jdW1lbnQpLm9uKCJjbGljayIsICIucHYtYWN0aW9uLWRyb3Bkb3duIGEiLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgIGlmKGUuaGFuZGxlZCAhPT0gdHJ1ZSkgewogICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9ICQoZS50YXJnZXQpLAogICAgICAgICAgICAgICAgICAgIGNhc2VJZCA9IHRhcmdldC5hdHRyKCdkYXRhLWNhc2UtaWQnKSwKICAgICAgICAgICAgICAgICAgICBpbnRha2VDYXNlTnVtYmVyID0gdGFyZ2V0LmF0dHIoJ2RhdGEtaW50YWtlLWNhc2UtbnVtJyksCiAgICAgICAgICAgICAgICAgICAgaW50YWtlQ2FzZVZlcnNpb24gPSB0YXJnZXQuYXR0cignZGF0YS1pbnRha2UtY2FzZS12ZXJzaW9uJyksCiAgICAgICAgICAgICAgICAgICAgYWN0aW9uID0gdGFyZ2V0LmRhdGEoJ2FjdGlvbicpLAogICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlSWQgPSB0YXJnZXQuYXR0cignZGF0YS10ZW1wbGF0ZUlkJyksCiAgICAgICAgICAgICAgICAgICAgY2FzZVN0YXRlID0gdGFyZ2V0LmRhdGEoJ2Nhc2Utc3RhdGUnKSwKICAgICAgICAgICAgICAgICAgICB0YXJnZXRDb250YWluZXIgPSB0YXJnZXQuZGF0YSgnY29udGFpbmVyJyk7CiAgICAgICAgICAgICAgICBoYW5kbGVBY3Rpb25Ecm9wZG93bihlLCBhY3Rpb24sIGNhc2VJZCwgdGVtcGxhdGVJZCwgaW50YWtlQ2FzZU51bWJlciwgY2FzZVN0YXRlLHRhcmdldENvbnRhaW5lciwgaW50YWtlQ2FzZVZlcnNpb24pOwogICAgICAgICAgICAgICAgZS5oYW5kbGVkID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBjYXNlTGlzdFRhYmxlLm9uKCdkcmF3LmR0ZmMnLCBmdW5jdGlvbigpewogICAgICAgICAgICB2YXIgaW5wdXRzID0gY29udGFpbmVyLmZpbmQoImRpdi5EVEZDX1Njcm9sbFdyYXBwZXIgaW5wdXRbZGF0YS1maWVsZD0iK2ZpeGVkRmlsdGVyQ29sTmFtZSsiXSIpOwogICAgICAgICAgICBpZihpbnB1dHMubGVuZ3RoID09PSAzKXsgLy9maXhlZCBjb2xzIGNyZWF0ZXMgdGhyZWUgaW5zdGFuY2VzIG9mIHRoZSBmaWx0ZXIgaW5wdXRzIGluc3RlYWQgb2YgMgogICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gJChpbnB1dHNbMl0pLnZhbCgpOwogICAgICAgICAgICAgICAgJChpbnB1dHNbMF0pLnZhbCh2YWx1ZSk7CiAgICAgICAgICAgICAgICAkKGlucHV0c1sxXSkudmFsKHZhbHVlKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBjYXNlTGlzdFRhYmxlLm9uKCdkcmF3LmR0JywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICBoaWdoTGlnaHRSb3dzKCk7CiAgICAgICAgICAgIGhpZGVDYXNlTGlzdEFjdGlvbkFsbEJ1dHRvbigpOwogICAgICAgICAgICB1bmNoZWNrU2VsZWN0QWxsQ2hlY2tib3goKTsKICAgICAgICAgICAgY29sUmVvcmRlckNhc2VMaXN0KCk7CiAgICAgICAgICAgIHB2dWkuZ3JpZC5tYW5hZ2VVSVdyYXBwZXIuc2V0UGVyZmVjdFNjcm9sbGJhcihjb250YWluZXIpOwogICAgICAgICAgICBwdnVpLmdyaWQubWFuYWdlVUlXcmFwcGVyLmhhbmRsZURyYWdEcm9wRXZlbnQoY29udGFpbmVyKTsKICAgICAgICAgICAgdXBkYXRlR3JpZFVJKCk7CiAgICAgICAgICAgIHB2dWkuZ3JpZC51dGlscy51cGRhdGVHcmlkT25SZXNpemUoY29udGFpbmVyKTsKICAgICAgICAgICAgcHZ1aS5jb21tb24uaGlkZVBWTG9hZGVyKCk7CiAgICAgICAgICAgIHB2dWkuZ3JpZC5tYW5hZ2VVSVdyYXBwZXIucHJldmVudFNjcm9sbGluZ0VtcHR5R3JpZChjb250YWluZXIsIHNjcm9sbGFibGVTZWN0aW9uKTsKICAgICAgICAgICAgcHZ1aS5ncmlkLm1hbmFnZVVJV3JhcHBlci5oYW5kbGVSb3dNb3VzZU92ZXJFdmVudChjb250YWluZXIpOwogICAgICAgICAgICBwdnVpLmdyaWQubWFuYWdlVUlXcmFwcGVyLmJpbmRJY29uSG92ZXJFdmVudHMoY29udGFpbmVyKTsKICAgICAgICAgICAgcHZ1aS5ncmlkLm1hbmFnZVVJV3JhcHBlci5oYW5kbGVHcmlkSG9yaXpvbnRhbFNjcm9sbChjb250YWluZXIpOwogICAgICAgICAgICBtYXNrUElJRmllbGRzKCk7CiAgICAgICAgICAgIHB2dWkuZ3JpZC5tYW5hZ2VVSVdyYXBwZXIuc2V0TW9yZU9wdGlvbihjb250YWluZXIpOwogICAgICAgICAgICBpbml0aWFsaXplUG9wb3ZlcigpOwogICAgICAgIH0pOwogICAgICAgIHJldHVybiBjYXNlTGlzdFRhYmxlOwogICAgfTsKCiAgICB2YXIgY3VycmVudENvbE9yZGVyID0gW107CgogICAgdmFyIGNvbFJlb3JkZXJDYXNlTGlzdCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgbmV3T3JkZXIgPSBidWlsZENvbHVtbk9yZGVyKCk7CiAgICAgICAgaWYgKCFfLmlzRXF1YWwoY3VycmVudENvbE9yZGVyLCBuZXdPcmRlcikpIHsKICAgICAgICAgICAgY2FzZUxpc3RUYWJsZS5jb2xSZW9yZGVyLm9yZGVyKG5ld09yZGVyLCB0cnVlKTsKICAgICAgICAgICAgY3VycmVudENvbE9yZGVyID0gbmV3T3JkZXI7CiAgICAgICAgfQogICAgfTsKCiAgICB2YXIgaGlkZUNhc2VMaXN0QWN0aW9uQWxsQnV0dG9uID0gZnVuY3Rpb24gKCkgewogICAgICAgIGNvbnRhaW5lci5maW5kKCIuYnRuLWNhc2VsaXN0LWFjdGlvbi1hbGwiKS5hZGRDbGFzcygiaGlkZSIpLmF0dHIoImRpc2FibGVkIiwgZmFsc2UpOwogICAgICAgIGNvbnRhaW5lci5maW5kKCIuZ3JpZC10b3AtaGVhZCAuZHJvcGRvd24tbWVudSIpLnBhcmVudCgpLnJlbW92ZUNsYXNzKCdvcGVuJyk7CiAgICB9OwoKICAgIHZhciBzaG93Q29uZmlnQ29scyA9IGZ1bmN0aW9uIChjb2xzKSB7CiAgICAgICAgdmFyIGxpc3RPcmRlciA9IDA7CiAgICAgICAgcmV0dXJuIF8ucmVkdWNlKGNvbHMsIGZ1bmN0aW9uIChjb2xsZWN0aW9uLCBjb2wpIHsKICAgICAgICAgICAgaWYgKCFfLmhhcyhjb2wsICdsaXN0T3JkZXInKSl7CiAgICAgICAgICAgICAgICBjb2wubGlzdE9yZGVyID0gbGlzdE9yZGVyKys7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29sbGVjdGlvbiA9IGNvbGxlY3Rpb24gKyAnPGEgaHJlZj0iIyIgY2xhc3M9Imxpc3QtZ3JvdXAtaXRlbSIgZGF0YS1maWVsZD0iJyArIGNvbC5uYW1lICsgJyI+JyArIGNvbC5sYWJlbCArICc8L2E+JyArICJcbiI7CiAgICAgICAgICAgIHJldHVybiBjb2xsZWN0aW9uOwogICAgICAgIH0sICIiKTsKICAgIH07CgogICAgdmFyIHByZV9sb2FkID0gZnVuY3Rpb24gKCkgewogICAgICAgICQuYWpheCh7CiAgICAgICAgICAgIHVybDogY3JlYXRlVVJMKHB2aV91cmxzLmNhc2VfbGlzdF9jb2x1bW5zX3VybCksCiAgICAgICAgICAgIGNhY2hlOiBmYWxzZSwKICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgIGlmIChkYXRhICYmIGRhdGEubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgIGNvbHVtbkNvbmZpZ3MgPSBfLmNvbGxlY3QoZGF0YSwgZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNmZyA9IHt9OwogICAgICAgICAgICAgICAgICAgICAgICBjZmcubmFtZSA9IGl0ZW0ubmFtZTsKICAgICAgICAgICAgICAgICAgICAgICAgY2ZnLmxhYmVsID0gaXRlbS5sYWJlbDsKICAgICAgICAgICAgICAgICAgICAgICAgY2ZnLnNlcSA9IGl0ZW0uc2VxOwogICAgICAgICAgICAgICAgICAgICAgICBjZmcubGlzdE9yZGVyID0gaXRlbS5saXN0T3JkZXI7CiAgICAgICAgICAgICAgICAgICAgICAgIGNmZy5jb250YWluZXJWaWV3ID0gaXRlbS5jb250YWluZXJWaWV3OwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2ZnOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY29udGFpbmVyLmZpbmQoJy5saXN0LWdyb3VwLXByaW1hcnknKS5odG1sKHNob3dDb25maWdDb2xzKGxpc3RDb2x1bW5zKHB2aV9saXN0X2NvbHVtbnNfdmlldy5wcmltYXJ5Q29scywgdHJ1ZSkpKTsKICAgICAgICAgICAgICAgIGNvbnRhaW5lci5maW5kKCcubGlzdC1ncm91cC1zZWNvbmRhcnknKS5odG1sKHNob3dDb25maWdDb2xzKGxpc3RDb2x1bW5zKHB2aV9saXN0X2NvbHVtbnNfdmlldy5zZWNvbmRhcnlDb2xzLCB0cnVlKSkpOwogICAgICAgICAgICAgICAgY29udGFpbmVyLmZpbmQoJy5saXN0LWdyb3VwLW9wdGlvbmFsJykuaHRtbChzaG93Q29uZmlnQ29scyhsaXN0Q29sdW1ucyhwdmlfbGlzdF9jb2x1bW5zX3ZpZXcub3B0aW9uYWxDb2xzLCB0cnVlKSkpOwogICAgICAgICAgICAgICAgaW5pdCgpOwogICAgICAgICAgICB9LAogICAgICAgICAgICBlcnJvcjpmdW5jdGlvbiAoanFYSFIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duKSB7CiAgICAgICAgICAgICAgICBwdmkudXRpbC5zaG93RmxvYXRpbmdOb3RpZmljYXRpb24uZXJyb3JNZXNzYWdlKGVycm9yVGhyb3duKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfTsKCiAgICB2YXIgY3JlYXRlVVJMID0gZnVuY3Rpb24gKHVybCkgewogICAgICAgIGlmICghdXJsLmVuZHNXaXRoKCIvIikpIHVybCA9IHVybCArICIvIjsKICAgICAgICByZXR1cm4gdXJsICsgcGFnZVR5cGVJZDsKICAgIH07CgogICAgdmFyIGJ1aWxkQ29sdW1uT3JkZXIgPSBmdW5jdGlvbiAoKSB7CgogICAgICAgIHZhciBnZXRQcmVEZWZPcmRlciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIGN1cnJlbnRIZWFkZXIgPSBkYXRhVGFibGUuZmluZCgndGhlYWQgdGgnKTsKICAgICAgICAgICAgcmV0dXJuIF8uY29sbGVjdChjdXJyZW50SGVhZGVyLCBmdW5jdGlvbiAoZWxlKSB7CiAgICAgICAgICAgICAgICBlbGUgPSAkKGVsZSk7CiAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgIGlkeDogZWxlLmRhdGEoJ2lkeCcpLAogICAgICAgICAgICAgICAgICAgIG5hbWU6IGVsZS5hdHRyKCdkYXRhLWZpZWxkJykKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0pOwogICAgICAgIH07CgogICAgICAgIHZhciBidWlsZE5ld09yZGVyID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgcHJlRGVmT3JkZXIgPSBnZXRQcmVEZWZPcmRlcigpOwogICAgICAgICAgICB2YXIgbmV3T3JkZXIgPSBbXTsKICAgICAgICAgICAgdmFyIHNvcnRlZFByaW1hcnlDb2xzID0gbGlzdENvbHVtbnMocHZpX2xpc3RfY29sdW1uc192aWV3LnByaW1hcnlDb2xzLCB0cnVlKTsKICAgICAgICAgICAgaWYgKGluaXRPcmRlcikgewogICAgICAgICAgICAgICAgaW5pdE9yZGVyID0gZmFsc2U7CiAgICAgICAgICAgICAgICBfLmVhY2goc29ydGVkUHJpbWFyeUNvbHMsIGZ1bmN0aW9uIChjZmcpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgZm91bmQgPSBfLmZpbmQocHJlRGVmT3JkZXIsIGZ1bmN0aW9uIChwZCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGNmZy5uYW1lID09PSBwZC5uYW1lKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICBpZiAoZm91bmQpCiAgICAgICAgICAgICAgICAgICAgICAgIG5ld09yZGVyLnB1c2goZm91bmQuaWR4KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuIG5ld09yZGVyOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbmV3T3JkZXIgPSBfLmNvbGxlY3Qoc29ydGVkUHJpbWFyeUNvbHMsIGZ1bmN0aW9uIChjb2xDZmcpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgZm91bmQgPSBfLmZpbmQocHJlRGVmT3JkZXIsIGZ1bmN0aW9uIChlbGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChjb2xDZmcuc2VxID09PSBlbGUuaWR4KTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm91bmQgPyBmb3VuZC5pZHggOiAwOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3T3JkZXI7CiAgICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIGNvbHVtbnMgPSBfLnJhbmdlKDAsIGNvbHVtblNpemUpOwogICAgICAgICAgICB2YXIgbmV3T3JkZXIgPSBidWlsZE5ld09yZGVyKCk7CiAgICAgICAgICAgIHZhciByZXN0Q29sdW1ucyA9IF8uZmlsdGVyKGNvbHVtbnMsIGZ1bmN0aW9uIChpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gIV8uY29udGFpbnMobmV3T3JkZXIsIGkpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdmFyIGZpbmFsT3JkZXIgPSBuZXdPcmRlci5jb25jYXQocmVzdENvbHVtbnMpOwogICAgICAgICAgICBmaW5hbE9yZGVyID0gXy53aXRob3V0KGZpbmFsT3JkZXIsIDAsIDEsIGNvbHVtblNpemUgLSAxKTsKICAgICAgICAgICAgZmluYWxPcmRlci5wdXNoKGNvbHVtblNpemUgLSAxKTsKICAgICAgICAgICAgZmluYWxPcmRlci51bnNoaWZ0KDEpOwogICAgICAgICAgICBmaW5hbE9yZGVyLnVuc2hpZnQoMCk7CiAgICAgICAgICAgIHJldHVybiBmaW5hbE9yZGVyOwogICAgICAgIH07CiAgICAgICAgcmV0dXJuIGluaXQoKTsKICAgIH07CgogICAgdmFyIHJlc2V0UHJvY2Vzc2luZ01lc3NhZ2UgPSBmdW5jdGlvbigpewogICAgICAgICQuZXh0ZW5kKCAkLmZuLmRhdGFUYWJsZS5kZWZhdWx0cywgewogICAgICAgICAgICBsYW5ndWFnZTogewogICAgICAgICAgICAgICAgInByb2Nlc3NpbmciOiAiIgogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9OwoKICAgIHZhciBpbml0TGlzdFBhZ2UgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmVzZXRQcm9jZXNzaW5nTWVzc2FnZSgpOwogICAgICAgIHByZV9sb2FkKCk7CiAgICAgICAgcmVJbml0QnV0dG9uc0FmdGVyUmVkcmF3KCk7CiAgICAgICAgcHZ1aS5ncmlkLnV0aWxzLmFwcGVuZERyb3Bkb3duT3V0c2lkZUNvbnRhaW5lcihjb250YWluZXIsJy50ZC1ib3g+LmRyb3Bkb3duJyk7CiAgICAgICAgcHZpLnJkbC5tYW5hZ2VSZXBvcnREaXN0cmlidXRpb24uaW5pdCgpOwogICAgICAgIGlmKCQoJyNpc0Rhc2hib2FyZFBhZ2UnKS5sZW5ndGggPCAxKSB7CiAgICAgICAgICAgIHB2aS51dGlsLmJpbmRGaWxlVXBsb2FkZXJFdmVudCgpOwogICAgICAgIH0KICAgIH07CgogICAgdmFyIGhpZ2hsaWdodFRhYiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoaW5pdGlhbGl6ZWQpIHsKICAgICAgICAgICAgdmFyIGNvbHVtbiA9IGNhc2VMaXN0VGFibGVSZWYuY2FzZUxpc3RUYWJsZS5jb2x1bW4oJ2Fzc2lnbmVkVG9Vc2VybmFtZTpuYW1lJyk7CiAgICAgICAgICAgIHZhciBhc3NpZ25lZFVzZXJuYW1lID0gY29sdW1uLnNlYXJjaCgpOwogICAgICAgICAgICB2YXIgdGFiQ2xhc3NOYW1lID0gIm15Q2FzZXNCdXR0b24iOwogICAgICAgICAgICBpZigodHlwZW9mIGR1cGxpY2F0ZVNlYXJjaFBhZ2VJZCAhPT0gJ3VuZGVmaW5lZCcpICYmIChwYWdlVHlwZUlkID09PSBkdXBsaWNhdGVTZWFyY2hQYWdlSWQudG9TdHJpbmcoKSkpewogICAgICAgICAgICAgICAgLy9pZiBkdXBsaWNhdGUgc2VhcmNoIHRoZW4gc2VhcmNoIGZvciBhbGwgY2FzZXMgYW5kIG1hcmsgYXNzaWduVG8gZmllbGQgcmVhZCBvbmx5CiAgICAgICAgICAgICAgICBjb250YWluZXIuZmluZCgiI2Fzc2lnbmVlLWZpbHRlciIpLnByb3AoJ3JlYWRvbmx5JywgdHJ1ZSk7CiAgICAgICAgICAgICAgICBjb2x1bW4uc2VhcmNoKCcnKTsKICAgICAgICAgICAgICAgICQoY29sdW1uLmhlYWRlcigpKS5maW5kKCdpbnB1dC5saXN0LWZpbHRlcicpLnZhbCgnJyk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoYXNzaWduZWRVc2VybmFtZSA9PT0gdW5kZWZpbmVkIHx8IGFzc2lnbmVkVXNlcm5hbWUgPT09IGxvZ2luVXNlcikgewogICAgICAgICAgICAgICAgY29udGFpbmVyLmZpbmQoIiNhc3NpZ25lZS1maWx0ZXIiKS5wcm9wKHsncmVhZG9ubHknOiB0cnVlLCAnZGlzYWJsZWQnOiB0cnVlfSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjb250YWluZXIuZmluZCgiI2Fzc2lnbmVlLWZpbHRlciIpLnByb3AoeydyZWFkb25seSc6IGZhbHNlLCAnZGlzYWJsZWQnOiBmYWxzZX0pOwogICAgICAgICAgICAgICAgdGFiQ2xhc3NOYW1lID0gImFsbENhc2VzQnV0dG9uIjsKICAgICAgICAgICAgfQogICAgICAgICAgICBjb250YWluZXIuZmluZCgnLm15Q2FzZXNCdXR0b24sIC5hbGxDYXNlc0J1dHRvbicpLnJlbW92ZUNsYXNzKCdidG4tcG9pbnRlZCcpOwogICAgICAgICAgICBjb250YWluZXIuZmluZCgiLiIgKyB0YWJDbGFzc05hbWUpLmFkZENsYXNzKCdidG4tcG9pbnRlZCcpOwogICAgICAgIH0KICAgIH07CgogICAgaW5pdExpc3RQYWdlKCk7Cgp9OwoKJC5mbi5EYXRhVGFibGUuZXh0LnBhZ2VyLmZ1bGxfbnVtYmVyc19ub19lbGxpcHNlcyA9IGZ1bmN0aW9uIChwYWdlLCBwYWdlcykgewogICAgdmFyIG51bWJlcnMgPSBbXTsKICAgICQuZm4uRGF0YVRhYmxlLmV4dC5wYWdlci5udW1iZXJzX2xlbmd0aCA9IDU7CiAgICB2YXIgYnV0dG9ucyA9ICQuZm4uRGF0YVRhYmxlLmV4dC5wYWdlci5udW1iZXJzX2xlbmd0aDsKICAgIHZhciBoYWxmID0gTWF0aC5mbG9vcihidXR0b25zIC8gMik7CiAgICB2YXIgX3JhbmdlID0gZnVuY3Rpb24gKGxlbiwgc3RhcnQpIHsKICAgICAgICB2YXIgZW5kOwogICAgICAgIGlmICh0eXBlb2Ygc3RhcnQgPT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgICAgIHN0YXJ0ID0gMDsKICAgICAgICAgICAgZW5kID0gbGVuOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGVuZCA9IHN0YXJ0OwogICAgICAgICAgICBzdGFydCA9IGxlbjsKICAgICAgICB9CiAgICAgICAgdmFyIG91dCA9IFtdOwogICAgICAgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgaSsrKSB7CiAgICAgICAgICAgIG91dC5wdXNoKGkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gb3V0OwogICAgfTsKICAgIGlmIChwYWdlcyA8PSBidXR0b25zKSB7CiAgICAgICAgbnVtYmVycyA9IF9yYW5nZSgwLCBwYWdlcyk7CiAgICB9IGVsc2UgaWYgKHBhZ2UgPD0gaGFsZikgewogICAgICAgIG51bWJlcnMgPSBfcmFuZ2UoMCwgYnV0dG9ucyk7CiAgICB9IGVsc2UgaWYgKHBhZ2UgPj0gcGFnZXMgLSAxIC0gaGFsZikgewogICAgICAgIG51bWJlcnMgPSBfcmFuZ2UocGFnZXMgLSBidXR0b25zLCBwYWdlcyk7CiAgICB9IGVsc2UgewogICAgICAgIG51bWJlcnMgPSBfcmFuZ2UocGFnZSAtIGhhbGYsIHBhZ2UgKyBoYWxmICsgMSk7CiAgICB9CiAgICBudW1iZXJzLkRUX2VsID0gJ3NwYW4nOwogICAgcmV0dXJuIFsnZmlyc3QnLCAncHJldmlvdXMnLCBudW1iZXJzLCAnbmV4dCcsICdsYXN0J107Cn07CgovKgogKiBGaWxlOiAgICAgICAgc3BlZWNoUmVjb2dTZWFyY2guanMKICogRGVzY3JpcHRpb246IFRoaXMgZmlsZSBpcyB1c2VkIGZvciBzcGVlY2ggcmVjb2duaXRpb24gaW4gU2VhcmNoIENhc2VzIGlucHV0IGluIGNhc2UgbGlzdCBzY3JlZW4KICogQXV0aG9yOiAgICAgIEdhdXRhbSBNYWxob3RyYSwgUGFydmVlbiBTb25pIFJ4TG9naXgKICogRGF0ZTogICAgICAgIDMxLUp1bHktMjAxNwogKiBVc2FnZTogICAgICAgVG8gcmVjb3JkIHVzZXIgc3BlZWNoIGFzIHRleHQgaW5wdXQgZm9yIHNlYXJjaCBjcml0ZXJpYSBpbiBjYXNlIGxpc3Qgc2NyZWVuCiAqIENvcHlyaWdodDogICBSeExvZ2l4IENvcnBvcmF0aW9uCiAqIFZlcnNpb246ICAgICBpbml0aWFsIHJlbGVhc2UgMC4xCiAqIHJlcXVpcmU6ICAgICBqUXVlcnkKICoKICogQ2hhbmdlIE1hbmFnZW1lbnQ6CiAqIE5hbWUgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb24gICAgIEF1dGhvciAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEZXNjcmlwdGlvbgogKiBzcGVlY2hSZWNvZ1NlYXJjaC5qcyAgICAgICAgICAgICAwLjEgICAgICAgICBHYXV0YW0gTWFsaG90cmEsIFBhcnZlZW4gU29uaSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSW5pdGlhbCBWZXJzaW9uCiAqCiAqLwoKKGZ1bmN0aW9uKCl7CiAgICB2YXIgZmluYWxfdHJhbnNjcmlwdCA9ICcnOwogICAgdmFyIHJlY29nbml6aW5nID0gZmFsc2U7CiAgICB2YXIgcmVjb2duaXRpb247CiAgICB2YXIgbWljRWxlbWVudCA9ICQoJyNtaWMnKTsKICAgIHRyeSB7CiAgICAgICAgaWYoISd3ZWJraXRTcGVlY2hSZWNvZ25pdGlvbicgaW4gd2luZG93KXsKICAgICAgICAgICAgcmVjb2duaXRpb249IG5ldyAod2luZG93LlNwZWVjaFJlY29nbml0aW9uIHx8IHdpbmRvdy5tb3pTcGVlY2hSZWNvZ25pdGlvbiB8fCB3aW5kb3cubXNTcGVlY2hSZWNvZ25pdGlvbikoKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHJlY29nbml0aW9uID0gbmV3IHdlYmtpdFNwZWVjaFJlY29nbml0aW9uKCk7CiAgICAgICAgfQogICAgfQogICAgY2F0Y2ggKGUpIHsKICAgICAgICByZWNvZ25pdGlvbiA9IHt9OwogICAgfQogICAgcmVjb2duaXRpb24uY29udGludW91cyA9IHRydWU7CiAgICByZWNvZ25pdGlvbi5pbnRlcmltUmVzdWx0cyA9IHRydWU7CiAgICByZWNvZ25pdGlvbi5vbnN0YXJ0ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgcmVjb2duaXppbmcgPSB0cnVlOwogICAgfTsKCiAgICByZWNvZ25pdGlvbi5vbmVycm9yID0gZnVuY3Rpb24oZXZlbnQpIHsKICAgICAgICBjb25zb2xlLmxvZyhldmVudC5lcnJvcik7CiAgICB9OwoKICAgIHJlY29nbml0aW9uLm9uZW5kID0gZnVuY3Rpb24oKSB7CiAgICAgICAgcmVjb2duaXppbmcgPSBmYWxzZTsKICAgICAgICAkKCcuc2VhcmNoLWJ1dHRvbicpLnRyaWdnZXIoJ2NsaWNrJyk7CiAgICB9OwoKICAgIHJlY29nbml0aW9uLm9ucmVzdWx0ID0gZnVuY3Rpb24oZXZlbnQpIHsKICAgICAgICB2YXIgaW50ZXJpbV90cmFuc2NyaXB0ID0gJyc7CiAgICAgICAgZm9yICh2YXIgaSA9IGV2ZW50LnJlc3VsdEluZGV4OyBpIDwgZXZlbnQucmVzdWx0cy5sZW5ndGg7ICsraSkgewogICAgICAgICAgICBpZiAoZXZlbnQucmVzdWx0c1tpXS5pc0ZpbmFsKSB7CiAgICAgICAgICAgICAgICBmaW5hbF90cmFuc2NyaXB0ICs9IGV2ZW50LnJlc3VsdHNbaV1bMF0udHJhbnNjcmlwdDsKICAgICAgICAgICAgICAgIC8vYWRkIHZvaWNlIHRleHQgdG8gdGhlIHNlYXJjaCBmaWVsZAogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInNpbXBsZVNlYXJjaEZpZWxkIikudmFsdWUgPSBmaW5hbF90cmFuc2NyaXB0OwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgaW50ZXJpbV90cmFuc2NyaXB0ICs9IGV2ZW50LnJlc3VsdHNbaV1bMF0udHJhbnNjcmlwdDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBmaW5hbF90cmFuc2NyaXB0ID0gY2FwaXRhbGl6ZShmaW5hbF90cmFuc2NyaXB0KTsKICAgICAgICBmaW5hbF9zcGFuLmlubmVySFRNTCA9IGxpbmVicmVhayhmaW5hbF90cmFuc2NyaXB0KTsKICAgICAgICBpbnRlcmltX3NwYW4uaW5uZXJIVE1MID0gbGluZWJyZWFrKGludGVyaW1fdHJhbnNjcmlwdCk7CgogICAgfTsKCiAgICB2YXIgdHdvX2xpbmUgPSAvXG5cbi9nOwogICAgdmFyIG9uZV9saW5lID0gL1xuL2c7CiAgICBmdW5jdGlvbiBsaW5lYnJlYWsocykgewogICAgICAgIHJldHVybiBzLnJlcGxhY2UodHdvX2xpbmUsICc8cD48L3A+JykucmVwbGFjZShvbmVfbGluZSwgJzxicj4nKTsKICAgIH0KCiAgICBmdW5jdGlvbiBjYXBpdGFsaXplKHMpIHsKICAgICAgICByZXR1cm4gcy5yZXBsYWNlKHMuc3Vic3RyKDAsMSksIGZ1bmN0aW9uKG0pIHsgcmV0dXJuIG0udG9VcHBlckNhc2UoKTsgfSk7CiAgICB9CgogICAgbWljRWxlbWVudC5jbGljayhmdW5jdGlvbihldmVudCl7CiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICBpZiAocmVjb2duaXppbmcpIHsKICAgICAgICAgICAgcmVjb2duaXRpb24uc3RvcCgpOwogICAgICAgICAgICBtaWNFbGVtZW50LnJlbW92ZUNsYXNzKCdmYS1taWNyb3Bob25lJyk7CiAgICAgICAgICAgIG1pY0VsZW1lbnQuYWRkQ2xhc3MoJ2ZhLW1pY3JvcGhvbmUtc2xhc2gnKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBtaWNFbGVtZW50LnJlbW92ZUNsYXNzKCdmYS1taWNyb3Bob25lLXNsYXNoJyk7CiAgICAgICAgbWljRWxlbWVudC5hZGRDbGFzcygnZmEtbWljcm9waG9uZScpOwogICAgICAgIGZpbmFsX3RyYW5zY3JpcHQgPSAnJzsKICAgICAgICByZWNvZ25pdGlvbi5sYW5nID0gJ2VuLVVTJzsKICAgICAgICByZWNvZ25pdGlvbi5pbnRlcmltUmVzdWx0cyA9IGZhbHNlOwogICAgICAgIHJlY29nbml0aW9uLnN0YXJ0KCk7CiAgICAgICAgZmluYWxfc3Bhbi5pbm5lckhUTUwgPSAnJzsKICAgICAgICBpbnRlcmltX3NwYW4uaW5uZXJIVE1MID0gJyc7CiAgICB9KTsKfSkoKTsKCi8vIFRoaXMgaXMgYSBtYW5pZmVzdCBmaWxlIHRoYXQnbGwgYmUgY29tcGlsZWQgaW50byBkYXNoYm9hcmQtbWFuaWZlc3QuanMuCi8vCi8vIEFueSBKYXZhU2NyaXB0IGZpbGUgd2l0aGluIHRoaXMgZGlyZWN0b3J5IGNhbiBiZSByZWZlcmVuY2VkIGhlcmUgdXNpbmcgYSByZWxhdGl2ZSBwYXRoLgovLwovLyBZb3UncmUgZnJlZSB0byBhZGQgYXBwbGljYXRpb24td2lkZSBKYXZhU2NyaXB0IHRvIHRoaXMgZmlsZSwgYnV0IGl0J3MgZ2VuZXJhbGx5IGJldHRlcgovLyB0byBjcmVhdGUgc2VwYXJhdGUgSmF2YVNjcmlwdCBmaWxlcyBhcyBuZWVkZWQuCi8vCi8vPSByZXF1aXJlIHZlbmRvclVpL2dyaWRzdGFjay9ncmlkc3RhY2subWluCi8vPSByZXF1aXJlIHZlbmRvclVpL2dyaWRzdGFjay9ncmlkc3RhY2sualF1ZXJ5VUkubWluCi8vPSByZXF1aXJlIHZlbmRvclVpL2NvdW50ZXJ1cC9qcXVlcnkuY291bnRlcnVwLm1pbgovLz0gcmVxdWlyZSBhcHAvZGFzaGJvYXJkL2Rhc2hib2FyZAovLz0gcmVxdWlyZSBhcHAvbGlzdC9saXN0LW1hbmlmZXN0Cg==</ActualData>
          </HTTPData>
        </HTTPDataSet>
        <IsExternalData>false</IsExternalData>
      </HTTPBody>
      <TcpPackets>
        <PacketInfo time="620993484" offset="0" length="16384" />
        <PacketInfo time="620993500" offset="16384" length="16384" />
        <PacketInfo time="620993500" offset="32768" length="16384" />
        <PacketInfo time="620993515" offset="49152" length="16384" />
        <PacketInfo time="620993515" offset="65536" length="16384" />
        <PacketInfo time="620993531" offset="81920" length="16384" />
        <PacketInfo time="620993531" offset="98304" length="1484" />
      </TcpPackets>
    </HTTPResponse>
    <HTTPTask id="601" hostname="10.100.22.228:8081" path="/assets/pv-btn-bg-fe78a517c666e4e5b987b878badafa68.jpg" url="http://10.100.22.228:8081/assets/pv-btn-bg-fe78a517c666e4e5b987b878badafa68.jpg" ip="10.100.22.228" port="8081" connectionId="36" origin="HTML" frame="1" startDateTime="2020-07-13T17:29:18.102+05:30" startTime="620993140" endTime="620993578">
      <HTTPRequest method="GET">
        <HTTPHeaders>
          <HTTPHeaderEntity name="Host" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MTAuMTAwLjIyLjIyODo4MDgx</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Connection" index="1">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>a2VlcC1hbGl2ZQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="User-Agent" index="2">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzgzLjAuNDEwMy4xMTYgU2FmYXJpLzUzNy4zNg==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Accept" index="3">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>aW1hZ2Uvd2VicCxpbWFnZS9hcG5nLGltYWdlLyosKi8qO3E9MC44</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Referer" index="4">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>aHR0cDovLzEwLjEwMC4yMi4yMjg6ODA4MS9hc3NldHMvYXBwbGljYXRpb24tMTNhMWRkYWUyNjdiN2I2YTMyZDEyY2ZiMWFjOThlNDMuY3Nz</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Accept-Encoding" index="5">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Z3ppcCwgZGVmbGF0ZQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Accept-Language" index="6">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>ZW4tVVMsZW47cT0wLjk=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Cookie" index="7">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>U0VTU0lPTj0xZmVlMTIwMC05NDQxLTQyYzUtYTUxYS1iMjhhZmU4OGVjYjQ7IEF1dGhUeXBlPURhdGFiYXNl</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPAllHeaders>
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>R0VUIC9hc3NldHMvcHYtYnRuLWJnLWZlNzhhNTE3YzY2NmU0ZTViOTg3Yjg3OGJhZGFmYTY4LmpwZyBIVFRQLzEuMQ0KSG9zdDogMTAuMTAwLjIyLjIyODo4MDgxDQpDb25uZWN0aW9uOiBrZWVwLWFsaXZlDQpVc2VyLUFnZW50OiBNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvODMuMC40MTAzLjExNiBTYWZhcmkvNTM3LjM2DQpBY2NlcHQ6IGltYWdlL3dlYnAsaW1hZ2UvYXBuZyxpbWFnZS8qLCovKjtxPTAuOA0KUmVmZXJlcjogaHR0cDovLzEwLjEwMC4yMi4yMjg6ODA4MS9hc3NldHMvYXBwbGljYXRpb24tMTNhMWRkYWUyNjdiN2I2YTMyZDEyY2ZiMWFjOThlNDMuY3NzDQpBY2NlcHQtRW5jb2Rpbmc6IGd6aXAsIGRlZmxhdGUNCkFjY2VwdC1MYW5ndWFnZTogZW4tVVMsZW47cT0wLjkNCkNvb2tpZTogU0VTU0lPTj0xZmVlMTIwMC05NDQxLTQyYzUtYTUxYS1iMjhhZmU4OGVjYjQ7IEF1dGhUeXBlPURhdGFiYXNlDQoNCg==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPAllHeaders>
          <HTTPCookies>
            <HTTPHeaderEntity name="SESSION" index="0">
              <HTTPDataSet>
                <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                  <ActualData>MWZlZTEyMDAtOTQ0MS00MmM1LWE1MWEtYjI4YWZlODhlY2I0</ActualData>
                </HTTPData>
              </HTTPDataSet>
              <IsExternalData>false</IsExternalData>
            </HTTPHeaderEntity>
            <HTTPHeaderEntity name="AuthType" index="1">
              <HTTPDataSet>
                <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                  <ActualData>RGF0YWJhc2U=</ActualData>
                </HTTPData>
              </HTTPDataSet>
              <IsExternalData>false</IsExternalData>
            </HTTPHeaderEntity>
          </HTTPCookies>
        </HTTPHeaders>
      </HTTPRequest>
      <HTTPResponse>
        <contentLenght>1708</contentLenght>
        <HTTPHeaders>
          <HTTPHeaderEntity name="X-Frame-Options" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>REVOWQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Last-Modified" index="1">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>RnJpLCAxMCBKdWwgMjAyMCAxMTo1ODo1MiBHTVQ=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="ETag" index="2">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>InB2LWJ0bi1iZy1mZTc4YTUxN2M2NjZlNGU1Yjk4N2I4NzhiYWRhZmE2OC5qcGci</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Vary" index="3">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>QWNjZXB0LUVuY29kaW5n</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Cache-Control" index="4">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>cHVibGljLCBtYXgtYWdlPTMxNTM2MDAw</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Content-Type" index="5">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>aW1hZ2UvanBlZztjaGFyc2V0PVVURi04</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Content-Length" index="6">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MTcwOA==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Date" index="7">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>TW9uLCAxMyBKdWwgMjAyMCAxMToyNTo1MiBHTVQ=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPAllHeaders>
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>SFRUUC8xLjEgMjAwIA0KWC1GcmFtZS1PcHRpb25zOiBERU5ZDQpMYXN0LU1vZGlmaWVkOiBGcmksIDEwIEp1bCAyMDIwIDExOjU4OjUyIEdNVA0KRVRhZzogInB2LWJ0bi1iZy1mZTc4YTUxN2M2NjZlNGU1Yjk4N2I4NzhiYWRhZmE2OC5qcGciDQpWYXJ5OiBBY2NlcHQtRW5jb2RpbmcNCkNhY2hlLUNvbnRyb2w6IHB1YmxpYywgbWF4LWFnZT0zMTUzNjAwMA0KQ29udGVudC1UeXBlOiBpbWFnZS9qcGVnO2NoYXJzZXQ9VVRGLTgNCkNvbnRlbnQtTGVuZ3RoOiAxNzA4DQpEYXRlOiBNb24sIDEzIEp1bCAyMDIwIDExOjI1OjUyIEdNVA0KDQo=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPAllHeaders>
        </HTTPHeaders>
        <HTTPBody>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QN4aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzEzMiA3OS4xNTkyODQsIDIwMTYvMDQvMTktMTM6MTM6NDAgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6ODUwNzNmZDYtYjRhOS00MTVlLTg0OWUtZDI1OTkzNzZlMjQwIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjlFNjZENjk3RTc3RDExRTY4OEEwODU5QjcwQUQwQjE5IiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjlFNjZENjk2RTc3RDExRTY4OEEwODU5QjcwQUQwQjE5IiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIEluRGVzaWduIENDIDIwMTcgKE1hY2ludG9zaCkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDoxQzNEMzJFNUU0OTQxMUU2QjAzRDg2RjM4MkYzQTVDRCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDoxQzNEMzJFNkU0OTQxMUU2QjAzRDg2RjM4MkYzQTVDRCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pv/uAA5BZG9iZQBkwAAAAAH/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQECAgICAgICAgICAgMDAwMDAwMDAwMBAQEBAQEBAgEBAgICAQICAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA//AABEIACgAAgMBEQACEQEDEQH/xAGiAAAABgIDAQAAAAAAAAAAAAAHCAYFBAkDCgIBAAsBAAAGAwEBAQAAAAAAAAAAAAYFBAMHAggBCQAKCxAAAgEDBAEDAwIDAwMCBgl1AQIDBBEFEgYhBxMiAAgxFEEyIxUJUUIWYSQzF1JxgRhikSVDobHwJjRyChnB0TUn4VM2gvGSokRUc0VGN0djKFVWVxqywtLi8mSDdJOEZaOzw9PjKThm83UqOTpISUpYWVpnaGlqdnd4eXqFhoeIiYqUlZaXmJmapKWmp6ipqrS1tre4ubrExcbHyMnK1NXW19jZ2uTl5ufo6er09fb3+Pn6EQACAQMCBAQDBQQEBAYGBW0BAgMRBCESBTEGACITQVEHMmEUcQhCgSORFVKhYhYzCbEkwdFDcvAX4YI0JZJTGGNE8aKyJjUZVDZFZCcKc4OTRnTC0uLyVWV1VjeEhaOzw9Pj8ykalKS0xNTk9JWltcXV5fUoR1dmOHaGlqa2xtbm9md3h5ent8fX5/dIWGh4iJiouMjY6Pg5SVlpeYmZqbnJ2en5KjpKWmp6ipqqusra6vr/2gAMAwEAAhEDEQA/ALJv7xZH/len/wCp83/R/v5qPrty/wB+zf723+frnp4F1/G/7T0F38aX/joP9uf+K+x7/V7+iP2f7HQ2/dY/h/l0Wz/Sdjv9TT/+fOm+v/JHuS9Nt6/yHQ48OP8AhH7OiQ/x+f8A46t+n/Up9P8AVfX6+1v7vHp/Lox+mHp/q/b0Fv3Df0P6bfoP1/p+j6f7x7Ff0sf8Dftf/oDo98M/0/8AnGf83X//2Q==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPBody>
        <TcpPackets>
          <PacketInfo time="620993578" offset="0" length="2013" />
        </TcpPackets>
      </HTTPResponse>
    </HTTPTask>
    <HTTPTask id="603" hostname="10.100.22.228:8081" path="/assets/section-hd-bg-8eaf77fc4a1a47c48ca4b2e3d5a96340.jpg" url="http://10.100.22.228:8081/assets/section-hd-bg-8eaf77fc4a1a47c48ca4b2e3d5a96340.jpg" ip="10.100.22.228" port="8081" connectionId="40" origin="HTML" frame="1" startDateTime="2020-07-13T17:29:18.124+05:30" startTime="620993140" endTime="620993593">
      <HTTPRequest method="GET">
        <HTTPHeaders>
          <HTTPHeaderEntity name="Host" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MTAuMTAwLjIyLjIyODo4MDgx</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Connection" index="1">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>a2VlcC1hbGl2ZQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="User-Agent" index="2">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzgzLjAuNDEwMy4xMTYgU2FmYXJpLzUzNy4zNg==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Accept" index="3">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>aW1hZ2Uvd2VicCxpbWFnZS9hcG5nLGltYWdlLyosKi8qO3E9MC44</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Referer" index="4">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>aHR0cDovLzEwLjEwMC4yMi4yMjg6ODA4MS9hc3NldHMvYXBwbGljYXRpb24tMTNhMWRkYWUyNjdiN2I2YTMyZDEyY2ZiMWFjOThlNDMuY3Nz</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Accept-Encoding" index="5">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Z3ppcCwgZGVmbGF0ZQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Accept-Language" index="6">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>ZW4tVVMsZW47cT0wLjk=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Cookie" index="7">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>U0VTU0lPTj0xZmVlMTIwMC05NDQxLTQyYzUtYTUxYS1iMjhhZmU4OGVjYjQ7IEF1dGhUeXBlPURhdGFiYXNl</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPAllHeaders>
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>R0VUIC9hc3NldHMvc2VjdGlvbi1oZC1iZy04ZWFmNzdmYzRhMWE0N2M0OGNhNGIyZTNkNWE5NjM0MC5qcGcgSFRUUC8xLjENCkhvc3Q6IDEwLjEwMC4yMi4yMjg6ODA4MQ0KQ29ubmVjdGlvbjoga2VlcC1hbGl2ZQ0KVXNlci1BZ2VudDogTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzgzLjAuNDEwMy4xMTYgU2FmYXJpLzUzNy4zNg0KQWNjZXB0OiBpbWFnZS93ZWJwLGltYWdlL2FwbmcsaW1hZ2UvKiwqLyo7cT0wLjgNClJlZmVyZXI6IGh0dHA6Ly8xMC4xMDAuMjIuMjI4OjgwODEvYXNzZXRzL2FwcGxpY2F0aW9uLTEzYTFkZGFlMjY3YjdiNmEzMmQxMmNmYjFhYzk4ZTQzLmNzcw0KQWNjZXB0LUVuY29kaW5nOiBnemlwLCBkZWZsYXRlDQpBY2NlcHQtTGFuZ3VhZ2U6IGVuLVVTLGVuO3E9MC45DQpDb29raWU6IFNFU1NJT049MWZlZTEyMDAtOTQ0MS00MmM1LWE1MWEtYjI4YWZlODhlY2I0OyBBdXRoVHlwZT1EYXRhYmFzZQ0KDQo=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPAllHeaders>
          <HTTPCookies>
            <HTTPHeaderEntity name="SESSION" index="0">
              <HTTPDataSet>
                <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                  <ActualData>MWZlZTEyMDAtOTQ0MS00MmM1LWE1MWEtYjI4YWZlODhlY2I0</ActualData>
                </HTTPData>
              </HTTPDataSet>
              <IsExternalData>false</IsExternalData>
            </HTTPHeaderEntity>
            <HTTPHeaderEntity name="AuthType" index="1">
              <HTTPDataSet>
                <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                  <ActualData>RGF0YWJhc2U=</ActualData>
                </HTTPData>
              </HTTPDataSet>
              <IsExternalData>false</IsExternalData>
            </HTTPHeaderEntity>
          </HTTPCookies>
        </HTTPHeaders>
      </HTTPRequest>
      <HTTPResponse>
        <contentLenght>1606</contentLenght>
        <HTTPHeaders>
          <HTTPHeaderEntity name="X-Frame-Options" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>REVOWQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Last-Modified" index="1">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>RnJpLCAxMCBKdWwgMjAyMCAxMTo1ODo1NCBHTVQ=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="ETag" index="2">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>InNlY3Rpb24taGQtYmctOGVhZjc3ZmM0YTFhNDdjNDhjYTRiMmUzZDVhOTYzNDAuanBnIg==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Vary" index="3">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>QWNjZXB0LUVuY29kaW5n</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Cache-Control" index="4">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>cHVibGljLCBtYXgtYWdlPTMxNTM2MDAw</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Content-Type" index="5">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>aW1hZ2UvanBlZztjaGFyc2V0PVVURi04</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Content-Length" index="6">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MTYwNg==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Date" index="7">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>TW9uLCAxMyBKdWwgMjAyMCAxMToyNTo1MiBHTVQ=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPAllHeaders>
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>SFRUUC8xLjEgMjAwIA0KWC1GcmFtZS1PcHRpb25zOiBERU5ZDQpMYXN0LU1vZGlmaWVkOiBGcmksIDEwIEp1bCAyMDIwIDExOjU4OjU0IEdNVA0KRVRhZzogInNlY3Rpb24taGQtYmctOGVhZjc3ZmM0YTFhNDdjNDhjYTRiMmUzZDVhOTYzNDAuanBnIg0KVmFyeTogQWNjZXB0LUVuY29kaW5nDQpDYWNoZS1Db250cm9sOiBwdWJsaWMsIG1heC1hZ2U9MzE1MzYwMDANCkNvbnRlbnQtVHlwZTogaW1hZ2UvanBlZztjaGFyc2V0PVVURi04DQpDb250ZW50LUxlbmd0aDogMTYwNg0KRGF0ZTogTW9uLCAxMyBKdWwgMjAyMCAxMToyNTo1MiBHTVQNCg0K</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPAllHeaders>
        </HTTPHeaders>
        <HTTPBody>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QN4aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzEzMiA3OS4xNTkyODQsIDIwMTYvMDQvMTktMTM6MTM6NDAgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6ODUwNzNmZDYtYjRhOS00MTVlLTg0OWUtZDI1OTkzNzZlMjQwIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjgxNjA4RkI0RTZEMjExRTY4OTI2QzAwNTczQ0JGQTQ0IiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjgxNjA4RkIzRTZEMjExRTY4OTI2QzAwNTczQ0JGQTQ0IiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIEluRGVzaWduIENDIDIwMTcgKE1hY2ludG9zaCkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1OTBENDIyOUU0OTQxMUU2QTREQ0RDRjE5NjI4RjcyMiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1OTBENDIyQUU0OTQxMUU2QTREQ0RDRjE5NjI4RjcyMiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pv/uAA5BZG9iZQBkwAAAAAH/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQECAgICAgICAgICAgMDAwMDAwMDAwMBAQEBAQEBAgEBAgICAQICAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA//AABEIACQAAQMBEQACEQEDEQH/xAGiAAAABgIDAQAAAAAAAAAAAAAHCAYFBAkDCgIBAAsBAAAGAwEBAQAAAAAAAAAAAAYFBAMHAggBCQAKCxAAAgEDBAEDAwIDAwMCBgl1AQIDBBEFEgYhBxMiAAgxFEEyIxUJUUIWYSQzF1JxgRhikSVDobHwJjRyChnB0TUn4VM2gvGSokRUc0VGN0djKFVWVxqywtLi8mSDdJOEZaOzw9PjKThm83UqOTpISUpYWVpnaGlqdnd4eXqFhoeIiYqUlZaXmJmapKWmp6ipqrS1tre4ubrExcbHyMnK1NXW19jZ2uTl5ufo6er09fb3+Pn6EQACAQMCBAQDBQQEBAYGBW0BAgMRBCESBTEGACITQVEHMmEUcQhCgSORFVKhYhYzCbEkwdFDcvAX4YI0JZJTGGNE8aKyJjUZVDZFZCcKc4OTRnTC0uLyVWV1VjeEhaOzw9Pj8ykalKS0xNTk9JWltcXV5fUoR1dmOHaGlqa2xtbm9md3h5ent8fX5/dIWGh4iJiouMjY6Pg5SVlpeYmZqbnJ2en5KjpKWmp6ipqqusra6vr/2gAMAwEAAhEDEQA/AN8v+NH/AI6j/ko/9G+90PXugY/vF/zdX/kr2/1rovf96f8Aa5P+TvfutVHSG976p13+1/02f+qnuvf8ut9vz6//2Q==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPBody>
        <TcpPackets>
          <PacketInfo time="620993578" offset="0" length="1915" />
        </TcpPackets>
      </HTTPResponse>
    </HTTPTask>
  </HTTPTask>
</HTTPSnapshot>